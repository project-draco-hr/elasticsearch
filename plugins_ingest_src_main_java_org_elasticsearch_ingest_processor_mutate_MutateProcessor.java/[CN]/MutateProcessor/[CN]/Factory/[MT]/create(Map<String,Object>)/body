{
  Map<String,Object> update=ConfigurationUtils.readOptionalObjectMap(config,"update");
  Map<String,String> rename=ConfigurationUtils.readOptionalStringMap(config,"rename");
  Map<String,String> convert=ConfigurationUtils.readOptionalStringMap(config,"convert");
  Map<String,String> split=ConfigurationUtils.readOptionalStringMap(config,"split");
  Map<String,List<String>> gsubConfig=ConfigurationUtils.readOptionalStringListMap(config,"gsub");
  Map<String,String> join=ConfigurationUtils.readOptionalStringMap(config,"join");
  List<String> remove=ConfigurationUtils.readOptionalStringList(config,"remove");
  List<String> trim=ConfigurationUtils.readOptionalStringList(config,"trim");
  List<String> uppercase=ConfigurationUtils.readOptionalStringList(config,"uppercase");
  List<String> lowercase=ConfigurationUtils.readOptionalStringList(config,"lowercase");
  Map<String,Tuple<Pattern,String>> gsub=null;
  if (gsubConfig != null) {
    gsub=new HashMap<>();
    for (    Map.Entry<String,List<String>> entry : gsubConfig.entrySet()) {
      List<String> searchAndReplace=entry.getValue();
      if (searchAndReplace.size() != 2) {
        throw new IllegalArgumentException("Invalid search and replace values (" + Arrays.toString(searchAndReplace.toArray()) + ") for field: "+ entry.getKey());
      }
      Pattern searchPattern=Pattern.compile(searchAndReplace.get(0));
      gsub.put(entry.getKey(),new Tuple<>(searchPattern,searchAndReplace.get(1)));
    }
  }
  return new MutateProcessor((update == null) ? null : Collections.unmodifiableMap(update),(rename == null) ? null : Collections.unmodifiableMap(rename),(convert == null) ? null : Collections.unmodifiableMap(convert),(split == null) ? null : Collections.unmodifiableMap(split),(gsub == null) ? null : Collections.unmodifiableMap(gsub),(join == null) ? null : Collections.unmodifiableMap(join),(remove == null) ? null : Collections.unmodifiableList(remove),(trim == null) ? null : Collections.unmodifiableList(trim),(uppercase == null) ? null : Collections.unmodifiableList(uppercase),(lowercase == null) ? null : Collections.unmodifiableList(lowercase));
}
