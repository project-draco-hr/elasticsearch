{
  if (!fieldMapper.isEnableLatLon()) {
    throw new ElasticsearchIllegalArgumentException("lat/lon is not enabled (indexed) for field [" + fieldMapper.name() + "], can't use indexed filter on it");
  }
  if (topLeft.lon() > bottomRight.lon()) {
    return new LeftGeoBoundingBoxFilter(topLeft,bottomRight,fieldMapper);
  }
 else {
    return new RightGeoBoundingBoxFilter(topLeft,bottomRight,fieldMapper);
  }
}
