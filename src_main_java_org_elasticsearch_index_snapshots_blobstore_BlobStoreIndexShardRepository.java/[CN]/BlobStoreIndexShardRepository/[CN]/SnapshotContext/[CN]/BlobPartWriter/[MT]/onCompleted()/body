{
  int nextPart=part + 1;
  if (nextPart < fileInfo.numberOfParts()) {
    try {
      writeBlob(indexInput,fileInfo,nextPart,latch,failures);
    }
 catch (    Throwable t) {
      onFailure(t);
    }
  }
 else {
    try {
      Store.verify(indexInput);
      indexInput.close();
      snapshotStatus.addProcessedFile(fileInfo.length());
    }
 catch (    Throwable t) {
      onFailure(t);
      return;
    }
    latch.countDown();
  }
}
