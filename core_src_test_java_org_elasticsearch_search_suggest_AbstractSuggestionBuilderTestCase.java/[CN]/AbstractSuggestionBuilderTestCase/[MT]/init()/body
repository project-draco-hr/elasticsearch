{
  Path genericConfigFolder=createTempDir();
  Settings baseSettings=settingsBuilder().put(Environment.PATH_HOME_SETTING.getKey(),createTempDir().toString()).put(Environment.PATH_CONF_SETTING.getKey(),genericConfigFolder).build();
  Environment environment=new Environment(baseSettings);
  ScriptContextRegistry scriptContextRegistry=new ScriptContextRegistry(Collections.emptyList());
  ScriptEngineRegistry scriptEngineRegistry=new ScriptEngineRegistry(Collections.singletonList(new ScriptEngineRegistry.ScriptEngineRegistration(TestEngineService.class,TestEngineService.TYPES)));
  ScriptSettings scriptSettings=new ScriptSettings(scriptEngineRegistry,scriptContextRegistry);
  suggesters=new Suggesters(Collections.emptyMap());
  namedWriteableRegistry=new NamedWriteableRegistry();
  namedWriteableRegistry.registerPrototype(SuggestionBuilder.class,TermSuggestionBuilder.PROTOTYPE);
  namedWriteableRegistry.registerPrototype(SuggestionBuilder.class,PhraseSuggestionBuilder.PROTOTYPE);
  namedWriteableRegistry.registerPrototype(SuggestionBuilder.class,CompletionSuggestionBuilder.PROTOTYPE);
  queriesRegistry=new SearchModule(Settings.EMPTY,namedWriteableRegistry).buildQueryParserRegistry();
  parseFieldMatcher=ParseFieldMatcher.STRICT;
}
