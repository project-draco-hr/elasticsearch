{
  int numRanges=randomIntBetween(1,10);
  List<Range> ranges=new ArrayList<>(numRanges);
  for (int i=0; i < numRanges; i++) {
    String key=null;
    if (randomBoolean()) {
      key=randomAsciiOfLengthBetween(1,20);
    }
    double from=randomBoolean() ? Double.NEGATIVE_INFINITY : randomIntBetween(Integer.MIN_VALUE,Integer.MAX_VALUE - 1000);
    double to=randomBoolean() ? Double.POSITIVE_INFINITY : (Double.isInfinite(from) ? randomIntBetween(Integer.MIN_VALUE,Integer.MAX_VALUE) : randomIntBetween((int)from,Integer.MAX_VALUE));
    if (randomBoolean()) {
      ranges.add(new Range(key,from,to));
    }
 else {
      String fromAsStr=Double.isInfinite(from) ? null : String.valueOf(from);
      String toAsStr=Double.isInfinite(to) ? null : String.valueOf(to);
      ranges.add(new Range(key,fromAsStr,toAsStr));
    }
  }
  DateRangeAggregatorFactory factory=new DateRangeAggregatorFactory("foo",ranges);
  factory.field(INT_FIELD_NAME);
  if (randomBoolean()) {
    factory.format("###.##");
  }
  if (randomBoolean()) {
    factory.keyed(randomBoolean());
  }
  if (randomBoolean()) {
    factory.missing(randomIntBetween(0,10));
  }
  return factory;
}
