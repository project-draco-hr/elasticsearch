{
  final DistanceValues distanceValues=new DistanceValues(valuesSource,distanceType,origin,unit);
  FieldDataSource.Numeric distanceSource=new DistanceSource(distanceValues,valuesSource.metaData());
  if (distanceSource.metaData().multiValued()) {
    distanceSource=new FieldDataSource.Numeric.SortedAndUnique(distanceSource);
  }
  final NumericValuesSource numericSource=new NumericValuesSource(distanceSource,null,null);
  return new RangeAggregator(name,factories,numericSource,rangeFactory,ranges,keyed,aggregationContext,parent);
}
