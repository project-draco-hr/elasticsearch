{
  DistanceSource distanceSource=new DistanceSource(valuesSource,distanceType,origin,unit);
  aggregationContext.registerReaderContextAware(distanceSource);
  return new RangeAggregator(name,factories,distanceSource,null,rangeFactory,ranges,keyed,aggregationContext,parent,metaData);
}
