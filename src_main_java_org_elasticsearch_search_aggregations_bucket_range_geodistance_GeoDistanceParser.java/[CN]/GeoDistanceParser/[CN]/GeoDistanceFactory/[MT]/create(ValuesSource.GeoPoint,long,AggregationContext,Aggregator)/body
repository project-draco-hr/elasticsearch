{
  final DistanceValues distanceValues=new DistanceValues(valuesSource,distanceType,origin,unit);
  ValuesSource.Numeric distanceSource=new DistanceSource(distanceValues,valuesSource.metaData());
  if (distanceSource.metaData().multiValued()) {
    distanceSource=new ValuesSource.Numeric.SortedAndUnique(distanceSource);
  }
  return new RangeAggregator(name,factories,distanceSource,null,rangeFactory,ranges,keyed,aggregationContext,parent);
}
