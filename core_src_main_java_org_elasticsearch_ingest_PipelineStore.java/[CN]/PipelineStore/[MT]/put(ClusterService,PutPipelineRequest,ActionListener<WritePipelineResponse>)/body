{
  Map<String,Object> pipelineConfig=XContentHelper.convertToMap(request.getSource(),false).v2();
  WritePipelineResponse response=validatePipelineResponse(request.getId(),pipelineConfig);
  if (response != null) {
    listener.onResponse(response);
    return;
  }
  clusterService.submitStateUpdateTask("put-pipeline-" + request.getId(),new AckedClusterStateUpdateTask<WritePipelineResponse>(request,listener){
    @Override protected WritePipelineResponse newResponse(    boolean acknowledged){
      return new WritePipelineResponse(acknowledged);
    }
    @Override public ClusterState execute(    ClusterState currentState) throws Exception {
      return innerPut(request,currentState);
    }
  }
);
}
