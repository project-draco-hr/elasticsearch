{
  if (Version.indexCreated(context.indexSettings()).before(Version.V_2_0_0_beta1) && !fieldType().dateTimeFormatter().format().contains("epoch_")) {
    String format=fieldType().timeUnit().equals(TimeUnit.SECONDS) ? "epoch_second" : "epoch_millis";
    fieldType().setDateTimeFormatter(Joda.forPattern(format + "||" + fieldType().dateTimeFormatter().format()));
  }
  FormatDateTimeFormatter dateTimeFormatter=fieldType().dateTimeFormatter;
  if (!locale.equals(dateTimeFormatter.locale())) {
    fieldType().setDateTimeFormatter(new FormatDateTimeFormatter(dateTimeFormatter.format(),dateTimeFormatter.parser(),dateTimeFormatter.printer(),locale));
  }
  super.setupFieldType(context);
}
