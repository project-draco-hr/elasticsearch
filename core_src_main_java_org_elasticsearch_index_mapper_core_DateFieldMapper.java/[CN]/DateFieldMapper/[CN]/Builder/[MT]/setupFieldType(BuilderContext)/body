{
  FormatDateTimeFormatter dateTimeFormatter=fieldType().dateTimeFormatter;
  if (Version.indexCreated(context.indexSettings()).before(Version.V_2_0_0)) {
    boolean includesEpochFormatter=dateTimeFormatter.format().contains("epoch_");
    if (!includesEpochFormatter) {
      String format=fieldType().timeUnit().equals(TimeUnit.SECONDS) ? "epoch_second" : "epoch_millis";
      fieldType().setDateTimeFormatter(Joda.forPattern(format + "||" + dateTimeFormatter.format()));
    }
  }
  if (!locale.equals(dateTimeFormatter.locale())) {
    fieldType().setDateTimeFormatter(new FormatDateTimeFormatter(dateTimeFormatter.format(),dateTimeFormatter.parser(),dateTimeFormatter.printer(),locale));
  }
  super.setupFieldType(context);
}
