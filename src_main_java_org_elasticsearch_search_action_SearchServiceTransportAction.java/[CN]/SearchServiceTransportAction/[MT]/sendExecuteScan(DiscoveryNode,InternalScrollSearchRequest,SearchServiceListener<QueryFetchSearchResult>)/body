{
  if (clusterService.state().nodes().localNodeId().equals(node.id())) {
    execute(new Callable<QueryFetchSearchResult>(){
      @Override public QueryFetchSearchResult call() throws Exception {
        return searchService.executeScan(request).result();
      }
    }
,listener);
  }
 else {
    transportService.sendRequest(node,SCAN_SCROLL_ACTION_NAME,request,new BaseTransportResponseHandler<ScrollQueryFetchSearchResult>(){
      @Override public ScrollQueryFetchSearchResult newInstance(){
        return new ScrollQueryFetchSearchResult();
      }
      @Override public void handleResponse(      ScrollQueryFetchSearchResult response){
        listener.onResult(response.result());
      }
      @Override public void handleException(      TransportException exp){
        listener.onFailure(exp);
      }
      @Override public String executor(){
        return ThreadPool.Names.SAME;
      }
    }
);
  }
}
