{
  if (clusterService.state().nodes().localNodeId().equals(node.id())) {
    final boolean freed=searchService.freeContext(contextId);
    actionListener.onResponse(freed);
  }
 else {
    if (node.getVersion().onOrAfter(Version.V_1_4_0_Beta1)) {
      transportService.sendRequest(node,FREE_CONTEXT_SCROLL_ACTION_NAME,new ScrollFreeContextRequest(request,contextId),new FreeContextResponseHandler(actionListener));
    }
 else {
      transportService.sendRequest(node,FREE_CONTEXT_ACTION_NAME,new ScrollFreeContextRequest(request,contextId),new FreeContextResponseHandler(actionListener));
    }
  }
}
