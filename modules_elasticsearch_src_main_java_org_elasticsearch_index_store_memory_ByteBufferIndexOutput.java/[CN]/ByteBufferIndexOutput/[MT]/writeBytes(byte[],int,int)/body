{
  while (len > 0) {
    if (!currentBuffer.hasRemaining()) {
      currentBufferIndex++;
      switchCurrentBuffer();
    }
    int remainInBuffer=currentBuffer.remaining();
    int bytesToCopy=len < remainInBuffer ? len : remainInBuffer;
    currentBuffer.put(b,offset,bytesToCopy);
    offset+=bytesToCopy;
    len-=bytesToCopy;
  }
}
