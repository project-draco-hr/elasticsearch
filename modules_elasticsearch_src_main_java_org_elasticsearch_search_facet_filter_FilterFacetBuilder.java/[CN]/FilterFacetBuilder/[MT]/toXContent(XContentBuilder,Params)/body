{
  if (filter == null) {
    throw new SearchSourceBuilderException("filter must be set on filter facet for facet [" + name + "]");
  }
  builder.startObject(name);
  builder.field(FilterFacetCollectorParser.NAME);
  filter.toXContent(builder,params);
  if (facetFilter != null) {
    builder.field("filter");
    facetFilter.toXContent(builder,params);
  }
  if (global != null) {
    builder.field("global",global);
  }
  builder.endObject();
}
