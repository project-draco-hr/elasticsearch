{
  if (entries.isEmpty()) {
    return new InternalTermsStatsLongFacet(facetName,comparatorType,size,ImmutableList.<InternalTermsStatsLongFacet.LongEntry>of(),missing);
  }
  if (size == 0) {
    return new InternalTermsStatsLongFacet(facetName,comparatorType,0,entries.valueCollection(),missing);
  }
  TreeSet<InternalTermsStatsLongFacet.LongEntry> ordered=new BoundedTreeSet<InternalTermsStatsLongFacet.LongEntry>(comparatorType.comparator(),size * numberOfShards);
  ordered.addAll(entries.valueCollection());
  pushFacets(entries);
  return new InternalTermsStatsLongFacet(facetName,comparatorType,size,ordered,missing);
}
