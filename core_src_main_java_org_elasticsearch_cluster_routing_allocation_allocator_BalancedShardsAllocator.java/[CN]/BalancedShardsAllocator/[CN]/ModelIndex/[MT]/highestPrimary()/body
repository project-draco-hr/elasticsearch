{
  if (highestPrimary == -1) {
    int maxId=-1;
    for (    MutableShardRouting shard : shards.keySet()) {
      if (shard.primary()) {
        maxId=Math.max(maxId,shard.id());
      }
    }
    return highestPrimary=maxId;
  }
  return highestPrimary;
}
