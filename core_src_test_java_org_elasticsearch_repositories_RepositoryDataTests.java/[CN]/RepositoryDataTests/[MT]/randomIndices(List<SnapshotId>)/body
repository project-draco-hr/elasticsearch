{
  final int totalSnapshots=snapshotIds.size();
  final int numIndices=randomIntBetween(1,30);
  final Map<String,IndexMeta> indices=new HashMap<>(numIndices);
  for (int i=0; i < numIndices; i++) {
    final String indexName=randomAsciiOfLength(8);
    final Set<SnapshotId> indexSnapshots=new LinkedHashSet<>();
    final int numIndicesForSnapshot=randomIntBetween(1,numIndices);
    for (int j=0; j < numIndicesForSnapshot; j++) {
      indexSnapshots.add(snapshotIds.get(randomIntBetween(0,totalSnapshots - 1)));
    }
    indices.put(indexName,new IndexMeta(indexName,UUIDs.randomBase64UUID(),indexSnapshots));
  }
  return indices;
}
