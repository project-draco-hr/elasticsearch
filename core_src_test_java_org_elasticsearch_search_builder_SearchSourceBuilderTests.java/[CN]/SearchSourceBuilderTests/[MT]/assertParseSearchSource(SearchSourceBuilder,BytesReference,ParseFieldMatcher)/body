{
  XContentParser parser=XContentFactory.xContent(searchSourceAsBytes).createParser(searchSourceAsBytes);
  QueryParseContext parseContext=new QueryParseContext(indicesQueriesRegistry,parser,pfm);
  if (randomBoolean()) {
    parser.nextToken();
  }
  SearchSourceBuilder newBuilder=SearchSourceBuilder.fromXContent(parseContext,aggParsers,suggesters);
  assertNull(parser.nextToken());
  assertEquals(testBuilder,newBuilder);
  assertEquals(testBuilder.hashCode(),newBuilder.hashCode());
}
