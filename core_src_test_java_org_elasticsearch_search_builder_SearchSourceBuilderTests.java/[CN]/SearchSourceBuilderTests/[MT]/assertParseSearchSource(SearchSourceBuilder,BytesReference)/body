{
  XContentParser parser=XContentFactory.xContent(searchSourceAsBytes).createParser(searchSourceAsBytes);
  QueryParseContext parseContext=createParseContext(parser);
  parseContext.reset(parser);
  if (randomBoolean()) {
    parser.nextToken();
  }
  SearchSourceBuilder newBuilder=SearchSourceBuilder.parseSearchSource(parser,parseContext,aggParsers);
  assertNotSame(testBuilder,newBuilder);
  assertEquals(testBuilder,newBuilder);
  assertEquals(testBuilder.hashCode(),newBuilder.hashCode());
}
