{
  SearchSourceBuilder testBuilder=createSearchSourceBuilder();
  try (BytesStreamOutput output=new BytesStreamOutput()){
    testBuilder.writeTo(output);
    try (StreamInput in=new NamedWriteableAwareStreamInput(StreamInput.wrap(output.bytes()),namedWriteableRegistry)){
      SearchSourceBuilder deserializedBuilder=SearchSourceBuilder.readSearchSourceFrom(in);
      assertEquals(deserializedBuilder,testBuilder);
      assertEquals(deserializedBuilder.hashCode(),testBuilder.hashCode());
      assertNotSame(deserializedBuilder,testBuilder);
    }
   }
 }
