{
  Settings settings=Settings.settingsBuilder().put(Environment.PATH_CONF_SETTING.getKey(),getDataPath("/indices/analyze/two_aff_conf_dir")).put(HUNSPELL_LAZY_LOAD,randomBoolean()).build();
  Dictionary dictionary=null;
  try {
    internalCluster().startNode(settings);
    dictionary=internalCluster().getInstance(HunspellService.class).getDictionary("en_US");
    fail("Multiple affix files didn't throw an error");
  }
 catch (  Throwable t) {
    assertNull(dictionary);
    assertThat(ExceptionsHelper.unwrap(t,ElasticsearchException.class).toString(),Matchers.containsString("Too many affix files"));
  }
}
