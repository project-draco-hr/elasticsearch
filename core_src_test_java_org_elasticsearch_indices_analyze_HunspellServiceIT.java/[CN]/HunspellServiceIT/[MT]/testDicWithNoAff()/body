{
  Settings settings=Settings.builder().put(Environment.PATH_CONF_SETTING.getKey(),getDataPath("/indices/analyze/no_aff_conf_dir")).put(HUNSPELL_LAZY_LOAD.getKey(),randomBoolean()).build();
  Dictionary dictionary=null;
  try {
    internalCluster().startNode(settings);
    dictionary=internalCluster().getInstance(HunspellService.class).getDictionary("en_US");
    fail("Missing affix file didn't throw an error");
  }
 catch (  Throwable t) {
    assertNull(dictionary);
    assertThat(ExceptionsHelper.unwrap(t,ElasticsearchException.class).toString(),Matchers.containsString("Missing affix file"));
  }
}
