{
  ConvertProcessor.Factory factory=new ConvertProcessor.Factory();
  Map<String,Object> config=new HashMap<>();
  ConvertProcessor.Type type=randomFrom(ConvertProcessor.Type.values());
  Map<String,String> fields=Collections.singletonMap("field1",type.toString());
  config.put("fields",fields);
  ConvertProcessor convertProcessor=factory.create(config);
  assertThat(convertProcessor.getFields().size(),equalTo(1));
  assertThat(convertProcessor.getFields().get("field1"),equalTo(type));
}
