{
  CountResponse[] iterationResults=new CountResponse[iterations];
  for (int i=0; i < iterations; i++) {
    CountResponse countResponse=client().prepareCount().setQuery(matchAllQuery()).execute().actionGet();
    iterationResults[i]=countResponse;
    logger.info("iteration [{}] - successful shards: {} (expected {})",i,countResponse.getSuccessfulShards(),numberOfShards);
    logger.info("iteration [{}] - failed shards: {} (expected 0)",i,countResponse.getFailedShards());
    if (countResponse.getShardFailures() != null && countResponse.getShardFailures().length > 0) {
      logger.info("iteration [{}] - shard failures: {}",i,Arrays.toString(countResponse.getShardFailures()));
    }
    logger.info("iteration [{}] - returned documents: {} (expected {})",i,countResponse.getCount(),numberOfDocs);
  }
  for (int i=0; i < iterations; i++) {
    CountResponse countResponse=iterationResults[i];
    assertHitCount(countResponse,numberOfDocs);
  }
}
