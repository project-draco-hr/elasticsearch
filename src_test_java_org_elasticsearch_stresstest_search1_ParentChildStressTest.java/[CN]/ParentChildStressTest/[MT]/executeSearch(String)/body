{
  SearchRequest request=Requests.searchRequest(INDEX_NAME).source(source);
  List<ShardSearchFailure> failures;
  SearchResponse response;
  response=client.search(request).actionGet();
  failures=Arrays.asList(response.getShardFailures());
  if (failures.size() != 0) {
    String failuresStr=failures.toString();
    if (!failuresStr.contains("reason [No active shards]")) {
      throw new RuntimeException(failures.toString());
    }
  }
  ArrayList<String> results=new ArrayList<>();
  if (response != null) {
    for (    SearchHit hit : response.getHits()) {
      String sourceStr=hit.sourceAsString();
      results.add(sourceStr);
    }
  }
  return results;
}
