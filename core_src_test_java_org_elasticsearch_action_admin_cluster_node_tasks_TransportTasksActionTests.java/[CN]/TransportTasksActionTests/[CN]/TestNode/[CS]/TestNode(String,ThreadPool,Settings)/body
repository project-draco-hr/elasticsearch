{
  transportService=new TransportService(settings,new LocalTransport(settings,threadPool,Version.CURRENT,new NamedWriteableRegistry()),threadPool,new NamedWriteableRegistry()){
    @Override protected TaskManager createTaskManager(){
      if (MockTaskManager.USE_MOCK_TASK_MANAGER_SETTING.get(settings)) {
        return new MockTaskManager(settings);
      }
 else {
        return super.createTaskManager();
      }
    }
  }
;
  transportService.start();
  clusterService=new TestClusterService(threadPool,transportService);
  discoveryNode=new DiscoveryNode(name,transportService.boundAddress().publishAddress(),Version.CURRENT);
  transportListTasksAction=new TransportListTasksAction(settings,clusterName,threadPool,clusterService,transportService,new ActionFilters(Collections.emptySet()),new IndexNameExpressionResolver(settings));
}
