{
  double value;
  if (jsonContext.externalValueSet()) {
    Object externalValue=jsonContext.externalValue();
    if (externalValue == null) {
      if (nullValue == null) {
        return null;
      }
      value=nullValue;
    }
 else {
      value=((Number)externalValue).doubleValue();
    }
    if (includeInAll == null || includeInAll) {
      jsonContext.allEntries().addText(names.fullName(),Double.toString(value),boost);
    }
  }
 else {
    if (jsonContext.jp().getCurrentToken() == JsonToken.VALUE_NULL) {
      if (nullValue == null) {
        return null;
      }
      value=nullValue;
      if (nullValueAsString != null && (includeInAll == null || includeInAll)) {
        jsonContext.allEntries().addText(names.fullName(),nullValueAsString,boost);
      }
    }
 else {
      if (jsonContext.jp().getCurrentToken() == JsonToken.VALUE_STRING) {
        value=Double.parseDouble(jsonContext.jp().getText());
      }
 else {
        value=jsonContext.jp().getDoubleValue();
      }
      if (includeInAll == null || includeInAll) {
        jsonContext.allEntries().addText(names.fullName(),jsonContext.jp().getText(),boost);
      }
    }
  }
  Field field=null;
  if (stored()) {
    field=new Field(names.indexName(),Numbers.doubleToBytes(value),store);
    if (indexed()) {
      field.setTokenStream(popCachedStream(precisionStep).setDoubleValue(value));
    }
  }
 else   if (indexed()) {
    field=new Field(names.indexName(),popCachedStream(precisionStep).setDoubleValue(value));
  }
  return field;
}
