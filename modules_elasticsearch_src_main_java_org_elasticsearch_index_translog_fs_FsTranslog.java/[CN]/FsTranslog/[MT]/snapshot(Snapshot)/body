{
synchronized (mutex) {
    if (currentId() != snapshot.translogId()) {
      return snapshot();
    }
    try {
      FsSnapshot fsSnapshot=(FsSnapshot)snapshot;
      raf.increaseRefCount();
      FsSnapshot newSnapshot=new FsSnapshot(shardId,id,raf,raf.raf().getFilePointer());
      newSnapshot.seekForward(fsSnapshot.position());
      return newSnapshot;
    }
 catch (    IOException e) {
      throw new TranslogException(shardId,"Failed to snapshot",e);
    }
  }
}
