{
  rwl.writeLock().lock();
  try {
    FsTranslogFile newFile;
    try {
      newFile=new FsTranslogFile(shardId,id,new RafReference(new File(location,"translog-" + id)));
    }
 catch (    IOException e) {
      throw new TranslogException(shardId,"failed to create new translog file",e);
    }
    FsTranslogFile old=current;
    current=newFile;
    if (old != null) {
      boolean delete=true;
      if (old.id() == id) {
        delete=false;
      }
      old.close(delete);
    }
  }
  finally {
    rwl.writeLock().unlock();
  }
}
