{
  InetAddress address=resolvePublishHostAddress(publishHost,null);
  if (address == null || address.isAnyLocalAddress()) {
    address=NetworkUtils.getFirstNonLoopbackAddress(NetworkUtils.StackType.IPv4);
    if (address == null) {
      address=NetworkUtils.getFirstNonLoopbackAddress(NetworkUtils.getIpStackType());
      if (address == null) {
        return NetworkUtils.getLocalAddress();
      }
    }
  }
  return address;
}
