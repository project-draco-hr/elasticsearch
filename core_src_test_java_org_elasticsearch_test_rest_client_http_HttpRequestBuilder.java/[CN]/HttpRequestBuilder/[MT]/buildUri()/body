{
  try {
    URI uri=new URI(protocol,null,host,port,path,null,null);
    StringBuilder uriBuilder=new StringBuilder(protocol).append("://").append(host).append(":").append(port).append(uri.getRawPath());
    if (params.size() > 0) {
      uriBuilder.append("?").append(Joiner.on('&').withKeyValueSeparator("=").join(params));
    }
    return URI.create(uriBuilder.toString());
  }
 catch (  URISyntaxException e) {
    throw new IllegalArgumentException("unable to build uri",e);
  }
}
