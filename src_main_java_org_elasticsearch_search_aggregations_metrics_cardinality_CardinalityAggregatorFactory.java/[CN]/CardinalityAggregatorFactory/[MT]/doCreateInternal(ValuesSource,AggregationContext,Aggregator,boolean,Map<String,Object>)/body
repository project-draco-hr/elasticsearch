{
  if (!(valuesSource instanceof ValuesSource.Numeric) && !rehash) {
    throw new AggregationExecutionException("Turning off rehashing for cardinality aggregation [" + name + "] on non-numeric values in not allowed");
  }
  return new CardinalityAggregator(name,valuesSource,rehash,precision(parent),config.formatter(),context,parent,metaData);
}
