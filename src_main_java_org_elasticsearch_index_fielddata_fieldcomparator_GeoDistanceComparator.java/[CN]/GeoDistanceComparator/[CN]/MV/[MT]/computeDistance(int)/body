{
  GeoPointValues.Iter iter=readerValues.getIter(doc);
  if (!iter.hasNext()) {
    return Double.MAX_VALUE;
  }
  GeoPoint point=iter.next();
  double distance=fixedSourceDistance.calculate(point.lat(),point.lon());
  while (iter.hasNext()) {
    point=iter.next();
    double newDistance=fixedSourceDistance.calculate(point.lat(),point.lon());
switch (sortMode) {
case MIN:
      if (distance > newDistance) {
        distance=newDistance;
      }
    break;
case MAX:
  if (distance < newDistance) {
    distance=newDistance;
  }
break;
}
}
return distance;
}
