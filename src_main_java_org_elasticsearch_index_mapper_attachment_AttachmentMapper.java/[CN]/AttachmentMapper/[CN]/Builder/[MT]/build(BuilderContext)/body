{
  ContentPath.Type origPathType=context.path().pathType();
  context.path().pathType(pathType);
  StringFieldMapper contentMapper=contentBuilder.build(context);
  context.path().add(name);
  DateFieldMapper dateMapper=dateBuilder.build(context);
  StringFieldMapper authorMapper=authorBuilder.build(context);
  StringFieldMapper titleMapper=titleBuilder.build(context);
  StringFieldMapper keywordsMapper=keywordsBuilder.build(context);
  StringFieldMapper contentTypeMapper=contentTypeBuilder.build(context);
  context.path().remove();
  context.path().pathType(origPathType);
  if (defaultIndexedChars != null && context.indexSettings() != null) {
    defaultIndexedChars=context.indexSettings().getAsInt("index.mapping.attachment.indexed_chars",100000);
  }
  if (defaultIndexedChars == null) {
    defaultIndexedChars=100000;
  }
  return new AttachmentMapper(name,pathType,defaultIndexedChars,contentMapper,dateMapper,titleMapper,authorMapper,keywordsMapper,contentTypeMapper);
}
