{
  out.writeVInt(aggregations.size());
  for (  Aggregation aggregation : aggregations) {
    InternalAggregation internal=(InternalAggregation)aggregation;
    try {
      internal.getWriteableName();
      out.writeBoolean(true);
      out.writeNamedWriteable(internal);
    }
 catch (    UnsupportedOperationException e) {
      out.writeBoolean(false);
      out.writeBytesReference(internal.type().stream());
      internal.writeTo(out);
    }
  }
}
