{
  assertAcked(prepareCreate("test").setSettings(ImmutableSettings.settingsBuilder().put("index.store.type","memory").put("index.number_of_shards","1").put("index.number_of_replicas","0").put("gateway.type","none").put("http.enabled",false).put(RobinEngine.INDEX_COMPOUND_ON_FLUSH,randomBoolean()).put("index.warmer.enabled",false).build()).get());
  final int iters=between(500,1000);
  for (int i=0; i < iters; i++) {
    client().prepareIndex("test","type1").setSource("a","" + i).setRefresh(true).execute().actionGet();
  }
  assertHitCount(client().prepareCount("test").setQuery(QueryBuilders.matchAllQuery()).get(),iters);
}
