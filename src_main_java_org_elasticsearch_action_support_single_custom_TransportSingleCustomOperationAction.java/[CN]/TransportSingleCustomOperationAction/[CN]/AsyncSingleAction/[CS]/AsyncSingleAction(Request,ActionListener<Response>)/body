{
  this.request=request;
  this.listener=listener;
  ClusterState clusterState=clusterService.state();
  nodes=clusterState.nodes();
  checkBlock(request,clusterState);
  this.shardsIt=shards(clusterState,request);
}
