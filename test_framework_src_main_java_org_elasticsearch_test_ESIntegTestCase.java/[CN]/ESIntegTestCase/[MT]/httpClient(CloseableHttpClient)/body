{
  final NodesInfoResponse nodeInfos=client().admin().cluster().prepareNodesInfo().get();
  final List<NodeInfo> nodes=nodeInfos.getNodes();
  assertFalse(nodeInfos.hasFailures());
  TransportAddress publishAddress=randomFrom(nodes).getHttp().address().publishAddress();
  assertEquals(1,publishAddress.uniqueAddressTypeId());
  InetSocketAddress address=((InetSocketTransportAddress)publishAddress).address();
  return new HttpRequestBuilder(httpClient).host(NetworkAddress.format(address.getAddress())).port(address.getPort());
}
