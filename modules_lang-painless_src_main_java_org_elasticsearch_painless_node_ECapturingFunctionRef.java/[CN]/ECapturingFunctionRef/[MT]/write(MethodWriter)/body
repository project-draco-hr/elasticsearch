{
  writer.writeDebugInfo(location);
  if (defInterface && captured.type.sort == Definition.Sort.DEF) {
    writer.push("D" + type + "."+ call+ ",1");
    writer.visitVarInsn(captured.type.type.getOpcode(Opcodes.ILOAD),captured.slot);
  }
 else   if (defInterface) {
    writer.push("S" + captured.type.name + "."+ call+ ",1");
    writer.visitVarInsn(captured.type.type.getOpcode(Opcodes.ILOAD),captured.slot);
  }
 else   if (ref == null) {
    writer.visitVarInsn(captured.type.type.getOpcode(Opcodes.ILOAD),captured.slot);
    String descriptor=Type.getMethodType(expected.type,captured.type.type).getDescriptor();
    writer.invokeDynamic(call,descriptor,DEF_BOOTSTRAP_HANDLE,DefBootstrap.REFERENCE,expected.name);
  }
 else {
    writer.visitVarInsn(captured.type.type.getOpcode(Opcodes.ILOAD),captured.slot);
    String invokedType=ref.invokedType.toMethodDescriptorString();
    Type samMethodType=Type.getMethodType(ref.samMethodType.toMethodDescriptorString());
    Type interfaceType=Type.getMethodType(ref.interfaceMethodType.toMethodDescriptorString());
    if (ref.needsBridges()) {
      writer.invokeDynamic(ref.invokedName,invokedType,LAMBDA_BOOTSTRAP_HANDLE,samMethodType,ref.implMethodASM,samMethodType,LambdaMetafactory.FLAG_BRIDGES,1,interfaceType);
    }
 else {
      writer.invokeDynamic(ref.invokedName,invokedType,LAMBDA_BOOTSTRAP_HANDLE,samMethodType,ref.implMethodASM,samMethodType,0);
    }
  }
}
