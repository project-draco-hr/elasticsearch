{
  BytesRef valueBytes=null;
  String fieldName=this.fieldName;
  MappedFieldType mapper=context.fieldMapper(fieldName);
  if (mapper != null) {
    fieldName=mapper.names().indexName();
    valueBytes=mapper.indexedValueForSearch(value);
  }
  if (valueBytes == null) {
    valueBytes=BytesRefs.toBytesRef(this.value);
  }
  SpanTermQuery query=new SpanTermQuery(new Term(fieldName,valueBytes));
  query.setBoost(boost);
  if (queryName != null) {
    context.addNamedQuery(queryName,query);
  }
  return query;
}
