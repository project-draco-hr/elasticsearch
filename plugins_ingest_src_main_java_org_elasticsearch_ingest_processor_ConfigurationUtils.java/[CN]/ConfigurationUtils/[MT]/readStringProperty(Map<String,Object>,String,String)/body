{
  Object value=configuration.remove(propertyName);
  if (value == null && defaultValue != null) {
    return defaultValue;
  }
 else   if (value == null) {
    throw new IllegalArgumentException("required property [" + propertyName + "] is missing");
  }
  if (value instanceof String) {
    return (String)value;
  }
 else {
    throw new IllegalArgumentException("property [" + propertyName + "] isn't a string, but of type ["+ value.getClass()+ "]");
  }
}
