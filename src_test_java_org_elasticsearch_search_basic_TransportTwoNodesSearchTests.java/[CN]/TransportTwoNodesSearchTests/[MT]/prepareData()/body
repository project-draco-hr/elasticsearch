{
  Set<String> fullExpectedIds=Sets.newHashSet();
  cluster().ensureAtLeastNumNodes(2);
  client().admin().indices().create(createIndexRequest("test").settings(settingsBuilder().put("index.number_of_shards",3).put("index.number_of_replicas",0).put("routing.hash.type","simple"))).actionGet();
  ensureGreen();
  for (int i=0; i < 100; i++) {
    index(client(),Integer.toString(i),"test",i);
    fullExpectedIds.add(Integer.toString(i));
  }
  client().admin().indices().refresh(refreshRequest("test")).actionGet();
  return fullExpectedIds;
}
