{
  if (array instanceof Map) {
    ((Map)array).put(index,value);
  }
 else {
    try {
      if (!indexsafe) {
        final Transform transform=getTransform(index.getClass(),Integer.class,definition);
        if (transform != null) {
          index=transform.method.handle.invoke(index);
        }
      }
    }
 catch (    final Throwable throwable) {
      throw new IllegalArgumentException("Error storing value [" + value + "] in list using index ["+ index+ "].",throwable);
    }
    if (array.getClass().isArray()) {
      try {
        if (!valuesafe) {
          final Transform transform=getTransform(value.getClass(),array.getClass().getComponentType(),definition);
          if (transform != null) {
            value=transform.method.handle.invoke(value);
          }
        }
        Array.set(array,(int)index,value);
      }
 catch (      final Throwable throwable) {
        throw new IllegalArgumentException("Error storing value [" + value + "] "+ "in array class ["+ array.getClass().getCanonicalName()+ "].",throwable);
      }
    }
 else     if (array instanceof List) {
      ((List)array).set((int)index,value);
    }
 else {
      throw new IllegalArgumentException("Attempting to address a non-array type " + "[" + array.getClass().getCanonicalName() + "] as an array.");
    }
  }
}
