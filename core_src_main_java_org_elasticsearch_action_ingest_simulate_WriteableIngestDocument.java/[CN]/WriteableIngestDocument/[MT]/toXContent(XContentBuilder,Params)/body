{
  builder.startObject(Fields.DOCUMENT);
  Map<IngestDocument.MetaData,String> metadataMap=ingestDocument.extractMetadata();
  for (  Map.Entry<IngestDocument.MetaData,String> metadata : metadataMap.entrySet()) {
    builder.field(metadata.getKey().getFieldName(),metadata.getValue());
  }
  builder.field(Fields.SOURCE,ingestDocument.getSourceAndMetadata());
  builder.startObject(Fields.INGEST);
  for (  Map.Entry<String,String> ingestMetadata : ingestDocument.getIngestMetadata().entrySet()) {
    builder.field(ingestMetadata.getKey(),ingestMetadata.getValue());
  }
  builder.endObject();
  builder.endObject();
  return builder;
}
