{
  int length=randomIntBetween(10,PAGE_SIZE * randomIntBetween(2,5));
  BytesReference pbr=getRandomizedPagedBytesReference(length);
  int sliceOffset=randomIntBetween(1,length / 2);
  int sliceLength=length - sliceOffset;
  BytesReference slice=pbr.slice(sliceOffset,sliceLength);
  File tFile=newTempFile();
  try (RandomAccessFile file=new RandomAccessFile(tFile,"rw")){
    slice.writeTo(file.getChannel());
    assertEquals(slice.length(),file.length());
    assertArrayEquals(slice.toBytes(),Files.readAllBytes(tFile.toPath()));
  }
 }
