{
  BytesRefHash parentIds=null;
  boolean constructed=false;
  try {
    parentIds=new BytesRefHash(numFoundParents,searchContext.bigArrays());
    for (int id=0; id < parentIdxs.size(); id++) {
      parentIds.add(globalValues.lookupOrd((int)parentIdxs.get(id)));
    }
    constructed=true;
  }
  finally {
    if (!constructed) {
      Releasables.close(parentIds);
    }
  }
  searchContext.addReleasable(parentIds,SearchContext.Lifetime.COLLECTION);
  return new ParentIdsFilter(parentType,nonNestedDocsFilter,parentIds);
}
