{
  Decision madeDecision=Decision.NO;
  for (  ObjectCursor<DiscoveryNode> cursor : allocation.nodes().getDataNodes().values()) {
    RoutingNode node=allocation.routingNodes().node(cursor.value.getId());
    if (node == null) {
      continue;
    }
    Decision decision=allocation.deciders().canAllocate(shard,node,allocation);
    if (decision.type() == Decision.Type.YES) {
      return decision;
    }
 else     if (madeDecision.type() == Decision.Type.NO && decision.type() == Decision.Type.THROTTLE) {
      madeDecision=decision;
    }
  }
  return madeDecision;
}
