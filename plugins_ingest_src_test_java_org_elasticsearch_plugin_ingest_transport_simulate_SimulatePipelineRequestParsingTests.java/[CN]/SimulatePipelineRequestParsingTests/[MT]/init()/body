{
  CompoundProcessor pipelineCompoundProcessor=mock(CompoundProcessor.class);
  when(pipelineCompoundProcessor.getProcessors()).thenReturn(Arrays.asList(mock(Processor.class)));
  Pipeline pipeline=new Pipeline(SimulatePipelineRequest.SIMULATED_PIPELINE_ID,null,pipelineCompoundProcessor);
  Map<String,Processor.Factory> processorRegistry=new HashMap<>();
  processorRegistry.put("mock_processor",mock(Processor.Factory.class));
  store=mock(PipelineStore.class);
  when(store.get(SimulatePipelineRequest.SIMULATED_PIPELINE_ID)).thenReturn(pipeline);
  when(store.getProcessorFactoryRegistry()).thenReturn(processorRegistry);
}
