{
  List<Connection> connections=getConnections();
  if (connections.isEmpty()) {
    throw new IllegalStateException("no connections available in the connection pool");
  }
  List<Connection> sortedConnections=new ArrayList<>(connections);
  Collections.sort(sortedConnections,new Comparator<Connection>(){
    @Override public int compare(    Connection o1,    Connection o2){
      return Long.compare(o1.getDeadUntil(),o2.getDeadUntil());
    }
  }
);
  return sortedConnections.get(0);
}
