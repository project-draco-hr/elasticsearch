{
  createIndex("test");
  client().prepareIndex("test","type1","1").setSource("field1","value1").get();
  client().prepareIndex("test","type2","2").setSource("field1","value2").get();
  refresh();
  SearchResponse searchResponse=client().prepareSearch().setQuery(idsQuery("type1","type2").addIds("1","2")).get();
  assertHitCount(searchResponse,2L);
  assertThat(searchResponse.getHits().hits().length,equalTo(2));
  searchResponse=client().prepareSearch().setQuery(idsQuery().addIds("1")).get();
  assertHitCount(searchResponse,1L);
  assertThat(searchResponse.getHits().hits().length,equalTo(1));
  searchResponse=client().prepareSearch().setQuery(idsQuery().addIds("1","2")).get();
  assertHitCount(searchResponse,2L);
  assertThat(searchResponse.getHits().hits().length,equalTo(2));
  searchResponse=client().prepareSearch().setQuery(idsQuery("type1").addIds("1","2")).get();
  assertHitCount(searchResponse,1L);
  assertThat(searchResponse.getHits().hits().length,equalTo(1));
  searchResponse=client().prepareSearch().setQuery(idsQuery(Strings.EMPTY_ARRAY).addIds("1")).get();
  assertHitCount(searchResponse,1L);
  assertThat(searchResponse.getHits().hits().length,equalTo(1));
  searchResponse=client().prepareSearch().setQuery(idsQuery("type1","type2","type3").addIds("1","2","3","4")).get();
  assertHitCount(searchResponse,2L);
  assertThat(searchResponse.getHits().hits().length,equalTo(2));
}
