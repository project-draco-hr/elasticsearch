{
  final Key key=new Key(this,context.reader().getCoreCacheKey());
  return (FD)cache.get(key,new Callable<AtomicFieldData>(){
    @Override public AtomicFieldData call() throws Exception {
      SegmentReaderUtils.registerCoreListener(context.reader(),IndexFieldCache.this);
      AtomicFieldData fieldData=indexFieldData.loadDirect(context);
      key.sizeInBytes=fieldData.getMemorySizeInBytes();
      key.listeners.add(indicesFieldDataCacheListener);
      final ShardId shardId=ShardUtils.extractShardId(context.reader());
      if (shardId != null) {
        final IndexShard shard=indexService.shard(shardId.id());
        if (shard != null) {
          key.listeners.add(shard.fieldData());
        }
      }
      for (      Listener listener : key.listeners) {
        listener.onLoad(fieldNames,fieldDataType,fieldData);
      }
      return fieldData;
    }
  }
);
}
