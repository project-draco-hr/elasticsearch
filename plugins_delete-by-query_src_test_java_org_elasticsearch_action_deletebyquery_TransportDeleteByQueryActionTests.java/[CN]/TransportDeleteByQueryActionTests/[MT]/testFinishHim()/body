{
  TestActionListener listener=new TestActionListener();
  newAsyncAction(new DeleteByQueryRequest(),listener).finishHim(null,false,null);
  waitForCompletion("waiting for finishHim to complete with success",listener);
  assertNoFailures(listener);
  assertNotNull(listener.getResponse());
  assertFalse(listener.getResponse().isTimedOut());
  listener=new TestActionListener();
  newAsyncAction(new DeleteByQueryRequest(),listener).finishHim(null,true,null);
  waitForCompletion("waiting for finishHim to complete with timed out = true",listener);
  assertNoFailures(listener);
  assertNotNull(listener.getResponse());
  assertTrue(listener.getResponse().isTimedOut());
  listener=new TestActionListener();
  newAsyncAction(new DeleteByQueryRequest(),listener).finishHim(null,false,new Throwable("Fake error"));
  waitForCompletion("waiting for finishHim to complete with error",listener);
  assertFailure(listener,"Fake error");
  assertNull(listener.getResponse());
}
