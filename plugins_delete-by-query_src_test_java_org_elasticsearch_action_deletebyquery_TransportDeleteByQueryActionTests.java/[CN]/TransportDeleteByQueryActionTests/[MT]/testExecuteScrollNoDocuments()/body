{
  createIndex("test");
  SearchResponse searchResponse=client().prepareSearch("test").setSearchType(SearchType.SCAN).setScroll(TimeValue.timeValueSeconds(10)).get();
  String scrollId=searchResponse.getScrollId();
  assertTrue(Strings.hasText(scrollId));
  DeleteByQueryRequest delete=new DeleteByQueryRequest().indices("test");
  TestActionListener listener=new TestActionListener();
  newAsyncAction(delete,listener).executeScroll(searchResponse.getScrollId());
  waitForCompletion("scroll request returns zero documents",listener);
  assertNull(listener.getError());
  assertFalse(listener.getResponse().isTimedOut());
  assertThat(listener.getResponse().getTotalFound(),equalTo(0L));
  assertThat(listener.getResponse().getTotalDeleted(),equalTo(0L));
  assertSearchContextsClosed();
}
