{
  byte status=0;
  status=TransportStreams.statusSetRequest(status);
  if (options.compress()) {
    status=TransportStreams.statusSetCompress(status);
    HandlesStreamOutput stream=cachedEntry.cachedHandlesLzfBytes();
    cachedEntry.bytes().write(HEADER_PLACEHOLDER);
    stream.writeUTF(action);
    message.writeTo(stream);
    stream.flush();
  }
 else {
    HandlesStreamOutput stream=cachedEntry.cachedHandlesBytes();
    cachedEntry.bytes().write(HEADER_PLACEHOLDER);
    stream.writeUTF(action);
    message.writeTo(stream);
    stream.flush();
  }
  TransportStreams.writeHeader(cachedEntry.bytes().unsafeByteArray(),cachedEntry.bytes().size(),requestId,status);
}
