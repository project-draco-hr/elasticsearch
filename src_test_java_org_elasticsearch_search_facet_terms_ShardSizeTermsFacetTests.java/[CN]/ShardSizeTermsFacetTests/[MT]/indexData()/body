{
  indexDoc("1","1",5);
  indexDoc("1","2",4);
  indexDoc("1","3",3);
  indexDoc("1","4",2);
  indexDoc("1","5",1);
  indexDoc("2","1",3);
  indexDoc("2","2",1);
  indexDoc("2","3",5);
  indexDoc("2","4",2);
  indexDoc("2","5",1);
  client().admin().indices().prepareFlush("idx").execute().actionGet();
  client().admin().indices().prepareRefresh("idx").execute().actionGet();
  long totalOnOne=client().prepareSearch("idx").setTypes("type").setRouting("1").setQuery(matchAllQuery()).execute().actionGet().getHits().getTotalHits();
  assertThat(totalOnOne,is(15l));
  long totalOnTwo=client().prepareSearch("idx").setTypes("type").setRouting("2").setQuery(matchAllQuery()).execute().actionGet().getHits().getTotalHits();
  assertThat(totalOnTwo,is(12l));
}
