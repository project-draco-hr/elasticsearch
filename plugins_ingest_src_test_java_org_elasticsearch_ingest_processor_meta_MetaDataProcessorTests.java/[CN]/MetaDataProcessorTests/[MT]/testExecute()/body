{
  Map<IngestDocument.MetaData,Mustache> templates=new HashMap<>();
  for (  MetaData metaData : MetaData.values()) {
    templates.put(metaData,new DefaultMustacheFactory().compile(new FastStringReader("some {{field}}"),"noname"));
  }
  MetaDataProcessor processor=new MetaDataProcessor(templates);
  IngestDocument ingestDocument=new IngestDocument("_index","_type","_id",Collections.singletonMap("field","value"));
  processor.execute(ingestDocument);
  for (  MetaData metaData : MetaData.values()) {
    assertThat(ingestDocument.getMetadata(metaData),Matchers.equalTo("some value"));
  }
}
