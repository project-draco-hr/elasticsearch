{
  blobStore.executorService().execute(new Runnable(){
    @Override public void run(){
      Path file=new Path(path,blobName);
      FSDataOutputStream fileStream;
      try {
        fileStream=blobStore.fileSystem().create(file,true);
      }
 catch (      IOException e) {
        listener.onFailure(e);
        return;
      }
      try {
        try {
          byte[] buffer=new byte[blobStore.bufferSizeInBytes()];
          int bytesRead;
          while ((bytesRead=is.read(buffer)) != -1) {
            fileStream.write(buffer,0,bytesRead);
          }
        }
  finally {
          try {
            is.close();
          }
 catch (          IOException ex) {
          }
          try {
            fileStream.close();
          }
 catch (          IOException ex) {
          }
        }
        listener.onCompleted();
      }
 catch (      Exception e) {
        try {
          if (blobStore.fileSystem().exists(file)) {
            blobStore.fileSystem().delete(file,true);
          }
        }
 catch (        Exception e1) {
        }
        listener.onFailure(e);
      }
    }
  }
);
}
