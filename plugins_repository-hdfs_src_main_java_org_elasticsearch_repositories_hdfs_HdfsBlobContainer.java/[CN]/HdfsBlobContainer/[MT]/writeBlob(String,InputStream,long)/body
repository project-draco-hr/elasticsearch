{
  SecurityUtils.execute(blobStore.getRepository(),new FcCallback<Void>(){
    @Override public Void doInHdfs(    FileContext fc) throws IOException {
      Path blob=new Path(path,blobName);
      EnumSet<CreateFlag> flags=EnumSet.of(CreateFlag.CREATE,CreateFlag.SYNC_BLOCK);
      CreateOpts[] opts={CreateOpts.bufferSize(blobStore.getBufferSizeInBytes())};
      try (FSDataOutputStream stream=fc.create(blob,flags,opts)){
        int bytesRead;
        byte[] buffer=new byte[blobStore.getBufferSizeInBytes()];
        while ((bytesRead=inputStream.read(buffer)) != -1) {
          stream.write(buffer,0,bytesRead);
          stream.hsync();
        }
      }
       return null;
    }
  }
);
}
