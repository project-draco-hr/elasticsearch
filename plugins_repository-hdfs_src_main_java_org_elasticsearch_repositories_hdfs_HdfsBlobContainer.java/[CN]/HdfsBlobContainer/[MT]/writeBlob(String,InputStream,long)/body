{
  repository.execute(new HdfsRepository.Operation<Void>(){
    @Override public Void run(    FileContext fileContext) throws IOException {
      Path blob=new Path(path,blobName);
      EnumSet<CreateFlag> flags=EnumSet.of(CreateFlag.CREATE,CreateFlag.SYNC_BLOCK);
      CreateOpts[] opts={CreateOpts.bufferSize(repository.bufferSizeInBytes)};
      try (FSDataOutputStream stream=fileContext.create(blob,flags,opts)){
        int bytesRead;
        byte[] buffer=new byte[repository.bufferSizeInBytes];
        while ((bytesRead=inputStream.read(buffer)) != -1) {
          stream.write(buffer,0,bytesRead);
          stream.hsync();
        }
      }
       return null;
    }
  }
);
}
