{
  SecurityUtils.execute(blobStore.fileContextFactory(),new FcCallback<Void>(){
    @Override public Void doInHdfs(    FileContext fc) throws IOException {
      try (FSDataOutputStream stream=createOutput(fc,blobName)){
        int bytesRead;
        byte[] buffer=new byte[blobStore.bufferSizeInBytes()];
        while ((bytesRead=inputStream.read(buffer)) != -1) {
          stream.write(buffer,0,bytesRead);
        }
        stream.hsync();
      }
       return null;
    }
  }
);
}
