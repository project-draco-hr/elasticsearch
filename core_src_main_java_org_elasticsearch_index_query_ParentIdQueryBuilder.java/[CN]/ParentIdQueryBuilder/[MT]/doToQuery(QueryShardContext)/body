{
  DocumentMapper childDocMapper=context.getMapperService().documentMapper(type);
  if (childDocMapper == null) {
    throw new QueryShardException(context,"[" + NAME + "] no mapping found for type ["+ type+ "]");
  }
  ParentFieldMapper parentFieldMapper=childDocMapper.parentFieldMapper();
  if (parentFieldMapper.active() == false) {
    throw new QueryShardException(context,"[" + NAME + "] _parent field has no parent type configured");
  }
  String fieldName=ParentFieldMapper.joinField(parentFieldMapper.type());
  return new DocValuesTermsQuery(fieldName,id);
}
