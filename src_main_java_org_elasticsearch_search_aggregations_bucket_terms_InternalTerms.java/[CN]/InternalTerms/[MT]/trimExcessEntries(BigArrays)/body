{
  final List<Bucket> newBuckets=Lists.newArrayList();
  for (  Bucket b : buckets) {
    if (newBuckets.size() >= requiredSize) {
      break;
    }
    if (b.docCount >= minDocCount) {
      newBuckets.add(b);
      b.aggregations.reduce(bigArrays);
    }
  }
  buckets=newBuckets;
}
