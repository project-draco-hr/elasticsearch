{
  List<XBooleanFilter> booleanFilters=new ArrayList<XBooleanFilter>();
  booleanFilters.add(createBooleanFilter(newFilterClause(0,'a',MUST,true),newFilterClause(1,'b',MUST,false),newFilterClause(2,'c',SHOULD,true),newFilterClause(3,'d',SHOULD,false),newFilterClause(4,'e',MUST_NOT,true),newFilterClause(5,'f',MUST_NOT,false)));
  booleanFilters.add(createBooleanFilter(newFilterClause(4,'e',MUST_NOT,true),newFilterClause(5,'f',MUST_NOT,false),newFilterClause(0,'a',MUST,true),newFilterClause(1,'b',MUST,false),newFilterClause(2,'c',SHOULD,true),newFilterClause(3,'d',SHOULD,false)));
  booleanFilters.add(createBooleanFilter(newFilterClause(2,'c',SHOULD,true),newFilterClause(3,'d',SHOULD,false),newFilterClause(4,'e',MUST_NOT,true),newFilterClause(5,'f',MUST_NOT,false),newFilterClause(0,'a',MUST,true),newFilterClause(1,'b',MUST,false)));
  for (  XBooleanFilter booleanFilter : booleanFilters) {
    FixedBitSet result=new FixedBitSet(reader.maxDoc());
    result.or(booleanFilter.getDocIdSet(reader.getContext(),reader.getLiveDocs()).iterator());
    assertThat(result.cardinality(),equalTo(2));
    assertThat(result.get(0),equalTo(true));
    assertThat(result.get(1),equalTo(true));
    assertThat(result.get(2),equalTo(false));
  }
  booleanFilters.clear();
  booleanFilters.add(createBooleanFilter(newFilterClause(0,'a',MUST,false),newFilterClause(1,'b',MUST,true),newFilterClause(2,'c',SHOULD,false),newFilterClause(3,'d',SHOULD,true),newFilterClause(4,'e',MUST_NOT,false),newFilterClause(5,'f',MUST_NOT,true)));
  booleanFilters.add(createBooleanFilter(newFilterClause(4,'e',MUST_NOT,false),newFilterClause(5,'f',MUST_NOT,true),newFilterClause(0,'a',MUST,false),newFilterClause(1,'b',MUST,true),newFilterClause(2,'c',SHOULD,false),newFilterClause(3,'d',SHOULD,true)));
  booleanFilters.add(createBooleanFilter(newFilterClause(2,'c',SHOULD,false),newFilterClause(3,'d',SHOULD,true),newFilterClause(4,'e',MUST_NOT,false),newFilterClause(5,'f',MUST_NOT,true),newFilterClause(0,'a',MUST,false),newFilterClause(1,'b',MUST,true)));
  for (  XBooleanFilter booleanFilter : booleanFilters) {
    FixedBitSet result=new FixedBitSet(reader.maxDoc());
    result.or(booleanFilter.getDocIdSet(reader.getContext(),reader.getLiveDocs()).iterator());
    assertThat(result.cardinality(),equalTo(2));
    assertThat(result.get(0),equalTo(true));
    assertThat(result.get(1),equalTo(true));
    assertThat(result.get(2),equalTo(false));
  }
}
