{
  IndexMetaData indexMetaData=IndexMetaData.builder("test").numberOfShards(2).numberOfReplicas(2).build();
  ShardCounter counter=new ShardCounter();
  IndexRoutingTable indexRoutingTable=genIndexRoutingTable(indexMetaData,counter);
  indexMetaData=IndexMetaData.builder("test").numberOfShards(2).numberOfReplicas(3).build();
  ClusterIndexHealth indexHealth=new ClusterIndexHealth(indexMetaData,indexRoutingTable);
  assertThat(indexHealth.getValidationFailures(),Matchers.hasSize(2));
  RoutingTable.Builder routingTable=RoutingTable.builder();
  MetaData.Builder metaData=MetaData.builder();
  metaData.put(indexMetaData,true);
  routingTable.add(indexRoutingTable);
  ClusterState clusterState=ClusterState.builder(ClusterName.DEFAULT).metaData(metaData).routingTable(routingTable).build();
  ClusterHealthResponse clusterHealth=new ClusterHealthResponse("bla",clusterState.metaData().concreteIndices(IndicesOptions.strictExpand(),(String[])null),clusterState);
  assertThat(clusterHealth.getValidationFailures(),Matchers.hasSize(0));
}
