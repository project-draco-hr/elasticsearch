{
  AnalyzeRequest request=new AnalyzeRequest();
  request.analyzer("custom_analyzer");
  request.text("the qu1ck brown fox-dog");
  try {
    TransportAnalyzeAction.analyze(request,AllFieldMapper.NAME,null,null,registry,environment);
    fail("no analysis service provided");
  }
 catch (  IllegalArgumentException e) {
    assertEquals(e.getMessage(),"failed to find global analyzer [custom_analyzer]");
  }
}
