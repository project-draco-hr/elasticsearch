{
  FileSystemUtils.moveFilesWithoutOverwriting(src.resolve("v1"),dst,".new");
  assertFileContent(dst,"file1.txt","version1");
  assertFileContent(dst,"dir/file2.txt","version1");
  FileSystemUtils.moveFilesWithoutOverwriting(src.resolve("v2"),dst,".new");
  assertFileContent(dst,"file1.txt","version1");
  assertFileContent(dst,"dir/file2.txt","version1");
  assertFileContent(dst,"file1.txt.new","version2");
  assertFileContent(dst,"dir/file2.txt.new","version2");
  assertFileContent(dst,"file3.txt","version1");
  assertFileContent(dst,"dir/subdir/file4.txt","version1");
  FileSystemUtils.moveFilesWithoutOverwriting(src.resolve("v3"),dst,".new");
  assertFileContent(dst,"file1.txt","version1");
  assertFileContent(dst,"dir/file2.txt","version1");
  assertFileContent(dst,"file1.txt.new","version3");
  assertFileContent(dst,"dir/file2.txt.new","version3");
  assertFileContent(dst,"file3.txt","version1");
  assertFileContent(dst,"dir/subdir/file4.txt","version1");
  assertFileContent(dst,"file3.txt.new","version2");
  assertFileContent(dst,"dir/subdir/file4.txt.new","version2");
  assertFileContent(dst,"dir/subdir/file5.txt","version1");
}
