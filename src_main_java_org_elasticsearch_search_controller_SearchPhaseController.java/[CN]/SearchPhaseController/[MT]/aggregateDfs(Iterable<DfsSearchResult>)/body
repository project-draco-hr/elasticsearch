{
  TMap<Term,TermStatistics> dfMap=new ExtTHashMap<Term,TermStatistics>(Constants.DEFAULT_CAPACITY,Constants.DEFAULT_LOAD_FACTOR);
  long aggMaxDoc=0;
  for (  DfsSearchResult result : results) {
    for (int i=0; i < result.termStatistics().length; i++) {
      TermStatistics existing=dfMap.get(result.terms()[i]);
      if (existing != null) {
        dfMap.put(result.terms()[i],new TermStatistics(existing.term(),existing.docFreq() + result.termStatistics()[i].docFreq(),existing.totalTermFreq() + result.termStatistics()[i].totalTermFreq()));
      }
 else {
        dfMap.put(result.terms()[i],result.termStatistics()[i]);
      }
    }
    aggMaxDoc+=result.maxDoc();
  }
  return new AggregatedDfs(dfMap,aggMaxDoc);
}
