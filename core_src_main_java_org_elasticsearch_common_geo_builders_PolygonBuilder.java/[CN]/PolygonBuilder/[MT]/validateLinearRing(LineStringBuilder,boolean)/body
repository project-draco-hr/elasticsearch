{
  int numValidPts;
  List<Coordinate> points=linestring.points;
  if (points.size() < (numValidPts=(coerce) ? 3 : 4)) {
    throw new IllegalArgumentException("invalid number of points in LinearRing (found [" + points.size() + "] - must be >= "+ numValidPts+ ")");
  }
  if (!points.get(0).equals(points.get(points.size() - 1))) {
    if (coerce) {
      points.add(points.get(0));
    }
 else {
      throw new IllegalArgumentException("invalid LinearRing found (coordinates are not closed)");
    }
  }
  return linestring;
}
