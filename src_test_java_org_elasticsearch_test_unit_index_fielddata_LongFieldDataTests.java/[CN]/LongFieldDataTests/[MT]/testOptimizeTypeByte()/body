{
  Document d=new Document();
  d.add(new StringField("_id","1",Field.Store.NO));
  d.add(new LongField("value",Byte.MAX_VALUE,Field.Store.NO));
  writer.addDocument(d);
  d=new Document();
  d.add(new StringField("_id","2",Field.Store.NO));
  d.add(new LongField("value",Byte.MIN_VALUE,Field.Store.NO));
  writer.addDocument(d);
  IndexNumericFieldData indexFieldData=ifdService.getForField(new FieldMapper.Names("value"),new FieldDataType("long"));
  AtomicNumericFieldData fieldData=indexFieldData.load(refreshReader());
  assertThat(fieldData,instanceOf(ByteArrayAtomicFieldData.class));
  assertThat(fieldData.getLongValues().getValue(0),equalTo((long)Byte.MAX_VALUE));
  assertThat(fieldData.getLongValues().getValue(1),equalTo((long)Byte.MIN_VALUE));
}
