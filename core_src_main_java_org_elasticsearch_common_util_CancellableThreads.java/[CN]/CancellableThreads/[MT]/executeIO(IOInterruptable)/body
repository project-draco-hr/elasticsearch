{
  boolean wasInterrupted=add();
  RuntimeException runtimeException=null;
  IOException ioException=null;
  try {
    interruptable.run();
  }
 catch (  InterruptedException|ThreadInterruptedException e) {
  }
catch (  RuntimeException t) {
    runtimeException=t;
  }
catch (  IOException e) {
    ioException=e;
  }
 finally {
    remove();
  }
  if (wasInterrupted) {
    Thread.currentThread().interrupt();
  }
 else {
    Thread.interrupted();
  }
synchronized (this) {
    if (isCancelled()) {
      onCancel(reason,ioException != null ? ioException : runtimeException);
    }
 else     if (ioException != null) {
      throw ioException;
    }
    if (runtimeException != null) {
      throw runtimeException;
    }
  }
}
