{
  assertBusy(new Runnable(){
    @Override public void run(){
      ClusterState state=getNodeClusterState(node);
      String masterNode=null;
      if (state.nodes().masterNode() != null) {
        masterNode=state.nodes().masterNode().name();
      }
      logger.trace("[{}] master is [{}]",node,state.nodes().masterNode());
      assertThat("node [" + node + "] still has ["+ masterNode+ "] as master",oldMasterNode,not(equalTo(masterNode)));
    }
  }
,10,TimeUnit.SECONDS);
}
