{
  int size=randomIntBetween(1,20);
  FiltersAggregatorBuilder factory;
  if (randomBoolean()) {
    KeyedFilter[] filters=new KeyedFilter[size];
    for (int i=0; i < size; i++) {
      filters[i]=new KeyedFilter(randomAsciiOfLengthBetween(1,20),QueryBuilders.termQuery(randomAsciiOfLengthBetween(5,20),randomAsciiOfLengthBetween(5,20)));
    }
    factory=new FiltersAggregatorBuilder(randomAsciiOfLengthBetween(1,20),filters);
  }
 else {
    QueryBuilder<?>[] filters=new QueryBuilder<?>[size];
    for (int i=0; i < size; i++) {
      filters[i]=QueryBuilders.termQuery(randomAsciiOfLengthBetween(5,20),randomAsciiOfLengthBetween(5,20));
    }
    factory=new FiltersAggregatorBuilder(randomAsciiOfLengthBetween(1,20),filters);
  }
  if (randomBoolean()) {
    factory.otherBucket(randomBoolean());
  }
  if (randomBoolean()) {
    factory.otherBucketKey(randomAsciiOfLengthBetween(1,20));
  }
  return factory;
}
