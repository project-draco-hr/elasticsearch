{
  Response response=null;
  try {
    response=newResponse(request,responses,unavailableShardExceptions,nodeIds,clusterState);
  }
 catch (  Throwable t) {
    logger.debug("failed to combine responses from nodes",t);
    listener.onFailure(t);
  }
  if (response != null) {
    try {
      listener.onResponse(response);
    }
 catch (    Throwable t) {
      listener.onFailure(t);
    }
  }
}
