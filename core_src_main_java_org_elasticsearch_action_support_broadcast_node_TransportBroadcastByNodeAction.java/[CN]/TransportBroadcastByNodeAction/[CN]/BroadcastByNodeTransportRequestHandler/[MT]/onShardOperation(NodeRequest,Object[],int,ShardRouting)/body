{
  try {
    if (logger.isTraceEnabled()) {
      logger.trace("[{}]  executing operation for shard [{}]",actionName,shardRouting.shortSummary());
    }
    ShardOperationResult result=shardOperation(request.indicesLevelRequest,shardRouting);
    shardResults[shardIndex]=result;
    if (logger.isTraceEnabled()) {
      logger.trace("[{}]  completed operation for shard [{}]",actionName,shardRouting.shortSummary());
    }
  }
 catch (  Exception e) {
    BroadcastShardOperationFailedException failure=new BroadcastShardOperationFailedException(shardRouting.shardId(),"operation " + actionName + " failed",e);
    failure.setIndex(shardRouting.getIndexName());
    failure.setShard(shardRouting.shardId());
    shardResults[shardIndex]=failure;
    if (TransportActions.isShardNotAvailableException(e)) {
      if (logger.isTraceEnabled()) {
        logger.trace("[{}] failed to execute operation for shard [{}]",e,actionName,shardRouting.shortSummary());
      }
    }
 else {
      if (logger.isDebugEnabled()) {
        logger.debug("[{}] failed to execute operation for shard [{}]",e,actionName,shardRouting.shortSummary());
      }
    }
  }
}
