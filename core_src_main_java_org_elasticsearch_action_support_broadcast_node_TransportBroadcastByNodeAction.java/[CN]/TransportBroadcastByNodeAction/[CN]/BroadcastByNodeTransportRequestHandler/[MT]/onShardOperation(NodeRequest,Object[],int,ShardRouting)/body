{
  try {
    if (logger.isTraceEnabled()) {
      logger.trace("[{}]  executing operation for shard [{}]",actionName,shardRouting.shortSummary());
    }
    ShardOperationResult result=shardOperation(request.indicesLevelRequest,shardRouting);
    shardResults[shardIndex]=result;
    if (logger.isTraceEnabled()) {
      logger.trace("[{}]  completed operation for shard [{}]",actionName,shardRouting.shortSummary());
    }
  }
 catch (  Throwable t) {
    BroadcastShardOperationFailedException e=new BroadcastShardOperationFailedException(shardRouting.shardId(),"operation " + actionName + " failed",t);
    e.setIndex(shardRouting.getIndex());
    e.setShard(shardRouting.shardId());
    shardResults[shardIndex]=e;
    if (TransportActions.isShardNotAvailableException(t)) {
      if (logger.isTraceEnabled()) {
        logger.trace("[{}] failed to execute operation for shard [{}]",t,actionName,shardRouting.shortSummary());
      }
    }
 else {
      if (logger.isDebugEnabled()) {
        logger.debug("[{}] failed to execute operation for shard [{}]",t,actionName,shardRouting.shortSummary());
      }
    }
  }
}
