{
  BytesStreamOutput bStream=new BytesStreamOutput();
  StreamOutput stream=bStream;
  if (isCompress()) {
    stream=CompressorFactory.defaultCompressor().streamOutput(stream);
  }
  XContentBuilder builder=XContentFactory.contentBuilder(XContentType.JSON,stream);
  builder.startObject();
  builder.startArray("snapshots");
  for (  SnapshotId snapshot : snapshots) {
    builder.value(snapshot.getSnapshot());
  }
  builder.endArray();
  builder.endObject();
  builder.close();
  snapshotsBlobContainer.writeBlob(SNAPSHOTS_FILE,bStream.bytes().streamInput(),bStream.bytes().length());
}
