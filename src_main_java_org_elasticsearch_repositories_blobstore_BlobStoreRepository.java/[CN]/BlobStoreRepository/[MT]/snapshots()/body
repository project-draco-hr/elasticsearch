{
  try {
    List<SnapshotId> snapshots=newArrayList();
    Map<String,BlobMetaData> blobs;
    try {
      blobs=snapshotsBlobContainer.listBlobsByPrefix(SNAPSHOT_PREFIX);
    }
 catch (    UnsupportedOperationException ex) {
      return readSnapshotList();
    }
    int prefixLength=SNAPSHOT_PREFIX.length();
    for (    BlobMetaData md : blobs.values()) {
      String name=md.name().substring(prefixLength);
      snapshots.add(new SnapshotId(repositoryName,name));
    }
    return ImmutableList.copyOf(snapshots);
  }
 catch (  IOException ex) {
    throw new RepositoryException(repositoryName,"failed to list snapshots in repository",ex);
  }
}
