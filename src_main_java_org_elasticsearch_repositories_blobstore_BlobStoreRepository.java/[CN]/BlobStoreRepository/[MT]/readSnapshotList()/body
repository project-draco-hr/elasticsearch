{
  byte[] data=snapshotsBlobContainer.readBlobFully(SNAPSHOTS_FILE);
  ArrayList<SnapshotId> snapshots=new ArrayList<SnapshotId>();
  XContentParser parser=null;
  try {
    parser=XContentHelper.createParser(data,0,data.length);
    if (parser.nextToken() == XContentParser.Token.START_OBJECT) {
      if (parser.nextToken() == XContentParser.Token.FIELD_NAME) {
        String currentFieldName=parser.currentName();
        if ("snapshots".equals(currentFieldName)) {
          if (parser.nextToken() == XContentParser.Token.START_ARRAY) {
            while (parser.nextToken() != XContentParser.Token.END_ARRAY) {
              snapshots.add(new SnapshotId(repositoryName,parser.text()));
            }
          }
        }
      }
    }
  }
  finally {
    if (parser != null) {
      parser.close();
    }
  }
  return ImmutableList.copyOf(snapshots);
}
