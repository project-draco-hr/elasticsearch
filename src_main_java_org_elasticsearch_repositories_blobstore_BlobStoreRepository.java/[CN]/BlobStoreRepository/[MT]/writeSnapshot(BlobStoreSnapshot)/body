{
  BytesStreamOutput bStream=new BytesStreamOutput();
  StreamOutput stream=bStream;
  if (isCompress()) {
    stream=CompressorFactory.defaultCompressor().streamOutput(stream);
  }
  XContentBuilder builder=XContentFactory.contentBuilder(XContentType.JSON,stream);
  builder.startObject();
  BlobStoreSnapshot.Builder.toXContent(snapshot,builder,globalOnlyFormatParams);
  builder.endObject();
  builder.close();
  return bStream;
}
