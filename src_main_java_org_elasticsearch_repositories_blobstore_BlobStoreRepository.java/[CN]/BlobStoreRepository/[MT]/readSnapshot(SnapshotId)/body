{
  try {
    try (InputStream blob=snapshotsBlobContainer.openInput(snapshotBlobName(snapshotId))){
      return readSnapshot(ByteStreams.toByteArray(blob));
    }
   }
 catch (  FileNotFoundException|NoSuchFileException ex) {
    throw new SnapshotMissingException(snapshotId,ex);
  }
catch (  IOException ex) {
    throw new SnapshotException(snapshotId,"failed to get snapshots",ex);
  }
}
