{
  try {
    String blobName=snapshotBlobName(snapshotId);
    int retryCount=0;
    while (true) {
      try (InputStream blob=snapshotsBlobContainer.openInput(blobName)){
        byte[] data=ByteStreams.toByteArray(blob);
        try {
          return readSnapshot(data);
        }
 catch (        ElasticsearchParseException ex) {
          if (retryCount++ < 3) {
            try {
              Thread.sleep(50);
            }
 catch (            InterruptedException ex1) {
              Thread.currentThread().interrupt();
            }
          }
 else {
            throw ex;
          }
        }
      }
     }
  }
 catch (  FileNotFoundException|NoSuchFileException ex) {
    throw new SnapshotMissingException(snapshotId,ex);
  }
catch (  IOException ex) {
    throw new SnapshotException(snapshotId,"failed to get snapshots",ex);
  }
}
