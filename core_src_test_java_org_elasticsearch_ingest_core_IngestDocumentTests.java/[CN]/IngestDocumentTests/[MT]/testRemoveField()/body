{
  ingestDocument.removeField("foo");
  assertThat(ingestDocument.getSourceAndMetadata().size(),equalTo(7));
  assertThat(ingestDocument.getSourceAndMetadata().containsKey("foo"),equalTo(false));
  ingestDocument.removeField("_index");
  assertThat(ingestDocument.getSourceAndMetadata().size(),equalTo(6));
  assertThat(ingestDocument.getSourceAndMetadata().containsKey("_index"),equalTo(false));
  ingestDocument.removeField("_source.fizz");
  assertThat(ingestDocument.getSourceAndMetadata().size(),equalTo(5));
  assertThat(ingestDocument.getSourceAndMetadata().containsKey("fizz"),equalTo(false));
  assertThat(ingestDocument.getIngestMetadata().size(),equalTo(1));
  ingestDocument.removeField("_ingest.timestamp");
  assertThat(ingestDocument.getSourceAndMetadata().size(),equalTo(5));
  assertThat(ingestDocument.getIngestMetadata().size(),equalTo(0));
}
