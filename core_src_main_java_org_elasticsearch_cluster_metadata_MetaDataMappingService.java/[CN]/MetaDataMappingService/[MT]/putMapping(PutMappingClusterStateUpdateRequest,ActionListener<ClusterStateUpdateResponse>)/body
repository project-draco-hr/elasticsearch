{
  clusterService.submitStateUpdateTask("put-mapping [" + request.type() + "]",request,ClusterStateTaskConfig.build(Priority.HIGH,request.masterNodeTimeout()),putMappingExecutor,new AckedClusterStateTaskListener(){
    @Override public void onFailure(    String source,    Throwable t){
      listener.onFailure(t);
    }
    @Override public boolean mustAck(    DiscoveryNode discoveryNode){
      return true;
    }
    @Override public void onAllNodesAcked(    @Nullable Throwable t){
      listener.onResponse(new ClusterStateUpdateResponse(true));
    }
    @Override public void onAckTimeout(){
      listener.onResponse(new ClusterStateUpdateResponse(false));
    }
    @Override public TimeValue ackTimeout(){
      return request.ackTimeout();
    }
  }
);
}
