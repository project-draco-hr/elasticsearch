{
  RestStatus status=RestStatus.OK;
  if (response.isTimedOut()) {
    status=RestStatus.REQUEST_TIMEOUT;
  }
  for (  Failure failure : response.getIndexingFailures()) {
    if (failure.getStatus().getStatus() > status.getStatus()) {
      status=failure.getStatus();
    }
  }
  for (  ShardSearchFailure failure : response.getSearchFailures()) {
    RestStatus failureStatus=ExceptionsHelper.status(failure.getCause());
    if (failureStatus.getStatus() > status.getStatus()) {
      status=failureStatus;
    }
  }
  return status;
}
