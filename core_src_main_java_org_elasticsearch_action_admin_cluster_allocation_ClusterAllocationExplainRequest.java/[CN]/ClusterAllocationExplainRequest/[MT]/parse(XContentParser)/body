{
  String currentFieldName=null;
  String index=null;
  Integer shard=null;
  Boolean primary=null;
  XContentParser.Token token;
  while ((token=parser.nextToken()) != XContentParser.Token.END_OBJECT) {
    if (token == XContentParser.Token.FIELD_NAME) {
      currentFieldName=parser.currentName();
    }
 else     if (token.isValue()) {
      if ("index".equals(currentFieldName)) {
        index=parser.text();
      }
 else       if ("shard".equals(currentFieldName)) {
        shard=parser.intValue();
      }
 else       if ("primary".equals(currentFieldName)) {
        primary=parser.booleanValue();
      }
 else {
        throw new ElasticsearchParseException("unexpected field [" + currentFieldName + "] in allocation explain request");
      }
    }
 else     if (token == XContentParser.Token.START_OBJECT) {
      continue;
    }
 else {
      throw new ElasticsearchParseException("unexpected token [" + token + "] in allocation explain request");
    }
  }
  if (index == null && shard == null && primary == null) {
    return new ClusterAllocationExplainRequest();
  }
 else   if (index == null || shard == null || primary == null) {
    throw new ElasticsearchParseException("'index', 'shard', and 'primary' must be specified in allocation explain request");
  }
  return new ClusterAllocationExplainRequest(index,shard,primary);
}
