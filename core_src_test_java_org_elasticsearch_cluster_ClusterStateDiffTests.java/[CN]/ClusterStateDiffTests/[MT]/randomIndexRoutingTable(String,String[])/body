{
  IndexRoutingTable.Builder builder=IndexRoutingTable.builder(index);
  int shardCount=randomInt(10);
  for (int i=0; i < shardCount; i++) {
    IndexShardRoutingTable.Builder indexShard=new IndexShardRoutingTable.Builder(new ShardId(index,i),randomBoolean());
    int replicaCount=randomIntBetween(1,10);
    for (int j=0; j < replicaCount; j++) {
      indexShard.addShard(new MutableShardRouting(index,i,randomFrom(nodeIds),j == 0,ShardRoutingState.fromValue((byte)randomIntBetween(1,4)),1));
    }
    builder.addIndexShard(indexShard.build());
  }
  return builder.build();
}
