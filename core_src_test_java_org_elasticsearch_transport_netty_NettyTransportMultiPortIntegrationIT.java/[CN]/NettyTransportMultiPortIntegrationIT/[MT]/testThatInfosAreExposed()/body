{
  NodesInfoResponse response=client().admin().cluster().prepareNodesInfo().clear().setTransport(true).get();
  for (  NodeInfo nodeInfo : response.getNodes()) {
    assertThat(nodeInfo.getTransport().getProfileAddresses().keySet(),hasSize(1));
    assertThat(nodeInfo.getTransport().getProfileAddresses(),hasKey("client1"));
    assertThat(nodeInfo.getTransport().getProfileAddresses().get("client1").boundAddress(),instanceOf(InetSocketTransportAddress.class));
    InetSocketTransportAddress inetSocketTransportAddress=(InetSocketTransportAddress)nodeInfo.getTransport().getProfileAddresses().get("client1").boundAddress();
    assertThat(inetSocketTransportAddress.address().getPort(),is(allOf(greaterThanOrEqualTo(randomPort),lessThanOrEqualTo(randomPort + 10))));
    assertThat(nodeInfo.getTransport().getProfileAddresses().get("client1").publishAddress(),instanceOf(InetSocketTransportAddress.class));
    InetSocketTransportAddress publishAddress=(InetSocketTransportAddress)nodeInfo.getTransport().getProfileAddresses().get("client1").publishAddress();
    assertThat(NetworkAddress.formatAddress(publishAddress.address().getAddress()),is("127.0.0.7"));
    assertThat(publishAddress.address().getPort(),is(4321));
  }
}
