{
  QueryBuilder rewrite=query.rewrite(queryShardContext);
  if (rewrite != query) {
    HasChildQueryBuilder hasChildQueryBuilder=new HasChildQueryBuilder(type,rewrite);
    hasChildQueryBuilder.minChildren=minChildren;
    hasChildQueryBuilder.maxChildren=maxChildren;
    hasChildQueryBuilder.scoreMode=scoreMode;
    hasChildQueryBuilder.queryInnerHits=queryInnerHits;
    return hasChildQueryBuilder.queryName(queryName()).boost(boost());
  }
  return this;
}
