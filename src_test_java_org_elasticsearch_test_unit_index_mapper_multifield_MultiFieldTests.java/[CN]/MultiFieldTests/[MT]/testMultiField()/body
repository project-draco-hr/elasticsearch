{
  String mapping=copyToStringFromClasspath("/org/elasticsearch/test/unit/index/mapper/multifield/test-mapping.json");
  DocumentMapper docMapper=MapperTestUtils.newParser().parse(mapping);
  BytesReference json=new BytesArray(copyToBytesFromClasspath("/org/elasticsearch/test/unit/index/mapper/multifield/test-data.json"));
  Document doc=docMapper.parse(json).rootDoc();
  IndexableField f=doc.getField("name");
  assertThat(f.name(),equalTo("name"));
  assertThat(f.stringValue(),equalTo("some name"));
  assertThat(f.fieldType().stored(),equalTo(true));
  assertThat(f.fieldType().indexed(),equalTo(true));
  f=doc.getField("name.indexed");
  assertThat(f.name(),equalTo("name.indexed"));
  assertThat(f.stringValue(),equalTo("some name"));
  assertThat(f.fieldType().stored(),equalTo(false));
  assertThat(f.fieldType().indexed(),equalTo(true));
  f=doc.getField("name.not_indexed");
  assertThat(f.name(),equalTo("name.not_indexed"));
  assertThat(f.stringValue(),equalTo("some name"));
  assertThat(f.fieldType().stored(),equalTo(true));
  assertThat(f.fieldType().indexed(),equalTo(false));
  f=doc.getField("object1.multi1");
  assertThat(f.name(),equalTo("object1.multi1"));
  f=doc.getField("object1.multi1.string");
  assertThat(f.name(),equalTo("object1.multi1.string"));
  assertThat(f.stringValue(),equalTo("2010-01-01"));
}
