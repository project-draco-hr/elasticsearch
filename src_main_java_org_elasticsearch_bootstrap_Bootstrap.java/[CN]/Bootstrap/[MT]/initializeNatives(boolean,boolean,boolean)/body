{
  final ESLogger logger=Loggers.getLogger(Bootstrap.class);
  if (mlockAll) {
    if (Constants.WINDOWS) {
      Natives.tryVirtualLock();
    }
 else {
      Natives.tryMlockall();
    }
  }
  if (Natives.definitelyRunningAsRoot()) {
    if (Boolean.parseBoolean(System.getProperty("es.insecure.allow.root"))) {
      logger.warn("running as ROOT user. this is a bad idea!");
    }
 else {
      throw new RuntimeException("don't run elasticsearch as root.");
    }
  }
  if (ctrlHandler) {
    Natives.addConsoleCtrlHandler(new ConsoleCtrlHandler(){
      @Override public boolean handle(      int code){
        if (CTRL_CLOSE_EVENT == code) {
          logger.info("running graceful exit on windows");
          Bootstrap.INSTANCE.stop();
          return true;
        }
        return false;
      }
    }
);
  }
  try {
    Kernel32Library.getInstance();
  }
 catch (  Throwable ignored) {
  }
  if (loadSigar) {
    try {
      Sigar.load();
      logger.trace("sigar libraries loaded successfully");
    }
 catch (    Throwable t) {
      logger.trace("failed to load sigar libraries",t);
    }
  }
 else {
    logger.trace("sigar not loaded, disabled via settings");
  }
  StringHelper.randomId();
}
