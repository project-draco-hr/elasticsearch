{
  if (!primaryAllocatedPostApi) {
    for (    ShardRouting shardRouting : shards) {
      if (shardRouting.primary() && shardRouting.active()) {
        primaryAllocatedPostApi=true;
      }
    }
  }
  return new IndexShardRoutingTable(shardId,ImmutableList.copyOf(shards),primaryAllocatedPostApi);
}
