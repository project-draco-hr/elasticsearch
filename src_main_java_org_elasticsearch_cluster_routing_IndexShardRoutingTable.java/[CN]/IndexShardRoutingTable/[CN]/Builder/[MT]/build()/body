{
  if (!allocatedPostApi) {
    for (    ShardRouting shardRouting : shards) {
      if (shardRouting.primary() && shardRouting.active()) {
        allocatedPostApi=true;
      }
    }
  }
  return new IndexShardRoutingTable(shardId,ImmutableList.copyOf(shards),allocatedPostApi);
}
