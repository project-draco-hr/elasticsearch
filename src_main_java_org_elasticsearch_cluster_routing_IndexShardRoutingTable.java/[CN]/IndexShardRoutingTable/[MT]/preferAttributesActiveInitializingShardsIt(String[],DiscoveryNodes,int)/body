{
  AttributesKey key=new AttributesKey(attributes);
  AttributesRoutings activeRoutings=getActiveAttribute(key,nodes);
  AttributesRoutings initializingRoutings=getInitializingAttribute(key,nodes);
  ArrayList<ShardRouting> ordered=new ArrayList<ShardRouting>(activeRoutings.totalSize + initializingRoutings.totalSize);
  index=Math.abs(index);
  addToListFromIndex(activeRoutings.withSameAttribute,ordered,index);
  addToListFromIndex(activeRoutings.withoutSameAttribute,ordered,index);
  addToListFromIndex(initializingRoutings.withSameAttribute,ordered,index);
  addToListFromIndex(initializingRoutings.withoutSameAttribute,ordered,index);
  return new PlainShardIterator(shardId,ordered);
}
