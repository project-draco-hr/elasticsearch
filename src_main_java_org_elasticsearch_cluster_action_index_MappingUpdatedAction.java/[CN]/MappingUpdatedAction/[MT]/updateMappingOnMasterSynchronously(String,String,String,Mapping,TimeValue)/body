{
  final CountDownLatch latch=new CountDownLatch(1);
  final Throwable[] cause=new Throwable[1];
  final MappingUpdateListener listener=new MappingUpdateListener(){
    @Override public void onMappingUpdate(){
      latch.countDown();
    }
    @Override public void onFailure(    Throwable t){
      cause[0]=t;
      latch.countDown();
    }
  }
;
  updateMappingOnMaster(index,indexUUID,type,mappingUpdate,listener);
  if (!latch.await(timeout.getMillis(),TimeUnit.MILLISECONDS)) {
    throw new TimeoutException("Time out while waiting for the master node to validate a mapping update for type [" + type + "]");
  }
  if (cause[0] != null) {
    throw cause[0];
  }
}
