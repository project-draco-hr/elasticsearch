{
  assertThat(awaitBusy(new Predicate<Object>(){
    public boolean apply(    Object o){
      return client().prepareCount().setQuery(matchAllQuery()).execute().actionGet().getCount() > numDocs;
    }
  }
,5,TimeUnit.MINUTES),equalTo(true));
}
