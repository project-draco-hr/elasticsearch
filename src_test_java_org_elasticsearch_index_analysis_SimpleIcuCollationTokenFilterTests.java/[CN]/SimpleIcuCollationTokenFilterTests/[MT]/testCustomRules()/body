{
  RuleBasedCollator baseCollator=(RuleBasedCollator)Collator.getInstance(new ULocale("de_DE"));
  String DIN5007_2_tailorings="& ae , a\u0308 & AE , A\u0308" + "& oe , o\u0308 & OE , O\u0308" + "& ue , u\u0308 & UE , u\u0308";
  RuleBasedCollator tailoredCollator=new RuleBasedCollator(baseCollator.getRules() + DIN5007_2_tailorings);
  String tailoredRules=tailoredCollator.getRules();
  Index index=new Index("test");
  Settings settings=ImmutableSettings.settingsBuilder().put("index.analysis.filter.myCollator.type","icu_collation").put("index.analysis.filter.myCollator.rules",tailoredRules).put("index.analysis.filter.myCollator.strength","primary").build();
  AnalysisService analysisService=createAnalysisService(index,settings);
  String germanUmlaut="T??ne";
  String germanOE="Toene";
  TokenFilterFactory filterFactory=analysisService.tokenFilter("myCollator");
  TokenStream tsUmlaut=filterFactory.create(new KeywordTokenizer(new StringReader(germanUmlaut)));
  TokenStream tsOE=filterFactory.create(new KeywordTokenizer(new StringReader(germanOE)));
  assertCollatesToSame(tsUmlaut,tsOE);
}
