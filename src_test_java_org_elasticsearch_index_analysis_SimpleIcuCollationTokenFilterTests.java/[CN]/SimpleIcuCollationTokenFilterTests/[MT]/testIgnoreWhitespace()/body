{
  Index index=new Index("test");
  Settings settings=ImmutableSettings.settingsBuilder().put("index.analysis.filter.myCollator.type","icu_collation").put("index.analysis.filter.myCollator.language","en").put("index.analysis.filter.myCollator.strength","primary").put("index.analysis.filter.myCollator.alternate","shifted").put("index.analysis.filter.myCollator.variableTop"," ").build();
  AnalysisService analysisService=createAnalysisService(index,settings);
  String withSpace="foo bar";
  String withoutSpace="foobar";
  String withPunctuation="foo-bar";
  TokenFilterFactory filterFactory=analysisService.tokenFilter("myCollator");
  TokenStream tsWithSpace=filterFactory.create(new KeywordTokenizer(new StringReader(withSpace)));
  TokenStream tsWithoutSpace=filterFactory.create(new KeywordTokenizer(new StringReader(withoutSpace)));
  assertCollatesToSame(tsWithSpace,tsWithoutSpace);
  tsWithSpace=filterFactory.create(new KeywordTokenizer(new StringReader(withSpace)));
  TokenStream tsWithPunctuation=filterFactory.create(new KeywordTokenizer(new StringReader(withPunctuation)));
  assertCollation(tsWithPunctuation,tsWithSpace,-1);
}
