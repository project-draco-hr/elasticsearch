{
  QueryParseContext context=createParseContext();
  String query=randomAsciiOfLengthBetween(1,10).toLowerCase(Locale.ROOT);
  String contentString="{\n" + "    \"simple_query_string\" : {\n" + "      \"query\" : \"" + query + "\""+ "    }\n"+ "}";
  XContentParser parser=XContentFactory.xContent(contentString).createParser(contentString);
  context.reset(parser);
  SimpleQueryStringBuilder queryBuilder=(SimpleQueryStringBuilder)parseQuery(parser,ParseFieldMatcher.EMPTY);
  assertThat(queryBuilder.value(),equalTo(query));
  assertThat(queryBuilder.fields(),notNullValue());
  assertThat(queryBuilder.fields().size(),equalTo(0));
  QueryShardContext shardContext=createShardContext();
  if (getCurrentTypes().length > 0 || shardContext.indexQueryParserService().getIndexCreatedVersion().before(Version.V_1_4_0_Beta1)) {
    Query luceneQuery=queryBuilder.toQuery(shardContext);
    assertThat(luceneQuery,instanceOf(BooleanQuery.class));
    TermQuery termQuery=(TermQuery)((BooleanQuery)luceneQuery).clauses().get(0).getQuery();
    assertThat(termQuery.getTerm(),equalTo(new Term(MetaData.ALL,query)));
  }
}
