{
  builder.startObject(getName());
  if (this.metaData != null) {
    builder.field("meta",this.metaData);
  }
  builder.field(type);
  internalXContent(builder,params);
  if (aggregations != null || aggregationsBinary != null || reducers != null) {
    builder.startObject("aggregations");
    if (aggregations != null) {
      for (      AbstractAggregationBuilder subAgg : aggregations) {
        subAgg.toXContent(builder,params);
      }
    }
    if (reducers != null) {
      for (      ReducerBuilder<?> subAgg : reducers) {
        subAgg.toXContent(builder,params);
      }
    }
    if (aggregationsBinary != null) {
      if (XContentFactory.xContentType(aggregationsBinary) == builder.contentType()) {
        builder.rawField("aggregations",aggregationsBinary);
      }
 else {
        builder.field("aggregations_binary",aggregationsBinary);
      }
    }
    builder.endObject();
  }
  return builder.endObject();
}
