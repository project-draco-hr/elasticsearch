{
  long maxTimeInMillis=TimeUnit.MILLISECONDS.convert(maxWaitTime,unit);
  long iterations=Math.max(Math.round(Math.log10(maxTimeInMillis) / Math.log10(2)),1);
  long timeInMillis=1;
  long sum=0;
  for (int i=0; i < iterations; i++) {
    if (breakPredicate.apply(null)) {
      return true;
    }
    sum+=timeInMillis;
    Thread.sleep(timeInMillis);
    timeInMillis*=2;
  }
  timeInMillis=maxTimeInMillis - sum;
  Thread.sleep(Math.max(timeInMillis,0));
  return breakPredicate.apply(null);
}
