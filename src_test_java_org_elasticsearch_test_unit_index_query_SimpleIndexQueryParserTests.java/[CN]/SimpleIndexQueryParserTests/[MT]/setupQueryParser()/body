{
  Settings settings=ImmutableSettings.settingsBuilder().put("index.cache.filter.type","none").build();
  Index index=new Index("test");
  Injector injector=new ModulesBuilder().add(new SettingsModule(settings),new ThreadPoolModule(settings),new IndicesQueriesModule(),new ScriptModule(settings),new MapperServiceModule(),new IndexSettingsModule(index,settings),new IndexCacheModule(settings),new AnalysisModule(settings),new IndexEngineModule(settings),new SimilarityModule(settings),new IndexQueryParserModule(settings),new IndexNameModule(index)).createInjector();
  String mapping=copyToStringFromClasspath("/org/elasticsearch/test/unit/index/query/mapping.json");
  injector.getInstance(MapperService.class).add("person",mapping);
  injector.getInstance(MapperService.class).documentMapper("person").parse(copyToBytesFromClasspath("/org/elasticsearch/test/unit/index/query/data.json"));
  this.queryParser=injector.getInstance(IndexQueryParserService.class);
}
