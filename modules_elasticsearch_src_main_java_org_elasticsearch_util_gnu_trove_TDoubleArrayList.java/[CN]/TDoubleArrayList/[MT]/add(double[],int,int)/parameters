double[] vals
int offset
int length
