{
  if (state == SnapshotState.FAILED) {
    return RestStatus.INTERNAL_SERVER_ERROR;
  }
  if (shardFailures.size() == 0) {
    return RestStatus.OK;
  }
  RestStatus status=RestStatus.OK;
  if (successfulShards == 0 && totalShards > 0) {
    for (    SnapshotShardFailure shardFailure : shardFailures)     if (shardFailure.status().getStatus() > status().getStatus()) {
      status=shardFailure.status();
    }
    return status;
  }
  return status;
}
