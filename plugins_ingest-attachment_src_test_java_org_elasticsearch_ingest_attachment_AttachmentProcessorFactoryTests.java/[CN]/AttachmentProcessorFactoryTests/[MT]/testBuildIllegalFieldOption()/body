{
  Map<String,Object> config=new HashMap<>();
  config.put("source_field","_field");
  config.put("fields",Collections.singletonList("invalid"));
  try {
    factory.create(config);
    fail("exception expected");
  }
 catch (  ElasticsearchParseException e) {
    assertThat(e.getMessage(),containsString("[fields] illegal field option [invalid]"));
    for (    AttachmentProcessor.Field field : AttachmentProcessor.Field.values()) {
      assertThat(e.getMessage(),containsString(field.name()));
    }
  }
  config=new HashMap<>();
  config.put("source_field","_field");
  config.put("fields","invalid");
  try {
    factory.create(config);
    fail("exception expected");
  }
 catch (  ElasticsearchParseException e) {
    assertThat(e.getMessage(),equalTo("[fields] property isn't a list, but of type [java.lang.String]"));
  }
}
