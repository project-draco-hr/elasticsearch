{
  Map<String,Object> config=new HashMap<>();
  config.put("source_field","_field");
  config.put("fields",Collections.singletonList("invalid"));
  try {
    factory.create(config);
    fail("exception expected");
  }
 catch (  ElasticsearchParseException e) {
    assertThat(e.getMessage(),equalTo("[fields] illegal field option [invalid]. valid values are " + "[CONTENT, TITLE, NAME, AUTHOR, KEYWORDS, DATE, CONTENT_TYPE, CONTENT_LENGTH, LANGUAGE]"));
  }
  config=new HashMap<>();
  config.put("source_field","_field");
  config.put("fields","invalid");
  try {
    factory.create(config);
    fail("exception expected");
  }
 catch (  ElasticsearchParseException e) {
    assertThat(e.getMessage(),equalTo("[fields] property isn't a list, but of type [java.lang.String]"));
  }
}
