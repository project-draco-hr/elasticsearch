{
  Map<String,Object> pipelineConfig=XContentHelper.convertToMap(request.source(),false).v2();
  try {
    constructPipeline(request.id(),pipelineConfig);
  }
 catch (  IOException e) {
    listener.onFailure(e);
    return;
  }
  IndexRequest indexRequest=new IndexRequest(request);
  indexRequest.index(PipelineStore.INDEX);
  indexRequest.type(PipelineStore.TYPE);
  indexRequest.id(request.id());
  indexRequest.source(request.source());
  indexRequest.refresh(true);
  client.index(indexRequest,listener);
}
