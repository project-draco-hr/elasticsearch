{
  Map<String,Pipeline> pipelines=new HashMap<>();
  SearchResponse searchResponse=client.prepareSearch(INDEX).setScroll(TimeValue.timeValueMinutes(1)).addSort("_doc",SortOrder.ASC).setIndicesOptions(IndicesOptions.lenientExpandOpen()).get();
  logger.info("Loading [{}] pipelines",searchResponse.getHits().totalHits());
  do {
    for (    SearchHit hit : searchResponse.getHits()) {
      logger.info("Loading pipeline [{}] with source [{}]",hit.getId(),hit.sourceAsString());
      Pipeline.Builder builder=new Pipeline.Builder(hit.sourceAsMap());
      pipelines.put(hit.getId(),builder.build());
    }
    searchResponse=client.prepareSearchScroll(searchResponse.getScrollId()).get();
  }
 while (searchResponse.getHits().getHits().length != 0);
  PipelineStore.this.pipelines=PipelineStore.this.pipelines.copyAndPutAll(pipelines);
}
