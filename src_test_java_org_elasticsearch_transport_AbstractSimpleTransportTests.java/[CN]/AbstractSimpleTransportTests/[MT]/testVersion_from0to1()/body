{
  serviceB.registerRequestHandler("/version",Version1Request.class,ThreadPool.Names.SAME,new TransportRequestHandler<Version1Request>(){
    @Override public void messageReceived(    Version1Request request,    TransportChannel channel) throws Exception {
      assertThat(request.value1,equalTo(1));
      assertThat(request.value2,equalTo(0));
      Version1Response response=new Version1Response();
      response.value1=1;
      response.value2=2;
      channel.sendResponse(response);
    }
  }
);
  Version0Request version0Request=new Version0Request();
  version0Request.value1=1;
  Version0Response version0Response=serviceA.submitRequest(nodeB,"/version",version0Request,new BaseTransportResponseHandler<Version0Response>(){
    @Override public Version0Response newInstance(){
      return new Version0Response();
    }
    @Override public void handleResponse(    Version0Response response){
      assertThat(response.value1,equalTo(1));
    }
    @Override public void handleException(    TransportException exp){
      exp.printStackTrace();
      fail();
    }
    @Override public String executor(){
      return ThreadPool.Names.SAME;
    }
  }
).txGet();
  assertThat(version0Response.value1,equalTo(1));
}
