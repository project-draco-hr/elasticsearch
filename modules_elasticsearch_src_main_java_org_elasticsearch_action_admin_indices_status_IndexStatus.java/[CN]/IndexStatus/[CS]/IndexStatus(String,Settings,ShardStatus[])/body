{
  this.index=index;
  this.settings=settings;
  Map<Integer,List<ShardStatus>> tmpIndexShards=Maps.newHashMap();
  for (  ShardStatus shard : shards) {
    List<ShardStatus> lst=tmpIndexShards.get(shard.shardRouting().id());
    if (lst == null) {
      lst=newArrayList();
      tmpIndexShards.put(shard.shardRouting().id(),lst);
    }
    lst.add(shard);
  }
  indexShards=Maps.newHashMap();
  for (  Map.Entry<Integer,List<ShardStatus>> entry : tmpIndexShards.entrySet()) {
    indexShards.put(entry.getKey(),new IndexShardStatus(entry.getValue().get(0).shardRouting().shardId(),entry.getValue().toArray(new ShardStatus[entry.getValue().size()])));
  }
}
