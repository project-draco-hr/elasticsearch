{
  long total_bytes=0;
  long to_upgrade_bytes=0;
  for (  IndexShardSegments shard : indexSegments) {
    for (    ShardSegments segs : shard.getShards()) {
      for (      Segment seg : segs.getSegments()) {
        total_bytes+=seg.sizeInBytes;
        if (seg.version.minor != Version.CURRENT.luceneVersion.minor) {
          to_upgrade_bytes+=seg.sizeInBytes;
        }
      }
    }
  }
  return new Tuple<>(total_bytes,to_upgrade_bytes);
}
