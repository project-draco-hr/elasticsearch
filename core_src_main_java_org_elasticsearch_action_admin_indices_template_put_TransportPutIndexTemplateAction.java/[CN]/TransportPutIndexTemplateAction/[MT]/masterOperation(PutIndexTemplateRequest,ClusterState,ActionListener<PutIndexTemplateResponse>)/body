{
  String cause=request.cause();
  if (cause.length() == 0) {
    cause="api";
  }
  final Settings.Builder templateSettingsBuilder=Settings.settingsBuilder();
  templateSettingsBuilder.put(request.settings()).normalizePrefix(IndexMetaData.INDEX_SETTING_PREFIX);
  indexScopedSettings.validate(templateSettingsBuilder);
  indexTemplateService.putTemplate(new MetaDataIndexTemplateService.PutRequest(cause,request.name()).template(request.template()).order(request.order()).settings(templateSettingsBuilder.build()).mappings(request.mappings()).aliases(request.aliases()).customs(request.customs()).create(request.create()).masterTimeout(request.masterNodeTimeout()),new MetaDataIndexTemplateService.PutListener(){
    @Override public void onResponse(    MetaDataIndexTemplateService.PutResponse response){
      listener.onResponse(new PutIndexTemplateResponse(response.acknowledged()));
    }
    @Override public void onFailure(    Throwable t){
      logger.debug("failed to put template [{}]",t,request.name());
      listener.onFailure(t);
    }
  }
);
}
