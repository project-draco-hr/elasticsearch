{
  setupMapperParser(false);
  byte[] html=copyToBytesFromClasspath("/org/elasticsearch/index/mapper/attachment/test/sample-files/text-in-english.txt");
  XContentBuilder xcb=jsonBuilder().startObject().startObject("file").field("_name","text-in-english.txt").field("_content",html).field("_detect_language",true).endObject().endObject();
  ParseContext.Document doc=docMapper.parse("person","1",xcb.bytes()).rootDoc();
  assertThat(doc.get(docMapper.mappers().getMapper("file.language").fieldType().names().indexName()),equalTo("en"));
}
