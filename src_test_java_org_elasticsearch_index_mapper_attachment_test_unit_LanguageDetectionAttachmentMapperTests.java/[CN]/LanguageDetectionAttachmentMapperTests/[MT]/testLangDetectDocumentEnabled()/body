{
  setupMapperParser(false);
  byte[] html=copyToBytesFromClasspath("/org/elasticsearch/index/mapper/attachment/test/sample-files/text-in-english.txt");
  XContentBuilder xcb=jsonBuilder().startObject().field("_id",1).startObject("file").field("_name","text-in-english.txt").field("_content",html).field("_detect_language",true).endObject().endObject();
  ParseContext.Document doc=docMapper.parse(xcb.bytes()).rootDoc();
  assertThat(doc.get(docMapper.mappers().smartName("file.language").mapper().names().indexName()),equalTo("en"));
}
