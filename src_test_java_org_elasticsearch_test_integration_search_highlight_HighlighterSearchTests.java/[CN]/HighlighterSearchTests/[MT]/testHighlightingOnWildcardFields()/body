{
  client.admin().indices().prepareDelete().execute().actionGet();
  client.admin().indices().prepareCreate("test").execute().actionGet();
  client.admin().cluster().prepareHealth("test").setWaitForGreenStatus().execute().actionGet();
  client.prepareIndex("test","type1").setSource("field1","this is a test","field2","this is another test").setRefresh(true).execute().actionGet();
  logger.info("--> highlighting and searching on field*");
  SearchSourceBuilder source=searchSource().query(termQuery("field1","test")).from(0).size(60).explain(true).highlight(highlight().field("field*").order("score").preTags("<xxx>").postTags("</xxx>"));
  SearchResponse searchResponse=client.search(searchRequest("test").setSource(source).setSearchType(QUERY_THEN_FETCH).setScroll(timeValueMinutes(10))).actionGet();
  assertThat("Failures " + Arrays.toString(searchResponse.getShardFailures()),searchResponse.getShardFailures().length,equalTo(0));
  assertThat(searchResponse.getHits().totalHits(),equalTo(1l));
  assertThat(searchResponse.getHits().getAt(0).highlightFields().get("field1").fragments()[0].string(),equalTo("this is a <xxx>test</xxx>"));
  assertThat(searchResponse.getHits().getAt(0).highlightFields().get("field2").fragments()[0].string(),equalTo("this is another <xxx>test</xxx>"));
}
