{
  FieldDataSource.Numeric dataSource=(FieldDataSource.Numeric)fieldDataSources.get(config.fieldContext.field());
  if (dataSource == null) {
    dataSource=new FieldDataSource.Numeric.FieldData((IndexNumericFieldData<?>)config.fieldContext.indexFieldData());
    setReaderIfNeeded((ReaderContextAware)dataSource);
    readerAwares.add((ReaderContextAware)dataSource);
    fieldDataSources.put(config.fieldContext.field(),dataSource);
  }
  if (config.script != null) {
    setScorerIfNeeded(config.script);
    setReaderIfNeeded(config.script);
    scorerAwares.add(config.script);
    readerAwares.add(config.script);
    dataSource=new FieldDataSource.Numeric.WithScript(dataSource,config.script);
    if (config.ensureUnique || config.ensureSorted) {
      dataSource=new FieldDataSource.Numeric.SortedAndUnique(dataSource);
      readerAwares.add((ReaderContextAware)dataSource);
    }
  }
  if (config.needsHashes) {
    dataSource.setNeedsHashes(true);
  }
  return new NumericValuesSource(dataSource,config.formatter(),config.parser());
}
