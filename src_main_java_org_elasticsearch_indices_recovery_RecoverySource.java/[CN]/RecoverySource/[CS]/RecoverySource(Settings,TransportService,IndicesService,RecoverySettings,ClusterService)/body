{
  super(settings);
  this.transportService=transportService;
  this.indicesService=indicesService;
  this.clusterService=clusterService;
  this.indicesService.indicesLifecycle().addListener(new IndicesLifecycle.Listener(){
    @Override public void beforeIndexShardClosed(    ShardId shardId,    @Nullable IndexShard indexShard,    @IndexSettings Settings indexSettings){
      if (indexShard != null) {
        ongoingRecoveries.cancel(indexShard,"shard is closed");
      }
    }
  }
);
  this.recoverySettings=recoverySettings;
  transportService.registerRequestHandler(Actions.START_RECOVERY,StartRecoveryRequest.class,ThreadPool.Names.GENERIC,new StartRecoveryTransportRequestHandler());
}
