{
  super(settings);
  this.transportService=transportService;
  this.indicesService=indicesService;
  this.mappingUpdatedAction=mappingUpdatedAction;
  this.clusterService=clusterService;
  this.indicesService.indicesLifecycle().addListener(new IndicesLifecycle.Listener(){
    @Override public void beforeIndexShardClosed(    ShardId shardId,    @Nullable IndexShard indexShard,    @IndexSettings Settings indexSettings){
      if (indexShard != null) {
        ongoingRecoveries.cancel(indexShard,"shard is closed");
      }
    }
  }
);
  this.recoverySettings=recoverySettings;
  transportService.registerHandler(Actions.START_RECOVERY,new StartRecoveryTransportRequestHandler());
}
