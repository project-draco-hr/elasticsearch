{
  Path tempDir=createTempDir();
  Settings.Builder settingsBuilder=settingsBuilder().put(Environment.PATH_HOME_SETTING.getKey(),tempDir);
  if (randomBoolean()) {
    settingsBuilder.put(Environment.PATH_PLUGINS_SETTING.getKey(),createTempDir());
  }
  if (randomBoolean()) {
    settingsBuilder.put(Environment.PATH_CONF_SETTING.getKey(),createTempDir());
  }
  environment=new Environment(settingsBuilder.build());
  supportsPermissions=tempDir.getFileSystem().supportedFileAttributeViews().contains("posix");
}
