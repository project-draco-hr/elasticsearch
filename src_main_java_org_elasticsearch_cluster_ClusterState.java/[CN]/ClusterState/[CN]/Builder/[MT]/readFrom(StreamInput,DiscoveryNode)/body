{
  Builder builder=new Builder();
  builder.version=in.readLong();
  builder.metaData=MetaData.Builder.readFrom(in);
  builder.routingTable=RoutingTable.Builder.readFrom(in);
  builder.nodes=DiscoveryNodes.Builder.readFrom(in,localNode);
  builder.blocks=ClusterBlocks.Builder.readClusterBlocks(in);
  if (in.getVersion().before(Version.V_1_1_0)) {
    AllocationExplanation.readAllocationExplanation(in);
  }
  int customSize=in.readVInt();
  for (int i=0; i < customSize; i++) {
    String type=in.readString();
    Custom customIndexMetaData=lookupFactorySafe(type).readFrom(in);
    builder.putCustom(type,customIndexMetaData);
  }
  return builder.build();
}
