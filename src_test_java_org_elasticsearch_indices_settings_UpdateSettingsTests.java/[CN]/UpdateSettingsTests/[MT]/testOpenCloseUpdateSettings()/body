{
  createIndex("test");
  try {
    client().admin().indices().prepareUpdateSettings("test").setSettings(ImmutableSettings.settingsBuilder().put("index.refresh_interval",-1).put("index.cache.filter.type","none")).execute().actionGet();
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
  IndexMetaData indexMetaData=client().admin().cluster().prepareState().execute().actionGet().getState().metaData().index("test");
  assertThat(indexMetaData.settings().get("index.refresh_interval"),nullValue());
  assertThat(indexMetaData.settings().get("index.cache.filter.type"),nullValue());
  GetSettingsResponse getSettingsResponse=client().admin().indices().prepareGetSettings("test").get();
  assertThat(getSettingsResponse.getSetting("test","index.refresh_interval"),nullValue());
  assertThat(getSettingsResponse.getSetting("test","index.cache.filter.type"),nullValue());
  client().admin().indices().prepareUpdateSettings("test").setSettings(ImmutableSettings.settingsBuilder().put("index.refresh_interval",-1)).execute().actionGet();
  indexMetaData=client().admin().cluster().prepareState().execute().actionGet().getState().metaData().index("test");
  assertThat(indexMetaData.settings().get("index.refresh_interval"),equalTo("-1"));
  getSettingsResponse=client().admin().indices().prepareGetSettings("test").get();
  assertThat(getSettingsResponse.getSetting("test","index.refresh_interval"),equalTo("-1"));
  ClusterHealthResponse health=client().admin().cluster().prepareHealth().setTimeout("30s").setWaitForEvents(Priority.LANGUID).setWaitForGreenStatus().execute().actionGet();
  assertThat(health.isTimedOut(),equalTo(false));
  client().admin().indices().prepareClose("test").execute().actionGet();
  client().admin().indices().prepareUpdateSettings("test").setSettings(ImmutableSettings.settingsBuilder().put("index.refresh_interval","1s").put("index.cache.filter.type","none")).execute().actionGet();
  indexMetaData=client().admin().cluster().prepareState().execute().actionGet().getState().metaData().index("test");
  assertThat(indexMetaData.settings().get("index.refresh_interval"),equalTo("1s"));
  assertThat(indexMetaData.settings().get("index.cache.filter.type"),equalTo("none"));
  getSettingsResponse=client().admin().indices().prepareGetSettings("test").get();
  assertThat(getSettingsResponse.getSetting("test","index.refresh_interval"),equalTo("1s"));
  assertThat(getSettingsResponse.getSetting("test","index.cache.filter.type"),equalTo("none"));
}
