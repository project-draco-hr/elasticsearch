{
  final Tuple<IndexService,Injector> indexServiceInjectorTuple=this.indices.get(shardId.getIndex());
  if (IndexMetaData.isOnSharedFilesystem(indexSettings) == false) {
    if (indexServiceInjectorTuple != null && nodeEnv.hasNodeFile()) {
      final IndexService indexService=indexServiceInjectorTuple.v1();
      return indexService.hasShard(shardId.id()) == false;
    }
 else     if (nodeEnv.hasNodeFile()) {
      if (NodeEnvironment.hasCustomDataPath(indexSettings)) {
        return Files.exists(nodeEnv.resolveCustomLocation(indexSettings,shardId));
      }
 else {
        return FileSystemUtils.exists(nodeEnv.availableShardPaths(shardId));
      }
    }
  }
 else {
    logger.trace("{} skipping shard directory deletion due to shadow replicas",shardId);
  }
  return false;
}
