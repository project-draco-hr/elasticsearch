{
  final IndexServiceInjectorPair indexServiceInjectorPair=this.indices.get(shardId.getIndex());
  if (IndexMetaData.isOnSharedFilesystem(indexSettings) == false) {
    if (indexServiceInjectorPair != null && nodeEnv.hasNodeFile()) {
      final IndexService indexService=indexServiceInjectorPair.getIndexService();
      return indexService.hasShard(shardId.id()) == false;
    }
 else     if (nodeEnv.hasNodeFile()) {
      if (NodeEnvironment.hasCustomDataPath(indexSettings)) {
        return Files.exists(nodeEnv.resolveCustomLocation(indexSettings,shardId));
      }
 else {
        return FileSystemUtils.exists(nodeEnv.availableShardPaths(shardId));
      }
    }
  }
 else {
    logger.trace("{} skipping shard directory deletion due to shadow replicas",shardId);
  }
  return false;
}
