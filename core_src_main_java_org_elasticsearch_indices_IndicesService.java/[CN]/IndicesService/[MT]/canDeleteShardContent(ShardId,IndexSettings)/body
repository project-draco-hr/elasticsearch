{
  final IndexService indexService=this.indices.get(shardId.getIndex());
  if (indexSettings.isOnSharedFilesystem() == false) {
    if (indexService != null && nodeEnv.hasNodeFile()) {
      return indexService.hasShard(shardId.id()) == false;
    }
 else     if (nodeEnv.hasNodeFile()) {
      if (indexSettings.hasCustomDataPath()) {
        return Files.exists(nodeEnv.resolveCustomLocation(indexSettings,shardId));
      }
 else {
        return FileSystemUtils.exists(nodeEnv.availableShardPaths(shardId));
      }
    }
  }
 else {
    logger.trace("{} skipping shard directory deletion due to shadow replicas",shardId);
  }
  return false;
}
