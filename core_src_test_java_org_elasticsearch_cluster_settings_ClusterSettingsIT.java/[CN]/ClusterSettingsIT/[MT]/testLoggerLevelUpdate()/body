{
  assertAcked(prepareCreate("test"));
  final String rootLevel=ESLoggerFactory.getRootLogger().getLevel();
  final String testLevel=ESLoggerFactory.getLogger("test").getLevel();
  try {
    client().admin().cluster().prepareUpdateSettings().setTransientSettings(Settings.builder().put("logger._root","BOOM")).execute().actionGet();
    fail("Expected IllegalArgumentException");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("No enum constant org.elasticsearch.common.logging.ESLoggerFactory.LogLevel.BOOM",e.getMessage());
  }
  try {
    client().admin().cluster().prepareUpdateSettings().setTransientSettings(Settings.builder().put("logger.test","TRACE").put("logger._root","trace")).execute().actionGet();
    assertEquals("TRACE",ESLoggerFactory.getLogger("test").getLevel());
    assertEquals("TRACE",ESLoggerFactory.getRootLogger().getLevel());
  }
  finally {
    client().admin().cluster().prepareUpdateSettings().setTransientSettings(Settings.builder().putNull("logger.test").putNull("logger._root")).execute().actionGet();
    assertEquals(testLevel,ESLoggerFactory.getLogger("test").getLevel());
    assertEquals(rootLevel,ESLoggerFactory.getRootLogger().getLevel());
  }
}
