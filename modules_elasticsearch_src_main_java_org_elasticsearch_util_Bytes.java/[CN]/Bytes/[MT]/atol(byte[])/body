{
  long result=0;
  boolean negative=false;
  int i=0, len=s.length;
  long limit=-Long.MAX_VALUE;
  long multmin;
  int digit;
  if (len > 0) {
    byte firstChar=s[0];
    if (firstChar < '0') {
      if (firstChar == '-') {
        negative=true;
        limit=Long.MIN_VALUE;
      }
 else       throw new NumberFormatException();
      if (len == 1)       throw new NumberFormatException();
      i++;
    }
    multmin=limit / 10;
    while (i < len) {
      digit=Character.digit(s[i++],10);
      if (digit < 0) {
        throw new NumberFormatException();
      }
      if (result < multmin) {
        throw new NumberFormatException();
      }
      result*=10;
      if (result < limit + digit) {
        throw new NumberFormatException();
      }
      result-=digit;
    }
  }
 else {
    throw new NumberFormatException();
  }
  return negative ? result : -result;
}
