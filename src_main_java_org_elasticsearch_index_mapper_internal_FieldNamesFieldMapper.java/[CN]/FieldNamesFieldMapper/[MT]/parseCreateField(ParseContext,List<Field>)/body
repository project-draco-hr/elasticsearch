{
  if (!fieldType.indexed() && !fieldType.stored() && !hasDocValues()) {
    return;
  }
  for (  ParseContext.Document document : context.docs()) {
    final List<String> paths=new ArrayList<>();
    for (    IndexableField field : document.getFields()) {
      paths.add(field.name());
    }
    for (    String path : paths) {
      for (      String fieldName : extractFieldNames(path)) {
        if (fieldType.indexed() || fieldType.stored()) {
          document.add(new Field(names().indexName(),fieldName,fieldType));
        }
        if (hasDocValues()) {
          document.add(new SortedSetDocValuesField(names().indexName(),new BytesRef(fieldName)));
        }
      }
    }
  }
}
