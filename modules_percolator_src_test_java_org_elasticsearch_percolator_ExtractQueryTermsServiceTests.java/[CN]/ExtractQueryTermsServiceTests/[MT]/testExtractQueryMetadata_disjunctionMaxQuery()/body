{
  TermQuery termQuery1=new TermQuery(new Term("_field","_term1"));
  TermQuery termQuery2=new TermQuery(new Term("_field","_term2"));
  TermQuery termQuery3=new TermQuery(new Term("_field","_term3"));
  TermQuery termQuery4=new TermQuery(new Term("_field","_term4"));
  DisjunctionMaxQuery disjunctionMaxQuery=new DisjunctionMaxQuery(Arrays.asList(termQuery1,termQuery2,termQuery3,termQuery4),0.1f);
  Result result=extractQueryTerms(disjunctionMaxQuery);
  assertThat(result.verified,is(true));
  List<Term> terms=new ArrayList<>(result.terms);
  Collections.sort(terms);
  assertThat(terms.size(),equalTo(4));
  assertThat(terms.get(0).field(),equalTo(termQuery1.getTerm().field()));
  assertThat(terms.get(0).bytes(),equalTo(termQuery1.getTerm().bytes()));
  assertThat(terms.get(1).field(),equalTo(termQuery2.getTerm().field()));
  assertThat(terms.get(1).bytes(),equalTo(termQuery2.getTerm().bytes()));
  assertThat(terms.get(2).field(),equalTo(termQuery3.getTerm().field()));
  assertThat(terms.get(2).bytes(),equalTo(termQuery3.getTerm().bytes()));
  assertThat(terms.get(3).field(),equalTo(termQuery4.getTerm().field()));
  assertThat(terms.get(3).bytes(),equalTo(termQuery4.getTerm().bytes()));
  disjunctionMaxQuery=new DisjunctionMaxQuery(Arrays.asList(termQuery1,termQuery2,termQuery3,new PhraseQuery("_field","_term4")),0.1f);
  result=extractQueryTerms(disjunctionMaxQuery);
  assertThat(result.verified,is(false));
  terms=new ArrayList<>(result.terms);
  Collections.sort(terms);
  assertThat(terms.size(),equalTo(4));
  assertThat(terms.get(0).field(),equalTo(termQuery1.getTerm().field()));
  assertThat(terms.get(0).bytes(),equalTo(termQuery1.getTerm().bytes()));
  assertThat(terms.get(1).field(),equalTo(termQuery2.getTerm().field()));
  assertThat(terms.get(1).bytes(),equalTo(termQuery2.getTerm().bytes()));
  assertThat(terms.get(2).field(),equalTo(termQuery3.getTerm().field()));
  assertThat(terms.get(2).bytes(),equalTo(termQuery3.getTerm().bytes()));
  assertThat(terms.get(3).field(),equalTo(termQuery4.getTerm().field()));
  assertThat(terms.get(3).bytes(),equalTo(termQuery4.getTerm().bytes()));
}
