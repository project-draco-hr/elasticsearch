{
  Processor processor=mock(Processor.class);
  when(processor.getType()).thenReturn("failed_processor");
  doThrow(new RuntimeException("error")).doNothing().when(processor).execute(ingestDocument);
  CompoundProcessor compoundProcessor=new CompoundProcessor(processor);
  assertThat(compoundProcessor.getProcessors().size(),equalTo(1));
  assertThat(compoundProcessor.getProcessors().get(0),equalTo(processor));
  assertThat(compoundProcessor.getOnFailureProcessors().isEmpty(),is(true));
  try {
    compoundProcessor.execute(ingestDocument);
    fail("should throw exception");
  }
 catch (  Exception e) {
    assertThat(e.getMessage(),equalTo("error"));
  }
  verify(processor,times(1)).execute(ingestDocument);
}
