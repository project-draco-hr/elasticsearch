{
  Injector riverInjector;
  River river;
synchronized (this) {
    riverInjector=riversInjectors.remove(riverName);
    if (riverInjector == null) {
      throw new RiverException(riverName,"missing");
    }
    logger.debug("closing river [{}][{}]",riverName.type(),riverName.name());
    Map<RiverName,River> tmpMap=Maps.newHashMap(rivers);
    river=tmpMap.remove(riverName);
    rivers=ImmutableMap.copyOf(tmpMap);
  }
  river.close();
  Injectors.close(injector);
}
