{
  if (riversInjectors.containsKey(riverName)) {
    throw new RiverException(riverName,"river already exists");
  }
  logger.debug("creating river [{}][{}]",riverName.type(),riverName.name());
  ModulesBuilder modules=new ModulesBuilder();
  modules.add(new RiverNameModule(riverName));
  modules.add(new RiverModule(riverName,settings,this.settings));
  Injector indexInjector=modules.createChildInjector(injector);
  riversInjectors.put(riverName,indexInjector);
  River river=indexInjector.getInstance(River.class);
  rivers=MapBuilder.newMapBuilder(rivers).put(riverName,river).immutableMap();
  river.start();
  return river;
}
