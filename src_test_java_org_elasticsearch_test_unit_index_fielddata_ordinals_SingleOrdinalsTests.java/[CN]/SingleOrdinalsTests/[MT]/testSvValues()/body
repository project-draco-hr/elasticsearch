{
  int numDocs=1000000;
  int numOrdinals=numDocs / 4;
  Map<Integer,Integer> controlDocToOrdinal=new HashMap<Integer,Integer>();
  OrdinalsBuilder builder=new OrdinalsBuilder(numDocs);
  int ordinal=builder.nextOrdinal();
  for (int doc=0; doc < numDocs; doc++) {
    if (doc % numOrdinals == 0) {
      ordinal=builder.nextOrdinal();
    }
    controlDocToOrdinal.put(doc,ordinal);
    builder.addDoc(doc);
  }
  Ordinals ords=builder.build(ImmutableSettings.EMPTY);
  assertThat(ords,instanceOf(SinglePackedOrdinals.class));
  Ordinals.Docs docs=ords.ordinals();
  assertThat(controlDocToOrdinal.size(),equalTo(docs.getNumDocs()));
  for (  Map.Entry<Integer,Integer> entry : controlDocToOrdinal.entrySet()) {
    assertThat(entry.getValue(),equalTo(docs.getOrd(entry.getKey())));
  }
}
