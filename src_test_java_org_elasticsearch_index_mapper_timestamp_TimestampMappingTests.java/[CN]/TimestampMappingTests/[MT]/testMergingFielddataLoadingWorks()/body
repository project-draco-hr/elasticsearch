{
  String mapping=XContentFactory.jsonBuilder().startObject().startObject("type").startObject("_timestamp").field("enabled",randomBoolean()).startObject("fielddata").field("loading","lazy").field("format","doc_values").endObject().field("store","yes").endObject().endObject().endObject().string();
  DocumentMapperParser parser=createIndex("test").mapperService().documentMapperParser();
  DocumentMapper docMapper=parser.parse(mapping);
  assertThat(docMapper.timestampFieldMapper().fieldDataType().getLoading(),equalTo(FieldMapper.Loading.LAZY));
  assertThat(docMapper.timestampFieldMapper().fieldDataType().getFormat(docMapper.timestampFieldMapper().fieldDataType().getSettings()),equalTo("doc_values"));
  mapping=XContentFactory.jsonBuilder().startObject().startObject("type").startObject("_timestamp").field("enabled",randomBoolean()).startObject("fielddata").field("loading","eager").field("format","array").endObject().field("store","yes").endObject().endObject().endObject().string();
  DocumentMapper.MergeResult mergeResult=docMapper.merge(parser.parse(mapping),DocumentMapper.MergeFlags.mergeFlags().simulate(false));
  assertThat(mergeResult.conflicts().length,equalTo(0));
  assertThat(docMapper.timestampFieldMapper().fieldDataType().getLoading(),equalTo(FieldMapper.Loading.EAGER));
  assertThat(docMapper.timestampFieldMapper().fieldDataType().getFormat(docMapper.timestampFieldMapper().fieldDataType().getSettings()),equalTo("array"));
}
