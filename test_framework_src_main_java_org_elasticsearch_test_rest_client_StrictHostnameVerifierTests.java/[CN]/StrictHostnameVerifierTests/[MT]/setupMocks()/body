{
  sslSocket=mock(SSLSocket.class);
  sslSession=mock(SSLSession.class);
  certificate=mock(X509Certificate.class);
  Collection<List<?>> subjectAlternativeNames=new ArrayList<>();
  for (  String san : IP_SANS) {
    subjectAlternativeNames.add(Arrays.asList(IP_SAN_TYPE,san));
  }
  for (  String san : DNS_SANS) {
    subjectAlternativeNames.add(Arrays.asList(DNS_SAN_TYPE,san));
  }
  when(sslSocket.getSession()).thenReturn(sslSession);
  when(sslSession.getPeerCertificates()).thenReturn(new Certificate[]{certificate});
  when(certificate.getSubjectX500Principal()).thenReturn(new X500Principal("CN=" + CNS[0]));
  when(certificate.getSubjectAlternativeNames()).thenReturn(subjectAlternativeNames);
}
