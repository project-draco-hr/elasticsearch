{
  List<InternalAggregation> aggregations=reduceContext.aggregations();
  if (aggregations.size() == 1) {
    B reduced=((B)aggregations.get(0));
    reduced.aggregations.reduce(reduceContext.cacheRecycler());
    return reduced;
  }
  B reduced=null;
  List<InternalAggregations> subAggregationsList=new ArrayList<InternalAggregations>(aggregations.size());
  for (  InternalAggregation aggregation : aggregations) {
    if (reduced == null) {
      reduced=(B)aggregation;
    }
 else {
      this.docCount+=((B)aggregation).docCount;
    }
    subAggregationsList.add(((B)aggregation).aggregations);
  }
  reduced.aggregations=InternalAggregations.reduce(subAggregationsList,reduceContext.cacheRecycler());
  return reduced;
}
