{
  GlobalOrdinalMapping mapping=(GlobalOrdinalMapping)globalOrdinals;
  for (int i=0; i < segmentDocCounts.size(); i++) {
    final long inc=segmentDocCounts.set(i,0);
    if (inc == 0) {
      continue;
    }
    final long globalOrd=mapping.getGlobalOrd(i);
    try {
      incrementBucketDocCount(inc,globalOrd);
    }
 catch (    IOException e) {
      throw ExceptionsHelper.convertToElastic(e);
    }
  }
}
