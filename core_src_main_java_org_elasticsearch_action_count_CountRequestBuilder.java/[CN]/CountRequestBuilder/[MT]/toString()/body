{
  if (sourceBuilder != null) {
    return sourceBuilder.toString();
  }
  if (request.source() != null) {
    try {
      return XContentHelper.convertToJson(request.source().toBytesArray(),false,true);
    }
 catch (    Exception e) {
      return "{ \"error\" : \"" + ExceptionsHelper.detailedMessage(e) + "\"}";
    }
  }
  return new QuerySourceBuilder().toString();
}
