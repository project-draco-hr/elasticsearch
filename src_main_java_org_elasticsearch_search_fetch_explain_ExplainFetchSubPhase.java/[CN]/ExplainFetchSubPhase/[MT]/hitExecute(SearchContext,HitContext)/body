{
  try {
    final int topLevelDocId=hitContext.hit().docId();
    Explanation explanation;
    if (context.rescore() != null) {
      RescoreSearchContext ctx=context.rescore();
      Rescorer rescorer=ctx.rescorer();
      explanation=rescorer.explain(topLevelDocId,context,ctx);
    }
 else {
      explanation=context.searcher().explain(context.query(),topLevelDocId);
    }
    hitContext.hit().explanation(explanation);
  }
 catch (  IOException e) {
    throw new FetchPhaseExecutionException(context,"Failed to explain doc [" + hitContext.hit().type() + "#"+ hitContext.hit().id()+ "]",e);
  }
}
