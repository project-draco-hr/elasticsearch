{
  super(index,indexSettings,name,settings);
  this.replace=settings.getAsBoolean("replace",true);
  String encoder=settings.get("encoder");
  if (encoder == null) {
    throw new ElasticSearchIllegalArgumentException("encoder must be set on phonetic token filter");
  }
  if ("metaphone".equalsIgnoreCase(encoder)) {
    this.encoder=new Metaphone();
  }
 else   if ("soundex".equalsIgnoreCase(encoder)) {
    this.encoder=new Soundex();
  }
 else   if ("caverphone1".equalsIgnoreCase(encoder)) {
    this.encoder=new Caverphone1();
  }
 else   if ("caverphone2".equalsIgnoreCase(encoder)) {
    this.encoder=new Caverphone2();
  }
 else   if ("caverphone".equalsIgnoreCase(encoder)) {
    this.encoder=new Caverphone2();
  }
 else   if ("refined_soundex".equalsIgnoreCase(encoder) || "refinedSoundex".equalsIgnoreCase(encoder)) {
    this.encoder=new RefinedSoundex();
  }
 else   if ("cologne".equalsIgnoreCase(encoder)) {
    this.encoder=new ColognePhonetic();
  }
 else   if ("double_metaphone".equalsIgnoreCase(encoder) || "doubleMetaphone".equalsIgnoreCase(encoder)) {
    DoubleMetaphone doubleMetaphone=new DoubleMetaphone();
    doubleMetaphone.setMaxCodeLen(settings.getAsInt("max_code_len",doubleMetaphone.getMaxCodeLen()));
    this.encoder=doubleMetaphone;
  }
 else   if ("bm".equalsIgnoreCase(encoder) || "beider_morse".equalsIgnoreCase(encoder)) {
    BeiderMorseEncoder bm=new BeiderMorseEncoder();
    String ruleType=settings.get("rule_type","approx");
    if ("approx".equalsIgnoreCase(ruleType)) {
      bm.setRuleType(RuleType.APPROX);
    }
 else     if ("exact".equalsIgnoreCase(ruleType)) {
      bm.setRuleType(RuleType.EXACT);
    }
 else {
      throw new ElasticSearchIllegalArgumentException("No matching rule type [" + ruleType + "] for beider morse encoder");
    }
    String nameType=settings.get("name_type","generic");
    if ("GENERIC".equalsIgnoreCase(nameType)) {
      bm.setNameType(NameType.GENERIC);
    }
 else     if ("ASHKENAZI".equalsIgnoreCase(nameType)) {
      bm.setNameType(NameType.ASHKENAZI);
    }
 else     if ("SEPHARDIC".equalsIgnoreCase(nameType)) {
      bm.setNameType(NameType.SEPHARDIC);
    }
    this.encoder=bm;
  }
 else {
    throw new ElasticSearchIllegalArgumentException("unknown encoder [" + encoder + "] for phonetic token filter");
  }
}
