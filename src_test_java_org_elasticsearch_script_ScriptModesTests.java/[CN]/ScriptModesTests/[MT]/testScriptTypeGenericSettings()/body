{
  int randomInt=randomIntBetween(1,ScriptType.values().length - 1);
  Set<ScriptType> randomScriptTypesSet=Sets.newHashSet();
  ScriptMode[] randomScriptModes=new ScriptMode[randomInt];
  for (int i=0; i < randomInt; i++) {
    boolean added=false;
    while (added == false) {
      added=randomScriptTypesSet.add(randomFrom(ScriptType.values()));
    }
    randomScriptModes[i]=randomFrom(ScriptMode.values());
  }
  ScriptType[] randomScriptTypes=randomScriptTypesSet.toArray(new ScriptType[randomScriptTypesSet.size()]);
  Settings.Builder builder=Settings.builder();
  for (int i=0; i < randomInt; i++) {
    builder.put(ScriptModes.SCRIPT_SETTINGS_PREFIX + randomScriptTypes[i],randomScriptModes[i]);
  }
  this.scriptModes=new ScriptModes(scriptEngines,scriptContextRegistry,builder.build());
  for (int i=0; i < randomInt; i++) {
    assertScriptModesAllOps(randomScriptModes[i],ALL_LANGS,randomScriptTypes[i]);
  }
  if (randomScriptTypesSet.contains(ScriptType.FILE) == false) {
    assertScriptModesAllOps(ScriptMode.ON,ALL_LANGS,ScriptType.FILE);
  }
  if (randomScriptTypesSet.contains(ScriptType.INDEXED) == false) {
    assertScriptModesAllOps(ScriptMode.SANDBOX,ALL_LANGS,ScriptType.INDEXED);
  }
  if (randomScriptTypesSet.contains(ScriptType.INLINE) == false) {
    assertScriptModesAllOps(ScriptMode.SANDBOX,ALL_LANGS,ScriptType.INLINE);
  }
}
