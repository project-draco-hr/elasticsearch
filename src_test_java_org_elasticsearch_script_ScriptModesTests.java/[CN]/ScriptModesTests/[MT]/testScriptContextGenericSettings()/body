{
  int randomInt=randomIntBetween(1,scriptContexts.length - 1);
  Set<ScriptContext> randomScriptContextsSet=Sets.newHashSet();
  ScriptMode[] randomScriptModes=new ScriptMode[randomInt];
  for (int i=0; i < randomInt; i++) {
    boolean added=false;
    while (added == false) {
      added=randomScriptContextsSet.add(randomFrom(scriptContexts));
    }
    randomScriptModes[i]=randomFrom(ScriptMode.values());
  }
  ScriptContext[] randomScriptContexts=randomScriptContextsSet.toArray(new ScriptContext[randomScriptContextsSet.size()]);
  Settings.Builder builder=Settings.builder();
  for (int i=0; i < randomInt; i++) {
    builder.put(ScriptModes.SCRIPT_SETTINGS_PREFIX + randomScriptContexts[i].getKey(),randomScriptModes[i]);
  }
  this.scriptModes=new ScriptModes(scriptEngines,scriptContextRegistry,builder.build());
  for (int i=0; i < randomInt; i++) {
    assertScriptModesAllTypes(randomScriptModes[i],ALL_LANGS,randomScriptContexts[i]);
  }
  ScriptContext[] complementOf=complementOf(randomScriptContexts);
  assertScriptModes(ScriptMode.ON,ALL_LANGS,new ScriptType[]{ScriptType.FILE},complementOf);
  assertScriptModes(ScriptMode.SANDBOX,ALL_LANGS,new ScriptType[]{ScriptType.INDEXED,ScriptType.INLINE},complementOf);
}
