{
  String value;
  if (context.externalValueSet()) {
    value=(String)context.externalValue();
    if (value == null) {
      value=nullValue;
    }
  }
 else {
    if (context.parser().currentToken() == XContentParser.Token.VALUE_NULL) {
      value=nullValue;
    }
 else {
      value=context.parser().text();
    }
  }
  if (value == null) {
    return null;
  }
  if (context.includeInAll(includeInAll)) {
    context.allEntries().addText(names.fullName(),value,boost);
  }
  if (!indexed() && !stored()) {
    context.ignoredValue(names.indexName(),value);
    return null;
  }
  FieldWrapper fieldWrapper=fieldCache.get();
  Field field=fieldWrapper.field;
  if (field == null) {
    field=new Field(names.indexName(),false,value,store,index,termVector);
  }
 else {
    field.setValue(value);
    fieldWrapper.field=null;
  }
  return field;
}
