{
  Set<SyncedFlushService.SyncedFlushResult> shardResults=new HashSet<>();
  SyncedFlushService.SyncedFlushResult syncedFlushResult;
  for (int i=100000; i >= 0; i--) {
    if (randomBoolean()) {
      syncedFlushResult=createSyncedFlushResult(i,"test");
      shardResults.add(syncedFlushResult);
    }
 else {
      syncedFlushResult=new SyncedFlushService.SyncedFlushResult(new ShardId("test",i),"all failed :(");
      shardResults.add(syncedFlushResult);
    }
  }
  SealIndicesResponse sealIndicesResponse=new SealIndicesResponse(shardResults);
  Map<String,Object> asMap=convertToMap(sealIndicesResponse);
  assertNotNull(asMap.get("test"));
  for (int i=0; i < 100000; i++) {
    assertThat((Integer)(((HashMap)((ArrayList)asMap.get("test")).get(i)).get("shard_id")),equalTo(i));
  }
}
