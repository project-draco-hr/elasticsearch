{
  add2SingleValuedDocumentsAndDeleteOneOfThem();
  IndexFieldData indexFieldData=getForField("value");
  AtomicReaderContext readerContext=refreshReader();
  AtomicFieldData fieldData=indexFieldData.load(readerContext);
  assertThat(indexFieldData.getHighestNumberOfSeenUniqueValues(),greaterThan(0l));
  BytesValues values=fieldData.getBytesValues();
  assertThat(fieldData.getNumDocs(),equalTo(2));
  assertThat(fieldData.getNumberUniqueValues(),equalTo(2l));
  for (int i=0; i < fieldData.getNumDocs(); ++i) {
    assertThat(values.hasValue(i),equalTo(true));
  }
}
