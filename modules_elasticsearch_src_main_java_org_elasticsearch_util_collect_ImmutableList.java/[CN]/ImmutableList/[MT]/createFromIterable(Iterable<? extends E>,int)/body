{
  Object[] array=new Object[estimatedSize];
  int index=0;
  for (  Object element : source) {
    if (index == estimatedSize) {
      estimatedSize=((estimatedSize / 2) + 1) * 3;
      array=copyOf(array,estimatedSize);
    }
    if (element == null) {
      throw new NullPointerException("at index " + index);
    }
    array[index++]=element;
  }
  if (index == 0) {
    return of();
  }
 else   if (index == 1) {
    @SuppressWarnings("unchecked") E element=(E)array[0];
    return of(element);
  }
  if (index != estimatedSize) {
    array=copyOf(array,index);
  }
  return new RegularImmutableList<E>(array,0,index);
}
