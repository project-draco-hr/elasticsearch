{
  final ShardId sId=new ShardId(index,shardId);
  final Injector shardInjector;
  final IndexShard indexShard;
  if (shards.containsKey(shardId) == false) {
    return;
  }
  logger.debug("[{}] closing... (reason: [{}])",shardId,reason);
  HashMap<Integer,IndexShardInjectorPair> newShards=new HashMap<>(shards);
  IndexShardInjectorPair indexShardInjectorPair=newShards.remove(shardId);
  indexShard=indexShardInjectorPair.getIndexShard();
  shardInjector=indexShardInjectorPair.getInjector();
  shards=unmodifiableMap(newShards);
  closeShardInjector(reason,sId,shardInjector,indexShard);
  logger.debug("[{}] closed (reason: [{}])",shardId,reason);
}
