{
  this.indexMetaData=metadata;
  Settings settings=metadata.getSettings();
  if (this.indexSettings.updateIndexSettings(metadata.getSettings())) {
    for (    final IndexShard shard : this.shards.values()) {
      try {
        shard.onRefreshSettings(settings);
      }
 catch (      Exception e) {
        logger.warn("[{}] failed to refresh shard settings",e,shard.shardId().id());
      }
    }
    try {
      indexStore.onRefreshSettings(settings);
    }
 catch (    Exception e) {
      logger.warn("failed to refresh index store settings",e);
    }
  }
}
