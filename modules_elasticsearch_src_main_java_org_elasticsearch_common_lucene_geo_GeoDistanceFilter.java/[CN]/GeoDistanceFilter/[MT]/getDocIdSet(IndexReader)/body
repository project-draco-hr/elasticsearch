{
  final GeoPointFieldData fieldData=(GeoPointFieldData)fieldDataCache.cache(GeoPointFieldDataType.TYPE,reader,fieldName);
  return new GetDocSet(reader.maxDoc()){
    @Override public boolean isCacheable(){
      return false;
    }
    @Override public boolean get(    int doc) throws IOException {
      if (!fieldData.hasValue(doc)) {
        return false;
      }
      if (fieldData.multiValued()) {
        GeoPoint[] points=fieldData.values(doc);
        for (        GeoPoint point : points) {
          double d=geoDistance.calculate(lat,lon,point.lat(),point.lon(),DistanceUnit.MILES);
          if (d < distance) {
            return true;
          }
        }
        return false;
      }
 else {
        GeoPoint point=fieldData.value(doc);
        double d=geoDistance.calculate(lat,lon,point.lat(),point.lon(),DistanceUnit.MILES);
        return d < distance;
      }
    }
  }
;
}
