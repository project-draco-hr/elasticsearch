{
  searchContext.idCache().refresh(searchContext.searcher().getTopReaderContext().leaves());
  int numDocs=(searchContext.from() + searchContext.size());
  if (numDocs == 0) {
    numDocs=1;
  }
  numDocs*=factor;
  while (true) {
    clear();
    TopDocs topDocs=searchContext.searcher().search(query,numDocs);
    processResults(topDocs,searchContext);
    if (numHits >= (searchContext.from() + searchContext.size())) {
      break;
    }
    if (topDocs.totalHits <= numDocs) {
      break;
    }
    numDocs*=incrementalFactor;
    if (numDocs > topDocs.totalHits) {
      numDocs=topDocs.totalHits;
    }
  }
}
