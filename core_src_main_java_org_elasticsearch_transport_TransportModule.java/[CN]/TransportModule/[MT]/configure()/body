{
  if (configuredTransportService != null) {
    logger.info("Using [{}] as transport service, overridden by [{}]",configuredTransportService.getName(),configuredTransportServiceSource);
    bind(TransportService.class).to(configuredTransportService).asEagerSingleton();
  }
 else {
    String typeName=settings.get(TRANSPORT_SERVICE_TYPE_KEY);
    if (typeName == null) {
      bind(TransportService.class).asEagerSingleton();
    }
 else {
      if (transportServices.containsKey(typeName) == false) {
        throw new IllegalArgumentException("Unknown TransportService [" + typeName + "]");
      }
      bind(TransportService.class).to(transportServices.get(typeName)).asEagerSingleton();
    }
  }
  bind(NamedWriteableRegistry.class).asEagerSingleton();
  if (configuredTransport != null) {
    logger.info("Using [{}] as transport, overridden by [{}]",configuredTransport.getName(),configuredTransportSource);
    bind(Transport.class).to(configuredTransport).asEagerSingleton();
  }
 else {
    String defaultType=DiscoveryNode.localNode(settings) ? LOCAL_TRANSPORT : NETTY_TRANSPORT;
    String typeName=settings.get(TRANSPORT_TYPE_KEY,defaultType);
    Class<? extends Transport> clazz=transports.get(typeName);
    if (clazz == null) {
      throw new IllegalArgumentException("Unknown Transport [" + typeName + "]");
    }
    bind(Transport.class).to(clazz).asEagerSingleton();
  }
}
