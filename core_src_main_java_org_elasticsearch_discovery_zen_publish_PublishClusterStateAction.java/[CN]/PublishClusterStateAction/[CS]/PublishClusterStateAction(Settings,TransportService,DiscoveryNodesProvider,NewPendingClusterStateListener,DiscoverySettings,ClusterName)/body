{
  super(settings);
  this.transportService=transportService;
  this.nodesProvider=nodesProvider;
  this.newPendingClusterStatelistener=listener;
  this.discoverySettings=discoverySettings;
  this.clusterName=clusterName;
  this.pendingStatesQueue=new PendingClusterStatesQueue(logger,settings.getAsInt(SETTINGS_MAX_PENDING_CLUSTER_STATES,25));
  transportService.registerRequestHandler(SEND_ACTION_NAME,BytesTransportRequest.class,ThreadPool.Names.SAME,new SendClusterStateRequestHandler());
  transportService.registerRequestHandler(COMMIT_ACTION_NAME,CommitClusterStateRequest.class,ThreadPool.Names.SAME,new CommitClusterStateRequestHandler());
}
