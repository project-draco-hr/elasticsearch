{
  if (nativeCopy && (dir instanceof FSDirectory)) {
    File destinationFile=new File(((FSDirectory)dir).getDirectory(),fileName);
    if (!destinationFile.exists()) {
      destinationFile.createNewFile();
    }
    copyFile(copyFrom,destinationFile);
  }
 else {
    FileInputStream is=null;
    IndexOutput output=null;
    try {
      is=new FileInputStream(copyFrom);
      output=dir.createOutput(fileName);
      copyToDirectory(is,output);
    }
  finally {
      Closeables.closeQuietly(is);
      Closeables.closeQuietly(output);
    }
  }
  sync(dir,fileName);
}
