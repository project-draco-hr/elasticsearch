{
  Map<String,Object> document=new HashMap<String,Object>(){
    private static final long serialVersionUID=362498820763181265L;
    @Override public Object remove(    Object key){
      if (key.equals("list")) {
        throw new UnsupportedOperationException();
      }
      return super.remove(key);
    }
  }
;
  document.put("list",Collections.singletonList("item"));
  IngestDocument ingestDocument=RandomDocumentPicks.randomIngestDocument(random(),document);
  Processor processor=new RenameProcessor(Collections.singletonMap("list","new_field"));
  try {
    processor.execute(ingestDocument);
    fail("processor execute should have failed");
  }
 catch (  UnsupportedOperationException e) {
    assertThat(ingestDocument.getSource().containsKey("list"),equalTo(true));
    assertThat(ingestDocument.getSource().containsKey("new_field"),equalTo(false));
  }
}
