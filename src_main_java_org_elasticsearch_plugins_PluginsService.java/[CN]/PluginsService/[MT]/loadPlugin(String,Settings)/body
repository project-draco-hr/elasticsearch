{
  try {
    Class<? extends Plugin> pluginClass=(Class<? extends Plugin>)settings.getClassLoader().loadClass(className);
    try {
      return pluginClass.getConstructor(Settings.class).newInstance(settings);
    }
 catch (    NoSuchMethodException e) {
      try {
        return pluginClass.getConstructor().newInstance();
      }
 catch (      NoSuchMethodException e1) {
        throw new ElasticSearchException("No constructor for [" + pluginClass + "]. A plugin class must "+ "have either an empty default constructor or a single argument constructor accepting a "+ "Settings instance");
      }
    }
  }
 catch (  Exception e) {
    throw new ElasticSearchException("Failed to load plugin class [" + className + "]",e);
  }
}
