{
  int numValues=delegate.setDocument(docId);
  if (numValues == 0) {
    return missing;
  }
  double relevantVal=sortMode.startDouble();
  for (int i=0; i < numValues; i++) {
    relevantVal=sortMode.apply(relevantVal,delegate.nextValue());
  }
  return sortMode.reduce(relevantVal,numValues);
}
