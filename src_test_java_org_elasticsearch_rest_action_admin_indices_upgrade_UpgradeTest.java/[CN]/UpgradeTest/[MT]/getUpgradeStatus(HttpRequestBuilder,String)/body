{
  HttpResponse rsp=httpClient.method("GET").path(path).execute();
  Map<String,Object> data=validateAndParse(rsp);
  List<UpgradeStatus> ret=new ArrayList<>();
  for (  String index : data.keySet()) {
    Map<String,Object> status=(Map<String,Object>)data.get(index);
    assertTrue("missing key size_in_bytes for index " + index,status.containsKey("size_in_bytes"));
    Object totalBytes=status.get("size_in_bytes");
    assertTrue("size_in_bytes for index " + index + " is not an integer",totalBytes instanceof Integer);
    assertTrue("missing key size_to_upgrade_in_bytes for index " + index,status.containsKey("size_to_upgrade_in_bytes"));
    Object toUpgradeBytes=status.get("size_to_upgrade_in_bytes");
    assertTrue("size_to_upgrade_in_bytes for index " + index + " is not an integer",toUpgradeBytes instanceof Integer);
    Object toUpgradeBytesAncient=status.get("size_to_upgrade_ancient_in_bytes");
    assertTrue("size_to_upgrade_ancient_in_bytes for index " + index + " is not an integer",toUpgradeBytesAncient instanceof Integer);
    ret.add(new UpgradeStatus(index,(Integer)totalBytes,(Integer)toUpgradeBytes,(Integer)toUpgradeBytesAncient));
  }
  return ret;
}
