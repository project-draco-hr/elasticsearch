{
  final IndexService indexService=createIndex("test");
  final IndexFieldDataService ifdService=indexService.fieldData();
  final BuilderContext ctx=new BuilderContext(indexService.getIndexSettings().getSettings(),new ContentPath(1));
  final MappedFieldType stringMapper=new StringFieldMapper.Builder("string").tokenized(false).build(ctx).fieldType();
  ifdService.clear();
  IndexFieldData<?> fd=ifdService.getForField(stringMapper);
  assertTrue(fd instanceof SortedSetDVOrdinalsIndexFieldData);
  for (  MappedFieldType mapper : Arrays.asList(new ByteFieldMapper.Builder("int").build(ctx).fieldType(),new ShortFieldMapper.Builder("int").build(ctx).fieldType(),new IntegerFieldMapper.Builder("int").build(ctx).fieldType(),new LongFieldMapper.Builder("long").build(ctx).fieldType())) {
    ifdService.clear();
    fd=ifdService.getForField(mapper);
    assertTrue(fd instanceof SortedNumericDVIndexFieldData);
  }
  final MappedFieldType floatMapper=new FloatFieldMapper.Builder("float").build(ctx).fieldType();
  ifdService.clear();
  fd=ifdService.getForField(floatMapper);
  assertTrue(fd instanceof SortedNumericDVIndexFieldData);
  final MappedFieldType doubleMapper=new DoubleFieldMapper.Builder("double").build(ctx).fieldType();
  ifdService.clear();
  fd=ifdService.getForField(doubleMapper);
  assertTrue(fd instanceof SortedNumericDVIndexFieldData);
}
