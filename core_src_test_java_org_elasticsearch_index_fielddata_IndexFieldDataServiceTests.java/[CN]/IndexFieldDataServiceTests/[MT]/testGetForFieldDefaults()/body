{
  final IndexService indexService=createIndex("test");
  final IndexFieldDataService ifdService=indexService.fieldData();
  for (  boolean docValues : Arrays.asList(true,false)) {
    final BuilderContext ctx=new BuilderContext(indexService.settingsService().getSettings(),new ContentPath(1));
    final MappedFieldType stringMapper=new StringFieldMapper.Builder("string").tokenized(false).docValues(docValues).build(ctx).fieldType();
    ifdService.clear();
    IndexFieldData<?> fd=ifdService.getForField(stringMapper);
    if (docValues) {
      assertTrue(fd instanceof SortedSetDVOrdinalsIndexFieldData);
    }
 else {
      assertTrue(fd instanceof PagedBytesIndexFieldData);
    }
    for (    MappedFieldType mapper : Arrays.asList(new ByteFieldMapper.Builder("int").docValues(docValues).build(ctx).fieldType(),new ShortFieldMapper.Builder("int").docValues(docValues).build(ctx).fieldType(),new IntegerFieldMapper.Builder("int").docValues(docValues).build(ctx).fieldType(),new LongFieldMapper.Builder("long").docValues(docValues).build(ctx).fieldType())) {
      ifdService.clear();
      fd=ifdService.getForField(mapper);
      if (docValues) {
        assertTrue(fd instanceof SortedNumericDVIndexFieldData);
      }
 else {
        assertTrue(fd instanceof PackedArrayIndexFieldData);
      }
    }
    final MappedFieldType floatMapper=new FloatFieldMapper.Builder("float").docValues(docValues).build(ctx).fieldType();
    ifdService.clear();
    fd=ifdService.getForField(floatMapper);
    if (docValues) {
      assertTrue(fd instanceof SortedNumericDVIndexFieldData);
    }
 else {
      assertTrue(fd instanceof FloatArrayIndexFieldData);
    }
    final MappedFieldType doubleMapper=new DoubleFieldMapper.Builder("double").docValues(docValues).build(ctx).fieldType();
    ifdService.clear();
    fd=ifdService.getForField(doubleMapper);
    if (docValues) {
      assertTrue(fd instanceof SortedNumericDVIndexFieldData);
    }
 else {
      assertTrue(fd instanceof DoubleArrayIndexFieldData);
    }
  }
}
