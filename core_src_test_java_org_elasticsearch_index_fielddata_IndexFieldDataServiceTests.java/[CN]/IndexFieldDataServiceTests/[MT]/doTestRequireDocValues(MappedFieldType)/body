{
  ThreadPool threadPool=new ThreadPool("random_threadpool_name");
  try {
    IndicesFieldDataCache cache=new IndicesFieldDataCache(Settings.EMPTY,null,threadPool);
    IndexFieldDataService ifds=new IndexFieldDataService(IndexSettingsModule.newIndexSettings(new Index("test"),Settings.EMPTY),cache,null,null);
    ft.setName("some_long");
    ft.setHasDocValues(true);
    ifds.getForField(ft);
    ft.setHasDocValues(false);
    try {
      ifds.getForField(ft);
      fail();
    }
 catch (    IllegalStateException e) {
      assertThat(e.getMessage(),containsString("doc values"));
    }
  }
  finally {
    threadPool.shutdown();
  }
}
