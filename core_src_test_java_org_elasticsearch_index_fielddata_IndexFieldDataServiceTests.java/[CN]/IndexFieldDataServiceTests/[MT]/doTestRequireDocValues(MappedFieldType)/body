{
  ThreadPool threadPool=new ThreadPool("random_threadpool_name");
  try {
    IndicesFieldDataCache cache=new IndicesFieldDataCache(Settings.EMPTY,null,threadPool);
    IndexFieldDataService ifds=new IndexFieldDataService(new IndexSettings(new Index("test"),Settings.settingsBuilder().put(IndexMetaData.SETTING_VERSION_CREATED,Version.CURRENT).build(),Collections.EMPTY_LIST),cache,null,null);
    ft.setNames(new Names("some_long"));
    ft.setHasDocValues(true);
    ifds.getForField(ft);
    ft.setHasDocValues(false);
    try {
      ifds.getForField(ft);
      fail();
    }
 catch (    IllegalStateException e) {
      assertThat(e.getMessage(),containsString("doc values"));
    }
  }
  finally {
    threadPool.shutdown();
  }
}
