{
  MultiSearchRequest multiSearchRequest=new MultiSearchRequest();
  multiSearchRequest.listenerThreaded(false);
  String[] indices=Strings.splitStringByCommaToArray(request.param("index"));
  String[] types=Strings.splitStringByCommaToArray(request.param("type"));
  IndicesOptions indicesOptions=IndicesOptions.fromRequest(request,multiSearchRequest.indicesOptions());
  multiSearchRequest.add(RestActions.getRestContent(request),request.contentUnsafe(),indices,types,request.param("search_type"),request.param("routing"),indicesOptions,allowExplicitIndex);
  client.multiSearch(multiSearchRequest,new RestToXContentListener<MultiSearchResponse>(channel));
}
