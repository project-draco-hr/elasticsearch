{
  try {
    ClusterState state=client().admin().cluster().prepareState().execute().actionGet().getState();
    return state.nodes().masterNode().name();
  }
 catch (  Throwable e) {
    logger.warn("Can't fetch cluster state",e);
    throw new RuntimeException("Can't get master node " + e.getMessage(),e);
  }
}
