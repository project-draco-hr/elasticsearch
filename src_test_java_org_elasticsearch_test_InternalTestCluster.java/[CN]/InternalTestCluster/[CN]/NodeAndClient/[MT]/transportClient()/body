{
  if (closed.get()) {
    throw new RuntimeException("already closed");
  }
  if (transportClient == null) {
    Client maybeTransportClient=client(random);
    if (maybeTransportClient instanceof TransportClient) {
      transportClient=maybeTransportClient;
    }
 else {
      transportClient=TransportClientFactory.NO_SNIFF_CLIENT_FACTORY.client(node,clusterName,random);
    }
  }
  return transportClient;
}
