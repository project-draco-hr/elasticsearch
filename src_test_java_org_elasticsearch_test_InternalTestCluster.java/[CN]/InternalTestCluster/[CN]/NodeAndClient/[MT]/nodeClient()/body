{
  if (closed.get()) {
    throw new RuntimeException("already closed");
  }
  if (nodeClient == null) {
    Client maybeNodeClient=client(random);
    if (client instanceof NodeClient) {
      nodeClient=maybeNodeClient;
    }
 else {
      nodeClient=node.client();
    }
  }
  return nodeClient;
}
