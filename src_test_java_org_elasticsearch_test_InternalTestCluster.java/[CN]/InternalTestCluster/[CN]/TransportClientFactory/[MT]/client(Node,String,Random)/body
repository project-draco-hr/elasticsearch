{
  TransportAddress addr=((InternalNode)node).injector().getInstance(TransportService.class).boundAddress().publishAddress();
  Settings nodeSettings=node.settings();
  Builder builder=settingsBuilder().put("client.transport.nodes_sampler_interval","1s").put("name",TRANSPORT_CLIENT_PREFIX + node.settings().get("name")).put("plugins." + PluginsService.LOAD_PLUGIN_FROM_CLASSPATH,false).put(ClusterName.SETTING,clusterName).put("client.transport.sniff",sniff);
  builder.put("node.mode",nodeSettings.get("node.mode",NODE_MODE));
  builder.put("node.local",nodeSettings.get("node.local",""));
  builder.put("logger.prefix",nodeSettings.get("logger.prefix",""));
  builder.put("logger.level",nodeSettings.get("logger.level","INFO"));
  builder.put("config.ignore_system_properties",true);
  TransportClient client=new TransportClient(builder.build());
  client.addTransportAddress(addr);
  return client;
}
