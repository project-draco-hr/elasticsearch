{
  expression.analyze(variables);
  expression.expected=expression.actual;
  expression=expression.cast(variables);
  final Type type;
  try {
    type=Definition.getType(this.type);
  }
 catch (  IllegalArgumentException exception) {
    throw createError(new IllegalArgumentException("Not a type [" + this.type + "]."));
  }
  variables.incrementScope();
  variable=variables.addVariable(location,type,name,true,false);
  if (expression.actual.sort == Sort.ARRAY) {
    analyzeArray(variables,type);
  }
 else   if (expression.actual.sort == Sort.DEF || Iterable.class.isAssignableFrom(expression.actual.clazz)) {
    analyzeIterable(variables,type);
  }
 else {
    throw location.createError(new IllegalArgumentException("Illegal for each type [" + expression.actual.name + "]."));
  }
  if (block == null) {
    throw location.createError(new IllegalArgumentException("Extraneous for each loop."));
  }
  block.beginLoop=true;
  block.inLoop=true;
  block.analyze(variables);
  block.statementCount=Math.max(1,block.statementCount);
  if (block.loopEscape && !block.anyContinue) {
    throw createError(new IllegalArgumentException("Extraneous for loop."));
  }
  statementCount=1;
  if (maxLoopCounter > 0) {
    loopCounterSlot=variables.getVariable(location,"#loop").slot;
  }
  variables.decrementScope();
}
