{
  final Tuple<IndexService,Injector> indexServiceInjectorTuple=this.indices.get(shardId.getIndex());
  if (IndexMetaData.isOnSharedFilesystem(indexSettings) == false) {
    if (indexServiceInjectorTuple != null && nodeEnv.hasNodeFile()) {
      final IndexService indexService=indexServiceInjectorTuple.v1();
      return indexService.hasShard(shardId.id()) == false;
    }
 else     if (nodeEnv.hasNodeFile()) {
      final Path[] shardLocations=nodeEnv.shardDataPaths(shardId,indexSettings);
      return FileSystemUtils.exists(shardLocations);
    }
  }
 else {
    logger.trace("{} skipping shard directory deletion due to shadow replicas",shardId);
  }
  return false;
}
