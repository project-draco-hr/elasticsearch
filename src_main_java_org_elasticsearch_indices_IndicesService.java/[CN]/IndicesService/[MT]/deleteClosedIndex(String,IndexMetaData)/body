{
  if (nodeEnv.hasNodeFile()) {
    String indexName=metaData.getIndex();
    try {
      ClusterState clusterState=clusterService.state();
      if (clusterState.metaData().hasIndex(indexName)) {
        final IndexMetaData index=clusterState.metaData().index(indexName);
        throw new ElasticsearchIllegalStateException("Can't delete closed index store for [" + indexName + "] - it's still part of the cluster state ["+ index.getUUID()+ "] ["+ metaData.getUUID()+ "]");
      }
      deleteIndexStore(reason,metaData);
    }
 catch (    IOException e) {
      logger.warn("[{}] failed to delete closed index",e,metaData.index());
    }
  }
}
