{
  internalCluster().startNodesAsync(currentNumNodes).get();
  if (client().admin().cluster().prepareHealth().setWaitForNodes("" + currentNumNodes).get().isTimedOut()) {
    logger.info("cluster forming timed out, cluster state:\n{}",client().admin().cluster().prepareState().get().getState().prettyPrint());
    fail("timed out waiting for cluster to form with [" + currentNumNodes + "] nodes");
  }
}
