{
  RoutingAllocation.Result routingResult=allocationService.reroute(currentState,request.getCommands(),request.explain(),request.isRetryFailed());
  ClusterState newState=ClusterState.builder(currentState).routingResult(routingResult).build();
  clusterStateToSend=newState;
  explanations=routingResult.explanations();
  if (request.dryRun()) {
    return currentState;
  }
  return newState;
}
