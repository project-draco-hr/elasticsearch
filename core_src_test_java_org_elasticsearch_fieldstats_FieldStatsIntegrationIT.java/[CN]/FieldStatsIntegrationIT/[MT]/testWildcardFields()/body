{
  assertAcked(prepareCreate("test1").addMapping("test","foo","type=long","foobar","type=text","barfoo","type=long"));
  assertAcked(prepareCreate("test2").addMapping("test","foobar","type=text","barfoo","type=long"));
  ensureGreen("test1","test2");
  FieldStatsResponse response=client().prepareFieldStats().setFields("foo*").get();
  assertAllSuccessful(response);
  assertThat(response.getAllFieldStats().size(),equalTo(2));
  assertThat(response.getAllFieldStats().get("foo").getMinValue(),nullValue());
  assertThat(response.getAllFieldStats().get("foobar").getMaxValue(),nullValue());
  response=client().prepareFieldStats().setFields("foo*").setLevel("indices").get();
  assertAllSuccessful(response);
  assertThat(response.getIndicesMergedFieldStats().size(),equalTo(2));
  assertThat(response.getIndicesMergedFieldStats().get("test1").size(),equalTo(2));
  assertThat(response.getIndicesMergedFieldStats().get("test1").get("foo").getMinValue(),nullValue());
  assertThat(response.getIndicesMergedFieldStats().get("test1").get("foo").getMaxValue(),nullValue());
  assertThat(response.getIndicesMergedFieldStats().get("test1").get("foobar").getMinValue(),nullValue());
  assertThat(response.getIndicesMergedFieldStats().get("test1").get("foobar").getMaxValue(),nullValue());
  assertThat(response.getIndicesMergedFieldStats().get("test2").size(),equalTo(1));
  assertThat(response.getIndicesMergedFieldStats().get("test2").get("foobar").getMinValue(),nullValue());
  assertThat(response.getIndicesMergedFieldStats().get("test2").get("foobar").getMaxValue(),nullValue());
}
