{
  assertAcked(prepareCreate("test").addMapping("test","string","type=string","date","type=date","double","type=double","double","type=double","float","type=float","long","type=long","integer","type=integer","short","type=short","byte","type=byte"));
  ensureGreen("test");
  byte minByte=Byte.MAX_VALUE;
  byte maxByte=Byte.MIN_VALUE;
  short minShort=Short.MAX_VALUE;
  short maxShort=Short.MIN_VALUE;
  int minInt=Integer.MAX_VALUE;
  int maxInt=Integer.MIN_VALUE;
  long minLong=Long.MAX_VALUE;
  long maxLong=Long.MIN_VALUE;
  float minFloat=Float.MAX_VALUE;
  float maxFloat=Float.MIN_VALUE;
  double minDouble=Double.MAX_VALUE;
  double maxDouble=Double.MIN_VALUE;
  String minString=new String(Character.toChars(1114111));
  String maxString="0";
  int numDocs=scaledRandomIntBetween(128,1024);
  List<IndexRequestBuilder> request=new ArrayList<>(numDocs);
  for (int doc=0; doc < numDocs; doc++) {
    byte b=randomByte();
    minByte=(byte)Math.min(minByte,b);
    maxByte=(byte)Math.max(maxByte,b);
    short s=randomShort();
    minShort=(short)Math.min(minShort,s);
    maxShort=(short)Math.max(maxShort,s);
    int i=randomInt();
    minInt=Math.min(minInt,i);
    maxInt=Math.max(maxInt,i);
    long l=randomLong();
    minLong=Math.min(minLong,l);
    maxLong=Math.max(maxLong,l);
    float f=randomFloat();
    minFloat=Math.min(minFloat,f);
    maxFloat=Math.max(maxFloat,f);
    double d=randomDouble();
    minDouble=Math.min(minDouble,d);
    maxDouble=Math.max(maxDouble,d);
    String str=randomRealisticUnicodeOfLength(3);
    if (str.compareTo(minString) < 0) {
      minString=str;
    }
    if (str.compareTo(maxString) > 0) {
      maxString=str;
    }
    request.add(client().prepareIndex("test","test",Integer.toString(doc)).setSource("byte",b,"short",s,"integer",i,"long",l,"float",f,"double",d,"string",str));
  }
  indexRandom(true,false,request);
  FieldStatsResponse response=client().prepareFieldStats().setFields("byte","short","integer","long","float","double","string").get();
  assertAllSuccessful(response);
  for (  FieldStats stats : response.getAllFieldStats().values()) {
    assertThat(stats.getMaxDoc(),equalTo((long)numDocs));
    assertThat(stats.getDocCount(),equalTo((long)numDocs));
    assertThat(stats.getDensity(),equalTo(100));
  }
  assertThat(response.getAllFieldStats().get("byte").getMinValue(),equalTo(Byte.toString(minByte)));
  assertThat(response.getAllFieldStats().get("byte").getMaxValue(),equalTo(Byte.toString(maxByte)));
  assertThat(response.getAllFieldStats().get("short").getMinValue(),equalTo(Short.toString(minShort)));
  assertThat(response.getAllFieldStats().get("short").getMaxValue(),equalTo(Short.toString(maxShort)));
  assertThat(response.getAllFieldStats().get("integer").getMinValue(),equalTo(Integer.toString(minInt)));
  assertThat(response.getAllFieldStats().get("integer").getMaxValue(),equalTo(Integer.toString(maxInt)));
  assertThat(response.getAllFieldStats().get("long").getMinValue(),equalTo(Long.toString(minLong)));
  assertThat(response.getAllFieldStats().get("long").getMaxValue(),equalTo(Long.toString(maxLong)));
  assertThat(response.getAllFieldStats().get("float").getMinValue(),equalTo(Float.toString(minFloat)));
  assertThat(response.getAllFieldStats().get("float").getMaxValue(),equalTo(Float.toString(maxFloat)));
  assertThat(response.getAllFieldStats().get("double").getMinValue(),equalTo(Double.toString(minDouble)));
  assertThat(response.getAllFieldStats().get("double").getMaxValue(),equalTo(Double.toString(maxDouble)));
}
