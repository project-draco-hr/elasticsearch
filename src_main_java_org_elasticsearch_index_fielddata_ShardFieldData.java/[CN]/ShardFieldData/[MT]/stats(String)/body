{
  ObjectLongOpenHashMap<String> fieldTotals=null;
  if (fields != null && fields.length > 0) {
    fieldTotals=new ObjectLongOpenHashMap<String>();
    for (    Map.Entry<String,CounterMetric> entry : perFieldTotals.entrySet()) {
      for (      String field : fields) {
        if (Regex.simpleMatch(field,entry.getKey())) {
          fieldTotals.put(entry.getKey(),entry.getValue().count());
        }
      }
    }
  }
  long memorySize=totalMetric.count();
  if (perFieldTotals.containsKey(ParentFieldMapper.NAME)) {
    memorySize-=perFieldTotals.get(ParentFieldMapper.NAME).count();
  }
  return new FieldDataStats(memorySize,evictionsMetric.count(),fieldTotals);
}
