{
  long[] usableSpace=new long[delegates.length];
  long size=0;
  for (int i=0; i < delegates.length; i++) {
    size+=getUsableSpace(delegates[i]);
    usableSpace[i]=size;
  }
  if (size != 0) {
    long random=ThreadLocalRandom.current().nextLong(size);
    for (int i=0; i < delegates.length; i++) {
      if (usableSpace[i] > random) {
        return delegates[i];
      }
    }
  }
  return delegates[ThreadLocalRandom.current().nextInt(delegates.length)];
}
