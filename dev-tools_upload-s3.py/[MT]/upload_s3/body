def upload_s3(conn, path, key, file, bucket):
    print ('Uploading %s to Amazon S3 bucket %s/%s' % (file, bucket, os.path.join(path, key)))

    def percent_cb(complete, total):
        sys.stdout.write('.')
        sys.stdout.flush()
    bucket = conn.create_bucket(bucket)
    k = bucket.new_key(os.path.join(path, key))
    k.set_contents_from_filename(file, cb=percent_cb, num_cb=100)
