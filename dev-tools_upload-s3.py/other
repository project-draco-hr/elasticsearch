import os
import sys
import argparse
try:
    import boto.s3
except:
    raise RuntimeError("\n  S3 upload requires boto to be installed\n    Use one of:\n      'pip install -U boto'\n      'apt-get install python-boto'\n      'easy_install boto'\n  ")
if (__name__ == '__main__'):
    parser = argparse.ArgumentParser(description='Uploads files to Amazon S3')
    parser.add_argument('--file', '-f', metavar='path to file', help='the branch to release from', required=True)
    parser.add_argument('--bucket', '-b', metavar='B42', default='download.elasticsearch.org', help='The S3 Bucket to upload to')
    parser.add_argument('--path', '-p', metavar='elasticsearch/elasticsearch', default='elasticsearch/elasticsearch', help='The key path to use')
    parser.add_argument('--key', '-k', metavar='key', default=None, help='The key - uses the file name as default key')
    args = parser.parse_args()
    if args.key:
        key = args.key
    else:
        key = os.path.basename(args.file)
    connection = boto.connect_s3()
    upload_s3(connection, args.path, key, args.file, args.bucket)
