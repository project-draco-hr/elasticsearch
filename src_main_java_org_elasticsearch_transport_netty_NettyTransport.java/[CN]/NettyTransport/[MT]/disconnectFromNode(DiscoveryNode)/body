{
  NodeChannels nodeChannels=connectedNodes.remove(node);
  if (nodeChannels != null) {
    connectionLock.acquire(node.id());
    try {
      try {
        nodeChannels.close();
      }
  finally {
        logger.debug("disconnected from [{}]",node);
        transportServiceAdapter.raiseNodeDisconnected(node);
      }
    }
  finally {
      connectionLock.release(node.id());
    }
  }
}
