{
  for (  DiscoveryNode node : connectedNodes.keySet()) {
synchronized (connectLock(node.id())) {
      NodeChannels nodeChannels=connectedNodes.get(node);
      if (nodeChannels != null && nodeChannels.hasChannel(channel)) {
        connectedNodes.remove(node);
        try {
          nodeChannels.close();
        }
  finally {
          logger.debug("disconnected from [{}] on channel failure",failure,node);
          transportServiceAdapter.raiseNodeDisconnected(node);
        }
      }
    }
  }
}
