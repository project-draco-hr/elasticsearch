{
  int index=address.indexOf('[');
  if (index != -1) {
    String host=address.substring(0,index);
    Set<String> ports=Strings.commaDelimitedListToSet(address.substring(index + 1,address.indexOf(']')));
    List<TransportAddress> addresses=Lists.newArrayList();
    for (    String port : ports) {
      int[] iPorts=new PortsRange(port).ports();
      for (      int iPort : iPorts) {
        addresses.add(new InetSocketTransportAddress(host,iPort));
      }
    }
    return addresses.toArray(new TransportAddress[addresses.size()]);
  }
 else {
    index=address.lastIndexOf(':');
    if (index == -1) {
      List<TransportAddress> addresses=Lists.newArrayList();
      String defaultPort=settings.get("transport.profiles.default.port",componentSettings.get("port",this.settings.get("transport.tcp.port",DEFAULT_PORT_RANGE)));
      int[] iPorts=new PortsRange(defaultPort).ports();
      for (      int iPort : iPorts) {
        addresses.add(new InetSocketTransportAddress(address,iPort));
      }
      return addresses.toArray(new TransportAddress[addresses.size()]);
    }
 else {
      String host=address.substring(0,index);
      int port=Integer.parseInt(address.substring(index + 1));
      return new TransportAddress[]{new InetSocketTransportAddress(host,port)};
    }
  }
}
