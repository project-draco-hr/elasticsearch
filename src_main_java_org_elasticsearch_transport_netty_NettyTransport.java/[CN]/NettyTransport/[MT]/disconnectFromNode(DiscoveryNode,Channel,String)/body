{
synchronized (connectLock(node.id())) {
    NodeChannels nodeChannels=connectedNodes.get(node);
    if (nodeChannels != null && nodeChannels.hasChannel(channel)) {
      connectedNodes.remove(node);
      try {
        nodeChannels.close();
      }
  finally {
        logger.debug("disconnected from [{}], {}",node,reason);
        transportServiceAdapter.raiseNodeDisconnected(node);
      }
    }
  }
}
