{
  ChannelPipeline channelPipeline=Channels.pipeline();
  SizeHeaderFrameDecoder sizeHeader=new SizeHeaderFrameDecoder();
  if (nettyTransport.maxCumulationBufferCapacity != null) {
    if (nettyTransport.maxCumulationBufferCapacity.bytes() > Integer.MAX_VALUE) {
      sizeHeader.setMaxCumulationBufferCapacity(Integer.MAX_VALUE);
    }
 else {
      sizeHeader.setMaxCumulationBufferCapacity((int)nettyTransport.maxCumulationBufferCapacity.bytes());
    }
  }
  if (nettyTransport.maxCompositeBufferComponents != -1) {
    sizeHeader.setMaxCumulationBufferComponents(nettyTransport.maxCompositeBufferComponents);
  }
  channelPipeline.addLast("size",sizeHeader);
  channelPipeline.addLast("dispatcher",new MessageChannelHandler(nettyTransport,nettyTransport.logger));
  return channelPipeline;
}
