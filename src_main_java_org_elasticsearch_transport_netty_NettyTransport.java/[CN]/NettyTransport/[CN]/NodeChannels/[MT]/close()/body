{
  List<ChannelFuture> futures=new ArrayList<>();
  closeChannelsAndWait(recovery,futures);
  closeChannelsAndWait(bulk,futures);
  closeChannelsAndWait(reg,futures);
  closeChannelsAndWait(state,futures);
  closeChannelsAndWait(ping,futures);
  for (  ChannelFuture future : futures) {
    future.awaitUninterruptibly();
  }
}
