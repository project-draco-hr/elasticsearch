{
  for (  Client client : clients()) {
    ClusterState state=client.admin().cluster().prepareState().setLocal(true).get().getState();
    int dataNodes=0;
    for (    DiscoveryNode discoveryNode : state.nodes()) {
      if (discoveryNode.isDataNode()) {
        dataNodes++;
      }
    }
    assertThat(dataNodes,equalTo(cluster().numDataNodes()));
  }
}
