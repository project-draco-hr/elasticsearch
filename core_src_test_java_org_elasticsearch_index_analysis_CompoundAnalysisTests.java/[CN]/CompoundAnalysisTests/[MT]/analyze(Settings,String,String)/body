{
  Index index=new Index("test");
  Injector parentInjector=new ModulesBuilder().add(new SettingsModule(settings),new EnvironmentModule(new Environment(settings)),new IndicesAnalysisModule()).createInjector();
  Injector injector=new ModulesBuilder().add(new IndexSettingsModule(index,settings),new IndexNameModule(index),new AnalysisModule(settings,parentInjector.getInstance(IndicesAnalysisService.class))).createChildInjector(parentInjector);
  AnalysisService analysisService=injector.getInstance(AnalysisService.class);
  Analyzer analyzer=analysisService.analyzer(analyzerName).analyzer();
  AllEntries allEntries=new AllEntries();
  allEntries.addText("field1",text,1.0f);
  allEntries.reset();
  TokenStream stream=AllTokenStream.allTokenStream("_all",allEntries,analyzer);
  stream.reset();
  CharTermAttribute termAtt=stream.addAttribute(CharTermAttribute.class);
  List<String> terms=new ArrayList<>();
  while (stream.incrementToken()) {
    String tokText=termAtt.toString();
    terms.add(tokText);
  }
  return terms;
}
