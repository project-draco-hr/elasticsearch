{
synchronized (mutex) {
    SnapshotDeletionPolicy.SnapshotHolder holder=snapshots.get(version);
    if (holder == null) {
      return false;
    }
    if (holder.counter <= 0) {
      snapshots.remove(version);
      return false;
    }
    if (--holder.counter == 0) {
      snapshots.remove(version);
    }
    return true;
  }
}
