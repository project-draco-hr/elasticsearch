{
  File pKeyFile=new File(keystore);
  KeyManagerFactory keyManagerFactory=KeyManagerFactory.getInstance("SunX509");
  KeyStore keyStore=KeyStore.getInstance("PKCS12");
  InputStream keyInput=new FileInputStream(pKeyFile);
  keyStore.load(keyInput,password.toCharArray());
  keyInput.close();
  keyManagerFactory.init(keyStore,password.toCharArray());
  SSLContext context=SSLContext.getInstance("TLS");
  context.init(keyManagerFactory.getKeyManagers(),null,new SecureRandom());
  return context.getSocketFactory();
}
