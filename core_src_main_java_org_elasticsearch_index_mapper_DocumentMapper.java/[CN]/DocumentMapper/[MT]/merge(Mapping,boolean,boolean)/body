{
  try (ReleasableLock lock=mappingWriteLock.acquire()){
    mapperService.checkMappersCompatibility(type,mapping,updateAllTypes);
    final MergeResult mergeResult=new MergeResult(simulate,updateAllTypes);
    this.mapping.merge(mapping,mergeResult);
    if (simulate == false) {
      addMappers(mergeResult.getNewObjectMappers(),mergeResult.getNewFieldMappers(),updateAllTypes);
      refreshSource();
    }
    return mergeResult;
  }
 }
