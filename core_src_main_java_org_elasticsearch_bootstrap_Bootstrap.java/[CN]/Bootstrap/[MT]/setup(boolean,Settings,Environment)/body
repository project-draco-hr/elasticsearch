{
  initializeNatives(settings.getAsBoolean("bootstrap.mlockall",false),settings.getAsBoolean("bootstrap.ctrlhandler",true),settings.getAsBoolean("bootstrap.sigar",true));
  if (addShutdownHook) {
    Runtime.getRuntime().addShutdownHook(new Thread(){
      @Override public void run(){
        if (node != null) {
          node.close();
        }
      }
    }
);
  }
  setupPlugins(environment);
  JarHell.checkJarHell();
  setupSecurity(settings,environment);
  Settings nodeSettings=Settings.settingsBuilder().put(settings).put(InternalSettingsPreparer.IGNORE_SYSTEM_PROPERTIES_SETTING,true).build();
  NodeBuilder nodeBuilder=NodeBuilder.nodeBuilder().settings(nodeSettings).loadConfigSettings(false);
  node=nodeBuilder.build();
}
