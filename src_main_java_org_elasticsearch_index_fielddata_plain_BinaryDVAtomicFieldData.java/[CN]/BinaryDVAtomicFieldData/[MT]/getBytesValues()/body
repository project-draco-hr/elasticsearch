{
  try {
    final BinaryDocValues values=DocValues.getBinary(reader,field);
    final Bits docsWithField=DocValues.getDocsWithField(reader,field);
    return new BytesValues(false){
      int docId;
      @Override public int setDocument(      int docId){
        this.docId=docId;
        return docsWithField.get(docId) ? 1 : 0;
      }
      @Override public BytesRef nextValue(){
        return values.get(docId);
      }
    }
;
  }
 catch (  IOException e) {
    throw new ElasticsearchIllegalStateException("Cannot load doc values",e);
  }
}
