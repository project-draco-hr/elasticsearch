{
  Directory dir=new RAMDirectory();
  IndexWriter indexWriter=new IndexWriter(dir,Lucene.STANDARD_ANALYZER,true,IndexWriter.MaxFieldLength.UNLIMITED);
  IndexReader reader=indexWriter.getReader();
  for (int i=0; i < 100; i++) {
    indexWriter.addDocument(doc().add(field("id",Integer.toString(i))).boost(i).build());
  }
  reader=refreshReader(reader);
  IndexSearcher searcher=new IndexSearcher(reader);
  assertThat(Lucene.count(searcher,new ConstantScoreQuery(filterCache.cache(new TermFilter(new Term("id","1")))),-1),equalTo(1l));
  assertThat(Lucene.count(searcher,new FilteredQuery(new MatchAllDocsQuery(),filterCache.cache(new TermFilter(new Term("id","1")))),-1),equalTo(1l));
  indexWriter.deleteDocuments(new Term("id","1"));
  reader=refreshReader(reader);
  searcher=new IndexSearcher(reader);
  assertThat(Lucene.count(searcher,new ConstantScoreQuery(filterCache.cache(new TermFilter(new Term("id","1")))),-1),equalTo(0l));
  assertThat(Lucene.count(searcher,new FilteredQuery(new MatchAllDocsQuery(),filterCache.cache(new TermFilter(new Term("id","1")))),-1),equalTo(0l));
  indexWriter.close();
}
