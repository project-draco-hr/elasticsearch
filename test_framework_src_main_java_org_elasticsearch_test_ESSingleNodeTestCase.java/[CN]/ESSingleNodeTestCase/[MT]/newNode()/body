{
  final Path tempDir=createTempDir();
  Settings settings=Settings.builder().put(ClusterName.CLUSTER_NAME_SETTING.getKey(),InternalTestCluster.clusterName("single-node-cluster",randomLong())).put(Environment.PATH_HOME_SETTING.getKey(),tempDir).put(Environment.PATH_REPO_SETTING.getKey(),tempDir.resolve("repo")).put(Environment.PATH_SHARED_DATA_SETTING.getKey(),createTempDir().getParent()).put("node.name",nodeName()).put("script.inline","true").put("script.stored","true").put(EsExecutors.PROCESSORS_SETTING.getKey(),1).put("http.enabled",false).put(Node.NODE_LOCAL_SETTING.getKey(),true).put(Node.NODE_DATA_SETTING.getKey(),true).put(nodeSettings()).build();
  Node build=new MockNode(settings,getPlugins());
  build.start();
  assertThat(DiscoveryNode.isLocalNode(build.settings()),is(true));
  return build;
}
