{
  BytesValues.WithOrdinals values=afd.getBytesValues(false);
  Ordinals.Docs segmentOrdinals=values.ordinals();
  Ordinals.Docs globalOrdinals=segmentOrdToGlobalOrdLookup.globalOrdinals(segmentOrdinals);
  final BytesValues.WithOrdinals[] bytesValues=new BytesValues.WithOrdinals[atomicReaders.length];
  for (int i=0; i < bytesValues.length; i++) {
    bytesValues[i]=atomicReaders[i].afd.getBytesValues(false);
  }
  return new BytesValues.WithOrdinals(globalOrdinals){
    int readerIndex;
    @Override public BytesRef getValueByOrd(    long globalOrd){
      final long segmentOrd=globalOrd - globalOrdToFirstSegmentDelta.get(globalOrd);
      readerIndex=(int)globalOrdToFirstSegment.get(globalOrd);
      return bytesValues[readerIndex].getValueByOrd(segmentOrd);
    }
    @Override public BytesRef copyShared(){
      return bytesValues[readerIndex].copyShared();
    }
    @Override public int currentValueHash(){
      return bytesValues[readerIndex].currentValueHash();
    }
  }
;
}
