{
  if (n < 0) {
    throw MathRuntimeException.createIllegalArgumentException("must have n >= 0 for n!, got n = {0}",n);
  }
  if (n < 21) {
    return Math.log(factorial(n));
  }
  double logSum=0;
  for (int i=2; i <= n; i++) {
    logSum+=Math.log(i);
  }
  return logSum;
}
