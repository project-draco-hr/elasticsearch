{
  if (n < 0) {
    throw MathRuntimeException.createIllegalArgumentException("must have n >= 0 for n!, got n = {0}",n);
  }
  if (n < 21) {
    return factorial(n);
  }
  return Math.floor(Math.exp(factorialLog(n)) + 0.5);
}
