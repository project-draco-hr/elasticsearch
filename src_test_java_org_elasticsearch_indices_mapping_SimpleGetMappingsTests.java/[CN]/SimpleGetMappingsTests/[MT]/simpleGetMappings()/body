{
  client().admin().indices().prepareCreate("indexa").addMapping("typeA",getMappingForType("typeA")).addMapping("typeB",getMappingForType("typeB")).addMapping("Atype",getMappingForType("Atype")).addMapping("Btype",getMappingForType("Btype")).execute().actionGet();
  client().admin().indices().prepareCreate("indexb").addMapping("typeA",getMappingForType("typeA")).addMapping("typeB",getMappingForType("typeB")).addMapping("Atype",getMappingForType("Atype")).addMapping("Btype",getMappingForType("Btype")).execute().actionGet();
  ClusterHealthResponse clusterHealth=client().admin().cluster().prepareHealth().setWaitForEvents(Priority.LANGUID).setWaitForGreenStatus().execute().actionGet();
  assertThat(clusterHealth.isTimedOut(),equalTo(false));
  GetMappingsResponse response=client().admin().indices().prepareGetMappings().execute().actionGet();
  assertThat(response.mappings().size(),equalTo(2));
  assertThat(response.mappings().get("indexa").size(),equalTo(4));
  assertThat(response.mappings().get("indexa").get("typeA"),notNullValue());
  assertThat(response.mappings().get("indexa").get("typeB"),notNullValue());
  assertThat(response.mappings().get("indexa").get("Atype"),notNullValue());
  assertThat(response.mappings().get("indexa").get("Btype"),notNullValue());
  assertThat(response.mappings().get("indexb").size(),equalTo(4));
  assertThat(response.mappings().get("indexb").get("typeA"),notNullValue());
  assertThat(response.mappings().get("indexb").get("typeB"),notNullValue());
  assertThat(response.mappings().get("indexb").get("Atype"),notNullValue());
  assertThat(response.mappings().get("indexb").get("Btype"),notNullValue());
  response=client().admin().indices().prepareGetMappings("*").setTypes("*").execute().actionGet();
  assertThat(response.mappings().size(),equalTo(2));
  assertThat(response.mappings().get("indexa").size(),equalTo(4));
  assertThat(response.mappings().get("indexa").get("typeA"),notNullValue());
  assertThat(response.mappings().get("indexa").get("typeB"),notNullValue());
  assertThat(response.mappings().get("indexa").get("Atype"),notNullValue());
  assertThat(response.mappings().get("indexa").get("Btype"),notNullValue());
  assertThat(response.mappings().get("indexb").size(),equalTo(4));
  assertThat(response.mappings().get("indexb").get("typeA"),notNullValue());
  assertThat(response.mappings().get("indexb").get("typeB"),notNullValue());
  assertThat(response.mappings().get("indexb").get("Atype"),notNullValue());
  assertThat(response.mappings().get("indexb").get("Btype"),notNullValue());
  response=client().admin().indices().prepareGetMappings("*").setTypes("typeA").execute().actionGet();
  assertThat(response.mappings().size(),equalTo(2));
  assertThat(response.mappings().get("indexa").size(),equalTo(1));
  assertThat(response.mappings().get("indexa").get("typeA"),notNullValue());
  assertThat(response.mappings().get("indexb").size(),equalTo(1));
  assertThat(response.mappings().get("indexb").get("typeA"),notNullValue());
  response=client().admin().indices().prepareGetMappings("indexa").execute().actionGet();
  assertThat(response.mappings().size(),equalTo(1));
  assertThat(response.mappings().get("indexa").size(),equalTo(4));
  assertThat(response.mappings().get("indexa").get("typeA"),notNullValue());
  assertThat(response.mappings().get("indexa").get("typeB"),notNullValue());
  assertThat(response.mappings().get("indexa").get("Atype"),notNullValue());
  assertThat(response.mappings().get("indexa").get("Btype"),notNullValue());
  response=client().admin().indices().prepareGetMappings("indexa").setTypes("A*").execute().actionGet();
  assertThat(response.mappings().size(),equalTo(1));
  assertThat(response.mappings().get("indexa").size(),equalTo(1));
  assertThat(response.mappings().get("indexa").get("Atype"),notNullValue());
  response=client().admin().indices().prepareGetMappings().setTypes("B*").execute().actionGet();
  assertThat(response.mappings().size(),equalTo(2));
  assertThat(response.mappings().get("indexa").size(),equalTo(1));
  assertThat(response.mappings().get("indexa").get("Btype"),notNullValue());
  assertThat(response.mappings().get("indexb").size(),equalTo(1));
  assertThat(response.mappings().get("indexb").get("Btype"),notNullValue());
  response=client().admin().indices().prepareGetMappings().setTypes("B*","A*").execute().actionGet();
  assertThat(response.mappings().size(),equalTo(2));
  assertThat(response.mappings().get("indexa").size(),equalTo(2));
  assertThat(response.mappings().get("indexa").get("Atype"),notNullValue());
  assertThat(response.mappings().get("indexa").get("Btype"),notNullValue());
  assertThat(response.mappings().get("indexb").size(),equalTo(2));
  assertThat(response.mappings().get("indexb").get("Atype"),notNullValue());
  assertThat(response.mappings().get("indexb").get("Btype"),notNullValue());
}
