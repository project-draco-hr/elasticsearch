{
  createIndex("test");
  ensureGreen("test");
  IndexResponse indexResponse=client().prepareIndex("test","type","1").setSource("field1","value1_1").setVersion(12).setVersionType(VersionType.FORCE).get();
  assertThat(indexResponse.getVersion(),equalTo(12l));
  indexResponse=client().prepareIndex("test","type","1").setSource("field1","value1_2").setVersion(12).setVersionType(VersionType.FORCE).get();
  assertThat(indexResponse.getVersion(),equalTo(12l));
  indexResponse=client().prepareIndex("test","type","1").setSource("field1","value1_2").setVersion(14).setVersionType(VersionType.FORCE).get();
  assertThat(indexResponse.getVersion(),equalTo(14l));
  indexResponse=client().prepareIndex("test","type","1").setSource("field1","value1_1").setVersion(13).setVersionType(VersionType.FORCE).get();
  assertThat(indexResponse.getVersion(),equalTo(13l));
  client().admin().indices().prepareRefresh().execute().actionGet();
  if (randomBoolean()) {
    refresh();
  }
  for (int i=0; i < 10; i++) {
    assertThat(client().prepareGet("test","type","1").get().getVersion(),equalTo(13l));
  }
  long v=randomIntBetween(12,14);
  DeleteResponse deleteResponse=client().prepareDelete("test","type","1").setVersion(v).setVersionType(VersionType.FORCE).get();
  assertThat(deleteResponse.isFound(),equalTo(true));
  assertThat(deleteResponse.getVersion(),equalTo(v));
}
