double[] val
int dir
boolean strict
