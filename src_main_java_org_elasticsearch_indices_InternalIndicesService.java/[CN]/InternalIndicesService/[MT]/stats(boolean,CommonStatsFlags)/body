{
  CommonStats stats=new CommonStats();
  if (flags.docs())   stats.docs=new DocsStats();
  if (flags.store())   stats.store=new StoreStats();
  if (flags.get())   stats.get=new GetStats();
  if (flags.indexing())   stats.indexing=new IndexingStats();
  if (flags.search())   stats.search=new SearchStats();
  if (flags.merge())   stats.merge=new MergeStats();
  if (flags.refresh())   stats.refresh=new RefreshStats();
  if (flags.flush())   stats.flush=new FlushStats();
  if (flags.fieldData())   stats.fieldData=new FieldDataStats();
  if (flags.idCache())   stats.idCache=new IdCacheStats();
  if (flags.filterCache())   stats.filterCache=new FilterCacheStats();
  if (includePrevious) {
    if (flags.get())     stats.get.add(oldShardsStats.getStats);
    if (flags.indexing())     stats.indexing.add(oldShardsStats.indexingStats);
    if (flags.search())     stats.search.add(oldShardsStats.searchStats);
    if (flags.merge())     stats.merge.add(oldShardsStats.mergeStats);
    if (flags.refresh())     stats.refresh.add(oldShardsStats.refreshStats);
    if (flags.flush())     stats.flush.add(oldShardsStats.flushStats);
  }
  for (  IndexService indexService : indices.values()) {
    for (    IndexShard indexShard : indexService) {
      if (flags.store())       stats.store.add(indexShard.storeStats());
      if (flags.docs())       stats.docs.add(indexShard.docStats());
      if (flags.get())       stats.get.add(indexShard.getStats());
      if (flags.indexing())       stats.indexing.add(indexShard.indexingStats());
      if (flags.search())       stats.search.add(indexShard.searchStats());
      if (flags.merge())       stats.merge.add(indexShard.mergeStats());
      if (flags.refresh())       stats.refresh.add(indexShard.refreshStats());
      if (flags.flush())       stats.flush.add(indexShard.flushStats());
      if (flags.filterCache())       stats.filterCache.add(indexShard.filterCacheStats());
      if (flags.idCache())       stats.idCache.add(indexShard.idCacheStats());
      if (flags.fieldData())       stats.fieldData.add(indexShard.fieldDataStats());
    }
  }
  return new NodeIndicesStats(stats);
}
