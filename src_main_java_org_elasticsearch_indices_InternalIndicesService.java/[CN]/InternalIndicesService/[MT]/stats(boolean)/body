{
  DocsStats docsStats=new DocsStats();
  StoreStats storeStats=new StoreStats();
  IndexingStats indexingStats=new IndexingStats();
  GetStats getStats=new GetStats();
  SearchStats searchStats=new SearchStats();
  FieldDataStats fieldDataStats=new FieldDataStats();
  FilterCacheStats filterCacheStats=new FilterCacheStats();
  IdCacheStats idCacheStats=new IdCacheStats();
  MergeStats mergeStats=new MergeStats();
  RefreshStats refreshStats=new RefreshStats();
  FlushStats flushStats=new FlushStats();
  if (includePrevious) {
    getStats.add(oldShardsStats.getStats);
    indexingStats.add(oldShardsStats.indexingStats);
    searchStats.add(oldShardsStats.searchStats);
    mergeStats.add(oldShardsStats.mergeStats);
    refreshStats.add(oldShardsStats.refreshStats);
    flushStats.add(oldShardsStats.flushStats);
  }
  for (  IndexService indexService : indices.values()) {
    for (    IndexShard indexShard : indexService) {
      storeStats.add(indexShard.storeStats());
      docsStats.add(indexShard.docStats());
      getStats.add(indexShard.getStats());
      indexingStats.add(indexShard.indexingStats());
      searchStats.add(indexShard.searchStats());
      mergeStats.add(indexShard.mergeStats());
      refreshStats.add(indexShard.refreshStats());
      flushStats.add(indexShard.flushStats());
      filterCacheStats.add(indexShard.filterCacheStats());
      idCacheStats.add(indexShard.idCacheStats());
      fieldDataStats.add(indexShard.fieldDataStats());
    }
  }
  return new NodeIndicesStats(storeStats,docsStats,indexingStats,getStats,searchStats,fieldDataStats,mergeStats,refreshStats,flushStats,filterCacheStats,idCacheStats);
}
