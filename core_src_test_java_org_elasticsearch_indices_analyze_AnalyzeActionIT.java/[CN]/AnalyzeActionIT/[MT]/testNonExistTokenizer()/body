{
  try {
    AnalyzeResponse analyzeResponse=client().admin().indices().prepareAnalyze("this is a test").setAnalyzer("not_exist_analyzer").get();
    fail("shouldn't get here");
  }
 catch (  Throwable t) {
    assertThat(t,instanceOf(IllegalArgumentException.class));
    assertThat(t.getMessage(),startsWith("failed to find global analyzer"));
  }
}
