{
  try {
    AnalyzeResponse analyzeResponse=client().admin().indices().prepareAnalyze("this is a test").setAnalyzer("not_exist_analyzer").get();
    fail("shouldn't get here");
  }
 catch (  Exception e) {
    assertThat(e,instanceOf(IllegalArgumentException.class));
    assertThat(e.getMessage(),startsWith("failed to find global analyzer"));
  }
}
