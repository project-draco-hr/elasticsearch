{
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",new BytesRef("banana"),new BytesRef("zebra"),true,true,DateTimeZone.UTC,null),equalTo(Relation.WITHIN));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",new BytesRef("banana"),null,true,true,DateTimeZone.UTC,null),equalTo(Relation.WITHIN));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",null,new BytesRef("zebra"),true,true,DateTimeZone.UTC,null),equalTo(Relation.WITHIN));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",null,null,true,true,DateTimeZone.UTC,null),equalTo(Relation.WITHIN));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",new BytesRef("banana"),new BytesRef("orange"),true,true,DateTimeZone.UTC,null),equalTo(Relation.WITHIN));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",new BytesRef("cherry"),new BytesRef("zebra"),true,true,DateTimeZone.UTC,null),equalTo(Relation.WITHIN));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",new BytesRef("banana"),new BytesRef("grape"),true,true,DateTimeZone.UTC,null),equalTo(Relation.INTERSECTS));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",new BytesRef("grape"),new BytesRef("zebra"),true,true,DateTimeZone.UTC,null),equalTo(Relation.INTERSECTS));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",new BytesRef("lime"),new BytesRef("mango"),true,true,DateTimeZone.UTC,null),equalTo(Relation.INTERSECTS));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",new BytesRef("banana"),new BytesRef("orange"),true,false,DateTimeZone.UTC,null),equalTo(Relation.INTERSECTS));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",new BytesRef("cherry"),new BytesRef("zebra"),false,true,DateTimeZone.UTC,null),equalTo(Relation.INTERSECTS));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",new BytesRef("orange"),new BytesRef("zebra"),true,true,DateTimeZone.UTC,null),equalTo(Relation.INTERSECTS));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",new BytesRef("apple"),new BytesRef("cherry"),true,true,DateTimeZone.UTC,null),equalTo(Relation.INTERSECTS));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",new BytesRef("peach"),new BytesRef("zebra"),true,true,DateTimeZone.UTC,null),equalTo(Relation.DISJOINT));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",new BytesRef("apple"),new BytesRef("banana"),true,true,DateTimeZone.UTC,null),equalTo(Relation.DISJOINT));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",null,new BytesRef("banana"),true,true,DateTimeZone.UTC,null),equalTo(Relation.DISJOINT));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",new BytesRef("peach"),null,true,true,DateTimeZone.UTC,null),equalTo(Relation.DISJOINT));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",new BytesRef("orange"),new BytesRef("zebra"),false,true,DateTimeZone.UTC,null),equalTo(Relation.DISJOINT));
  assertThat(fieldStatsProvider.isFieldWithinQuery("keyword_field",new BytesRef("apple"),new BytesRef("cherry"),true,false,DateTimeZone.UTC,null),equalTo(Relation.DISJOINT));
}
