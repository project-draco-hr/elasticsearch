{
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field","2013-01-01","now",true,true,DateTimeZone.UTC,null),equalTo(Relation.WITHIN));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field","2013-01-01",null,true,true,DateTimeZone.UTC,null),equalTo(Relation.WITHIN));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field",null,"now",true,true,DateTimeZone.UTC,null),equalTo(Relation.WITHIN));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field",null,null,true,true,DateTimeZone.UTC,null),equalTo(Relation.WITHIN));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field","2013-01-01","2014-06-01",true,true,DateTimeZone.UTC,null),equalTo(Relation.WITHIN));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field","2014-01-01","now",true,true,DateTimeZone.UTC,null),equalTo(Relation.WITHIN));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field","2013-01-01","2014-03-01",true,true,DateTimeZone.UTC,null),equalTo(Relation.INTERSECTS));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field","2014-03-01","now",true,true,DateTimeZone.UTC,null),equalTo(Relation.INTERSECTS));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field","2014-03-01","2014-05-01",true,true,DateTimeZone.UTC,null),equalTo(Relation.INTERSECTS));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field","2013-01-01","2014-06-01",true,false,DateTimeZone.UTC,null),equalTo(Relation.INTERSECTS));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field","2014-01-01","now",false,true,DateTimeZone.UTC,null),equalTo(Relation.INTERSECTS));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field","2014-06-01","now",true,true,DateTimeZone.UTC,null),equalTo(Relation.INTERSECTS));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field","2013-01-01","2014-01-01",true,true,DateTimeZone.UTC,null),equalTo(Relation.INTERSECTS));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field","2015-01-01","now",true,true,DateTimeZone.UTC,null),equalTo(Relation.DISJOINT));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field","2013-01-01","2013-09-01",true,true,DateTimeZone.UTC,null),equalTo(Relation.DISJOINT));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field",null,"2013-09-01",true,true,DateTimeZone.UTC,null),equalTo(Relation.DISJOINT));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field","2015-01-01",null,true,true,DateTimeZone.UTC,null),equalTo(Relation.DISJOINT));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field","2014-06-01","now",false,true,DateTimeZone.UTC,null),equalTo(Relation.DISJOINT));
  assertThat(fieldStatsProvider.isFieldWithinQuery("date_field","2013-01-01","2014-01-01",true,false,DateTimeZone.UTC,null),equalTo(Relation.DISJOINT));
}
