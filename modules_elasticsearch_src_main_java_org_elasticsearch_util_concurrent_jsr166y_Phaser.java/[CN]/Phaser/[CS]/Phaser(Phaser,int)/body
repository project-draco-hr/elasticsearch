{
  if (parties < 0 || parties > ushortMask)   throw new IllegalArgumentException("Illegal number of parties");
  int phase=0;
  this.parent=parent;
  if (parent != null) {
    this.root=parent.root;
    phase=parent.register();
  }
 else   this.root=this;
  this.state=trippedStateFor(phase,parties);
}
