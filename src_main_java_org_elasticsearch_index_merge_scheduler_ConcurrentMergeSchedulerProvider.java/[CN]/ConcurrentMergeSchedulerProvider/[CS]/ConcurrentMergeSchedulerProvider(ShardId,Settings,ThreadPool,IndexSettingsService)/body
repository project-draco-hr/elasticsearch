{
  super(shardId,indexSettings,threadPool);
  this.indexSettingsService=indexSettingsService;
  this.maxThreadCount=indexSettings.getAsInt(MAX_THREAD_COUNT,Math.max(1,Math.min(4,EsExecutors.boundedNumberOfProcessors(indexSettings) / 2)));
  this.maxMergeCount=indexSettings.getAsInt(MAX_MERGE_COUNT,maxThreadCount + 5);
  this.autoThrottle=indexSettings.getAsBoolean(AUTO_THROTTLE,true);
  logger.debug("using [concurrent] merge scheduler with max_thread_count[{}], max_merge_count[{}], auto_throttle[{}]",maxThreadCount,maxMergeCount,autoThrottle);
  indexSettingsService.addListener(applySettings);
}
