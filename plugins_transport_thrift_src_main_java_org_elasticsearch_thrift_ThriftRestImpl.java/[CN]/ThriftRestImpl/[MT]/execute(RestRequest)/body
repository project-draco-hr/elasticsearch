{
  if (logger.isTraceEnabled()) {
    logger.trace("thrift message {}",request);
  }
  final CountDownLatch latch=new CountDownLatch(1);
  final AtomicReference<RestResponse> ref=new AtomicReference<RestResponse>();
  restController.dispatchRequest(new ThriftRestRequest(request),new RestChannel(){
    @Override public void sendResponse(    RestResponse response){
      ref.set(response);
      latch.countDown();
    }
  }
);
  try {
    latch.await();
    return convert(ref.get());
  }
 catch (  Exception e) {
    throw new TException("failed to generate response",e);
  }
}
