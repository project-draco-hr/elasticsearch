{
  final Definition definition=metadata.definition;
  final AnalyzerUtility utility=new AnalyzerUtility(metadata);
  final AnalyzerCaster caster=new AnalyzerCaster(definition);
  final AnalyzerPromoter promoter=new AnalyzerPromoter(definition);
  statement=new AnalyzerStatement(metadata,this,utility,caster);
  expression=new AnalyzerExpression(metadata,this,caster,promoter);
  external=new AnalyzerExternal(metadata,this,utility,caster,promoter);
  utility.incrementScope();
  utility.addVariable(null,"#this",definition.execType);
  metadata.paramsValueSlot=utility.addVariable(null,"params",definition.smapType).slot;
  metadata.scorerValueSlot=utility.addVariable(null,"#scorer",definition.objectType).slot;
  metadata.docValueSlot=utility.addVariable(null,"doc",definition.smapType).slot;
  metadata.aggregationValueSlot=utility.addVariable(null,"_value",definition.defType).slot;
  metadata.loopCounterSlot=utility.addVariable(null,"#loop",definition.intType).slot;
  metadata.scoreValueSlot=utility.addVariable(null,"_score",definition.doubleType).slot;
  metadata.ctxValueSlot=utility.addVariable(null,"ctx",definition.smapType).slot;
  metadata.createStatementMetadata(metadata.root);
  visit(metadata.root);
  utility.decrementScope();
}
