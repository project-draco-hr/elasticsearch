{
  long now=System.currentTimeMillis();
  try {
    builder.get();
    fail("Expected ClusterBlockException");
  }
 catch (  ClusterBlockException e) {
    if (!autoCreateIndex) {
      assertThat(System.currentTimeMillis() - now,lessThan(timeout.millis() / 2));
    }
 else {
      assertThat(System.currentTimeMillis() - now,greaterThan(timeout.millis() - 50));
      assertThat(e.status(),equalTo(RestStatus.SERVICE_UNAVAILABLE));
    }
  }
}
