{
  try {
    indicesService.processPendingDeletes(new Index(index),new TimeValue(30,TimeUnit.MINUTES));
    if (nodes.localNodeMaster()) {
      innerNodeIndexStoreDeleted(index,nodeId);
    }
 else {
      transportService.sendRequest(clusterState.nodes().masterNode(),INDEX_STORE_DELETED_ACTION_NAME,new NodeIndexStoreDeletedMessage(index,nodeId),EmptyTransportResponseHandler.INSTANCE_SAME);
    }
  }
 catch (  LockObtainFailedException exc) {
    logger.warn("[{}] failed to lock all shards for index - timed out after 30 seconds",index);
  }
}
