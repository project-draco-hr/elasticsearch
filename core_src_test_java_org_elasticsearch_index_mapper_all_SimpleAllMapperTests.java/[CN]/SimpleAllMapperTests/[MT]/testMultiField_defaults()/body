{
  String mapping=copyToStringFromClasspath("/org/elasticsearch/index/mapper/all/multifield-mapping_default.json");
  DocumentMapper docMapper=createIndex("test").mapperService().documentMapperParser().parse(mapping);
  XContentBuilder builder=XContentFactory.jsonBuilder();
  builder.startObject().field("foo").startObject().field("bar","Elasticsearch rules!").endObject().endObject();
  Document doc=docMapper.parse("test","test","1",builder.bytes()).rootDoc();
  AllField field=(AllField)doc.getField("_all");
  AllEntries allEntries=field.getAllEntries();
  assertThat(allEntries.fields(),hasSize(1));
  assertThat(allEntries.fields(),hasItem("foo.bar"));
}
