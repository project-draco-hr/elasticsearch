{
  if (before == null) {
    throw createError(new IllegalArgumentException("Illegal field [" + value + "] access made without target."));
  }
  Sort sort=before.sort;
  if (sort == Sort.ARRAY) {
    return new LArrayLength(location,value).copy(this).analyze(locals);
  }
 else   if (sort == Sort.DEF) {
    return new LDefField(location,value).copy(this).analyze(locals);
  }
  Struct struct=before.struct;
  field=statik ? struct.staticMembers.get(value) : struct.members.get(value);
  if (field != null) {
    if (store && java.lang.reflect.Modifier.isFinal(field.modifiers)) {
      throw createError(new IllegalArgumentException("Cannot write to read-only field [" + value + "] for type ["+ struct.name+ "]."));
    }
    after=field.type;
    return this;
  }
 else {
    boolean shortcut=struct.methods.containsKey(new Definition.MethodKey("get" + Character.toUpperCase(value.charAt(0)) + value.substring(1),0)) || struct.methods.containsKey(new Definition.MethodKey("is" + Character.toUpperCase(value.charAt(0)) + value.substring(1),0)) || struct.methods.containsKey(new Definition.MethodKey("set" + Character.toUpperCase(value.charAt(0)) + value.substring(1),1));
    if (shortcut) {
      return new LShortcut(location,value).copy(this).analyze(locals);
    }
 else {
      EConstant index=new EConstant(location,value);
      index.analyze(locals);
      if (Map.class.isAssignableFrom(before.clazz)) {
        return new LMapShortcut(location,index).copy(this).analyze(locals);
      }
      if (List.class.isAssignableFrom(before.clazz)) {
        return new LListShortcut(location,index).copy(this).analyze(locals);
      }
    }
  }
  throw createError(new IllegalArgumentException("Unknown field [" + value + "] for type ["+ struct.name+ "]."));
}
