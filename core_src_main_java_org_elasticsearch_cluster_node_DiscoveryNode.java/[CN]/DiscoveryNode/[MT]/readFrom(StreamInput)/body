{
  String nodeName=in.readString().intern();
  String nodeId=in.readString().intern();
  String hostName=in.readString().intern();
  String hostAddress=in.readString().intern();
  TransportAddress address=TransportAddressSerializers.addressFromStream(in);
  int size=in.readVInt();
  ImmutableOpenMap.Builder<String,String> attributesBuilder=ImmutableOpenMap.builder(size);
  for (int i=0; i < size; i++) {
    attributesBuilder.put(in.readString().intern(),in.readString().intern());
  }
  ImmutableOpenMap<String,String> attributes=attributesBuilder.build();
  Version version=Version.readVersion(in);
  return new DiscoveryNode(nodeName,nodeId,hostName,hostAddress,address,attributes,version);
}
