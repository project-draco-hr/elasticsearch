{
  if (isUpgraded(indexMetaData)) {
    return indexMetaData;
  }
  checkSupportedVersion(indexMetaData);
  IndexMetaData newMetaData=upgradeLegacyRoutingSettings(indexMetaData);
  newMetaData=addDefaultUnitsIfNeeded(newMetaData);
  checkMappingsCompatibility(newMetaData);
  newMetaData=upgradeSettings(newMetaData);
  newMetaData=markAsUpgraded(newMetaData);
  return newMetaData;
}
