{
  if (isUpgraded(indexMetaData)) {
    return indexMetaData;
  }
  checkSupportedVersion(indexMetaData);
  IndexMetaData newMetaData=indexMetaData;
  newMetaData=addDefaultUnitsIfNeeded(newMetaData);
  checkMappingsCompatibility(newMetaData);
  newMetaData=markAsUpgraded(newMetaData);
  return newMetaData;
}
