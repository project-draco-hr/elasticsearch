{
  this.shardSnapshots=shardSnapshots;
  this.files=files;
  Map<String,List<FileInfo>> physicalFiles=newHashMap();
  for (  SnapshotFiles snapshot : shardSnapshots) {
    for (    FileInfo fileInfo : snapshot.indexFiles()) {
      List<FileInfo> physicalFileList=physicalFiles.get(fileInfo.physicalName());
      if (physicalFileList == null) {
        physicalFileList=new ArrayList<>();
        physicalFiles.put(fileInfo.physicalName(),physicalFileList);
      }
      physicalFileList.add(files.get(fileInfo.name()));
    }
  }
  ImmutableMap.Builder<String,List<FileInfo>> mapBuilder=ImmutableMap.builder();
  for (  Map.Entry<String,List<FileInfo>> entry : physicalFiles.entrySet()) {
    mapBuilder.put(entry.getKey(),Collections.unmodifiableList(new ArrayList<>(entry.getValue())));
  }
  this.physicalFiles=mapBuilder.build();
}
