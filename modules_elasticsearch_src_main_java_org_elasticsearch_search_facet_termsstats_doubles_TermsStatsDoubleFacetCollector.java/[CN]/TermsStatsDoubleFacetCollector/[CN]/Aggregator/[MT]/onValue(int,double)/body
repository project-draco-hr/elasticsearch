{
  InternalTermsStatsDoubleFacet.DoubleEntry doubleEntry=entries.get(value);
  if (doubleEntry == null) {
    doubleEntry=new InternalTermsStatsDoubleFacet.DoubleEntry(value,1,0,0,Double.MAX_VALUE,Double.MIN_VALUE);
    entries.put(value,doubleEntry);
  }
 else {
    doubleEntry.count++;
  }
  if (valueFieldData.multiValued()) {
    valueAggregator.doubleEntry=doubleEntry;
    valueFieldData.forEachValueInDoc(docId,valueAggregator);
  }
 else {
    double valueValue=valueFieldData.doubleValue(docId);
    if (valueValue < doubleEntry.min) {
      doubleEntry.min=valueValue;
    }
    if (valueValue > doubleEntry.max) {
      doubleEntry.max=valueValue;
    }
    doubleEntry.totalCount++;
    doubleEntry.total+=valueValue;
  }
}
