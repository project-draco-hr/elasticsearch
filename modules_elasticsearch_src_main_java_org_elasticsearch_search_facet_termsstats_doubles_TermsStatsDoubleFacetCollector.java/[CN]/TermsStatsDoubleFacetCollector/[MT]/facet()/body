{
  if (entries.isEmpty()) {
    return new InternalTermsStatsDoubleFacet(facetName,comparatorType,size,ImmutableList.<InternalTermsStatsDoubleFacet.DoubleEntry>of(),missing);
  }
  if (size == 0) {
    return new InternalTermsStatsDoubleFacet(facetName,comparatorType,0,entries.valueCollection(),missing);
  }
  TreeSet<InternalTermsStatsDoubleFacet.DoubleEntry> ordered=new BoundedTreeSet<InternalTermsStatsDoubleFacet.DoubleEntry>(comparatorType.comparator(),size * numberOfShards);
  ordered.addAll(entries.valueCollection());
  pushFacets(entries);
  return new InternalTermsStatsDoubleFacet(facetName,comparatorType,size,ordered,missing);
}
