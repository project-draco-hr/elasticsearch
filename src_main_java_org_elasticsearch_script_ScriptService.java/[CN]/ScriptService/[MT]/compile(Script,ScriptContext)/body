{
  if (script == null) {
    throw new ElasticsearchIllegalArgumentException("The parameter script (Script) must not be null.");
  }
  if (scriptContext == null) {
    throw new ElasticsearchIllegalArgumentException("The parameter scriptContext (ScriptContext) must not be null.");
  }
  String lang=script.getLang();
  if (lang == null) {
    lang=defaultLang;
  }
  ScriptEngineService scriptEngineService=getScriptEngineServiceForLang(lang);
  if (canExecuteScript(lang,scriptEngineService,script.getType(),scriptContext) == false) {
    throw new ScriptException("scripts of type [" + script.getType() + "], operation ["+ scriptContext.getKey()+ "] and lang ["+ lang+ "] are disabled");
  }
  return compileInternal(script);
}
