{
  for (  File file : dir.listFiles()) {
    if (file.isDirectory()) {
      processScriptsDirectory(prefix + file.getName() + "_",file);
    }
 else {
      int extIndex=file.getName().lastIndexOf('.');
      if (extIndex != -1) {
        String ext=file.getName().substring(extIndex + 1);
        String scriptName=prefix + file.getName().substring(0,extIndex);
        boolean found=false;
        for (        ScriptEngineService engineService : scriptEngines.values()) {
          for (          String s : engineService.extensions()) {
            if (s.equals(ext)) {
              found=true;
              try {
                String script=Streams.copyToString(new InputStreamReader(new FileInputStream(file),"UTF-8"));
                staticCache.put(scriptName,new CompiledScript(engineService.types()[0],engineService.compile(script)));
              }
 catch (              Exception e) {
                logger.warn("failed to load/compile script [{}]",e,scriptName);
              }
              break;
            }
          }
          if (found) {
            break;
          }
        }
        if (!found) {
          logger.warn("no script engine found for [{}]",ext);
        }
      }
    }
  }
}
