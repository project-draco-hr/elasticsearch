{
  ScriptEngineService service=scriptEngines.get(lang);
  if (service == null) {
    throw new ElasticsearchIllegalArgumentException("script_lang not supported [" + lang + "]");
  }
  if (this.dynamicScriptingDisabled == DynamicScriptDisabling.EVERYTHING_ALLOWED || "native".equals(lang) || "mustache".equals(lang)) {
    return true;
  }
 else   if (this.dynamicScriptingDisabled == DynamicScriptDisabling.ONLY_DISK_ALLOWED) {
    return false;
  }
 else {
    return service.sandboxed();
  }
}
