{
  if (reader == null) {
    return null;
  }
  if (reader instanceof SegmentReader) {
    return (SegmentReader)reader;
  }
 else   if (reader instanceof FilterAtomicReader) {
    final FilterAtomicReader fReader=(FilterAtomicReader)reader;
    try {
      return FILTER_ATOMIC_READER_IN == null ? null : segmentReader((AtomicReader)FILTER_ATOMIC_READER_IN.get(fReader));
    }
 catch (    IllegalAccessException e) {
    }
  }
  if (fail) {
    throw new ElasticsearchIllegalStateException("Can not extract segment reader from given index reader [" + reader + "]");
  }
  return null;
}
