{
  if (!running) {
    return;
  }
  DiscoveryNodes prevNodes=latestNodes;
  this.latestNodes=clusterState.nodes();
  this.clusterStateVersion=clusterState.version();
  DiscoveryNodes.Delta delta=this.latestNodes.delta(prevNodes);
  for (  DiscoveryNode newNode : delta.addedNodes()) {
    if (newNode.id().equals(this.localNode.id())) {
      continue;
    }
    if (!nodesFD.containsKey(newNode)) {
      nodesFD.put(newNode,new NodeFD());
      threadPool.schedule(TimeValue.timeValueMillis(0),ThreadPool.Names.SAME,new SendPingRequest(newNode));
    }
  }
  for (  DiscoveryNode removedNode : delta.removedNodes()) {
    nodesFD.remove(removedNode);
  }
}
