{
  int numberOfUnassignedShards=newClusterState.getRoutingNodes().unassigned().size();
  if (numberOfUnassignedShards > 0) {
    String reason=String.format(Locale.ROOT,"[%d] unassigned shards after failing shards",numberOfUnassignedShards);
    if (logger.isTraceEnabled()) {
      logger.trace(reason + ", scheduling a reroute");
    }
    routingService.reroute(reason);
  }
}
