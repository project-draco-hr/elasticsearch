{
  try (XContentParser qSourceParser=XContentFactory.xContent(source).createParser(source)){
    final QueryShardContext contextCopy=new QueryShardContext(context.index(),context.indexQueryParserService());
    contextCopy.reset(qSourceParser);
    QueryBuilder result=contextCopy.parseContext().parseInnerQueryBuilder();
    context.combineNamedQueries(contextCopy);
    return result.toQuery(context);
  }
 }
