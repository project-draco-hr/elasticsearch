{
  try (XContentParser qSourceParser=XContentFactory.xContent(source).createParser(source)){
    final QueryShardContext contextCopy=new QueryShardContext(context);
    contextCopy.reset(qSourceParser);
    contextCopy.parseFieldMatcher(context.parseFieldMatcher());
    QueryBuilder<?> result=contextCopy.parseContext().parseInnerQueryBuilder();
    context.combineNamedQueries(contextCopy);
    return result.toQuery(context);
  }
 }
