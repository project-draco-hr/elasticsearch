{
  PutWarmerRequest putWarmerRequest=new PutWarmerRequest(request.param("name"));
  BytesReference sourceBytes=RestActions.getRestContent(request);
  XContentParser parser=XContentFactory.xContent(sourceBytes).createParser(sourceBytes);
  QueryParseContext queryParseContext=new QueryParseContext(new Index(""),queryRegistry);
  queryParseContext.reset(parser);
  SearchSourceBuilder source=SearchSourceBuilder.PROTOTYPE.fromXContent(parser,queryParseContext);
  SearchRequest searchRequest=new SearchRequest(Strings.splitStringByCommaToArray(request.param("index"))).types(Strings.splitStringByCommaToArray(request.param("type"))).requestCache(request.paramAsBoolean("request_cache",null)).source(source);
  searchRequest.indicesOptions(IndicesOptions.fromRequest(request,searchRequest.indicesOptions()));
  putWarmerRequest.searchRequest(searchRequest);
  putWarmerRequest.timeout(request.paramAsTime("timeout",putWarmerRequest.timeout()));
  putWarmerRequest.masterNodeTimeout(request.paramAsTime("master_timeout",putWarmerRequest.masterNodeTimeout()));
  client.admin().indices().putWarmer(putWarmerRequest,new AcknowledgedRestListener<>(channel));
}
