{
  int sizeToAllocate=type == Type.SMALL ? smallBufferSizeInBytes : largeBufferSizeInBytes;
  if (direct) {
    return ByteBuffer.allocateDirect(sizeToAllocate);
  }
  return ByteBuffer.allocate(sizeToAllocate);
}
