{
  final DiscoveryNodes discoNodes=clusterService.state().nodes();
  for (  final DiscoveryNode node : discoNodes) {
    if (node.equals(discoNodes.localNode())) {
      continue;
    }
    if (!node.masterNode() && !RiverNodeHelper.isRiverNode(node)) {
      continue;
    }
    transportService.sendRequest(node,PublishClusterStateRequestHandler.ACTION,new PublishClusterStateRequest(clusterState),new VoidTransportResponseHandler(false){
      @Override public void handleException(      TransportException exp){
        logger.debug("failed to send cluster state to [{}], should be detected as failed soon...",exp,node);
      }
    }
);
  }
}
