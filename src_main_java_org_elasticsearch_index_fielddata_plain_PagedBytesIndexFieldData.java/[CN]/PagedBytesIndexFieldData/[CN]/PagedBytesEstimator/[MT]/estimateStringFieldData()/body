{
  try {
    AtomicReader reader=context.reader();
    Terms terms=reader.terms(getFieldNames().indexName());
    Fields fields=reader.fields();
    final Terms fieldTerms=fields.terms(getFieldNames().indexName());
    if (fieldTerms instanceof FieldReader) {
      final Stats stats=((FieldReader)fieldTerms).computeStats();
      long totalTermBytes=stats.totalTermBytes;
      if (logger.isTraceEnabled()) {
        logger.trace("totalTermBytes: {}, terms.size(): {}, terms.getSumDocFreq(): {}",totalTermBytes,terms.size(),terms.getSumDocFreq());
      }
      long totalBytes=totalTermBytes + (2 * terms.size()) + (4 * terms.getSumDocFreq());
      return totalBytes;
    }
  }
 catch (  Exception e) {
    logger.warn("Unable to estimate memory overhead",e);
  }
  return 0;
}
