{
  DateMathParser parser=new DateMathParser(Joda.forPattern("dateOptionalTime"),TimeUnit.MILLISECONDS);
  assertThat(parser.parse("1970-01-01",0),equalTo(0l));
  assertThat(parser.parse("1970-01-01||+1m",0),equalTo(TimeUnit.MINUTES.toMillis(1)));
  assertThat(parser.parse("1970-01-01||+1m+1s",0),equalTo(TimeUnit.MINUTES.toMillis(1) + TimeUnit.SECONDS.toMillis(1)));
  assertThat(parser.parse("2013-01-01||+1y",0),equalTo(parser.parse("2013-01-01",0) + TimeUnit.DAYS.toMillis(365)));
  assertThat(parser.parse("2013-03-03||/y",0),equalTo(parser.parse("2013-01-01",0)));
  assertThat(parser.parseUpperInclusive("2013-03-03||/y",0),equalTo(parser.parse("2014-01-01",0)));
}
