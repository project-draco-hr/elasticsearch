{
  IngestDocument ingestDocument=RandomDocumentPicks.randomIngestDocument(random());
  int numFields=randomIntBetween(1,5);
  Set<String> fields=new HashSet<>();
  for (int i=0; i < numFields; i++) {
    fields.add(RandomDocumentPicks.randomExistingFieldName(random(),ingestDocument));
  }
  Processor processor=new RemoveProcessor(fields);
  processor.execute(ingestDocument);
  for (  String field : fields) {
    assertThat(ingestDocument.getPropertyValue(field,Object.class),nullValue());
    assertThat(ingestDocument.hasPropertyValue(field),equalTo(false));
  }
}
