{
  String[] nameParts=name.split("\\.");
  ContentPath path=new ContentPath();
  for (int i=0; i < nameParts.length - 1; ++i) {
    path.add(nameParts[i]);
  }
  ParseContext context=new ParseContext.InternalParseContext(Settings.EMPTY,mapperService.documentMapperParser(),mapperService.documentMapper("type"),path);
  Mapper.Builder builder=new ObjectMapper.Builder(nameParts[nameParts.length - 1]).enabled(true);
  Mapper.BuilderContext builderContext=new Mapper.BuilderContext(context.indexSettings(),context.path());
  return (ObjectMapper)builder.build(builderContext);
}
