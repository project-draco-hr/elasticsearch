{
  if (allocation.ignoreDisable()) {
    return Decision.YES;
  }
  Settings indexSettings=allocation.routingNodes().metaData().index(shardRouting.index()).settings();
  if (shardRouting.primary() && !allocation.routingNodes().routingTable().index(shardRouting.index()).shard(shardRouting.id()).primaryAllocatedPostApi()) {
    return indexSettings.getAsBoolean(INDEX_ROUTING_ALLOCATION_DISABLE_NEW_ALLOCATION,disableNewAllocation) ? Decision.NO : Decision.YES;
  }
  if (indexSettings.getAsBoolean(INDEX_ROUTING_ALLOCATION_DISABLE_ALLOCATION,disableAllocation)) {
    return Decision.NO;
  }
  if (indexSettings.getAsBoolean(INDEX_ROUTING_ALLOCATION_DISABLE_REPLICA_ALLOCATION,disableReplicaAllocation)) {
    return shardRouting.primary() ? Decision.YES : Decision.NO;
  }
  return Decision.YES;
}
