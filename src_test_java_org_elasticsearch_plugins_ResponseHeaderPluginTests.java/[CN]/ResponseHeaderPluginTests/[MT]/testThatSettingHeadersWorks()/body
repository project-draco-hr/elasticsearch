{
  ensureGreen();
  HttpResponse response=httpClient().method("GET").path("/_protected").execute();
  assertThat(response.getStatusCode(),equalTo(RestStatus.UNAUTHORIZED.getStatus()));
  assertThat(response.getHeaders().get("Secret"),equalTo("required"));
  HttpResponse authResponse=httpClient().method("GET").path("/_protected").addHeader("Secret","password").execute();
  assertThat(authResponse.getStatusCode(),equalTo(RestStatus.OK.getStatus()));
  assertThat(authResponse.getHeaders().get("Secret"),equalTo("granted"));
}
