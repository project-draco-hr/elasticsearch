{
  if (context.request().scroll() != null) {
    TopDocs topDocs=context.queryResult().topDocs();
    int[] docIdsToLoad=new int[topDocs.scoreDocs.length];
    for (int i=0; i < topDocs.scoreDocs.length; i++) {
      docIdsToLoad[i]=topDocs.scoreDocs[i].doc;
    }
    context.docIdsToLoad(docIdsToLoad,0,docIdsToLoad.length);
  }
 else {
    TopDocs topDocs=context.queryResult().topDocs();
    if (topDocs.scoreDocs.length < context.from()) {
      context.docIdsToLoad(EMPTY_DOC_IDS,0,0);
      return;
    }
    int totalSize=context.from() + context.size();
    int[] docIdsToLoad=new int[Math.min(topDocs.scoreDocs.length - context.from(),context.size())];
    int counter=0;
    for (int i=context.from(); i < totalSize; i++) {
      if (i < topDocs.scoreDocs.length) {
        docIdsToLoad[counter]=topDocs.scoreDocs[i].doc;
      }
 else {
        break;
      }
      counter++;
    }
    context.docIdsToLoad(docIdsToLoad,0,counter);
  }
}
