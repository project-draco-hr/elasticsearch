{
  int numQueries=scaledRandomIntBetween(32,256);
  for (int i=0; i < numQueries; i++) {
    String id=Integer.toString(i);
    Query query;
    if (randomBoolean()) {
      query=new PrefixQuery(new Term("field",id));
    }
 else     if (randomBoolean()) {
      query=new WildcardQuery(new Term("field",id + "*"));
    }
 else     if (randomBoolean()) {
      query=new CustomQuery(new Term("field",id + "*"));
    }
 else     if (randomBoolean()) {
      query=new SpanTermQuery(new Term("field",id));
    }
 else {
      query=new TermQuery(new Term("field",id));
    }
    addPercolatorQuery(id,query);
  }
  indexWriter.close();
  directoryReader=DirectoryReader.open(directory);
  IndexSearcher shardSearcher=newSearcher(directoryReader);
  for (int i=0; i < numQueries; i++) {
    MemoryIndex memoryIndex=new MemoryIndex();
    String id=Integer.toString(i);
    memoryIndex.addField("field",id,new WhitespaceAnalyzer());
    duelRun(memoryIndex,shardSearcher);
  }
}
