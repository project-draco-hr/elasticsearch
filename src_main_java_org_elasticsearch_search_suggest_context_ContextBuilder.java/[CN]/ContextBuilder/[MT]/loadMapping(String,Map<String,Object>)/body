{
  final Object argType=config.get(ContextMapping.FIELD_TYPE);
  if (argType == null) {
    throw new ElasticsearchParseException("missing [" + ContextMapping.FIELD_TYPE + "] in context mapping");
  }
  final String type=argType.toString();
  if (GeolocationContextMapping.TYPE.equals(type)) {
    return GeolocationContextMapping.load(name,config);
  }
 else   if (CategoryContextMapping.TYPE.equals(type)) {
    return CategoryContextMapping.load(name,config);
  }
 else {
    throw new ElasticsearchParseException("unknown context type[" + type + "]");
  }
}
