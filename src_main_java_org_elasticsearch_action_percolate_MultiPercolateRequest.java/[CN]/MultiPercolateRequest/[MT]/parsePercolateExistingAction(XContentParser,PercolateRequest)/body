{
  String globalIndex=indices != null && indices.length > 0 ? indices[0] : null;
  GetRequest getRequest=new GetRequest(globalIndex);
  percolateRequest.getRequest(getRequest);
  String currentFieldName=null;
  XContentParser.Token token;
  while ((token=parser.nextToken()) != XContentParser.Token.END_OBJECT) {
    if (token == XContentParser.Token.FIELD_NAME) {
      currentFieldName=parser.currentName();
    }
 else     if (token.isValue()) {
      if ("id".equals(currentFieldName)) {
        getRequest.id(parser.text());
      }
 else       if ("index".equals(currentFieldName)) {
        getRequest.index(parser.text());
      }
 else       if ("type".equals(currentFieldName)) {
        getRequest.type(parser.text());
      }
 else       if ("preference".equals(currentFieldName)) {
        getRequest.preference(parser.text());
      }
 else       if ("routing".equals(currentFieldName)) {
        getRequest.routing(parser.text());
      }
 else       if ("percolate_index".equals(currentFieldName) || "percolate_indices".equals(currentFieldName) || "percolateIndex".equals(currentFieldName)|| "percolateIndices".equals(currentFieldName)) {
        percolateRequest.indices(Strings.splitStringByCommaToArray(parser.text()));
      }
 else       if ("percolate_type".equals(currentFieldName) || "percolateType".equals(currentFieldName)) {
        percolateRequest.documentType(parser.text());
      }
 else       if ("percolate_preference".equals(currentFieldName) || "percolatePreference".equals(currentFieldName)) {
        percolateRequest.preference(parser.text());
      }
 else       if ("percolate_routing".equals(currentFieldName) || "percolateRouting".equals(currentFieldName)) {
        percolateRequest.routing(parser.text());
      }
 else       if ("ignore_indices".equals(currentFieldName) || "ignoreIndices".equals(currentFieldName)) {
        percolateRequest.ignoreIndices(IgnoreIndices.fromString(parser.text()));
      }
    }
 else     if (token == XContentParser.Token.START_ARRAY) {
      if ("index".equals(currentFieldName) || "indices".equals(currentFieldName)) {
        percolateRequest.indices(parseArray(parser));
      }
 else {
        throw new ElasticSearchParseException(currentFieldName + " doesn't support arrays");
      }
    }
  }
  if ((percolateRequest.indices() == null || percolateRequest.indices().length == 0) && percolateRequest.getRequest().index() != null) {
    percolateRequest.indices(percolateRequest.getRequest().index());
  }
  if (percolateRequest.documentType() == null && percolateRequest.getRequest().type() != null) {
    percolateRequest.documentType(percolateRequest.getRequest().type());
  }
  if (percolateRequest.routing() == null && percolateRequest.getRequest().routing() != null) {
    percolateRequest.routing(percolateRequest.getRequest().routing());
  }
  if (percolateRequest.preference() == null && percolateRequest.getRequest().preference() != null) {
    percolateRequest.preference(percolateRequest.getRequest().preference());
  }
}
