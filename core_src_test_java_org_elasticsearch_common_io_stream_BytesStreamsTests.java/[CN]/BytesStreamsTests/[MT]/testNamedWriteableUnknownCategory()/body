{
  BytesStreamOutput out=new BytesStreamOutput();
  out.writeNamedWriteable(new TestNamedWriteable("test1","test2"));
  StreamInput in=new NamedWriteableAwareStreamInput(StreamInput.wrap(out.bytes().toBytes()),new NamedWriteableRegistry());
  try {
    in.readNamedWriteable(BaseNamedWriteable.class);
    fail("read should have failed");
  }
 catch (  IllegalArgumentException e) {
    assertThat(e.getMessage(),equalTo("unknown named writeable category [" + BaseNamedWriteable.class.getName() + "]"));
  }
}
