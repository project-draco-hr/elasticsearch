{
  for (  MutableShardRouting shardRouting : shards) {
    if (shardRouting.shardId().equals(shard.shardId())) {
      throw new ElasticSearchIllegalStateException("Trying to add a shard [" + shard.shardId().index().name() + "]["+ shard.shardId().id()+ "] to a node ["+ nodeId+ "] where it already exists");
    }
  }
  shards.add(shard);
  shard.assignToNode(node.id());
}
