{
  String sourceField=readStringProperty(TYPE,processorTag,config,"source_field");
  String targetField=readStringProperty(TYPE,processorTag,config,"target_field","attachment");
  List<String> fieldNames=readOptionalList(TYPE,processorTag,config,"fields");
  int indexedChars=readIntProperty(TYPE,processorTag,config,"indexed_chars",NUMBER_OF_CHARS_INDEXED);
  final Set<Field> fields;
  if (fieldNames != null) {
    fields=EnumSet.noneOf(Field.class);
    for (    String fieldName : fieldNames) {
      try {
        fields.add(Field.parse(fieldName));
      }
 catch (      Exception e) {
        throw newConfigurationException(TYPE,processorTag,"fields","illegal field option [" + fieldName + "]. valid values are "+ Arrays.toString(Field.values()));
      }
    }
  }
 else {
    fields=DEFAULT_FIELDS;
  }
  return new AttachmentProcessor(processorTag,sourceField,targetField,fields,indexedChars);
}
