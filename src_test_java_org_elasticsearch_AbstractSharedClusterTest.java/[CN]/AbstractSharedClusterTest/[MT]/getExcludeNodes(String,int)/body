{
  Set<String> nodeExclude=cluster().nodeExclude(index);
  Set<String> nodesInclude=cluster().nodesInclude(index);
  if (nodesInclude.size() < num) {
    Iterator<String> limit=Iterators.limit(nodeExclude.iterator(),num - nodesInclude.size());
    while (limit.hasNext()) {
      limit.next();
      limit.remove();
    }
  }
 else {
    Iterator<String> limit=Iterators.limit(nodesInclude.iterator(),nodesInclude.size() - num);
    while (limit.hasNext()) {
      nodeExclude.add(limit.next());
      limit.remove();
    }
  }
  return nodeExclude;
}
