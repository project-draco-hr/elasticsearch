{
  CloseableHttpResponse closeableHttpResponse=null;
  try {
    HttpUriRequest httpUriRequest=buildRequest();
    if (logger.isTraceEnabled()) {
      StringBuilder stringBuilder=new StringBuilder(httpUriRequest.getMethod()).append(" ").append(httpUriRequest.getURI());
      if (Strings.hasLength(body)) {
        stringBuilder.append("\n").append(body);
      }
      logger.trace("sending request \n{}",stringBuilder.toString());
    }
    closeableHttpResponse=httpClient.execute(httpUriRequest);
    HttpResponse httpResponse=new HttpResponse(httpUriRequest,closeableHttpResponse);
    logger.trace("got response \n{}\n{}",closeableHttpResponse,httpResponse.hasBody() ? httpResponse.getBody() : "");
    return httpResponse;
  }
  finally {
    try {
      IOUtils.close(closeableHttpResponse);
    }
 catch (    IOException e) {
      logger.error("error closing http response",e);
    }
  }
}
