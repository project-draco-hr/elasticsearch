{
  if ((Constants.WINDOWS || Constants.SUN_OS) && Constants.JRE_IS_64BIT && MMapDirectory.UNMAP_SUPPORTED) {
    return new MmapFsDirectoryService(shardId,indexSettings,indexStore,path);
  }
 else   if (Constants.WINDOWS) {
    return new SimpleFsDirectoryService(shardId,indexSettings,indexStore,path);
  }
switch (random.nextInt(4)) {
case 2:
    return new DefaultFsDirectoryService(shardId,indexSettings,indexStore,path);
case 1:
  return new MmapFsDirectoryService(shardId,indexSettings,indexStore,path);
case 0:
if (random.nextInt(10) == 0) {
  return new SimpleFsDirectoryService(shardId,indexSettings,indexStore,path);
}
default :
return new NioFsDirectoryService(shardId,indexSettings,indexStore,path);
}
}
