{
  QueryShardContext context=cache.get();
  context.reset(parser);
  try {
    context.parseFieldMatcher(parseFieldMatcher);
    Query filter=context.parseContext().parseInnerQueryBuilder().toFilter(context);
    if (filter == null) {
      return null;
    }
    return new ParsedQuery(filter,context.copyNamedQueries());
  }
  finally {
    context.reset(null);
  }
}
