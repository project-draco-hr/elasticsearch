{
  super(settings);
  this.indicesService=indicesService;
  this.clusterService=clusterService;
  this.transportService=transportService;
  transportService.registerRequestHandler(PRE_SYNCED_FLUSH_ACTION_NAME,PreSyncedFlushRequest.class,ThreadPool.Names.FLUSH,new PreSyncedFlushTransportHandler());
  transportService.registerRequestHandler(SYNCED_FLUSH_ACTION_NAME,SyncedFlushRequest.class,ThreadPool.Names.FLUSH,new SyncedFlushTransportHandler());
  transportService.registerRequestHandler(IN_FLIGHT_OPS_ACTION_NAME,InFlightOpsRequest.class,ThreadPool.Names.SAME,new InFlightOpCountTransportHandler());
  preSyncTimeout=settings.getAsTime(SETTING_PRE_SYNC_TIMEOUT,TimeValue.timeValueMinutes(5));
  syncTimeout=settings.getAsTime(SETTING_SYNC_TIMEOUT,TimeValue.timeValueMinutes(5));
  inflightOpsTimeout=settings.getAsTime(SETTING_IN_FLIGHT_OPS_TIMEOUT,TimeValue.timeValueMinutes(5));
}
