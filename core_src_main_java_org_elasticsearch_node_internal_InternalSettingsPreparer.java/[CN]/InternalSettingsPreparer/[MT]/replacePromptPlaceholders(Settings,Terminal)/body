{
  UnmodifiableIterator<Map.Entry<String,String>> iter=settings.getAsMap().entrySet().iterator();
  Settings.Builder builder=Settings.builder().classLoader(settings.getClassLoaderIfSet());
  while (iter.hasNext()) {
    Map.Entry<String,String> entry=iter.next();
    String value=entry.getValue();
    String key=entry.getKey();
switch (value) {
case SECRET_PROMPT_VALUE:
      String secretValue=promptForValue(key,terminal,true);
    if (Strings.hasLength(secretValue)) {
      builder.put(key,secretValue);
    }
  break;
case TEXT_PROMPT_VALUE:
String textValue=promptForValue(key,terminal,false);
if (Strings.hasLength(textValue)) {
builder.put(key,textValue);
}
break;
default :
builder.put(key,value);
break;
}
}
return builder.build();
}
