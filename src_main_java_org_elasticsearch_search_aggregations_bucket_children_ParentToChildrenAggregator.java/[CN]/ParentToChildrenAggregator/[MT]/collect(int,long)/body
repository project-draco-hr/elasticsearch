{
  if (parentDocs != null && parentDocs.get(docId)) {
    long globalOrdinal=globalOrdinals.getOrd(docId);
    if (globalOrdinal != -1) {
      if (parentOrdToBuckets.get(globalOrdinal) == -1) {
        parentOrdToBuckets.set(globalOrdinal,bucketOrdinal);
      }
 else {
        long[] bucketOrds=parentOrdToOtherBuckets.get(globalOrdinal);
        if (bucketOrds != null) {
          bucketOrds=Arrays.copyOf(bucketOrds,bucketOrds.length + 1);
          bucketOrds[bucketOrds.length - 1]=bucketOrdinal;
          parentOrdToOtherBuckets.put(globalOrdinal,bucketOrds);
        }
 else {
          parentOrdToOtherBuckets.put(globalOrdinal,new long[]{bucketOrdinal});
        }
        multipleBucketsPerParentOrd=true;
      }
    }
  }
}
