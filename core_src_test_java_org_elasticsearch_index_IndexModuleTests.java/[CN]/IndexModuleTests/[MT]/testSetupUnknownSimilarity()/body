{
  Settings indexSettings=Settings.settingsBuilder().put("index.similarity.my_similarity.type","test_similarity").put(IndexMetaData.SETTING_VERSION_CREATED,Version.CURRENT).put("path.home",createTempDir().toString()).build();
  IndexModule module=new IndexModule(IndexSettingsModule.newIndexSettings(new Index("foo"),indexSettings),null,new AnalysisRegistry(null,environment));
  try {
    module.newIndexService(nodeEnvironment,deleter,nodeServicesProvider);
  }
 catch (  IllegalArgumentException ex) {
    assertEquals("Unknown Similarity type [test_similarity] for [my_similarity]",ex.getMessage());
  }
}
