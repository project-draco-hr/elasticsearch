{
  ThreadPool threadPool=new ThreadPool("test");
  CircuitBreakerService circuitBreakerService=new NoneCircuitBreakerService();
  PageCacheRecycler recycler=new PageCacheRecycler(settings,threadPool);
  BigArrays bigArrays=new BigArrays(recycler,circuitBreakerService);
  Set<ScriptEngineService> scriptEngines=Collections.emptySet();
  scriptEngines.addAll(Arrays.asList(scriptEngineServices));
  ScriptEngineRegistry scriptEngineRegistry=new ScriptEngineRegistry(Collections.emptyList());
  ScriptContextRegistry scriptContextRegistry=new ScriptContextRegistry(Collections.emptyList());
  ScriptSettings scriptSettings=new ScriptSettings(scriptEngineRegistry,scriptContextRegistry);
  ScriptService scriptService=new ScriptService(settings,environment,scriptEngines,new ResourceWatcherService(settings,threadPool),scriptEngineRegistry,scriptContextRegistry,scriptSettings);
  IndicesQueriesRegistry indicesQueriesRegistry=new IndicesQueriesRegistry();
  return new NodeServicesProvider(threadPool,bigArrays,client,scriptService,indicesQueriesRegistry,circuitBreakerService);
}
