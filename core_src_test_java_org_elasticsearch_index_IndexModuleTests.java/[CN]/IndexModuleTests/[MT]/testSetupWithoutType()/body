{
  Settings indexSettings=Settings.settingsBuilder().put("index.similarity.my_similarity.foo","bar").put("path.home",createTempDir().toString()).put(IndexMetaData.SETTING_VERSION_CREATED,Version.CURRENT).build();
  IndexModule module=new IndexModule(IndexSettingsModule.newIndexSettings(new Index("foo"),indexSettings),null,new AnalysisRegistry(null,environment));
  try {
    module.newIndexService(nodeEnvironment,deleter,nodeServicesProvider);
  }
 catch (  IllegalArgumentException ex) {
    assertEquals("Similarity [my_similarity] must have an associated type",ex.getMessage());
  }
}
