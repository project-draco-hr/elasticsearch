{
  logger.debug("creating repository [{}][{}]",repositoryMetaData.type(),repositoryMetaData.name());
  Repository.Factory factory=typesRegistry.get(repositoryMetaData.type());
  if (factory == null) {
    throw new RepositoryException(repositoryMetaData.name(),"repository type [" + repositoryMetaData.type() + "] does not exist");
  }
  try {
    Repository repository=factory.create(repositoryMetaData);
    repository.start();
    return repository;
  }
 catch (  Exception e) {
    logger.warn(new ParameterizedMessage("failed to create repository [{}][{}]",repositoryMetaData.type(),repositoryMetaData.name()),e);
    throw new RepositoryException(repositoryMetaData.name(),"failed to create repository",e);
  }
}
