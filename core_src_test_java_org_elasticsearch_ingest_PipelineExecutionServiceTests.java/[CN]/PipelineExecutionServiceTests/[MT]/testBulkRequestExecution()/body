{
  BulkRequest bulkRequest=new BulkRequest();
  int numRequest=scaledRandomIntBetween(8,64);
  for (int i=0; i < numRequest; i++) {
    IndexRequest indexRequest=new IndexRequest("_index","_type","_id");
    indexRequest.source("field1","value1");
    bulkRequest.add(indexRequest);
  }
  String pipelineId="_id";
  when(store.get(pipelineId)).thenReturn(new Pipeline(pipelineId,null,new CompoundProcessor()));
  @SuppressWarnings("unchecked") Consumer<Throwable> requestItemErrorHandler=mock(Consumer.class);
  @SuppressWarnings("unchecked") Consumer<Boolean> completionHandler=mock(Consumer.class);
  executionService.execute(bulkRequest.requests(),pipelineId,requestItemErrorHandler,completionHandler);
  verify(requestItemErrorHandler,never()).accept(Matchers.any());
  verify(completionHandler,times(1)).accept(true);
}
