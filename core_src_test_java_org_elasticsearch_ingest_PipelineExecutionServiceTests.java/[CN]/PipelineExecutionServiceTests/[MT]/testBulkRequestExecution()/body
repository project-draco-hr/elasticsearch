{
  BulkRequest bulkRequest=new BulkRequest();
  String pipelineId="_id";
  int numRequest=scaledRandomIntBetween(8,64);
  for (int i=0; i < numRequest; i++) {
    IndexRequest indexRequest=new IndexRequest("_index","_type","_id").pipeline(pipelineId);
    indexRequest.source("field1","value1");
    bulkRequest.add(indexRequest);
  }
  when(store.get(pipelineId)).thenReturn(new Pipeline(pipelineId,null,new CompoundProcessor()));
  @SuppressWarnings("unchecked") Consumer<Tuple<IndexRequest,Throwable>> requestItemErrorHandler=mock(Consumer.class);
  @SuppressWarnings("unchecked") Consumer<Boolean> completionHandler=mock(Consumer.class);
  executionService.execute(bulkRequest.requests(),requestItemErrorHandler,completionHandler);
  verify(requestItemErrorHandler,never()).accept(any());
  verify(completionHandler,times(1)).accept(true);
}
