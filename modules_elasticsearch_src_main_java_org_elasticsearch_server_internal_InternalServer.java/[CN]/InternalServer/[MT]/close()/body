{
  if (lifecycle.started()) {
    stop();
  }
  if (!lifecycle.moveToClosed()) {
    return;
  }
  Logger logger=Loggers.getLogger(Server.class,settings.get("name"));
  logger.info("{{}}: Closing ...",Version.full());
  if (settings.getAsBoolean("http.enabled",true)) {
    injector.getInstance(HttpServer.class).close();
  }
  injector.getInstance(Client.class).close();
  injector.getInstance(RoutingService.class).close();
  injector.getInstance(ClusterService.class).close();
  injector.getInstance(DiscoveryService.class).close();
  injector.getInstance(MonitorService.class).close();
  injector.getInstance(GatewayService.class).close();
  injector.getInstance(SearchService.class).close();
  injector.getInstance(IndicesService.class).close();
  injector.getInstance(TransportService.class).close();
  injector.getInstance(ThreadPool.class).shutdown();
  try {
    injector.getInstance(ThreadPool.class).awaitTermination(10,TimeUnit.SECONDS);
  }
 catch (  InterruptedException e) {
  }
  try {
    injector.getInstance(ThreadPool.class).shutdownNow();
  }
 catch (  Exception e) {
  }
  logger.info("{{}}: Closed",Version.full());
}
