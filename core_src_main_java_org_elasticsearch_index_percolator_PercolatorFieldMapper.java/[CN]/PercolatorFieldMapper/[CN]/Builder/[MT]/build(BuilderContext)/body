{
  context.path().add(name());
  KeywordFieldMapper extractedTermsField=createExtractQueryFieldBuilder(EXTRACTED_TERMS_FIELD_NAME,context);
  ((PercolatorFieldType)fieldType).queryTermsField=extractedTermsField.fieldType();
  KeywordFieldMapper unknownQueryField=createExtractQueryFieldBuilder(UNKNOWN_QUERY_FIELD_NAME,context);
  ((PercolatorFieldType)fieldType).unknownQueryField=unknownQueryField.fieldType();
  BinaryFieldMapper queryBuilderField=createQueryBuilderFieldBuilder(context);
  ((PercolatorFieldType)fieldType).queryBuilderField=queryBuilderField.fieldType();
  context.path().remove();
  setupFieldType(context);
  return new PercolatorFieldMapper(name(),fieldType,defaultFieldType,context.indexSettings(),multiFieldsBuilder.build(this,context),copyTo,queryShardContext,extractedTermsField,unknownQueryField,queryBuilderField);
}
