{
  QueryShardContext queryShardContext=new QueryShardContext(this.queryShardContext);
  XContentParser parser=context.parser();
  QueryBuilder<?> queryBuilder=parseQueryBuilder(queryShardContext.newParseContext(parser),parser.getTokenLocation());
  queryBuilder=queryBuilder.rewrite(queryShardContext);
  try (XContentBuilder builder=XContentFactory.contentBuilder(PercolatorQueryCache.QUERY_BUILDER_CONTENT_TYPE)){
    queryBuilder.toXContent(builder,new MapParams(Collections.emptyMap()));
    builder.flush();
    byte[] queryBuilderAsBytes=builder.bytes().toBytes();
    context.doc().add(new Field(queryBuilderField.name(),queryBuilderAsBytes,queryBuilderField.fieldType()));
  }
   Query query=toQuery(queryShardContext,mapUnmappedFieldAsString,queryBuilder);
  ExtractQueryTermsService.extractQueryTerms(query,context.doc(),queryTermsField.name(),unknownQueryField.name(),queryTermsField.fieldType());
  return null;
}
