{
  final Aggregator aggregator=factory.create(context,parent,estimatedBucketsCount);
  if (aggregator.shouldCollect()) {
    context.registerReaderContextAware(aggregator);
  }
  aggregator.preCollection();
  return aggregator;
}
