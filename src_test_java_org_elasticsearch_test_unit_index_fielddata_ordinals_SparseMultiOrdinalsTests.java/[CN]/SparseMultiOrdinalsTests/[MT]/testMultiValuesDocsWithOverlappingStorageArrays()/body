{
  int maxDoc=7;
  int maxOrds=15;
  OrdinalsBuilder builder=new OrdinalsBuilder(maxDoc);
  for (int i=0; i < maxOrds; i++) {
    builder.nextOrdinal();
    if (i < 10) {
      builder.addDoc(0);
    }
    builder.addDoc(1);
    if (i == 0) {
      builder.addDoc(2);
    }
    if (i < 5) {
      builder.addDoc(3);
    }
    if (i < 6) {
      builder.addDoc(4);
    }
    if (i == 1) {
      builder.addDoc(5);
    }
    if (i < 10) {
      builder.addDoc(6);
    }
  }
  Ordinals ordinals=new SparseMultiArrayOrdinals(builder,64);
  Ordinals.Docs docs=ordinals.ordinals();
  assertThat(docs.getNumDocs(),equalTo(maxDoc));
  assertThat(docs.getNumOrds(),equalTo(maxOrds));
  assertThat(docs.isMultiValued(),equalTo(true));
  assertThat(docs.getOrd(0),equalTo(1));
  IntArrayRef ref=docs.getOrds(0);
  assertThat(ref.start,equalTo(0));
  for (int i=0; i < 10; i++) {
    assertThat(ref.values[i],equalTo(i + 1));
  }
  assertThat(ref.end,equalTo(10));
  assertThat(docs.getOrd(1),equalTo(1));
  ref=docs.getOrds(1);
  assertThat(ref.start,equalTo(0));
  for (int i=0; i < 15; i++) {
    assertThat(ref.values[i],equalTo(i + 1));
  }
  assertThat(ref.end,equalTo(15));
  assertThat(docs.getOrd(2),equalTo(1));
  ref=docs.getOrds(2);
  assertThat(ref.start,equalTo(0));
  assertThat(ref.values[0],equalTo(1));
  assertThat(ref.end,equalTo(1));
  assertThat(docs.getOrd(3),equalTo(1));
  ref=docs.getOrds(3);
  assertThat(ref.start,equalTo(0));
  for (int i=0; i < 5; i++) {
    assertThat(ref.values[i],equalTo(i + 1));
  }
  assertThat(ref.end,equalTo(5));
  assertThat(docs.getOrd(4),equalTo(1));
  ref=docs.getOrds(4);
  assertThat(ref.start,equalTo(0));
  for (int i=0; i < 6; i++) {
    assertThat(ref.values[i],equalTo(i + 1));
  }
  assertThat(ref.end,equalTo(6));
  assertThat(docs.getOrd(5),equalTo(2));
  ref=docs.getOrds(5);
  assertThat(ref.start,equalTo(0));
  assertThat(ref.values[0],equalTo(2));
  assertThat(ref.end,equalTo(1));
  assertThat(docs.getOrd(6),equalTo(1));
  ref=docs.getOrds(6);
  assertThat(ref.start,equalTo(0));
  for (int i=0; i < 10; i++) {
    assertThat(ref.values[i],equalTo(i + 1));
  }
  assertThat(ref.end,equalTo(10));
}
