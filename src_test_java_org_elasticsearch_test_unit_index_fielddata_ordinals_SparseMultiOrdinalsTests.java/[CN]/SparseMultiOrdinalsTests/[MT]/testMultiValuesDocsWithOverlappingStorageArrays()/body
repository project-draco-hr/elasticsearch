{
  int maxDoc=7;
  int maxOrds=15;
  int[][] ords=new int[maxOrds][maxDoc];
  for (int i=0; i < 10; i++) {
    ords[i][0]=(i + 1);
  }
  for (int i=0; i < 15; i++) {
    ords[i][1]=(i + 1);
  }
  ords[0][2]=1;
  for (int i=0; i < 5; i++) {
    ords[i][3]=(i + 1);
  }
  for (int i=0; i < 6; i++) {
    ords[i][4]=(i + 1);
  }
  ords[0][5]=2;
  for (int i=0; i < 10; i++) {
    ords[i][6]=(i + 1);
  }
  Ordinals ordinals=new SparseMultiArrayOrdinals(ords,maxOrds,20);
  Ordinals.Docs docs=ordinals.ordinals();
  assertThat(docs.getNumDocs(),equalTo(maxDoc));
  assertThat(docs.getNumOrds(),equalTo(maxOrds));
  assertThat(docs.isMultiValued(),equalTo(true));
  assertThat(docs.getOrd(0),equalTo(1));
  IntArrayRef ref=docs.getOrds(0);
  assertThat(ref.start,equalTo(0));
  for (int i=0; i < 10; i++) {
    assertThat(ref.values[i],equalTo(i + 1));
  }
  assertThat(ref.end,equalTo(10));
  assertThat(docs.getOrd(1),equalTo(1));
  ref=docs.getOrds(1);
  assertThat(ref.start,equalTo(0));
  for (int i=0; i < 15; i++) {
    assertThat(ref.values[i],equalTo(i + 1));
  }
  assertThat(ref.end,equalTo(15));
  assertThat(docs.getOrd(2),equalTo(1));
  ref=docs.getOrds(2);
  assertThat(ref.start,equalTo(0));
  assertThat(ref.values[0],equalTo(1));
  assertThat(ref.end,equalTo(1));
  assertThat(docs.getOrd(3),equalTo(1));
  ref=docs.getOrds(3);
  assertThat(ref.start,equalTo(0));
  for (int i=0; i < 5; i++) {
    assertThat(ref.values[i],equalTo(i + 1));
  }
  assertThat(ref.end,equalTo(5));
  assertThat(docs.getOrd(4),equalTo(1));
  ref=docs.getOrds(4);
  assertThat(ref.start,equalTo(0));
  for (int i=0; i < 6; i++) {
    assertThat(ref.values[i],equalTo(i + 1));
  }
  assertThat(ref.end,equalTo(6));
  assertThat(docs.getOrd(5),equalTo(2));
  ref=docs.getOrds(5);
  assertThat(ref.start,equalTo(0));
  assertThat(ref.values[0],equalTo(2));
  assertThat(ref.end,equalTo(1));
  assertThat(docs.getOrd(6),equalTo(1));
  ref=docs.getOrds(6);
  assertThat(ref.start,equalTo(0));
  for (int i=0; i < 10; i++) {
    assertThat(ref.values[i],equalTo(i + 1));
  }
  assertThat(ref.end,equalTo(10));
}
