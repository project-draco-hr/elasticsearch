{
  logger.info("-->  starting river [{}]",riverName);
  IndexResponse indexResponse=client().prepareIndex(RiverIndexName.Conf.DEFAULT_INDEX_NAME,riverName,"_meta").setSource("type",DummyRiverModule.class.getCanonicalName()).get();
  assertTrue(indexResponse.isCreated());
  logger.info("-->  checking that river [{}] was created",riverName);
  assertThat(awaitBusy(new Predicate<Object>(){
    public boolean apply(    Object obj){
      GetResponse response=client().prepareGet(RiverIndexName.Conf.DEFAULT_INDEX_NAME,riverName,"_status").get();
      return response.isExists();
    }
  }
,5,TimeUnit.SECONDS),equalTo(true));
}
