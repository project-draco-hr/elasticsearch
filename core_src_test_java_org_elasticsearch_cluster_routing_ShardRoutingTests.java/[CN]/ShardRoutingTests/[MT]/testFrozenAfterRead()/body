{
  ShardRouting routing=TestShardRouting.newShardRouting("foo",1,"node_1",null,null,false,ShardRoutingState.INITIALIZING,1);
  routing.moveToPrimary();
  assertTrue(routing.primary());
  routing.moveFromPrimary();
  assertFalse(routing.primary());
  BytesStreamOutput out=new BytesStreamOutput();
  routing.writeTo(out);
  ShardRouting newRouting=ShardRouting.readShardRoutingEntry(StreamInput.wrap(out.bytes()));
  try {
    newRouting.moveToPrimary();
    fail("must be frozen");
  }
 catch (  IllegalStateException ex) {
  }
}
