{
  try {
    Path translogFile=getDataPath("/org/elasticsearch/index/translog/translog-v1-truncated.binary");
    assertThat("test file should exist",Files.exists(translogFile),equalTo(true));
    TranslogStream stream=TranslogStreams.translogStreamFor(translogFile);
    try (StreamInput in=stream.openInput(translogFile)){
      while (true) {
        try {
          stream.read(in);
        }
 catch (        EOFException e) {
          break;
        }
      }
    }
     fail("should have thrown an exception about the body being truncated");
  }
 catch (  TruncatedTranslogException e) {
    assertThat("translog truncated: " + e.getMessage(),e.getMessage().contains("reached premature end of file, translog is truncated"),equalTo(true));
  }
}
