{
  Map<String,InnerHitBuilder> innerHitBuilders=new HashMap<>();
  String innerHitName=null;
  for (Token token=parser.nextToken(); token != Token.END_OBJECT; token=parser.nextToken()) {
switch (token) {
case START_OBJECT:
      InnerHitBuilder innerHitBuilder=InnerHitBuilder.fromXContent(parser,context);
    innerHitBuilder.setName(innerHitName);
  innerHitBuilders.put(innerHitName,innerHitBuilder);
break;
case FIELD_NAME:
innerHitName=parser.currentName();
break;
default :
throw new ParsingException(parser.getTokenLocation(),"Expected [" + XContentParser.Token.START_OBJECT + "] in ["+ parser.currentName()+ "] but found ["+ token+ "]",parser.getTokenLocation());
}
}
return new InnerHitsBuilder(innerHitBuilders);
}
