{
  TDigestState merged=null;
  for (  InternalAggregation aggregation : reduceContext.aggregations()) {
    final InternalPercentiles percentiles=(InternalPercentiles)aggregation;
    if (merged == null) {
      merged=new TDigestState(percentiles.state.compression());
    }
    merged.add(percentiles.state);
  }
  return new InternalPercentiles(getName(),percents,merged,keyed);
}
