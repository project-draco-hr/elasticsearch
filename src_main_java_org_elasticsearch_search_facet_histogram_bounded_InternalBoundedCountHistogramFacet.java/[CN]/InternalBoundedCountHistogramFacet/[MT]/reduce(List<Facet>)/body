{
  if (facets.size() == 1) {
    InternalBoundedCountHistogramFacet firstHistoFacet=(InternalBoundedCountHistogramFacet)facets.get(0);
    if (comparatorType != ComparatorType.KEY) {
      Arrays.sort(firstHistoFacet.entries,comparatorType.comparator());
    }
    return facets.get(0);
  }
  InternalBoundedCountHistogramFacet firstHistoFacet=(InternalBoundedCountHistogramFacet)facets.get(0);
  for (int i=1; i < facets.size(); i++) {
    InternalBoundedCountHistogramFacet histoFacet=(InternalBoundedCountHistogramFacet)facets.get(i);
    for (int j=0; j < firstHistoFacet.size; j++) {
      firstHistoFacet.counts[j]+=histoFacet.counts[j];
    }
    histoFacet.releaseCache();
  }
  if (comparatorType != ComparatorType.KEY) {
    Arrays.sort(firstHistoFacet.entries,comparatorType.comparator());
  }
  return firstHistoFacet;
}
