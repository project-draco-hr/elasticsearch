{
  long totalQueryTime;
  client.admin().indices().prepareClearCache().setFieldDataCache(true).execute().actionGet();
  System.out.println("--> Warmup (" + name + ")...");
  for (int j=0; j < QUERY_WARMUP; j++) {
    SearchResponse searchResponse=client.prepareSearch().setSearchType(SearchType.COUNT).setQuery(matchAllQuery()).addFacet(termsStatsFacet(name).keyField(keyField).valueField(valueField)).execute().actionGet();
    if (j == 0) {
      System.out.println("--> Loading (" + name + "): took: "+ searchResponse.took());
    }
    if (searchResponse.hits().totalHits() != COUNT) {
      System.err.println("--> mismatch on hits");
    }
  }
  System.out.println("--> Warmup (" + name + ") DONE");
  System.out.println("--> Running (" + name + ")...");
  totalQueryTime=0;
  for (int j=0; j < QUERY_COUNT; j++) {
    SearchResponse searchResponse=client.prepareSearch().setSearchType(SearchType.COUNT).setQuery(matchAllQuery()).addFacet(termsStatsFacet(name).keyField(keyField).valueField(valueField)).execute().actionGet();
    if (searchResponse.hits().totalHits() != COUNT) {
      System.err.println("--> mismatch on hits");
    }
    totalQueryTime+=searchResponse.tookInMillis();
  }
  System.out.println("--> Terms Facet (" + name + "), hint("+ executionHint+ "): "+ (totalQueryTime / QUERY_COUNT)+ "ms");
  return new StatsResult(name,totalQueryTime);
}
