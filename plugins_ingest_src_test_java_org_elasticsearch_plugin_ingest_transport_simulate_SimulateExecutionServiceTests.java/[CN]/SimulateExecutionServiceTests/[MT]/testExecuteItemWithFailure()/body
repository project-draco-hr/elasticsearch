{
  Exception e=new RuntimeException("processor failed");
  doThrow(e).when(processor).execute(ingestDocument);
  SimulateDocumentResult actualItemResponse=executionService.executeDocument(pipeline,ingestDocument,false);
  verify(processor,times(1)).execute(ingestDocument);
  assertThat(actualItemResponse,instanceOf(SimulateDocumentSimpleResult.class));
  SimulateDocumentSimpleResult simulateDocumentSimpleResult=(SimulateDocumentSimpleResult)actualItemResponse;
  assertThat(simulateDocumentSimpleResult.getIngestDocument(),nullValue());
  assertThat(simulateDocumentSimpleResult.getFailure(),instanceOf(RuntimeException.class));
  RuntimeException runtimeException=(RuntimeException)simulateDocumentSimpleResult.getFailure();
  assertThat(runtimeException.getMessage(),equalTo("processor failed"));
}
