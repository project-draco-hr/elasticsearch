{
  SimulateDocumentResult actualItemResponse=executionService.executeDocument(pipeline,ingestDocument,true);
  verify(processor,times(2)).execute(ingestDocument);
  assertThat(actualItemResponse,instanceOf(SimulateDocumentVerboseResult.class));
  SimulateDocumentVerboseResult simulateDocumentVerboseResult=(SimulateDocumentVerboseResult)actualItemResponse;
  assertThat(simulateDocumentVerboseResult.getProcessorResults().size(),equalTo(2));
  assertThat(simulateDocumentVerboseResult.getProcessorResults().get(0).getProcessorId(),equalTo("processor[mock]-0"));
  assertThat(simulateDocumentVerboseResult.getProcessorResults().get(0).getIngestDocument(),not(sameInstance(ingestDocument)));
  assertThat(simulateDocumentVerboseResult.getProcessorResults().get(0).getIngestDocument(),equalTo(ingestDocument));
  assertThat(simulateDocumentVerboseResult.getProcessorResults().get(0).getIngestDocument().getSourceAndMetadata(),not(sameInstance(ingestDocument.getSourceAndMetadata())));
  assertThat(simulateDocumentVerboseResult.getProcessorResults().get(0).getFailure(),nullValue());
  assertThat(simulateDocumentVerboseResult.getProcessorResults().get(1).getProcessorId(),equalTo("processor[mock]-1"));
  assertThat(simulateDocumentVerboseResult.getProcessorResults().get(1).getIngestDocument(),not(sameInstance(ingestDocument)));
  assertThat(simulateDocumentVerboseResult.getProcessorResults().get(1).getIngestDocument(),equalTo(ingestDocument));
  assertThat(simulateDocumentVerboseResult.getProcessorResults().get(1).getIngestDocument().getSourceAndMetadata(),not(sameInstance(ingestDocument.getSourceAndMetadata())));
  assertThat(simulateDocumentVerboseResult.getProcessorResults().get(1).getIngestDocument().getSourceAndMetadata(),not(sameInstance(simulateDocumentVerboseResult.getProcessorResults().get(0).getIngestDocument().getSourceAndMetadata())));
  assertThat(simulateDocumentVerboseResult.getProcessorResults().get(1).getFailure(),nullValue());
}
