{
  if (type == ClusterRebalanceType.INDICES_PRIMARIES_ACTIVE) {
    for (    MutableShardRouting shard : allocation.routingNodes().unassigned()) {
      if (shard.primary()) {
        return false;
      }
    }
    for (    RoutingNode node : allocation.routingNodes()) {
      for (      MutableShardRouting shard : node) {
        if (shard.primary() && !shard.active()) {
          return false;
        }
      }
    }
    return true;
  }
  if (type == ClusterRebalanceType.INDICES_ALL_ACTIVE) {
    if (!allocation.routingNodes().unassigned().isEmpty()) {
      return false;
    }
    for (    RoutingNode node : allocation.routingNodes()) {
      for (      MutableShardRouting shard : node) {
        if (!shard.active()) {
          return false;
        }
      }
    }
  }
  return true;
}
