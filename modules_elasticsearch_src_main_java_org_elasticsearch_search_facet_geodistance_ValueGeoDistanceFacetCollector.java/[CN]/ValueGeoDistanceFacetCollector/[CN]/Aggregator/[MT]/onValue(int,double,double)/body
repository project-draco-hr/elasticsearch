{
  double distance=geoDistance.calculate(this.lat,this.lon,lat,lon,unit);
  for (  GeoDistanceFacet.Entry entry : entries) {
    if (entry.foundInDoc) {
      continue;
    }
    if (distance >= entry.getFrom() && distance < entry.getTo()) {
      entry.foundInDoc=true;
      entry.count++;
      if (valueFieldData.multiValued()) {
        double[] values=valueFieldData.doubleValues(docId);
        entry.totalCount+=values.length;
        for (        double value : values) {
          entry.total+=value;
          if (value < entry.min) {
            entry.min=value;
          }
          if (value > entry.max) {
            entry.max=value;
          }
        }
      }
 else       if (valueFieldData.hasValue(docId)) {
        entry.totalCount++;
        double value=valueFieldData.doubleValue(docId);
        entry.total+=value;
        if (value < entry.min) {
          entry.min=value;
        }
        if (value > entry.max) {
          entry.max=value;
        }
      }
    }
  }
}
