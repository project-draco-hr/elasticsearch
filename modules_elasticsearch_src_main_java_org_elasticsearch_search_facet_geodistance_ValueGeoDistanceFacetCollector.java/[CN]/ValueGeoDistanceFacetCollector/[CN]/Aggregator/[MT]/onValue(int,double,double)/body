{
  double distance=geoDistance.calculate(this.lat,this.lon,lat,lon,unit);
  for (  GeoDistanceFacet.Entry entry : entries) {
    if (entry.foundInDoc) {
      continue;
    }
    if (distance >= entry.getFrom() && distance < entry.getTo()) {
      entry.foundInDoc=true;
      entry.count++;
      if (valueFieldData.multiValued()) {
        double[] values=valueFieldData.doubleValues(docId);
        for (        double value : values) {
          entry.total+=value;
        }
      }
 else       if (valueFieldData.hasValue(docId)) {
        entry.total+=valueFieldData.doubleValue(docId);
      }
    }
  }
}
