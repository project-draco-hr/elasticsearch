{
  final CellValues cellIdValues=new CellValues(valuesSource,precision);
  ValuesSource.Numeric cellIdSource=new CellIdSource(cellIdValues,valuesSource.metaData());
  if (cellIdSource.metaData().multiValued()) {
    cellIdSource=new ValuesSource.Numeric.SortedAndUnique(cellIdSource);
  }
  return new GeoHashGridAggregator(name,factories,cellIdSource,requiredSize,shardSize,aggregationContext,parent);
}
