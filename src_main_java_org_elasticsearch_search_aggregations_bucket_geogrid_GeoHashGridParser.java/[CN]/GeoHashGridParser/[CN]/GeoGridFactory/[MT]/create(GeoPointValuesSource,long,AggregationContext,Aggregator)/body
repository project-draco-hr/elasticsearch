{
  final CellValues cellIdValues=new CellValues(valuesSource,precision);
  FieldDataSource.Numeric cellIdSource=new CellIdSource(cellIdValues,valuesSource.metaData());
  if (cellIdSource.metaData().multiValued()) {
    cellIdSource=new FieldDataSource.Numeric.SortedAndUnique(cellIdSource);
  }
  final NumericValuesSource geohashIdSource=new NumericValuesSource(cellIdSource,null,null);
  return new GeoHashGridAggregator(name,factories,geohashIdSource,requiredSize,shardSize,aggregationContext,parent);
}
