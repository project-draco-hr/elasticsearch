{
  ClusterName thisClusterName=clusterService.state().getClusterName();
  if (!thisClusterName.equals(request.clusterName)) {
    logger.trace("shard exists request meant for cluster[{}], but this is cluster[{}], ignoring request",request.clusterName,thisClusterName);
    return false;
  }
  ShardId shardId=request.shardId;
  IndexService indexService=indicesService.indexService(shardId.index().getName());
  if (indexService != null && indexService.indexUUID().equals(request.indexUUID)) {
    IndexShard indexShard=indexService.shard(shardId.getId());
    if (indexShard != null) {
      return ACTIVE_STATES.contains(indexShard.state());
    }
  }
  return false;
}
