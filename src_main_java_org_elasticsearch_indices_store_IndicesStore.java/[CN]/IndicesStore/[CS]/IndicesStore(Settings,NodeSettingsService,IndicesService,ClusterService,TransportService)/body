{
  super(settings);
  this.nodeSettingsService=nodeSettingsService;
  this.indicesService=indicesService;
  this.clusterService=clusterService;
  this.transportService=transportService;
  transportService.registerRequestHandler(ACTION_SHARD_EXISTS,ShardActiveRequest.class,ThreadPool.Names.SAME,new ShardActiveRequestHandler());
  this.rateLimitingType=settings.get("indices.store.throttle.type",StoreRateLimiting.Type.NONE.name());
  rateLimiting.setType(rateLimitingType);
  this.rateLimitingThrottle=settings.getAsBytesSize("indices.store.throttle.max_bytes_per_sec",new ByteSizeValue(10240,ByteSizeUnit.MB));
  rateLimiting.setMaxRate(rateLimitingThrottle);
  this.deleteShardTimeout=settings.getAsTime(INDICES_STORE_DELETE_SHARD_TIMEOUT,new TimeValue(30,TimeUnit.SECONDS));
  logger.debug("using indices.store.throttle.type [{}], with index.store.throttle.max_bytes_per_sec [{}]",rateLimitingType,rateLimitingThrottle);
  nodeSettingsService.addListener(applySettings);
  clusterService.addLast(this);
}
