{
  spare.reset(value,hashCode);
  InternalTermsStatsStringFacet.StringEntry stringEntry=entries.get(spare);
  if (stringEntry == null) {
    HashedBytesRef theValue=new HashedBytesRef(makesSafe(value,values),hashCode);
    stringEntry=new InternalTermsStatsStringFacet.StringEntry(theValue,1,0,0,Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY);
    entries.put(theValue,stringEntry);
  }
 else {
    stringEntry.count++;
  }
  script.setNextDocId(docId);
  double valueValue=script.runAsDouble();
  if (valueValue < stringEntry.min) {
    stringEntry.min=valueValue;
  }
  if (valueValue > stringEntry.max) {
    stringEntry.max=valueValue;
  }
  stringEntry.total+=valueValue;
  stringEntry.totalCount++;
}
