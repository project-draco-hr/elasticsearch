{
  DocumentMapper documentMapper=searchContext.mapperService().documentMapper(hitContext.hit().type());
  FieldMapper<?> mapper=documentMapper.mappers().smartNameFieldMapper(fieldName);
  if (mapper == null) {
    MapperService.SmartNameFieldMappers fullMapper=searchContext.mapperService().smartName(fieldName);
    if (fullMapper == null || !fullMapper.hasDocMapper() || fullMapper.docMapper().type().equals(hitContext.hit().type())) {
      return null;
    }
    mapper=fullMapper.mapper();
  }
  return mapper;
}
