{
  try {
    if (mutex.tryAcquire(timeoutInMillis,TimeUnit.MILLISECONDS) == false) {
      throw new LockObtainFailedException("Can't lock shard " + lockKey + ", timed out after "+ timeoutInMillis+ "ms");
    }
  }
 catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
    throw new LockObtainFailedException("Can't lock shard " + lockKey + ", interrupted",e);
  }
}
