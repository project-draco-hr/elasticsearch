{
  if (indexed() || context == null) {
    return super.prefixQuery(value,method,context);
  }
  Collection<String> queryTypes=context.queryTypes();
  if (queryTypes.size() == 1) {
    PrefixQuery prefixQuery=new PrefixQuery(UidFieldMapper.TERM_FACTORY.createTerm(Uid.createUid(Iterables.getFirst(queryTypes,null),value)));
    if (method != null) {
      prefixQuery.setRewriteMethod(method);
    }
  }
  BooleanQuery query=new BooleanQuery();
  for (  String queryType : queryTypes) {
    PrefixQuery prefixQuery=new PrefixQuery(UidFieldMapper.TERM_FACTORY.createTerm(Uid.createUid(queryType,value)));
    if (method != null) {
      prefixQuery.setRewriteMethod(method);
    }
    query.add(prefixQuery,BooleanClause.Occur.SHOULD);
  }
  return query;
}
