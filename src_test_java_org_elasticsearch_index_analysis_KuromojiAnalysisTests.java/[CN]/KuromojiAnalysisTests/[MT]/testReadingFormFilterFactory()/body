{
  AnalysisService analysisService=createAnalysisService();
  TokenFilterFactory tokenFilter=analysisService.tokenFilter("kuromoji_rf");
  MatcherAssert.assertThat(tokenFilter,instanceOf(KuromojiReadingFormFilterFactory.class));
  String source="???????????????????????????????????????";
  String[] expected_tokens_romanji=new String[]{"kon'ya","ha","robato","sensei","to","hanashi","ta"};
  Tokenizer tokenizer=new JapaneseTokenizer(new StringReader(source),null,true,JapaneseTokenizer.Mode.SEARCH);
  assertSimpleTSOutput(tokenFilter.create(tokenizer),expected_tokens_romanji);
  tokenizer=new JapaneseTokenizer(new StringReader(source),null,true,JapaneseTokenizer.Mode.SEARCH);
  String[] expected_tokens_katakana=new String[]{"?????????","???","????????????","????????????","???","?????????","???"};
  tokenFilter=analysisService.tokenFilter("kuromoji_readingform");
  MatcherAssert.assertThat(tokenFilter,instanceOf(KuromojiReadingFormFilterFactory.class));
  assertSimpleTSOutput(tokenFilter.create(tokenizer),expected_tokens_katakana);
}
