{
  if (started) {
    return;
  }
  started=true;
  this.nodeDescription=nodeDescription;
  if (settings.getAsBoolean(SettingsConstants.CREATE_CONNECTOR,false)) {
    final String port=settings.get("jmx.port","9400-9500");
    PortsRange portsRange=new PortsRange(port);
    final AtomicReference<Exception> lastException=new AtomicReference<Exception>();
    boolean success=portsRange.iterate(new PortsRange.PortCallback(){
      @Override public boolean onPortNumber(      int portNumber){
        try {
          LocateRegistry.createRegistry(portNumber);
          serviceUrl=settings.get("jmx.serviceUrl",JMXRMI_URI_PATTERN).replace("{jmx.port}",Integer.toString(portNumber));
          JMXServiceURL url=new JMXServiceURL(serviceUrl);
          connectorServer=JMXConnectorServerFactory.newJMXConnectorServer(url,settings.getAsMap(),mBeanServer);
          connectorServer.start();
          String publishHost=HostResolver.resultPublishHostAddress(settings.get("jmx.publishHost"),settings,LOCAL_IP).getHostAddress();
          publishUrl=settings.get("jmx.publishUrl",JMXRMI_PUBLISH_URI_PATTERN).replace("{jmx.port}",Integer.toString(portNumber)).replace("{jmx.host}",publishHost);
        }
 catch (        Exception e) {
          lastException.set(e);
          return false;
        }
        return true;
      }
    }
);
    if (!success) {
      throw new JmxConnectorCreationException("Failed to bind to [" + port + "]",lastException.get());
    }
    logger.info("bound_address[{}], publish_address[{}]",serviceUrl,publishUrl);
  }
  for (  ResourceDMBean resource : constructionMBeans) {
    register(resource);
  }
}
