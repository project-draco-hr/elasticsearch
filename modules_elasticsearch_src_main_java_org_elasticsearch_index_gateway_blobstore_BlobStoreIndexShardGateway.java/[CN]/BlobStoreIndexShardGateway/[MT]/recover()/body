{
  recoveryStatus.startTime(System.currentTimeMillis());
  recoveryStatus.index().startTime(System.currentTimeMillis());
  recoveryStatus.updateStage(RecoveryStatus.Stage.INDEX);
  recoverIndex();
  recoveryStatus.index().took(System.currentTimeMillis() - recoveryStatus.index().startTime());
  recoveryStatus.translog().startTime(System.currentTimeMillis());
  recoveryStatus.updateStage(RecoveryStatus.Stage.TRANSLOG);
  recoverTranslog();
  recoveryStatus.translog().took(System.currentTimeMillis() - recoveryStatus.index().startTime());
  recoveryStatus.took(System.currentTimeMillis() - recoveryStatus.startTime());
  recoveryStatus.updateStage(RecoveryStatus.Stage.DONE);
  return recoveryStatus;
}
