{
  Document d=new Document();
  d.add(new StringField("_id","1",Field.Store.NO));
  d.add(new LongField("value",Integer.MAX_VALUE + 1l,Field.Store.NO));
  writer.addDocument(d);
  d=new Document();
  d.add(new StringField("_id","2",Field.Store.NO));
  d.add(new LongField("value",Integer.MIN_VALUE - 1l,Field.Store.NO));
  writer.addDocument(d);
  IndexNumericFieldData indexFieldData=ifdService.getForField(new FieldMapper.Names("value"),new FieldDataType("long"));
  AtomicNumericFieldData fieldData=indexFieldData.load(refreshReader());
  assertThat(fieldData,instanceOf(PackedArrayAtomicFieldData.class));
  assertThat(fieldData.getLongValues().getValue(0),equalTo((long)Integer.MAX_VALUE + 1l));
  assertThat(fieldData.getLongValues().getValue(1),equalTo((long)Integer.MIN_VALUE - 1l));
}
