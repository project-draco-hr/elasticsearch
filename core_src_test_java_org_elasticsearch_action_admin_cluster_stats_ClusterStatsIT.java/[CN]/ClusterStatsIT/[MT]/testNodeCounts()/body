{
  ClusterStatsResponse response=client().admin().cluster().prepareClusterStats().get();
  assertCounts(response.getNodesStats().getCounts(),1,0,0,1,0);
  internalCluster().startNode(Settings.builder().put(Node.NODE_DATA_SETTING.getKey(),false));
  waitForNodes(2);
  response=client().admin().cluster().prepareClusterStats().get();
  assertCounts(response.getNodesStats().getCounts(),2,1,0,1,0);
  internalCluster().startNode(Settings.builder().put(Node.NODE_MASTER_SETTING.getKey(),false));
  waitForNodes(3);
  response=client().admin().cluster().prepareClusterStats().get();
  assertCounts(response.getNodesStats().getCounts(),3,1,1,1,0);
  internalCluster().startNode(Settings.builder().put(Node.NODE_CLIENT_SETTING.getKey(),true));
  waitForNodes(4);
  response=client().admin().cluster().prepareClusterStats().get();
  assertCounts(response.getNodesStats().getCounts(),4,1,1,1,1);
}
