{
  if (lon_deg >= -180 && lon_deg <= 180) {
    return lon_deg;
  }
  double off=(lon_deg + 180) % 360;
  if (off < 0) {
    return 180 + off;
  }
 else   if (off == 0 && lon_deg > 0) {
    return 180;
  }
 else {
    return -180 + off;
  }
}
