{
  Engine.Searcher searchResult=engine.searcher();
  MatcherAssert.assertThat(searchResult,EngineSearcherTotalHitsMatcher.engineSearcherTotalHits(0));
  searchResult.release();
  ParsedDocument doc=new ParsedDocument("1","1","test",null,-1,-1,doc().add(uidField("1")).add(field("value","test")).build(),Lucene.STANDARD_ANALYZER,B_1,false);
  engine.create(new Engine.Create(null,newUid("1"),doc));
  searchResult=engine.searcher();
  MatcherAssert.assertThat(searchResult,EngineSearcherTotalHitsMatcher.engineSearcherTotalHits(0));
  MatcherAssert.assertThat(searchResult,EngineSearcherTotalHitsMatcher.engineSearcherTotalHits(new TermQuery(new Term("value","test")),0));
  searchResult.release();
  engine.refresh(new Engine.Refresh(true));
  searchResult=engine.searcher();
  MatcherAssert.assertThat(searchResult,EngineSearcherTotalHitsMatcher.engineSearcherTotalHits(1));
  MatcherAssert.assertThat(searchResult,EngineSearcherTotalHitsMatcher.engineSearcherTotalHits(new TermQuery(new Term("value","test")),1));
  engine.delete(new Engine.Delete("test","1",newUid("1")));
  engine.refresh(new Engine.Refresh(true));
  Engine.Searcher updateSearchResult=engine.searcher();
  MatcherAssert.assertThat(updateSearchResult,EngineSearcherTotalHitsMatcher.engineSearcherTotalHits(0));
  updateSearchResult.release();
  MatcherAssert.assertThat(searchResult,EngineSearcherTotalHitsMatcher.engineSearcherTotalHits(1));
  MatcherAssert.assertThat(searchResult,EngineSearcherTotalHitsMatcher.engineSearcherTotalHits(new TermQuery(new Term("value","test")),1));
  searchResult.release();
}
