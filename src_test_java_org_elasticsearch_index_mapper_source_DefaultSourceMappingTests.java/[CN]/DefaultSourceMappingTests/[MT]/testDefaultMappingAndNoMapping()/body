{
  String defaultMapping=XContentFactory.jsonBuilder().startObject().startObject(MapperService.DEFAULT_MAPPING).startObject("_source").field("enabled",false).endObject().endObject().endObject().string();
  DocumentMapper mapper=MapperTestUtils.newParser().parse("my_type",null,defaultMapping);
  assertThat(mapper.type(),equalTo("my_type"));
  assertThat(mapper.sourceMapper().enabled(),equalTo(false));
  try {
    mapper=MapperTestUtils.newParser().parse(null,null,defaultMapping);
    assertThat(mapper.type(),equalTo("my_type"));
    assertThat(mapper.sourceMapper().enabled(),equalTo(false));
    fail();
  }
 catch (  MapperParsingException e) {
  }
  try {
    mapper=MapperTestUtils.newParser().parse(null,"{}",defaultMapping);
    assertThat(mapper.type(),equalTo("my_type"));
    assertThat(mapper.sourceMapper().enabled(),equalTo(false));
    fail();
  }
 catch (  MapperParsingException e) {
    assertThat(e.getMessage(),equalTo("malformed mapping no root object found"));
  }
}
