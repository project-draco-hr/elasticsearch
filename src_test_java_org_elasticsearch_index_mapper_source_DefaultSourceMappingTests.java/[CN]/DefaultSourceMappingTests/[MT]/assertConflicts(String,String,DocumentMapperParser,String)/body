{
  DocumentMapper docMapper=parser.parse(mapping1);
  docMapper.refreshSource();
  docMapper=parser.parse(docMapper.mappingSource().string());
  MergeResult mergeResult=docMapper.merge(parser.parse(mapping2).mapping(),true);
  List<String> expectedConflicts=new ArrayList<>(Arrays.asList(conflicts));
  for (  String conflict : mergeResult.buildConflicts()) {
    assertTrue("found unexpected conflict [" + conflict + "]",expectedConflicts.remove(conflict));
  }
  assertTrue("missing conflicts: " + Arrays.toString(expectedConflicts.toArray()),expectedConflicts.isEmpty());
}
