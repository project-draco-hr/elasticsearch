{
  ParsedSimulateRequest expectedRequest=new ParsedSimulateRequest(pipeline,Collections.singletonList(data),false);
  Map<String,Object> raw=new HashMap<>();
  List<Map<String,Object>> docs=new ArrayList<>();
  Map<String,Object> doc=new HashMap<>();
  doc.put("_index","_index");
  doc.put("_type","_type");
  doc.put("_id","_id");
  doc.put("_source",data.getDocument());
  docs.add(doc);
  raw.put("docs",docs);
  ParsedSimulateRequest actualRequest=parser.parseWithPipelineId("_id",raw,false,store);
  assertThat(actualRequest,equalTo(expectedRequest));
}
