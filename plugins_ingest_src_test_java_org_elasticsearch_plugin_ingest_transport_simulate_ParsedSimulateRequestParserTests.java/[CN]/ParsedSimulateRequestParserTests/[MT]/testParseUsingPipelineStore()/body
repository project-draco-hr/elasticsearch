{
  ParsedSimulateRequest expectedRequest=new ParsedSimulateRequest(pipeline,Collections.singletonList(data),false);
  Map<String,Object> raw=new HashMap<>();
  List<Map<String,Object>> docs=new ArrayList<>();
  Map<String,Object> doc=new HashMap<>();
  doc.put(Fields.INDEX,"_index");
  doc.put(Fields.TYPE,"_type");
  doc.put(Fields.ID,"_id");
  doc.put(Fields.SOURCE,data.getDocument());
  docs.add(doc);
  raw.put(Fields.DOCS,docs);
  ParsedSimulateRequest actualRequest=parser.parseWithPipelineId("_id",raw,false,store);
  assertThat(actualRequest,equalTo(expectedRequest));
}
