{
  String ipAsString;
  if (context.externalValueSet()) {
    ipAsString=(String)context.externalValue();
    if (ipAsString == null) {
      ipAsString=nullValue;
    }
  }
 else {
    if (context.parser().currentToken() == XContentParser.Token.VALUE_NULL) {
      ipAsString=nullValue;
    }
 else {
      ipAsString=context.parser().text();
    }
  }
  if (ipAsString == null) {
    return null;
  }
  if (includeInAll == null || includeInAll) {
    context.allEntries().addText(names.fullName(),ipAsString,boost);
  }
  long value=ipToLong(ipAsString);
  Field field=null;
  if (stored()) {
    field=new Field(names.indexName(),Numbers.longToBytes(value),store);
    if (indexed()) {
      field.setTokenStream(popCachedStream(precisionStep).setLongValue(value));
    }
  }
 else   if (indexed()) {
    field=new Field(names.indexName(),popCachedStream(precisionStep).setLongValue(value));
  }
  return field;
}
