{
  if ((precision > 12) || (precision < 1)) {
    throw new IllegalArgumentException("Illegal precision length of " + precision + ". Long-based geohashes only support precisions between 1 and 12");
  }
  double latInterval0=-90.0;
  double latInterval1=90.0;
  double lngInterval0=-180.0;
  double lngInterval1=180.0;
  long geohash=0l;
  boolean isEven=true;
  int bit=0;
  int ch=0;
  int geohashLength=0;
  while (geohashLength < precision) {
    double mid=0.0;
    if (isEven) {
      mid=(lngInterval0 + lngInterval1) / 2D;
      if (longitude > mid) {
        ch|=BITS[bit];
        lngInterval0=mid;
      }
 else {
        lngInterval1=mid;
      }
    }
 else {
      mid=(latInterval0 + latInterval1) / 2D;
      if (latitude > mid) {
        ch|=BITS[bit];
        latInterval0=mid;
      }
 else {
        latInterval1=mid;
      }
    }
    isEven=!isEven;
    if (bit < 4) {
      bit++;
    }
 else {
      geohashLength++;
      geohash|=ch;
      if (geohashLength < precision) {
        geohash<<=5;
      }
      bit=0;
      ch=0;
    }
  }
  geohash<<=4;
  geohash|=precision;
  return geohash;
}
