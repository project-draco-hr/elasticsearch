{
  for (  String action : actions) {
    List<TransportRequest> requests=consumeTransportRequests(action);
    if (!optional) {
      assertThat("no internal requests intercepted for action [" + action + "]",requests.size(),greaterThan(0));
    }
    for (    TransportRequest internalRequest : requests) {
      assertThat(internalRequest,instanceOf(IndicesRequest.class));
      assertThat(internalRequest.getClass().getName(),((IndicesRequest)internalRequest).indices(),equalTo(indices));
    }
  }
}
