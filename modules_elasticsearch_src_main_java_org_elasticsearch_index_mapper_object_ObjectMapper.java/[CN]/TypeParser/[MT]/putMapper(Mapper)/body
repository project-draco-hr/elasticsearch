{
  if (mapper instanceof AllFieldMapper.IncludeInAll) {
    ((AllFieldMapper.IncludeInAll)mapper).includeInAllIfNotSet(includeInAll);
  }
synchronized (mutex) {
    mappers=newMapBuilder(mappers).put(mapper.name(),mapper).immutableMap();
  }
  return this;
}
