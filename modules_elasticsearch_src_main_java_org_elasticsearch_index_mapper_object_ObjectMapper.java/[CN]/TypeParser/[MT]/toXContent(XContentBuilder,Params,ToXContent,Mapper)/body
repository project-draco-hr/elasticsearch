{
  builder.startObject(name);
  if (nested.isNested()) {
    if (nested == Nested.NESTED) {
      builder.field("type",NESTED_CONTENT_TYPE);
    }
 else     if (nested == Nested.OBJECT_AND_NESTED) {
      builder.field("type",OBJECT_AND_NESTED_CONTENT_TYPE);
    }
 else     if (nested == Nested.ROOT_AND_NESTED) {
      builder.field("type",ROOT_AND_NESTED_CONTENT_TYPE);
    }
  }
 else   if (mappers.isEmpty()) {
    builder.field("type",CONTENT_TYPE);
  }
  if (this instanceof RootObjectMapper) {
    if (dynamic != Dynamic.TRUE) {
      builder.field("dynamic",dynamic.name().toLowerCase());
    }
  }
 else {
    if (dynamic != Defaults.DYNAMIC) {
      builder.field("dynamic",dynamic.name().toLowerCase());
    }
  }
  if (enabled != Defaults.ENABLED) {
    builder.field("enabled",enabled);
  }
  if (pathType != Defaults.PATH_TYPE) {
    builder.field("path",pathType.name().toLowerCase());
  }
  if (includeInAll != null) {
    builder.field("include_in_all",includeInAll);
  }
  if (custom != null) {
    custom.toXContent(builder,params);
  }
  doXContent(builder,params);
  TreeMap<String,Mapper> sortedMappers=new TreeMap<String,Mapper>(mappers);
  for (  Mapper mapper : sortedMappers.values()) {
    if (mapper instanceof InternalMapper) {
      mapper.toXContent(builder,params);
    }
  }
  if (additionalMappers != null) {
    for (    Mapper mapper : additionalMappers) {
      mapper.toXContent(builder,params);
    }
  }
  if (!mappers.isEmpty()) {
    builder.startObject("properties");
    for (    Mapper mapper : sortedMappers.values()) {
      if (!(mapper instanceof InternalMapper)) {
        mapper.toXContent(builder,params);
      }
    }
    builder.endObject();
  }
  builder.endObject();
}
