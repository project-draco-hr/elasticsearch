{
  ImmutableMap.Builder<String,DiscoveryNode> dataNodesBuilder=ImmutableMap.builder();
  for (  Map.Entry<String,DiscoveryNode> nodeEntry : nodes.entrySet()) {
    if (nodeEntry.getValue().dataNode()) {
      dataNodesBuilder.put(nodeEntry.getKey(),nodeEntry.getValue());
    }
  }
  return new DiscoveryNodes(ImmutableMap.copyOf(nodes),dataNodesBuilder.build(),masterNodeId,localNodeId);
}
