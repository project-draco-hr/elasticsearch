{
  ingestDocument.removeField("fizz.buzz");
  assertThat(ingestDocument.getSourceAndMetadata().size(),equalTo(8));
  assertThat(ingestDocument.getSourceAndMetadata().get("fizz"),instanceOf(Map.class));
  @SuppressWarnings("unchecked") Map<String,Object> map=(Map<String,Object>)ingestDocument.getSourceAndMetadata().get("fizz");
  assertThat(map.size(),equalTo(2));
  assertThat(map.containsKey("buzz"),equalTo(false));
  ingestDocument.removeField("fizz.foo_null");
  assertThat(map.size(),equalTo(1));
  assertThat(ingestDocument.getSourceAndMetadata().size(),equalTo(8));
  assertThat(ingestDocument.getSourceAndMetadata().containsKey("fizz"),equalTo(true));
  ingestDocument.removeField("fizz.1");
  assertThat(map.size(),equalTo(0));
  assertThat(ingestDocument.getSourceAndMetadata().size(),equalTo(8));
  assertThat(ingestDocument.getSourceAndMetadata().containsKey("fizz"),equalTo(true));
}
