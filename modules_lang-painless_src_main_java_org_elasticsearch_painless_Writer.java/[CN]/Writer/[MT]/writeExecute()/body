{
  if (variables.reserved.score) {
    final Variable scorer=variables.getVariable(null,Reserved.SCORER);
    final Variable score=variables.getVariable(null,Reserved.SCORE);
    adapter.visitVarInsn(Opcodes.ALOAD,scorer.slot);
    adapter.invokeVirtual(WriterConstants.SCORER_TYPE,WriterConstants.SCORER_SCORE);
    adapter.visitInsn(Opcodes.F2D);
    adapter.visitVarInsn(Opcodes.DSTORE,score.slot);
  }
  if (variables.reserved.ctx) {
    final Variable input=variables.getVariable(null,Reserved.PARAMS);
    final Variable ctx=variables.getVariable(null,Reserved.CTX);
    adapter.visitVarInsn(Opcodes.ALOAD,input.slot);
    adapter.push(Reserved.CTX);
    adapter.invokeInterface(MAP_TYPE,MAP_GET);
    adapter.visitVarInsn(Opcodes.ASTORE,ctx.slot);
  }
  if (variables.reserved.loop) {
    final Variable loop=variables.getVariable(null,Reserved.LOOP);
    adapter.push(settings.getMaxLoopCounter());
    adapter.visitVarInsn(Opcodes.ISTORE,loop.slot);
  }
  root.write(settings,definition,adapter);
  adapter.endMethod();
}
