{
  if (metadata.scoreValueUsed) {
    execute.visitVarInsn(Opcodes.ALOAD,metadata.scorerValueSlot);
    execute.invokeVirtual(WriterConstants.SCORER_TYPE,WriterConstants.SCORER_SCORE);
    execute.visitInsn(Opcodes.F2D);
    execute.visitVarInsn(Opcodes.DSTORE,metadata.scoreValueSlot);
  }
  if (metadata.ctxValueUsed) {
    execute.visitVarInsn(Opcodes.ALOAD,metadata.inputValueSlot);
    execute.push("ctx");
    execute.invokeInterface(WriterConstants.MAP_TYPE,WriterConstants.MAP_GET);
    execute.visitVarInsn(Opcodes.ASTORE,metadata.ctxValueSlot);
  }
  execute.push(settings.getMaxLoopCounter());
  execute.visitVarInsn(Opcodes.ISTORE,metadata.loopCounterSlot);
  visit(root);
  execute.endMethod();
}
