{
  final Metadata.ExtNodeMetadata sourceenmd=metadata.getExtNodeMetadata(source);
  final Metadata.ExternalMetadata parentemd=metadata.getExternalMetadata(sourceenmd.parent);
  final boolean makearray="#makearray".equals(sourceenmd.target);
  final boolean constructor=sourceenmd.target instanceof Constructor;
  if (!makearray && !constructor) {
    throw new IllegalStateException(Metadata.error(source) + "Target not found for new call.");
  }
  if (makearray) {
    for (    final ExpressionContext exprctx : source.expression()) {
      visit(exprctx);
    }
    if (sourceenmd.type.sort == Sort.ARRAY) {
      execute.visitMultiANewArrayInsn(sourceenmd.type.type.getDescriptor(),sourceenmd.type.type.getDimensions());
    }
 else {
      execute.newArray(sourceenmd.type.type);
    }
  }
 else {
    execute.newInstance(sourceenmd.type.type);
    if (parentemd.read) {
      execute.dup();
    }
    for (    final ExpressionContext exprctx : source.arguments().expression()) {
      visit(exprctx);
    }
    final Constructor target=(Constructor)sourceenmd.target;
    execute.invokeConstructor(target.owner.type,target.method);
  }
}
