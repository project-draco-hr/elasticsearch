{
  final Metadata.ExtNodeMetadata sourceenmd=metadata.getExtNodeMetadata(source);
  final Metadata.ExternalMetadata parentemd=metadata.getExternalMetadata(sourceenmd.parent);
  final boolean length="#length".equals(sourceenmd.target);
  final boolean array="#brace".equals(sourceenmd.target);
  final boolean name=sourceenmd.target instanceof String && !length && !array;
  final boolean variable=sourceenmd.target instanceof Integer;
  final boolean field=sourceenmd.target instanceof Field;
  final boolean shortcut=sourceenmd.target instanceof Object[];
  if (!length && !variable && !field&& !array&& !name&& !shortcut) {
    throw new IllegalStateException(Metadata.error(source) + "Target not found for load/store.");
  }
  final boolean maplist=shortcut && (boolean)((Object[])sourceenmd.target)[2];
  final Object constant=shortcut ? ((Object[])sourceenmd.target)[3] : null;
  final boolean x1=field || name || (shortcut && !maplist);
  final boolean x2=array || (shortcut && maplist);
  if (length) {
    execute.arrayLength();
  }
 else   if (sourceenmd.last && parentemd.storeExpr != null) {
    final Metadata.ExpressionMetadata expremd=metadata.getExpressionMetadata(parentemd.storeExpr);
    final boolean cat=strings.contains(parentemd.storeExpr);
    if (cat) {
      if (field || name || shortcut) {
        execute.dupX1();
      }
 else       if (array) {
        execute.dup2X1();
      }
      if (maplist) {
        if (constant != null) {
          writeConstant(source,constant);
        }
        execute.dupX2();
      }
      writeLoadStoreInstruction(source,false,variable,field,name,array,shortcut);
      writeAppendStrings(sourceenmd.type.sort);
      visit(parentemd.storeExpr);
      if (strings.contains(parentemd.storeExpr)) {
        writeAppendStrings(expremd.to.sort);
        strings.remove(parentemd.storeExpr);
      }
      writeToStrings();
      checkWriteCast(source,sourceenmd.castTo);
      if (parentemd.read) {
        writeDup(sourceenmd.type.sort.size,x1,x2);
      }
      writeLoadStoreInstruction(source,true,variable,field,name,array,shortcut);
    }
 else     if (parentemd.token > 0) {
      final int token=parentemd.token;
      if (field || name || shortcut) {
        execute.dup();
      }
 else       if (array) {
        execute.dup2();
      }
      if (maplist) {
        if (constant != null) {
          writeConstant(source,constant);
        }
        execute.dupX1();
      }
      writeLoadStoreInstruction(source,false,variable,field,name,array,shortcut);
      if (parentemd.read && parentemd.post) {
        writeDup(sourceenmd.type.sort.size,x1,x2);
      }
      checkWriteCast(source,sourceenmd.castFrom);
      visit(parentemd.storeExpr);
      writeBinaryInstruction(source,sourceenmd.promote,token);
      boolean exact=false;
      if (!settings.getNumericOverflow() && expremd.typesafe && sourceenmd.type.sort != Sort.DEF && (token == MUL || token == DIV || token == REM || token == ADD || token == SUB)) {
        exact=writeExactInstruction(sourceenmd.type.sort,sourceenmd.promote.sort);
      }
      if (!exact) {
        checkWriteCast(source,sourceenmd.castTo);
      }
      if (parentemd.read && !parentemd.post) {
        writeDup(sourceenmd.type.sort.size,x1,x2);
      }
      writeLoadStoreInstruction(source,true,variable,field,name,array,shortcut);
    }
 else {
      if (constant != null) {
        writeConstant(source,constant);
      }
      visit(parentemd.storeExpr);
      if (parentemd.read) {
        writeDup(sourceenmd.type.sort.size,x1,x2);
      }
      writeLoadStoreInstruction(source,true,variable,field,name,array,shortcut);
    }
  }
 else {
    if (constant != null) {
      writeConstant(source,constant);
    }
    writeLoadStoreInstruction(source,false,variable,field,name,array,shortcut);
  }
}
