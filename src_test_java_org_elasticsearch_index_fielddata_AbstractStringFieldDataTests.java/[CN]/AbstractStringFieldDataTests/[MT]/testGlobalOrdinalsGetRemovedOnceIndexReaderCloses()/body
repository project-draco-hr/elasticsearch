{
  fillExtendedMvSet();
  refreshReader();
  FieldDataType fieldDataType=new FieldDataType("string",ImmutableSettings.builder().put("global_values","fixed"));
  IndexFieldData.WithOrdinals ifd=getForField(fieldDataType,"value");
  IndexFieldData.WithOrdinals globalOrdinals=ifd.loadGlobal(topLevelReader);
  assertThat(ifd.loadGlobal(topLevelReader),sameInstance(globalOrdinals));
  assertThat(indicesFieldDataCache.getCache().size(),equalTo(4l));
  IndexFieldData.WithOrdinals cachedInstace=null;
  for (  RamUsage ramUsage : indicesFieldDataCache.getCache().asMap().values()) {
    if (ramUsage instanceof IndexFieldData.WithOrdinals) {
      cachedInstace=(IndexFieldData.WithOrdinals)ramUsage;
      break;
    }
  }
  assertThat(cachedInstace,sameInstance(globalOrdinals));
  topLevelReader.close();
  assertThat(indicesFieldDataCache.getCache().size(),equalTo(3l));
  refreshReader();
  assertThat(ifd.loadGlobal(topLevelReader),not(sameInstance(globalOrdinals)));
  ifdService.clear();
  assertThat(indicesFieldDataCache.getCache().size(),equalTo(0l));
}
