{
  SecureASTCustomizer scz=new SecureASTCustomizer();
  scz.setClosuresAllowed(true);
  scz.setMethodDefinitionAllowed(false);
  List<String> importWhitelist=new ArrayList<>();
  importWhitelist.addAll(ImmutableSet.copyOf(GroovySandboxExpressionChecker.defaultClassConstructionWhitelist));
  scz.setImportsWhitelist(importWhitelist);
  scz.setPackageAllowed(false);
  String[] receiverWhitelist=settings.getAsArray(GROOVY_SCRIPT_SANDBOX_RECEIVER_WHITELIST,defaultReceiverWhitelist,true);
  scz.setReceiversWhiteList(newArrayList(receiverWhitelist));
  scz.addExpressionCheckers(new GroovySandboxExpressionChecker(settings,blacklistAdditions));
  return scz;
}
