{
  final Class<? extends ShardsAllocator> shardsAllocator;
  final String type=settings.get(TYPE_KEY,BALANCED_ALLOCATOR_KEY);
  if (BALANCED_ALLOCATOR_KEY.equals(type)) {
    shardsAllocator=BalancedShardsAllocator.class;
  }
 else   if (EVEN_SHARD_COUNT_ALLOCATOR_KEY.equals(type)) {
    final ESLogger logger=Loggers.getLogger(getClass(),settings);
    logger.warn("{} allocator has been removed in 2.0 using {} instead",EVEN_SHARD_COUNT_ALLOCATOR_KEY,BALANCED_ALLOCATOR_KEY);
    shardsAllocator=BalancedShardsAllocator.class;
  }
 else {
    throw new IllegalArgumentException("Unknown ShardsAllocator type [" + type + "]");
  }
  return shardsAllocator;
}
