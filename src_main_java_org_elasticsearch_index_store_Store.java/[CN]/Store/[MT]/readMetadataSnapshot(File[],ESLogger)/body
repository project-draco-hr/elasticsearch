{
  final Directory[] dirs=new Directory[indexLocations.length];
  try {
    for (int i=0; i < indexLocations.length; i++) {
      dirs[i]=new SimpleFSDirectory(indexLocations[i]);
    }
    DistributorDirectory dir=new DistributorDirectory(dirs);
    failIfCorrupted(dir,new ShardId("",1));
    return new MetadataSnapshot(dir,logger);
  }
  finally {
    IOUtils.close(dirs);
  }
}
