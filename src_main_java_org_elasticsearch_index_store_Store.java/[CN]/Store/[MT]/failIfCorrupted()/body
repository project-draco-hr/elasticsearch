{
  ensureOpen();
  final String[] files=directory().listAll();
  List<CorruptIndexException> ex=new ArrayList<>();
  for (  String file : files) {
    if (file.startsWith(CORRUPTED)) {
      try (ChecksumIndexInput input=directory().openChecksumInput(file,IOContext.READONCE)){
        CodecUtil.checkHeader(input,CODEC,VERSION,VERSION);
        String msg=input.readString();
        StringBuilder builder=new StringBuilder(this.shardId.toString());
        builder.append(" Corrupted index [");
        builder.append(file).append("] caused by: ");
        builder.append(msg);
        ex.add(new CorruptIndexException(builder.toString()));
        CodecUtil.checkFooter(input);
      }
     }
  }
  if (ex.isEmpty() == false) {
    ExceptionsHelper.rethrowAndSuppress(ex);
  }
}
