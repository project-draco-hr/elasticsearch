{
  ensureOpen();
synchronized (mutex) {
    StoreFileMetaData fromMetaData=filesMetadata.get(from);
    if (fromMetaData == null) {
      throw new FileNotFoundException(from);
    }
    directoryService.renameFile(fromMetaData.directory(),from,to);
    StoreFileMetaData toMetaData=new StoreFileMetaData(to,fromMetaData.length(),fromMetaData.checksum(),fromMetaData.directory());
    filesMetadata=ImmutableOpenMap.builder(filesMetadata).fRemove(from).fPut(to,toMetaData).build();
    files=filesMetadata.keys().toArray(String.class);
  }
}
