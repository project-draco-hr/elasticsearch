{
  String checksumName=CHECKSUMS_PREFIX + System.currentTimeMillis();
  while (directory.fileExists(checksumName)) {
    checksumName=CHECKSUMS_PREFIX + System.currentTimeMillis();
  }
  try (IndexOutput output=directory.createOutput(checksumName,IOContext.DEFAULT)){
    output.writeInt(0);
    output.writeStringStringMap(checksums);
  }
   directory.sync(Collections.singleton(checksumName));
}
