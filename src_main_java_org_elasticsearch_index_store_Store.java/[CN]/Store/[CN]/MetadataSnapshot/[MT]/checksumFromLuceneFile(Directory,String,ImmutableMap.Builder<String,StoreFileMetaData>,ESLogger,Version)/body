{
  try (IndexInput in=directory.openInput(file,IOContext.READONCE)){
    try {
      if (in.length() < CodecUtil.footerLength()) {
        throw new CorruptIndexException("Can't retrieve checksum from file: " + file + " file length must be >= "+ CodecUtil.footerLength()+ " but was: "+ in.length());
      }
      String checksum=digestToString(CodecUtil.retrieveChecksum(in));
      builder.put(file,new StoreFileMetaData(file,directory.fileLength(file),checksum,version));
    }
 catch (    Throwable ex) {
      logger.debug("Can retrieve checksum from file [{}]",ex,file);
      throw ex;
    }
  }
 }
