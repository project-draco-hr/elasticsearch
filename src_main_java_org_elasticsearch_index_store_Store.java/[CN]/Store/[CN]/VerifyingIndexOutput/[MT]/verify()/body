{
  if (metadata.checksum().equals(actualChecksum) && writtenBytes == metadata.length()) {
    return;
  }
  throw new CorruptIndexException("verification failed (hardware problem?) : expected=" + metadata.checksum() + " actual="+ actualChecksum+ " writtenLength="+ writtenBytes+ " expectedLength="+ metadata.length()+ " (resource="+ metadata.toString()+ ")");
}
