{
  if (!syncNeeded()) {
    return;
  }
synchronized (this) {
    try (ReleasableLock lock=writeLock.acquire()){
      flush();
      lastSyncedOffset=totalOffset;
    }
     checkpoint(lastSyncedOffset,operationCounter,channelReference);
  }
}
