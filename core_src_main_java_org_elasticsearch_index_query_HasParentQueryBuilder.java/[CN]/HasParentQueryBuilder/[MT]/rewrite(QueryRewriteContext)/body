{
  QueryBuilder rewrite=query.rewrite(queryShardContext);
  if (rewrite != query) {
    HasParentQueryBuilder hasParentQueryBuilder=new HasParentQueryBuilder(type,rewrite);
    hasParentQueryBuilder.score=score;
    hasParentQueryBuilder.innerHit=innerHit;
    return hasParentQueryBuilder.queryName(queryName()).boost(boost());
  }
  return this;
}
