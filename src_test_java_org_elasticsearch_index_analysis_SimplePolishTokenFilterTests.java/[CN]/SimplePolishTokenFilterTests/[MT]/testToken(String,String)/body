{
  Index index=new Index("test");
  Settings settings=ImmutableSettings.settingsBuilder().put(IndexMetaData.SETTING_VERSION_CREATED,Version.CURRENT).put("path.home",createTempDir()).put("index.analysis.filter.myStemmer.type","polish_stem").build();
  AnalysisService analysisService=createAnalysisService(index,settings);
  TokenFilterFactory filterFactory=analysisService.tokenFilter("myStemmer");
  Tokenizer tokenizer=new KeywordTokenizer();
  tokenizer.setReader(new StringReader(source));
  TokenStream ts=filterFactory.create(tokenizer);
  CharTermAttribute term1=ts.addAttribute(CharTermAttribute.class);
  ts.reset();
  assertThat(ts.incrementToken(),equalTo(true));
  assertThat(term1.toString(),equalTo(expected));
}
