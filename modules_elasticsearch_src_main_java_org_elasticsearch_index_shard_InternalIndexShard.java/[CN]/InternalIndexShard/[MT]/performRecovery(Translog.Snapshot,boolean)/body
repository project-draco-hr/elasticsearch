{
  if (state != IndexShardState.RECOVERING) {
    throw new IndexShardNotRecoveringException(shardId,state);
  }
  if (!phase3) {
    engine.start();
  }
  applyTranslogOperations(snapshot);
  if (phase3) {
synchronized (mutex) {
      state=IndexShardState.STARTED;
    }
    scheduleRefresherIfNeeded();
  }
}
