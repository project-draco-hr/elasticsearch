{
  if (idValues.setDocument(doc) > 0) {
    BytesRef id=idValues.nextValue();
    fieldsVisitor.reset();
    reader.document(doc,fieldsVisitor);
    try {
      final Query parseQuery=percolator.parsePercolatorDocument(null,fieldsVisitor.source());
      if (parseQuery != null) {
        queries.put(BytesRef.deepCopyOf(id),parseQuery);
      }
 else {
        logger.warn("failed to add query [{}] - parser returned null",id);
      }
    }
 catch (    Exception e) {
      logger.warn("failed to add query [{}]",e,id.utf8ToString());
    }
  }
}
