{
  super(indexerName,settings);
  this.client=client;
  String user=XContentMapValues.nodeStringValue(settings.settings().get("user"),null);
  String password=XContentMapValues.nodeStringValue(settings.settings().get("password"),null);
  logger.info("creating twitter stream indexer for [{}]",user);
  this.bulkSize=XContentMapValues.nodeIntegerValue(settings.settings().get("bulk_size"),100);
  this.dropThreshold=XContentMapValues.nodeIntegerValue(settings.settings().get("drop_threshold"),10);
  if (user == null || password == null) {
    stream=null;
    indexName=null;
    typeName=null;
    logger.warn("no user / password specified, disabling indexer...");
    return;
  }
  if (settings.settings().containsKey("index")) {
    Map<String,Object> indexSettings=(Map<String,Object>)settings.settings().get("index");
    indexName=XContentMapValues.nodeStringValue(indexSettings.get("index"),indexerName.name());
    typeName=XContentMapValues.nodeStringValue(indexSettings.get("type"),indexerName.name());
  }
 else {
    indexName=indexerName.name();
    typeName="status";
  }
  stream=new TwitterStreamFactory(new StatusHandler()).getInstance(user,password);
}
