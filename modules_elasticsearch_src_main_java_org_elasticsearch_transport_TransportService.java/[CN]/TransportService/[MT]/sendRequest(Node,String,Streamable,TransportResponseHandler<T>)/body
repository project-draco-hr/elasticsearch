{
  final long requestId=newRequestId();
  try {
    clientHandlers.put(requestId,handler);
    transport.sendRequest(node,requestId,action,message,handler);
  }
 catch (  Exception e) {
    clientHandlers.remove(requestId);
    if (throwConnectException) {
      if (e instanceof ConnectTransportException) {
        throw (ConnectTransportException)e;
      }
    }
    handler.handleException(new SendRequestTransportException(node,action,e));
  }
}
