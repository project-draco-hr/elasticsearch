{
  Permissions policy=new Permissions();
  addPath(policy,"path.home",environment.binFile(),"read,readlink");
  addPath(policy,"path.home",environment.libFile(),"read,readlink");
  addPath(policy,"path.plugins",environment.pluginsFile(),"read,readlink");
  addPath(policy,"path.conf",environment.configFile(),"read,readlink");
  addPath(policy,"path.scripts",environment.scriptsFile(),"read,readlink");
  addPath(policy,"java.io.tmpdir",environment.tmpFile(),"read,readlink,write,delete");
  addPath(policy,"path.logs",environment.logsFile(),"read,readlink,write,delete");
  if (environment.sharedDataFile() != null) {
    addPath(policy,"path.shared_data",environment.sharedDataFile(),"read,readlink,write,delete");
  }
  for (  Path path : environment.dataFiles()) {
    addPath(policy,"path.data",path,"read,readlink,write,delete");
  }
  for (  Path path : environment.dataWithClusterFiles()) {
    addPath(policy,"path.data",path,"read,readlink,write,delete");
  }
  for (  Path path : environment.repoFiles()) {
    addPath(policy,"path.repo",path,"read,readlink,write,delete");
  }
  if (environment.pidFile() != null) {
    policy.add(new FilePermission(environment.pidFile().toString(),"delete"));
  }
  return policy;
}
