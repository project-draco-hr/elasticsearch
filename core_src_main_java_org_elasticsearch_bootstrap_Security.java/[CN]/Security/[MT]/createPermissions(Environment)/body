{
  Permissions policy=new Permissions();
  addPath(policy,environment.binFile(),"read,readlink");
  addPath(policy,environment.libFile(),"read,readlink");
  addPath(policy,environment.pluginsFile(),"read,readlink");
  addPath(policy,environment.configFile(),"read,readlink");
  addPath(policy,environment.tmpFile(),"read,readlink,write,delete");
  addPath(policy,environment.logsFile(),"read,readlink,write,delete");
  for (  Path path : environment.dataFiles()) {
    addPath(policy,path,"read,readlink,write,delete");
  }
  for (  Path path : environment.dataWithClusterFiles()) {
    addPath(policy,path,"read,readlink,write,delete");
  }
  for (  Path path : environment.repoFiles()) {
    addPath(policy,path,"read,readlink,write,delete");
  }
  if (environment.pidFile() != null) {
    policy.add(new FilePermission(environment.pidFile().toString(),"delete"));
  }
  return policy;
}
