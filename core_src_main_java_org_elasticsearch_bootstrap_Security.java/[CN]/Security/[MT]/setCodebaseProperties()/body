{
  ClassLoader loader=Security.class.getClassLoader();
  if (loader instanceof URLClassLoader) {
    for (    URL url : ((URLClassLoader)loader).getURLs()) {
      for (      Map.Entry<Pattern,String> e : SPECIAL_JARS.entrySet()) {
        if (e.getKey().matcher(url.getPath()).matches()) {
          String prop=e.getValue();
          if (System.getProperty(prop) != null) {
            throw new IllegalStateException("property: " + prop + " is unexpectedly set: "+ System.getProperty(prop));
          }
          System.setProperty(prop,url.toString());
        }
      }
    }
    for (    String prop : SPECIAL_JARS.values()) {
      if (System.getProperty(prop) == null) {
        System.setProperty(prop,"file:/dev/null");
      }
    }
  }
 else {
    throw new UnsupportedOperationException("Unsupported system classloader type: " + loader.getClass());
  }
}
