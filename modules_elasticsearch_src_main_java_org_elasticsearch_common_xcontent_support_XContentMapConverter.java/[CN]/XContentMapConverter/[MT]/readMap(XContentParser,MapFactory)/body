{
  Map<String,Object> map=mapFactory.newMap();
  XContentParser.Token t=parser.currentToken();
  if (t == null) {
    t=parser.nextToken();
  }
  if (t == XContentParser.Token.START_OBJECT) {
    t=parser.nextToken();
  }
  for (; t == XContentParser.Token.FIELD_NAME; t=parser.nextToken()) {
    String fieldName=parser.currentName();
    t=parser.nextToken();
    Object value=readValue(parser,mapFactory,t);
    map.put(fieldName,value);
  }
  return map;
}
