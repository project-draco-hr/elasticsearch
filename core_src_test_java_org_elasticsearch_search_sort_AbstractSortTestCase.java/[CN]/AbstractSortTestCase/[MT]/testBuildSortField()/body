{
  QueryShardContext mockShardContext=createMockShardContext();
  for (int runs=0; runs < NUMBER_OF_TESTBUILDERS; runs++) {
    T sortBuilder=createTestItem();
    SortField sortField=sortBuilder.build(mockShardContext);
    XContentBuilder builder=XContentFactory.contentBuilder(randomFrom(XContentType.values()));
    if (randomBoolean()) {
      builder.prettyPrint();
    }
    builder.startObject();
    sortBuilder.toXContent(builder,ToXContent.EMPTY_PARAMS);
    builder.endObject();
    XContentParser parser=XContentHelper.createParser(builder.bytes());
    parser.nextToken();
    List<SortField> sortFields=parseElement.parse(parser,mockShardContext);
    assertEquals(1,sortFields.size());
    SortField sortFieldOldStyle=sortFields.get(0);
    assertEquals(sortFieldOldStyle.getField(),sortField.getField());
    assertEquals(sortFieldOldStyle.getReverse(),sortField.getReverse());
    assertEquals(sortFieldOldStyle.getType(),sortField.getType());
  }
}
