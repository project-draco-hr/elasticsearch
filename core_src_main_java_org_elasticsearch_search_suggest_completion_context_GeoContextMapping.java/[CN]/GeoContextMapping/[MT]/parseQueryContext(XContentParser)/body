{
  List<GeoQueryContext> queryContexts=new ArrayList<>();
  Token token=parser.nextToken();
  if (token == Token.START_OBJECT || token == Token.VALUE_STRING) {
    queryContexts.add(GeoQueryContext.parse(parser));
  }
 else   if (token == Token.START_ARRAY) {
    while (parser.nextToken() != Token.END_ARRAY) {
      queryContexts.add(GeoQueryContext.parse(parser));
    }
  }
  List<QueryContext> queryContextList=new ArrayList<>();
  for (  GeoQueryContext queryContext : queryContexts) {
    int minPrecision=this.precision;
    if (queryContext.precision != -1) {
      minPrecision=Math.min(minPrecision,queryContext.precision);
    }
    GeoPoint point=queryContext.geoPoint;
    final Collection<String> locations=new HashSet<>();
    String geoHash=GeoHashUtils.stringEncode(point.getLon(),point.getLat(),minPrecision);
    locations.add(geoHash);
    if (queryContext.neighbours.isEmpty() && geoHash.length() == this.precision) {
      GeoHashUtils.addNeighbors(geoHash,locations);
    }
 else     if (queryContext.neighbours.isEmpty() == false) {
      for (      Integer neighbourPrecision : queryContext.neighbours) {
        if (neighbourPrecision < geoHash.length()) {
          String truncatedGeoHash=geoHash.substring(0,neighbourPrecision);
          locations.add(truncatedGeoHash);
          GeoHashUtils.addNeighbors(truncatedGeoHash,locations);
        }
      }
    }
    for (    String location : locations) {
      queryContextList.add(new QueryContext(location,queryContext.boost,location.length() < this.precision));
    }
  }
  return queryContextList;
}
