{
  DiscoveryNode localNode=clusterService.localNode();
  IndexerClusterState state=event.state();
  for (  IndexerName indexerName : indexers.keySet()) {
    IndexerRouting routing=state.routing().routing(indexerName);
    if (routing == null || !localNode.equals(routing.node())) {
      closeIndexer(indexerName);
    }
  }
  for (  final IndexerRouting routing : state.routing()) {
    if (routing.node() == null) {
      continue;
    }
    if (!routing.node().equals(localNode)) {
      continue;
    }
    if (indexers.containsKey(routing.indexerName())) {
      continue;
    }
    client.prepareGet(indexerIndexName,routing.indexerName().name(),"_meta").execute(new ActionListener<GetResponse>(){
      @Override public void onResponse(      GetResponse getResponse){
        if (!indexers.containsKey(routing.indexerName())) {
          if (getResponse.exists()) {
            createIndexer(routing.indexerName(),getResponse.sourceAsMap());
          }
        }
      }
      @Override public void onFailure(      Throwable e){
        logger.warn("failed to get _meta from [{}]/[{}]",e,routing.indexerName().type(),routing.indexerName().name());
      }
    }
);
  }
}
