{
  DiscoveryNode localNode=clusterService.localNode();
  IndexerClusterState state=event.state();
  for (  IndexerName indexerName : indexers.keySet()) {
    IndexerMetaData indexerMetaData=state.metaData().indexer(indexerName);
    if (indexerMetaData == null) {
      deleteIndexer(indexerName);
    }
    IndexerRouting routing=state.routing().routing(indexerName);
    if (routing == null || !localNode.equals(routing.node())) {
      cleanIndexer(indexerName);
    }
  }
  for (  IndexerRouting routing : state.routing()) {
    if (!routing.node().equals(localNode)) {
      continue;
    }
    IndexerMetaData indexerMetaData=state.metaData().indexer(routing.indexerName());
    createIndexer(indexerMetaData.indexerName(),indexerMetaData.settings());
  }
}
