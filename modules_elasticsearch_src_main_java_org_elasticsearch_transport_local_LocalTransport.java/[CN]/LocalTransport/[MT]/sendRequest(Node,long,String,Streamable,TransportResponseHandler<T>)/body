{
  BytesStreamOutput stream=BytesStreamOutput.Cached.cached();
  stream.writeLong(requestId);
  byte status=0;
  status=setRequest(status);
  stream.writeByte(status);
  stream.writeUTF(action);
  message.writeTo(stream);
  final LocalTransport targetTransport=transports.get(node.address());
  if (targetTransport == null) {
    throw new ConnectTransportException(node,"Failed to connect");
  }
  final byte[] data=stream.copiedByteArray();
  threadPool.execute(new Runnable(){
    @Override public void run(){
      targetTransport.messageReceived(data,action,LocalTransport.this,handler);
    }
  }
);
}
