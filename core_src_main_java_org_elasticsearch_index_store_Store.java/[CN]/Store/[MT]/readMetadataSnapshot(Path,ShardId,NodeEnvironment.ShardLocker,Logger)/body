{
  try (ShardLock lock=shardLocker.lock(shardId,TimeUnit.SECONDS.toMillis(5));Directory dir=new SimpleFSDirectory(indexLocation)){
    failIfCorrupted(dir,shardId);
    return new MetadataSnapshot(null,dir,logger);
  }
 catch (  IndexNotFoundException ex) {
  }
catch (  FileNotFoundException|NoSuchFileException ex) {
    logger.info("Failed to open / find files while reading metadata snapshot");
  }
catch (  ShardLockObtainFailedException ex) {
    logger.info("{}: failed to obtain shard lock",ex,shardId);
  }
  return MetadataSnapshot.EMPTY;
}
