{
  keyScript.setNextDocId(doc);
  valueScript.setNextDocId(doc);
  long bucket;
  if (interval == 0) {
    bucket=keyScript.runAsLong();
  }
 else {
    bucket=bucket(keyScript.runAsDouble(),interval);
  }
  double value=valueScript.runAsDouble();
  counts.adjustOrPutValue(bucket,1,1);
  totals.adjustOrPutValue(bucket,value,value);
}
