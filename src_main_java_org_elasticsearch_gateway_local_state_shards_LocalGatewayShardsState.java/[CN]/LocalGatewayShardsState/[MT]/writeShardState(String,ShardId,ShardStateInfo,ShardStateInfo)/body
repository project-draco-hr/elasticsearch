{
  logger.trace("{} writing shard state, reason [{}]",shardId,reason);
  final boolean deleteOldFiles=previousStateInfo != null && previousStateInfo.version != shardStateInfo.version;
  newShardStateInfoFormat(deleteOldFiles).write(shardStateInfo,SHARD_STATE_FILE_PREFIX,shardStateInfo.version,nodeEnv.shardLocations(shardId));
}
