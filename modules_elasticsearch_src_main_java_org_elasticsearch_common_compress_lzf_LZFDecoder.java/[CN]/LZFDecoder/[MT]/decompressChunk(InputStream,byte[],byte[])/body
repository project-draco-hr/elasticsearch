{
  int bytesInOutput;
  int headerLength=is.read(inputBuffer,0,HEADER_BYTES);
  if (headerLength != HEADER_BYTES) {
    return -1;
  }
  int inPtr=0;
  if (inputBuffer[inPtr] != LZFChunk.BYTE_Z || inputBuffer[inPtr + 1] != LZFChunk.BYTE_V) {
    throw new IOException("Corrupt input data, block did not start with 'ZV' signature bytes");
  }
  inPtr+=2;
  int type=inputBuffer[inPtr++];
  int compLen=uint16(inputBuffer,inPtr);
  inPtr+=2;
  if (type == LZFChunk.BLOCK_TYPE_NON_COMPRESSED) {
    readFully(is,false,outputBuffer,0,compLen);
    bytesInOutput=compLen;
  }
 else {
    readFully(is,true,inputBuffer,0,2 + compLen);
    int uncompLen=uint16(inputBuffer,0);
    decompressChunk(inputBuffer,2,outputBuffer,0,uncompLen);
    bytesInOutput=uncompLen;
  }
  return bytesInOutput;
}
