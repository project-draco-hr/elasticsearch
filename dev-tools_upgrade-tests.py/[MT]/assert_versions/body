def assert_versions(bwc_version, current_version, node_dir):
    assert ([int(x) for x in bwc_version.split('.')] < [int(x) for x in current_version.split('.')]), ('[%s] must be < than [%s]' % (bwc_version, current_version))
    for version in [bwc_version, current_version]:
        assert (not (version in BLACK_LIST)), ('Version %s is blacklisted - %s, see %s' % (version, BLACK_LIST[version]['reason'], BLACK_LIST[version]['issue']))
        dir = os.path.join(node_dir, ('elasticsearch-%s' % current_version))
        assert os.path.isdir(dir), ('Expected elasticsearch-%s install directory does not exists: %s' % (version, dir))
