{
  if (shape instanceof JtsGeometry) {
    Geometry geometry=((JtsGeometry)shape).getGeom();
    if (geometry instanceof Point) {
      serializePoint((Point)geometry,builder);
    }
 else     if (geometry instanceof LineString) {
      serializeLineString((LineString)geometry,builder);
    }
 else     if (geometry instanceof Polygon) {
      serializePolygon((Polygon)geometry,builder);
    }
 else     if (geometry instanceof MultiPoint) {
      serializeMultiPoint((MultiPoint)geometry,builder);
    }
 else     if (geometry instanceof MultiPolygon) {
      serializeMulitPolygon((MultiPolygon)geometry,builder);
    }
 else {
      throw new ElasticSearchIllegalArgumentException("Geometry type [" + geometry.getGeometryType() + "] not supported");
    }
  }
 else   if (shape instanceof com.spatial4j.core.shape.Point) {
    serializePoint((com.spatial4j.core.shape.Point)shape,builder);
  }
 else   if (shape instanceof Rectangle) {
    serializeRectangle((Rectangle)shape,builder);
  }
 else {
    throw new ElasticSearchIllegalArgumentException("Shape type [" + shape.getClass().getSimpleName() + "] not supported");
  }
}
