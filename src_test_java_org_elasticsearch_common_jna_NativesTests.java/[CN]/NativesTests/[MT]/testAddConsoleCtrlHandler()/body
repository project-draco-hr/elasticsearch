{
  ConsoleCtrlHandler handler=new ConsoleCtrlHandler(){
    @Override public boolean handle(    int code){
      return false;
    }
  }
;
  Natives.addConsoleCtrlHandler(handler);
  if (Constants.WINDOWS) {
    assertNotNull(Kernel32Library.getInstance());
    assertThat(Kernel32Library.getInstance().getCallbacks().size(),equalTo(1));
  }
 else {
    assertNotNull(Kernel32Library.getInstance());
    assertThat(Kernel32Library.getInstance().getCallbacks().size(),equalTo(0));
    try {
      Kernel32Library.getInstance().addConsoleCtrlHandler(handler);
      fail("should have thrown an unsupported operation exception");
    }
 catch (    UnsatisfiedLinkError e) {
    }
  }
}
