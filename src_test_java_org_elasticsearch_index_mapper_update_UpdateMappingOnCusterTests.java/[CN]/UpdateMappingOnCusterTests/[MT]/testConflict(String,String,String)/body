{
  assertAcked(prepareCreate(INDEX).setSource(mapping).get());
  ensureGreen(INDEX);
  GetMappingsResponse mappingsBeforeUpdateResponse=client().admin().indices().prepareGetMappings(INDEX).addTypes(TYPE).get();
  try {
    client().admin().indices().preparePutMapping(INDEX).setType(TYPE).setSource(mappingUpdate).get();
    fail();
  }
 catch (  MergeMappingException e) {
    for (    String errorMessage : errorMessages) {
      assertThat(e.getDetailedMessage(),containsString(errorMessage));
    }
  }
  compareMappingOnNodes(mappingsBeforeUpdateResponse);
}
