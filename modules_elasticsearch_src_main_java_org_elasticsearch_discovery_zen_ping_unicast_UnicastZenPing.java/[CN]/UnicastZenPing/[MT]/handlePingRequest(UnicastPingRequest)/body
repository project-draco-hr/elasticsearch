{
  temporalResponses.add(request.pingResponse);
  threadPool.schedule(new Runnable(){
    @Override public void run(){
      temporalResponses.remove(request.pingResponse);
    }
  }
,TimeValue.timeValueMillis(request.timeout.millis() * 2),ThreadPool.ExecutionType.DEFAULT);
  List<PingResponse> pingResponses=newArrayList(temporalResponses);
  DiscoveryNodes discoNodes=nodesProvider.nodes();
  pingResponses.add(new PingResponse(discoNodes.localNode(),discoNodes.masterNode(),clusterName));
  UnicastPingResponse unicastPingResponse=new UnicastPingResponse();
  unicastPingResponse.id=request.id;
  unicastPingResponse.pingResponses=pingResponses.toArray(new PingResponse[pingResponses.size()]);
  return unicastPingResponse;
}
