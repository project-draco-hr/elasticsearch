{
  ListenableActionFuture<IndexResponse> addFuture=addDocument(documentId);
  internalEngine.waitUntilIndexOperationReceived();
  internalEngine.letIndexOperationBegin();
  internalEngine.waitUntilIndexOperationFinished();
  internalEngine.letIndexOperationReturn();
  waitUntilResponseReceived(addFuture);
}
