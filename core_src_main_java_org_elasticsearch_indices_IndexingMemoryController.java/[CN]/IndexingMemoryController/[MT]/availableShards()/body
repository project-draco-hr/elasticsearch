{
  List<IndexShard> availableShards=new ArrayList<>();
  for (  IndexService indexService : indicesService) {
    for (    IndexShard shard : indexService) {
      if (shard.canIndex() && CAN_WRITE_INDEX_BUFFER_STATES.contains(shard.state())) {
        availableShards.add(shard);
      }
    }
  }
  return availableShards;
}
