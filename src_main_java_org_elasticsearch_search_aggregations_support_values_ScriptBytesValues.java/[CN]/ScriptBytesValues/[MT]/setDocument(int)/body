{
  script.setNextDocId(docId);
  value=script.run();
  if (value == null) {
    iter=Iterators.emptyIterator();
    return 0;
  }
  if (value.getClass().isArray()) {
    final int length=Array.getLength(value);
    iter=new Iterator<Object>(){
      int i=0;
      @Override public boolean hasNext(){
        return i < length;
      }
      @Override public Object next(){
        return Array.get(value,i++);
      }
      @Override public void remove(){
        throw new UnsupportedOperationException();
      }
    }
;
    return length;
  }
  if (value instanceof Collection) {
    final Collection<?> coll=(Collection<?>)value;
    iter=coll.iterator();
    return coll.size();
  }
  iter=Iterators.singletonIterator(value);
  return 1;
}
