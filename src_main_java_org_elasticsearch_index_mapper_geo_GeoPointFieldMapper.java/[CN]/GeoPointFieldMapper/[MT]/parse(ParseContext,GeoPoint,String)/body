{
  if (fieldType().normalizeLat() || fieldType().normalizeLon()) {
    GeoUtils.normalizePoint(point,fieldType().normalizeLat(),fieldType().normalizeLon());
  }
  if (fieldType().validateLat()) {
    if (point.lat() > 90.0 || point.lat() < -90.0) {
      throw new IllegalArgumentException("illegal latitude value [" + point.lat() + "] for "+ name());
    }
  }
  if (fieldType().validateLon()) {
    if (point.lon() > 180.0 || point.lon() < -180) {
      throw new IllegalArgumentException("illegal longitude value [" + point.lon() + "] for "+ name());
    }
  }
  if (fieldType.indexOptions() != IndexOptions.NONE || fieldType.stored()) {
    Field field=new Field(fieldType.names().indexName(),Double.toString(point.lat()) + ',' + Double.toString(point.lon()),fieldType);
    context.doc().add(field);
  }
  if (fieldType().isGeohashEnabled()) {
    if (geohash == null) {
      geohash=GeoHashUtils.encode(point.lat(),point.lon());
    }
    addGeohashField(context,geohash);
  }
  if (fieldType().isLatLonEnabled()) {
    latMapper.parse(context.createExternalValueContext(point.lat()));
    lonMapper.parse(context.createExternalValueContext(point.lon()));
  }
  if (fieldType().hasDocValues()) {
    CustomGeoPointDocValuesField field=(CustomGeoPointDocValuesField)context.doc().getByKey(fieldType().names().indexName());
    if (field == null) {
      field=new CustomGeoPointDocValuesField(fieldType().names().indexName(),point.lat(),point.lon());
      context.doc().addWithKey(fieldType().names().indexName(),field);
    }
 else {
      field.add(point.lat(),point.lon());
    }
  }
  multiFields.parse(this,context);
}
