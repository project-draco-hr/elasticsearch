{
  out.writeVInt(p);
  if (algorithm.get(bucket) == LINEAR_COUNTING) {
    out.writeBoolean(LINEAR_COUNTING);
    final IntArray hashes=hashSet.values(bucket);
    boolean success=false;
    try {
      out.writeVLong(hashes.size());
      for (long i=0; i < hashes.size(); ++i) {
        out.writeInt(hashes.get(i));
      }
      success=true;
    }
  finally {
      Releasables.release(success,hashes);
    }
  }
 else {
    out.writeBoolean(HYPERLOGLOG);
    for (long i=bucket << p, end=i + m; i < end; ++i) {
      out.writeByte(runLens.get(i));
    }
  }
}
