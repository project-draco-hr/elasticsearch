{
  final GeoPointFieldData fieldData=(GeoPointFieldData)fieldDataCache.cache(GeoPointFieldDataType.TYPE,reader,fieldName);
  if (topLeft.lon > bottomRight.lon) {
    return new GetDocSet(reader.maxDoc()){
      @Override public boolean get(      int doc) throws IOException {
        if (!fieldData.hasValue(doc)) {
          return false;
        }
        if (fieldData.multiValued()) {
          GeoPoint[] points=fieldData.values(doc);
          for (          GeoPoint point : points) {
            if (point.lon() < 0) {
              if (-180.0 <= point.lon() && bottomRight.lon >= point.lon() && topLeft.lat >= point.lat() && bottomRight.lat <= point.lat()) {
                return true;
              }
            }
 else {
              if (topLeft.lon <= point.lon() && 180 >= point.lon() && topLeft.lat >= point.lat() && bottomRight.lat <= point.lat()) {
                return true;
              }
            }
          }
        }
 else {
          GeoPoint point=fieldData.value(doc);
          if (point.lon() < 0) {
            if (-180.0 <= point.lon() && bottomRight.lon >= point.lon() && topLeft.lat >= point.lat() && bottomRight.lat <= point.lat()) {
              return true;
            }
          }
 else {
            if (topLeft.lon <= point.lon() && 180 >= point.lon() && topLeft.lat >= point.lat() && bottomRight.lat <= point.lat()) {
              return true;
            }
          }
        }
        return false;
      }
    }
;
  }
 else {
    return new GetDocSet(reader.maxDoc()){
      @Override public boolean get(      int doc) throws IOException {
        if (!fieldData.hasValue(doc)) {
          return false;
        }
        if (fieldData.multiValued()) {
          GeoPoint[] points=fieldData.values(doc);
          for (          GeoPoint point : points) {
            if (topLeft.lon <= point.lon() && bottomRight.lon >= point.lon() && topLeft.lat >= point.lat() && bottomRight.lat <= point.lat()) {
              return true;
            }
          }
        }
 else {
          GeoPoint point=fieldData.value(doc);
          if (topLeft.lon <= point.lon() && bottomRight.lon >= point.lon() && topLeft.lat >= point.lat() && bottomRight.lat <= point.lat()) {
            return true;
          }
        }
        return false;
      }
    }
;
  }
}
