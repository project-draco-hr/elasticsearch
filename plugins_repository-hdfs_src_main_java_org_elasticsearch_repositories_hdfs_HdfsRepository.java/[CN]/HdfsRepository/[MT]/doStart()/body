{
  if (path == null) {
    throw new IllegalArgumentException("no 'path' defined for hdfs snapshot/restore");
  }
  try {
    fc=getFileContext();
    Path hdfsPath=SecurityUtils.execute(fc,new FcCallback<Path>(){
      @Override public Path doInHdfs(      FileContext fc) throws IOException {
        return fc.makeQualified(new Path(path));
      }
    }
);
    logger.debug("Using file-system [{}] for URI [{}], path [{}]",fc.getDefaultFileSystem(),fc.getDefaultFileSystem().getUri(),hdfsPath);
    blobStore=new HdfsBlobStore(settings,this,hdfsPath,threadPool);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  super.doStart();
}
