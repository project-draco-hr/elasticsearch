{
  final TokenStreamComponents source=new TokenStreamComponents(new PatternTokenizer(reader,pattern,-1));
  TokenStream result=null;
  if (lowercase) {
    result=new LowerCaseFilter(version,source.getTokenStream());
  }
  result=new StopFilter(version,(result == null) ? source.getTokenStream() : result,stopWords);
  return new TokenStreamComponents(source.getTokenizer(),result);
}
