{
  for (  String type : Arrays.asList("Byte","Int","Long","Float","Double","Object")) {
    BigArrays bigArrays=new BigArrays(ImmutableSettings.builder().put(BigArrays.MAX_SIZE_IN_BYTES_SETTING,Long.MAX_VALUE).build(),null);
    Method create=BigArrays.class.getMethod("new" + type + "Array",long.class);
    final int size=scaledRandomIntBetween(5,1 << 16);
    BigArray array=(BigArray)create.invoke(bigArrays,size);
    assertEquals(array.ramBytesUsed(),bigArrays.sizeInBytes());
    Method resize=BigArrays.class.getMethod("resize",array.getClass().getInterfaces()[0],long.class);
    int newSize=scaledRandomIntBetween(5,1 << 16);
    array=(BigArray)resize.invoke(bigArrays,array,newSize);
    assertEquals(array.ramBytesUsed(),bigArrays.sizeInBytes());
    array.close();
    assertEquals(0,bigArrays.sizeInBytes());
  }
}
