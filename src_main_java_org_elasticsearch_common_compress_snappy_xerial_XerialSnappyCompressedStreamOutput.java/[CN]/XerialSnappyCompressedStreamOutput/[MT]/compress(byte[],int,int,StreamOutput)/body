{
  int compressedLength=Snappy.rawCompress(data,offset,len,compressedBuffer,0);
  if (compressedLength >= (len - (len / 8))) {
    out.writeBoolean(false);
    out.writeVInt(len);
    out.writeBytes(data,offset,len);
  }
 else {
    out.writeBoolean(true);
    out.writeVInt(compressedLength);
    out.writeBytes(compressedBuffer,0,compressedLength);
  }
}
