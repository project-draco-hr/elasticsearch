{
  XContentParser.Token token;
  String currentFieldName=null;
  while ((token=parser.nextToken()) != XContentParser.Token.END_OBJECT) {
switch (token) {
case FIELD_NAME:
      currentFieldName=parser.currentName();
    break;
case START_ARRAY:
  if ("pipelines".equals(currentFieldName)) {
    Map<String,PipelineConfiguration> pipelines=new HashMap<>();
    while ((token=parser.nextToken()) != XContentParser.Token.END_ARRAY) {
      if (token == XContentParser.Token.START_OBJECT) {
        PipelineConfiguration pipeline=new PipelineConfiguration(parser);
        pipelines.put(pipeline.getId(),pipeline);
      }
    }
    return new IngestMetadata(pipelines);
  }
break;
}
}
return PROTO;
}
