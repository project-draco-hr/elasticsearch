{
  int detailLevel=getPrefixTree().getMaxLevelForPrecision(shape,getDistanceErrorPct());
  List<Node> nodes=getPrefixTree().getNodes(shape,detailLevel,false);
  BooleanQuery query=new BooleanQuery();
  query.add(new MatchAllDocsQuery(),BooleanClause.Occur.SHOULD);
  for (  Node node : nodes) {
    query.add(new TermQuery(getFieldName().createIndexNameTerm(node.getTokenString())),BooleanClause.Occur.MUST_NOT);
  }
  return new ConstantScoreQuery(query);
}
