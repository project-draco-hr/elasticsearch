{
  int detailLevel=getPrefixTree().getLevelForDistance(calcDistanceFromErrPct(shape,getDistanceErrorPct(),GeoShapeConstants.SPATIAL_CONTEXT));
  List<Node> nodes=getPrefixTree().getNodes(shape,detailLevel,false);
  Term[] nodeTerms=new Term[nodes.size()];
  for (int i=0; i < nodes.size(); i++) {
    nodeTerms[i]=getFieldName().createIndexNameTerm(nodes.get(i).getTokenString());
  }
  return new XTermsFilter(nodeTerms);
}
