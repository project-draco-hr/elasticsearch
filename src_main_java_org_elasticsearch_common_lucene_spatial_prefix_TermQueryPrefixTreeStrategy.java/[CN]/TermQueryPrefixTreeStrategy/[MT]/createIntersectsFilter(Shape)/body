{
  int detailLevel=getPrefixTree().getLevelForDistance(calcDistanceFromErrPct(shape,getDistanceErrorPct(),GeoShapeConstants.SPATIAL_CONTEXT));
  List<Node> nodes=getPrefixTree().getNodes(shape,detailLevel,false);
  BytesRef[] nodeTerms=new BytesRef[nodes.size()];
  for (int i=0; i < nodes.size(); i++) {
    nodeTerms[i]=new BytesRef(nodes.get(i).getTokenString());
  }
  return new TermsFilter(getFieldName().indexName(),nodeTerms);
}
