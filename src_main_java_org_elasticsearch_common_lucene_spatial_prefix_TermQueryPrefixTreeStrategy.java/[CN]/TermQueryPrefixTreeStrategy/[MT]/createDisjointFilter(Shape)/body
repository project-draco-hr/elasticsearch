{
  int detailLevel=getPrefixTree().getLevelForDistance(calcDistanceFromErrPct(shape,getDistanceErrorPct(),GeoShapeConstants.SPATIAL_CONTEXT));
  List<Node> nodes=getPrefixTree().getNodes(shape,detailLevel,false);
  XBooleanFilter filter=new XBooleanFilter();
  for (  Node node : nodes) {
    filter.add(new TermFilter(getFieldName().createIndexNameTerm(node.getTokenString())),BooleanClause.Occur.MUST_NOT);
  }
  return filter;
}
