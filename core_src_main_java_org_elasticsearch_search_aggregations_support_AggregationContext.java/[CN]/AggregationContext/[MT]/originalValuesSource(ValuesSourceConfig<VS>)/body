{
  if (config.fieldContext == null) {
    if (ValuesSource.Numeric.class.isAssignableFrom(config.valueSourceType)) {
      return (VS)numericScript(config);
    }
    if (ValuesSource.Bytes.class.isAssignableFrom(config.valueSourceType)) {
      return (VS)bytesScript(config);
    }
    throw new AggregationExecutionException("value source of type [" + config.valueSourceType.getSimpleName() + "] is not supported by scripts");
  }
  if (ValuesSource.Numeric.class.isAssignableFrom(config.valueSourceType)) {
    return (VS)numericField(config);
  }
  if (ValuesSource.GeoPoint.class.isAssignableFrom(config.valueSourceType)) {
    return (VS)geoPointField(config);
  }
  return (VS)bytesField(config);
}
