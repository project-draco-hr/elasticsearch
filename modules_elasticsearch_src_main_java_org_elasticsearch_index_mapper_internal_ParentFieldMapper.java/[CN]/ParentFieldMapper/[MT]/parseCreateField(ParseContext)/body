{
  if (context.parser().currentName() != null && context.parser().currentName().equals(Defaults.NAME)) {
    String parentId=context.parser().text();
    return new Field(names.indexName(),Uid.createUid(context.stringBuilder(),type,parentId),store,index);
  }
  String parsedParentId=context.doc().get(Defaults.NAME);
  if (context.externalValueSet()) {
    String parentId=(String)context.externalValue();
    if (parsedParentId == null) {
      if (parentId == null) {
        throw new MapperParsingException("No parent id provided, not within the document, and not externally");
      }
      return new Field(names.indexName(),Uid.createUid(context.stringBuilder(),type,parentId),store,index);
    }
 else     if (parentId != null && !parsedParentId.equals(Uid.createUid(context.stringBuilder(),type,parentId))) {
      throw new MapperParsingException("Parent id mismatch, document value is [" + Uid.createUid(parsedParentId).id() + "], while external value is ["+ parentId+ "]");
    }
  }
  return null;
}
