{
  while (token != XContentParser.Token.END_OBJECT) {
    ObjectMapper newUpdate=null;
    if (token == XContentParser.Token.START_OBJECT) {
      newUpdate=parseObject(context,mapper,currentFieldName);
    }
 else     if (token == XContentParser.Token.START_ARRAY) {
      newUpdate=parseArray(context,mapper,currentFieldName);
    }
 else     if (token == XContentParser.Token.FIELD_NAME) {
      currentFieldName=parser.currentName();
    }
 else     if (token == XContentParser.Token.VALUE_NULL) {
      parseNullValue(context,mapper,currentFieldName);
    }
 else     if (token == null) {
      throw new MapperParsingException("object mapping for [" + mapper.name() + "] tried to parse field ["+ currentFieldName+ "] as object, but got EOF, has a concrete value been provided to it?");
    }
 else     if (token.isValue()) {
      newUpdate=parseValue(context,mapper,currentFieldName,token);
    }
    token=parser.nextToken();
    if (newUpdate != null) {
      if (update == null) {
        update=newUpdate;
      }
 else {
        update=update.merge(newUpdate,false);
      }
    }
  }
  return update;
}
