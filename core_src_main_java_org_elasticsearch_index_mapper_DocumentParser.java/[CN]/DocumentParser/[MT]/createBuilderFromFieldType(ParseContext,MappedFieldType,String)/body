{
  Mapper.Builder builder=null;
  if (fieldType instanceof StringFieldType) {
    builder=context.root().findTemplateBuilder(context,currentFieldName,"string","string");
    if (builder == null) {
      builder=new StringFieldMapper.Builder(currentFieldName);
    }
  }
 else   if (fieldType instanceof TextFieldType) {
    builder=context.root().findTemplateBuilder(context,currentFieldName,"text","string");
    if (builder == null) {
      builder=new TextFieldMapper.Builder(currentFieldName).addMultiField(new KeywordFieldMapper.Builder("keyword").ignoreAbove(256));
    }
  }
 else   if (fieldType instanceof KeywordFieldType) {
    builder=context.root().findTemplateBuilder(context,currentFieldName,"keyword","string");
    if (builder == null) {
      builder=new KeywordFieldMapper.Builder(currentFieldName);
    }
  }
 else {
switch (fieldType.typeName()) {
case "date":
      builder=context.root().findTemplateBuilder(context,currentFieldName,"date");
    if (builder == null) {
      builder=newDateBuilder(currentFieldName,null,Version.indexCreated(context.indexSettings()));
    }
  break;
case "long":
builder=context.root().findTemplateBuilder(context,currentFieldName,"long");
if (builder == null) {
builder=newLongBuilder(currentFieldName,Version.indexCreated(context.indexSettings()));
}
break;
case "double":
builder=context.root().findTemplateBuilder(context,currentFieldName,"double");
if (builder == null) {
builder=newDoubleBuilder(currentFieldName,Version.indexCreated(context.indexSettings()));
}
break;
case "integer":
builder=context.root().findTemplateBuilder(context,currentFieldName,"integer");
if (builder == null) {
builder=newIntBuilder(currentFieldName,Version.indexCreated(context.indexSettings()));
}
break;
case "float":
builder=context.root().findTemplateBuilder(context,currentFieldName,"float");
if (builder == null) {
builder=newFloatBuilder(currentFieldName,Version.indexCreated(context.indexSettings()));
}
break;
default :
break;
}
}
return builder;
}
