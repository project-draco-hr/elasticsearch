{
  Map<String,Object> transformed;
  try (XContentParser autoCloses=parser){
    transformed=transformSourceAsMap(mapping,parser.mapOrdered());
  }
   XContentBuilder builder=XContentFactory.contentBuilder(parser.contentType()).value(transformed);
  return parser.contentType().xContent().createParser(builder.bytes());
}
