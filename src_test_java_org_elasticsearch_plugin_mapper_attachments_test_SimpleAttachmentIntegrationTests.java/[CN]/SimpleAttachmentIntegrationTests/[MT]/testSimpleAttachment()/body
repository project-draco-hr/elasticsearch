{
  String mapping=copyToStringFromClasspath("/org/elasticsearch/index/mapper/xcontent/test-mapping.json");
  byte[] html=copyToBytesFromClasspath("/org/elasticsearch/index/mapper/xcontent/testXHTML.html");
  client().admin().indices().putMapping(putMappingRequest("test").type("person").source(mapping)).actionGet();
  index("test","person",jsonBuilder().startObject().field("file",html).endObject());
  refresh();
  CountResponse countResponse=client().count(countRequest("test").query(fieldQuery("file.title","test document"))).actionGet();
  assertThat(countResponse.getCount(),equalTo(1l));
  countResponse=client().count(countRequest("test").query(fieldQuery("file","tests the ability"))).actionGet();
  assertThat(countResponse.getCount(),equalTo(1l));
}
