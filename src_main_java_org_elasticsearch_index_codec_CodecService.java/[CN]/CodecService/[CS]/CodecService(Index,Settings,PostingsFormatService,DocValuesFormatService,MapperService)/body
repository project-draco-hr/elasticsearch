{
  super(index,indexSettings);
  this.postingsFormatService=postingsFormatService;
  this.docValuesFormatService=docValuesFormatService;
  this.mapperService=mapperService;
  MapBuilder<String,Codec> codecs=MapBuilder.<String,Codec>newMapBuilder();
  if (mapperService == null) {
    codecs.put(DEFAULT_CODEC,new Lucene50Codec());
    codecs.put(BEST_COMPRESSION_CODEC,new Lucene50Codec(Mode.BEST_COMPRESSION));
  }
 else {
    codecs.put(DEFAULT_CODEC,new PerFieldMappingPostingFormatCodec(Mode.BEST_SPEED,mapperService,postingsFormatService.get(PostingsFormatService.DEFAULT_FORMAT).get(),docValuesFormatService.get(DocValuesFormatService.DEFAULT_FORMAT).get(),logger));
    codecs.put(BEST_COMPRESSION_CODEC,new PerFieldMappingPostingFormatCodec(Mode.BEST_COMPRESSION,mapperService,postingsFormatService.get(PostingsFormatService.DEFAULT_FORMAT).get(),docValuesFormatService.get(DocValuesFormatService.DEFAULT_FORMAT).get(),logger));
  }
  for (  String codec : Codec.availableCodecs()) {
    codecs.put(codec,Codec.forName(codec));
  }
  this.codecs=codecs.immutableMap();
}
