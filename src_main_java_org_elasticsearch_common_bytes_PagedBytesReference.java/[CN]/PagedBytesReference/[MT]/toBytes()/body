{
  if (length == 0) {
    return BytesRef.EMPTY_BYTES;
  }
  BytesRef ref=new BytesRef();
  bytearray.get(offset,length,ref);
  byte[] result=ref.bytes;
  if (result.length != length || ref.offset != 0) {
    result=Arrays.copyOfRange(result,ref.offset,ref.offset + length);
  }
  return result;
}
