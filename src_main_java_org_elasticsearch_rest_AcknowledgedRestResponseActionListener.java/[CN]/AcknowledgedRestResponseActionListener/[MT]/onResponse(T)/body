{
  try {
    XContentBuilder builder=RestXContentBuilder.restContentBuilder(request);
    builder.startObject().field(Fields.ACKNOWLEDGED,response.isAcknowledged());
    addCustomFields(builder,response);
    builder.endObject();
    channel.sendResponse(new XContentRestResponse(request,OK,builder));
  }
 catch (  IOException e) {
    onFailure(e);
  }
}
