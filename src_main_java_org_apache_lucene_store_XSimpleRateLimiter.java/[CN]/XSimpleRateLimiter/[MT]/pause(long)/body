{
  if (bytes == 1) {
    return 0;
  }
  final long targetNS=lastNS=lastNS + ((long)(bytes * nsPerByte));
  final long startNs;
  long curNS=startNs=System.nanoTime();
  if (lastNS < curNS) {
    lastNS=curNS;
  }
  while (true) {
    final long pauseNS=targetNS - curNS;
    if (pauseNS > 0) {
      try {
        Thread.sleep((int)(pauseNS / 1000000),(int)(pauseNS % 1000000));
      }
 catch (      InterruptedException ie) {
        throw new ThreadInterruptedException(ie);
      }
      curNS=System.nanoTime();
      continue;
    }
    break;
  }
  return curNS - startNs;
}
