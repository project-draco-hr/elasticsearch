{
  String enabledMapping=XContentFactory.jsonBuilder().startObject().startObject("type").startObject("_routing").field("store","no").field("index","no").endObject().endObject().endObject().string();
  Settings indexSettings=Settings.builder().put(IndexMetaData.SETTING_VERSION_CREATED,Version.V_1_4_2.id).build();
  DocumentMapper enabledMapper=createIndex("test",indexSettings).mapperService().documentMapperParser().parse("type",new CompressedXContent(enabledMapping));
  XContentBuilder builder=JsonXContent.contentBuilder().startObject();
  enabledMapper.routingFieldMapper().toXContent(builder,ToXContent.EMPTY_PARAMS).endObject();
  builder.close();
  Map<String,Object> serializedMap;
  try (XContentParser parser=JsonXContent.jsonXContent.createParser(builder.bytes())){
    serializedMap=parser.map();
  }
   assertThat(serializedMap,hasKey("_routing"));
  assertThat(serializedMap.get("_routing"),instanceOf(Map.class));
  Map<String,Object> routingConfiguration=(Map<String,Object>)serializedMap.get("_routing");
  assertThat(routingConfiguration,hasKey("store"));
  assertThat(routingConfiguration.get("store").toString(),is("false"));
  assertThat(routingConfiguration,hasKey("index"));
  assertThat(routingConfiguration.get("index").toString(),is("no"));
}
