{
  if (owningBucketOrdinal >= maxes.size()) {
    long from=maxes.size();
    maxes=BigArrays.grow(maxes,owningBucketOrdinal + 1);
    maxes.fill(from,maxes.size(),Double.NEGATIVE_INFINITY);
  }
  final int valueCount=values.setDocument(doc);
  double max=maxes.get(owningBucketOrdinal);
  for (int i=0; i < valueCount; i++) {
    max=Math.max(max,values.nextValue());
  }
  maxes.set(owningBucketOrdinal,max);
}
