{
  while (cumulation.readable()) {
    if (cumulation.readableBytes() < 4) {
      break;
    }
    int dataLen=cumulation.getInt(cumulation.readerIndex());
    if (dataLen <= 0) {
      throw new StreamCorruptedException("invalid data length: " + dataLen);
    }
    int actualSize=dataLen + 4;
    if (cumulation.readableBytes() < actualSize) {
      return actualSize;
    }
    cumulation.skipBytes(4);
    process(context,channel,cumulation,dataLen);
  }
  if (!cumulation.readable()) {
    this.cumulation=null;
  }
  return 0;
}
