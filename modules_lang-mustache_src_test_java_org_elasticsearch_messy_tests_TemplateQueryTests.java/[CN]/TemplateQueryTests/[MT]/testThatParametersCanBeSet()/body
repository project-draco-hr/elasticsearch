{
  index("test","type","1",jsonBuilder().startObject().field("theField","foo").endObject());
  index("test","type","2",jsonBuilder().startObject().field("theField","foo 2").endObject());
  index("test","type","3",jsonBuilder().startObject().field("theField","foo 3").endObject());
  index("test","type","4",jsonBuilder().startObject().field("theField","foo 4").endObject());
  index("test","type","5",jsonBuilder().startObject().field("otherField","foo").endObject());
  refresh();
  Map<String,Object> templateParams=new HashMap<>();
  templateParams.put("mySize","2");
  templateParams.put("myField","theField");
  templateParams.put("myValue","foo");
  SearchTemplateResponse searchResponse=new SearchTemplateRequestBuilder(client()).setRequest(new SearchRequest("test").types("type")).setScript("full-query-template").setScriptType(ScriptType.FILE).setScriptParams(templateParams).get();
  assertHitCount(searchResponse.getResponse(),4);
  assertThat(searchResponse.getResponse().getHits().getHits().length,is(2));
  templateParams.put("myField","otherField");
  searchResponse=new SearchTemplateRequestBuilder(client()).setRequest(new SearchRequest("test").types("type")).setScript("full-query-template").setScriptType(ScriptType.FILE).setScriptParams(templateParams).get();
  assertHitCount(searchResponse.getResponse(),1);
}
