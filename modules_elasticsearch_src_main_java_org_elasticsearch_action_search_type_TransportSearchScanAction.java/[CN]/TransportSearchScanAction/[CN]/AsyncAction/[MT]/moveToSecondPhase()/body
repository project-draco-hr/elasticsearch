{
  long totalHits=0;
  for (  ScanSearchResult scanSearchResult : scanResults.values()) {
    totalHits+=scanSearchResult.totalHits();
  }
  final InternalSearchResponse internalResponse=new InternalSearchResponse(new InternalSearchHits(InternalSearchHits.EMPTY,totalHits,0.0f),null,false);
  String scrollId=null;
  if (request.scroll() != null) {
    scrollId=TransportSearchHelper.buildScrollId(request.searchType(),scanResults.values());
  }
  listener.onResponse(new SearchResponse(internalResponse,scrollId,expectedSuccessfulOps,successulOps.get(),buildTookInMillis(),buildShardFailures()));
}
