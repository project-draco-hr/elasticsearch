{
  IndexSearcher contextSearcher=context.searchContext().searcher();
  if (searcher != contextSearcher) {
    searcher=contextSearcher;
    Query filter=this.filter.toQuery(context.searchContext().indexShard().getQueryShardContext());
    weight=contextSearcher.createNormalizedWeight(filter,false);
  }
  return new FilterAggregator(name,weight,factories,context,parent,pipelineAggregators,metaData);
}
