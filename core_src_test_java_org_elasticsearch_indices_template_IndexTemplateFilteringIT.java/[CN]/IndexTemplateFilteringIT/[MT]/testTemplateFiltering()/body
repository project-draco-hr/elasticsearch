{
  client().admin().indices().preparePutTemplate("template1").setTemplate("test*").addMapping("type1","field1","type=string").get();
  client().admin().indices().preparePutTemplate("template2").setTemplate("test*").addMapping("type2","field2","type=string").get();
  client().admin().indices().preparePutTemplate("template3").setTemplate("no_match").addMapping("type3","field3","type=string").get();
  assertAcked(prepareCreate("test"));
  GetMappingsResponse response=client().admin().indices().prepareGetMappings("test").get();
  assertThat(response,notNullValue());
  ImmutableOpenMap<String,MappingMetaData> metadata=response.getMappings().get("test");
  assertThat(metadata.size(),is(1));
  assertThat(metadata.get("type2"),notNullValue());
}
