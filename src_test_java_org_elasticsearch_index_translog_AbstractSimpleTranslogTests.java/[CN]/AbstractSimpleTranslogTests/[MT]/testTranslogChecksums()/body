{
  List<Translog.Location> locations=newArrayList();
  int translogOperations=randomIntBetween(10,100);
  for (int op=0; op < translogOperations; op++) {
    String ascii=randomAsciiOfLengthBetween(1,50);
    locations.add(translog.add(new Translog.Create("test","" + op,ascii.getBytes("UTF-8"))));
  }
  translog.sync();
  corruptTranslogs(translogFileDirectory());
  AtomicInteger corruptionsCaught=new AtomicInteger(0);
  for (  Translog.Location location : locations) {
    try {
      TranslogStreams.readSource(translog.read(location));
    }
 catch (    TranslogCorruptedException e) {
      corruptionsCaught.incrementAndGet();
    }
  }
  assertThat("at least one corruption was caused and caught",corruptionsCaught.get(),greaterThanOrEqualTo(1));
}
