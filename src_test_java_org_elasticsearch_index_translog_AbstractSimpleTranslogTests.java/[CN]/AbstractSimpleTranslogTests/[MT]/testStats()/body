{
  TranslogStats stats=stats();
  assertThat(stats.estimatedNumberOfOperations(),equalTo(0l));
  long lastSize=stats.translogSizeInBytes().bytes();
  assertThat(lastSize,equalTo(17l));
  translog.add(new Translog.Create("test","1",new byte[]{1}));
  stats=stats();
  assertThat(stats.estimatedNumberOfOperations(),equalTo(1l));
  assertThat(stats.translogSizeInBytes().bytes(),greaterThan(lastSize));
  lastSize=stats.translogSizeInBytes().bytes();
  translog.add(new Translog.Index("test","2",new byte[]{2}));
  stats=stats();
  assertThat(stats.estimatedNumberOfOperations(),equalTo(2l));
  assertThat(stats.translogSizeInBytes().bytes(),greaterThan(lastSize));
  lastSize=stats.translogSizeInBytes().bytes();
  translog.add(new Translog.Delete(newUid("3")));
  stats=stats();
  assertThat(stats.estimatedNumberOfOperations(),equalTo(3l));
  assertThat(stats.translogSizeInBytes().bytes(),greaterThan(lastSize));
  lastSize=stats.translogSizeInBytes().bytes();
  translog.add(new Translog.DeleteByQuery(new BytesArray(new byte[]{4}),null));
  stats=stats();
  assertThat(stats.estimatedNumberOfOperations(),equalTo(4l));
  assertThat(stats.translogSizeInBytes().bytes(),greaterThan(lastSize));
  translog.newTranslog(2);
  stats=stats();
  assertThat(stats.estimatedNumberOfOperations(),equalTo(0l));
  assertThat(stats.translogSizeInBytes().bytes(),equalTo(17l));
}
