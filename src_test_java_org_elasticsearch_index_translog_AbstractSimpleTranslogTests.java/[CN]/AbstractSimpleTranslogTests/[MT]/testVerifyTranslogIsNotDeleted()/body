{
  Path path=translogFileDirectory();
  assertTrue(Files.exists(path.resolve("translog-1")));
  translog.add(new Translog.Create("test","1",new byte[]{1}));
  Translog.Snapshot snapshot=translog.snapshot();
  assertThat(snapshot,TranslogSizeMatcher.translogSize(1));
  assertThat(snapshot.estimatedTotalOperations(),equalTo(1));
  if (randomBoolean()) {
    translog.close();
    snapshot.close();
  }
 else {
    snapshot.close();
    translog.close();
  }
  assertTrue(Files.exists(path.resolve("translog-1")));
}
