{
  Translog.Snapshot snapshot=translog.snapshot();
  MatcherAssert.assertThat(snapshot,TranslogSizeMatcher.translogSize(0));
  snapshot.release();
  translog.add(new Translog.Create("test","1",new byte[]{1}));
  snapshot=translog.snapshot();
  MatcherAssert.assertThat(snapshot,TranslogSizeMatcher.translogSize(1));
  assertThat(snapshot.estimatedTotalOperations(),equalTo(1));
  snapshot.release();
  translog.newTransientTranslog(2);
  snapshot=translog.snapshot();
  MatcherAssert.assertThat(snapshot,TranslogSizeMatcher.translogSize(1));
  assertThat(snapshot.estimatedTotalOperations(),equalTo(1));
  snapshot.release();
  translog.add(new Translog.Index("test","2",new byte[]{2}));
  snapshot=translog.snapshot();
  MatcherAssert.assertThat(snapshot,TranslogSizeMatcher.translogSize(2));
  assertThat(snapshot.estimatedTotalOperations(),equalTo(2));
  snapshot.release();
  translog.makeTransientCurrent();
  snapshot=translog.snapshot();
  MatcherAssert.assertThat(snapshot,TranslogSizeMatcher.translogSize(1));
  assertThat(snapshot.estimatedTotalOperations(),equalTo(1));
  snapshot.release();
}
