{
  Translog.Snapshot snapshot=translog.snapshot();
  MatcherAssert.assertThat(snapshot,TranslogSizeMatcher.translogSize(0));
  snapshot.close();
  translog.add(new Translog.Create("test","1",new byte[]{1}));
  snapshot=translog.snapshot();
  MatcherAssert.assertThat(snapshot,TranslogSizeMatcher.translogSize(1));
  while (snapshot.next() != null) {
  }
  long lastPosition=snapshot.position();
  snapshot.close();
  translog.add(new Translog.Create("test","2",new byte[]{1}));
  snapshot=translog.snapshot();
  snapshot.seekTo(lastPosition);
  MatcherAssert.assertThat(snapshot,TranslogSizeMatcher.translogSize(1));
  snapshot.close();
  snapshot=translog.snapshot();
  snapshot.seekTo(lastPosition);
  Translog.Create create=(Translog.Create)snapshot.next();
  assertThat(create != null,equalTo(true));
  assertThat(create.id(),equalTo("2"));
  snapshot.close();
}
