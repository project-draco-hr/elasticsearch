{
  String enabledMapping=XContentFactory.jsonBuilder().startObject().startObject("type").startObject("_field_names").field("enabled",true).endObject().endObject().endObject().string();
  String disabledMapping=XContentFactory.jsonBuilder().startObject().startObject("type").startObject("_field_names").field("enabled",false).endObject().endObject().endObject().string();
  DocumentMapperParser parser=createIndex("test").mapperService().documentMapperParser();
  DocumentMapper mapperEnabled=parser.parse(enabledMapping);
  DocumentMapper mapperDisabled=parser.parse(disabledMapping);
  mapperEnabled.merge(mapperDisabled,DocumentMapper.MergeFlags.mergeFlags().simulate(false));
  assertFalse(mapperEnabled.rootMapper(FieldNamesFieldMapper.class).enabled());
  mapperEnabled=parser.parse(enabledMapping);
  mapperDisabled.merge(mapperEnabled,DocumentMapper.MergeFlags.mergeFlags().simulate(false));
  assertTrue(mapperEnabled.rootMapper(FieldNamesFieldMapper.class).enabled());
}
