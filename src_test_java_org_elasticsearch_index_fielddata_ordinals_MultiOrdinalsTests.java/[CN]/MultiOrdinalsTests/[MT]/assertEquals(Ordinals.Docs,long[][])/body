{
  long numOrds=0;
  for (int doc=0; doc < ordinalPlan.length; ++doc) {
    if (ordinalPlan[doc].length > 0) {
      numOrds=Math.max(numOrds,ordinalPlan[doc][ordinalPlan[doc].length - 1]);
    }
  }
  assertThat(docs.getNumDocs(),equalTo(ordinalPlan.length));
  assertThat(docs.getNumOrds(),equalTo(numOrds));
  assertThat(docs.getMaxOrd(),equalTo(numOrds + 1));
  assertThat(docs.isMultiValued(),equalTo(true));
  for (int doc=0; doc < ordinalPlan.length; ++doc) {
    LongsRef ref=docs.getOrds(doc);
    assertThat(ref.offset,equalTo(0));
    long[] ords=ordinalPlan[doc];
    assertThat(ref,equalTo(new LongsRef(ords,0,ords.length)));
    assertIter(docs.getIter(doc),ords);
  }
}
