{
  Query query=queryBuilder.toQuery(context);
  Query filter=filterBuilder.toFilter(context);
  if (query == null) {
    return null;
  }
  if (filter == null || Queries.isConstantMatchAllQuery(filter)) {
    return query;
  }
 else   if (Queries.isConstantMatchAllQuery(query)) {
    return new ConstantScoreQuery(filter);
  }
  return Queries.filtered(query,filter);
}
