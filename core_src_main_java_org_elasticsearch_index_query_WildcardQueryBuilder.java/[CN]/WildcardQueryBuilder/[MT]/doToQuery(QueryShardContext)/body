{
  String indexFieldName;
  BytesRef valueBytes;
  MappedFieldType fieldType=context.fieldMapper(fieldName);
  if (fieldType != null) {
    indexFieldName=fieldType.names().indexName();
    valueBytes=fieldType.indexedValueForSearch(value);
  }
 else {
    indexFieldName=fieldName;
    valueBytes=new BytesRef(value);
  }
  WildcardQuery query=new WildcardQuery(new Term(indexFieldName,valueBytes));
  MultiTermQuery.RewriteMethod rewriteMethod=QueryParsers.parseRewriteMethod(context.parseFieldMatcher(),rewrite,null);
  QueryParsers.setRewriteMethod(query,rewriteMethod);
  return query;
}
