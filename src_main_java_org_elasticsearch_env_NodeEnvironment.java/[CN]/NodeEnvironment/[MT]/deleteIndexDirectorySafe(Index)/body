{
  final List<ShardLock> locks=lockAllForIndex(index);
  try {
    final Path[] indexPaths=new Path[nodeIndicesPaths.length];
    for (int i=0; i < indexPaths.length; i++) {
      indexPaths[i]=nodeIndicesPaths[i].resolve(index.name());
    }
    IOUtils.rm(indexPaths);
  }
  finally {
    IOUtils.closeWhileHandlingException(locks);
  }
}
