{
  if (nodeFiles == null || locks == null) {
    throw new ElasticSearchIllegalStateException("node is not configured to store local location");
  }
  Set<ShardId> shardIds=Sets.newHashSet();
  for (  File indicesLocation : nodeIndicesLocations) {
    File[] indicesList=indicesLocation.listFiles();
    if (indicesList == null) {
      continue;
    }
    for (    File indexLocation : indicesList) {
      if (!indexLocation.isDirectory()) {
        continue;
      }
      String indexName=indexLocation.getName();
      File[] shardsList=indexLocation.listFiles();
      if (shardsList == null) {
        continue;
      }
      for (      File shardLocation : shardsList) {
        if (!shardLocation.isDirectory()) {
          continue;
        }
        shardIds.add(new ShardId(indexName,Integer.parseInt(shardLocation.getName())));
      }
    }
  }
  return shardIds;
}
