{
  int docCounter=0;
  IndexReader[] memoryIndices=new IndexReader[parsedDocument.docs().size()];
  for (  ParseContext.Document d : parsedDocument.docs()) {
    memoryIndices[docCounter]=indexDoc(d,parsedDocument.analyzer()).createSearcher().getIndexReader();
    docCounter++;
  }
  MultiReader mReader=new MultiReader(memoryIndices,true);
  try {
    AtomicReader slowReader=SlowCompositeReaderWrapper.wrap(mReader);
    DocSearcher docSearcher=new DocSearcher(new IndexSearcher(slowReader));
    context.initialize(docSearcher,parsedDocument);
  }
 catch (  IOException e) {
    throw new ElasticsearchException("Failed to create index for percolator with nested document ",e);
  }
}
