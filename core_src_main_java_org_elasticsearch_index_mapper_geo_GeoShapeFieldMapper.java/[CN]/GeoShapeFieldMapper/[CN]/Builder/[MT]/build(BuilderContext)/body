{
  GeoShapeFieldType geoShapeFieldType=(GeoShapeFieldType)fieldType;
  if (geoShapeFieldType.tree.equals("quadtree") && context.indexCreatedVersion().before(Version.V_2_0_0)) {
    geoShapeFieldType.setTree("legacyquadtree");
  }
  if (context.indexCreatedVersion().before(Version.V_2_0_0) || (geoShapeFieldType.treeLevels() == 0 && geoShapeFieldType.precisionInMeters() < 0)) {
    geoShapeFieldType.setDefaultDistanceErrorPct(Defaults.LEGACY_DISTANCE_ERROR_PCT);
  }
  setupFieldType(context);
  return new GeoShapeFieldMapper(name,fieldType,context.indexSettings(),multiFieldsBuilder.build(this,context),copyTo);
}
