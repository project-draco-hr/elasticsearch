{
  SearchResponse response=client().prepareSearch("range_idx").addAggregation(ipRange("range").field("ip").addMaskRange("0.0.0.0/0")).execute().actionGet();
  assertSearchResponse(response);
  Range range=response.getAggregations().get("range");
  assertThat(range,notNullValue());
  assertThat(range.getName(),equalTo("range"));
  List<? extends Bucket> buckets=range.getBuckets();
  assertThat(range.getBuckets().size(),equalTo(1));
  Range.Bucket bucket=buckets.get(0);
  assertEquals(4l,bucket.getDocCount());
}
