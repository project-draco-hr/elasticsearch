{
  createIndex("test");
  NodesInfoResponse nodesInfo=client().admin().cluster().prepareNodesInfo().execute().actionGet();
  Settings settings=Settings.settingsBuilder().put("node.name","transport_client_" + getTestName()).put("client.transport.ignore_cluster_name",true).build();
  for (  NodeInfo n : nodesInfo.getNodes()) {
    TransportClient tc=TransportClient.builder().settings(settings).build().addTransportAddress(n.getNode().address());
    NodesStatsRequestBuilder nsBuilder=tc.admin().cluster().prepareNodesStats();
    Class c=nsBuilder.getClass();
    for (    Method method : c.getDeclaredMethods()) {
      if (method.getName().startsWith("set")) {
        if (method.getParameterTypes().length == 1 && method.getParameterTypes()[0] == boolean.class) {
          method.invoke(nsBuilder,randomBoolean());
        }
      }
 else       if ((method.getName().equals("all") || method.getName().equals("clear")) && randomBoolean()) {
        method.invoke(nsBuilder);
      }
    }
    NodesStatsResponse ns=nsBuilder.execute().actionGet();
    tc.close();
  }
}
