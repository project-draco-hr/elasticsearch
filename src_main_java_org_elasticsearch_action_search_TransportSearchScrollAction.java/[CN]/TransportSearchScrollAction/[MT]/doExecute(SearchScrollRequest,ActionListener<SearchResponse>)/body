{
  try {
    ParsedScrollId scrollId=parseScrollId(request.scrollId());
    if (scrollId.getType().equals(QUERY_THEN_FETCH_TYPE)) {
      queryThenFetchAction.execute(request,scrollId,listener);
    }
 else     if (scrollId.getType().equals(QUERY_AND_FETCH_TYPE)) {
      queryAndFetchAction.execute(request,scrollId,listener);
    }
 else     if (scrollId.getType().equals(SCAN)) {
      scanAction.execute(request,scrollId,listener);
    }
 else {
      throw new ElasticsearchIllegalArgumentException("Scroll id type [" + scrollId.getType() + "] unrecognized");
    }
  }
 catch (  Throwable e) {
    listener.onFailure(e);
  }
}
