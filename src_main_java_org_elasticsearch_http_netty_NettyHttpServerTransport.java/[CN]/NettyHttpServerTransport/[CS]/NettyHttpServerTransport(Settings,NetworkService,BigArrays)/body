{
  super(settings);
  this.networkService=networkService;
  this.bigArrays=bigArrays;
  if (settings.getAsBoolean("netty.epollBugWorkaround",false)) {
    System.setProperty("org.jboss.netty.epollBugWorkaround","true");
  }
  ByteSizeValue maxContentLength=settings.getAsBytesSize("http.netty.max_content_length",settings.getAsBytesSize("http.max_content_length",new ByteSizeValue(100,ByteSizeUnit.MB)));
  this.maxChunkSize=settings.getAsBytesSize("http.netty.max_chunk_size",settings.getAsBytesSize("http.max_chunk_size",new ByteSizeValue(8,ByteSizeUnit.KB)));
  this.maxHeaderSize=settings.getAsBytesSize("http.netty.max_header_size",settings.getAsBytesSize("http.max_header_size",new ByteSizeValue(8,ByteSizeUnit.KB)));
  this.maxInitialLineLength=settings.getAsBytesSize("http.netty.max_initial_line_length",settings.getAsBytesSize("http.max_initial_line_length",new ByteSizeValue(4,ByteSizeUnit.KB)));
  this.resetCookies=settings.getAsBoolean("http.netty.reset_cookies",settings.getAsBoolean("http.reset_cookies",false));
  this.maxCumulationBufferCapacity=settings.getAsBytesSize("http.netty.max_cumulation_buffer_capacity",null);
  this.maxCompositeBufferComponents=settings.getAsInt("http.netty.max_composite_buffer_components",-1);
  this.workerCount=settings.getAsInt("http.netty.worker_count",EsExecutors.boundedNumberOfProcessors(settings) * 2);
  this.blockingServer=settings.getAsBoolean("http.netty.http.blocking_server",settings.getAsBoolean(TCP_BLOCKING_SERVER,settings.getAsBoolean(TCP_BLOCKING,false)));
  this.port=settings.get("http.netty.port",settings.get("http.port","9200-9300"));
  this.bindHost=settings.get("http.netty.bind_host",settings.get("http.bind_host",settings.get("http.host")));
  this.publishHost=settings.get("http.netty.publish_host",settings.get("http.publish_host",settings.get("http.host")));
  this.publishPort=settings.getAsInt("http.netty.publish_port",settings.getAsInt("http.publish_port",0));
  this.tcpNoDelay=settings.get("http.netty.tcp_no_delay",settings.get(TCP_NO_DELAY,"true"));
  this.tcpKeepAlive=settings.get("http.netty.tcp_keep_alive",settings.get(TCP_KEEP_ALIVE,"true"));
  this.reuseAddress=settings.getAsBoolean("http.netty.reuse_address",settings.getAsBoolean(TCP_REUSE_ADDRESS,NetworkUtils.defaultReuseAddress()));
  this.tcpSendBufferSize=settings.getAsBytesSize("http.netty.tcp_send_buffer_size",settings.getAsBytesSize(TCP_SEND_BUFFER_SIZE,TCP_DEFAULT_SEND_BUFFER_SIZE));
  this.tcpReceiveBufferSize=settings.getAsBytesSize("http.netty.tcp_receive_buffer_size",settings.getAsBytesSize(TCP_RECEIVE_BUFFER_SIZE,TCP_DEFAULT_RECEIVE_BUFFER_SIZE));
  this.detailedErrorsEnabled=settings.getAsBoolean(SETTING_HTTP_DETAILED_ERRORS_ENABLED,true);
  long defaultReceiverPredictor=512 * 1024;
  if (JvmInfo.jvmInfo().mem().directMemoryMax().bytes() > 0) {
    long l=(long)((0.3 * JvmInfo.jvmInfo().mem().directMemoryMax().bytes()) / workerCount);
    defaultReceiverPredictor=Math.min(defaultReceiverPredictor,Math.max(l,64 * 1024));
  }
  ByteSizeValue receivePredictorMin=settings.getAsBytesSize("http.netty.receive_predictor_min",settings.getAsBytesSize("http.netty.receive_predictor_size",new ByteSizeValue(defaultReceiverPredictor)));
  ByteSizeValue receivePredictorMax=settings.getAsBytesSize("http.netty.receive_predictor_max",settings.getAsBytesSize("http.netty.receive_predictor_size",new ByteSizeValue(defaultReceiverPredictor)));
  if (receivePredictorMax.bytes() == receivePredictorMin.bytes()) {
    receiveBufferSizePredictorFactory=new FixedReceiveBufferSizePredictorFactory((int)receivePredictorMax.bytes());
  }
 else {
    receiveBufferSizePredictorFactory=new AdaptiveReceiveBufferSizePredictorFactory((int)receivePredictorMin.bytes(),(int)receivePredictorMin.bytes(),(int)receivePredictorMax.bytes());
  }
  this.compression=settings.getAsBoolean(SETTING_HTTP_COMPRESSION,false);
  this.compressionLevel=settings.getAsInt(SETTING_HTTP_COMPRESSION_LEVEL,6);
  this.pipelining=settings.getAsBoolean(SETTING_PIPELINING,DEFAULT_SETTING_PIPELINING);
  this.pipeliningMaxEvents=settings.getAsInt(SETTING_PIPELINING_MAX_EVENTS,DEFAULT_SETTING_PIPELINING_MAX_EVENTS);
  if (maxContentLength.bytes() > Integer.MAX_VALUE) {
    logger.warn("maxContentLength[" + maxContentLength + "] set to high value, resetting it to [100mb]");
    maxContentLength=new ByteSizeValue(100,ByteSizeUnit.MB);
  }
  this.maxContentLength=maxContentLength;
  logger.debug("using max_chunk_size[{}], max_header_size[{}], max_initial_line_length[{}], max_content_length[{}], receive_predictor[{}->{}], pipelining[{}], pipelining_max_events[{}]",maxChunkSize,maxHeaderSize,maxInitialLineLength,this.maxContentLength,receivePredictorMin,receivePredictorMax,pipelining,pipeliningMaxEvents);
}
