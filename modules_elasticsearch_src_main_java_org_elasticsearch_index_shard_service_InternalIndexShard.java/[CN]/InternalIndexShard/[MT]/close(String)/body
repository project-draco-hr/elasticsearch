{
synchronized (mutex) {
    if (state != IndexShardState.CLOSED) {
      if (refreshScheduledFuture != null) {
        refreshScheduledFuture.cancel(true);
        refreshScheduledFuture=null;
      }
      if (optimizeScheduleFuture != null) {
        optimizeScheduleFuture.cancel(true);
        optimizeScheduleFuture=null;
      }
    }
    logger.debug("state: [{}]->[{}], reason [{}]",state,IndexShardState.CLOSED,reason);
    state=IndexShardState.CLOSED;
  }
}
