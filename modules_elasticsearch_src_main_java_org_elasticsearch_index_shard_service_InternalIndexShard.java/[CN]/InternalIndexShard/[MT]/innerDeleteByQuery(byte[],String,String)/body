{
  IndexQueryParser queryParser=queryParserService.defaultIndexQueryParser();
  if (queryParserName != null) {
    queryParser=queryParserService.indexQueryParser(queryParserName);
    if (queryParser == null) {
      throw new IndexQueryParserMissingException(queryParserName);
    }
  }
  Query query=queryParser.parse(querySource).query();
  query=filterByTypesIfNeeded(query,types);
  if (logger.isTraceEnabled()) {
    logger.trace("delete_by_query [{}]",query);
  }
  engine.delete(new Engine.DeleteByQuery(query,querySource,queryParserName,types));
}
