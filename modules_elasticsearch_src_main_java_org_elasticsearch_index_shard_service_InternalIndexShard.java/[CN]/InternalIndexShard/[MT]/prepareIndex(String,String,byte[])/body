{
  DocumentMapper docMapper=mapperService.type(type);
  if (docMapper == null) {
    throw new DocumentMapperNotFoundException("No mapper found for type [" + type + "]");
  }
  ParsedDocument doc=docMapper.parse(type,id,source);
  return new Engine.Index(docMapper.uidMapper().term(doc.uid()),doc,docMapper.mappers().indexAnalyzer());
}
