{
  if (withFlush) {
    engine.flush(new Engine.Flush());
  }
  if (checkIndex) {
    checkIndex(true);
  }
synchronized (mutex) {
    logger.debug("state: [{}]->[{}]",state,IndexShardState.STARTED);
    state=IndexShardState.STARTED;
  }
  scheduleRefresherIfNeeded();
  engine.refresh(new Engine.Refresh(true));
}
