{
  DocumentMapper docMapper=mapperService.type(source.type());
  if (docMapper == null) {
    throw new DocumentMapperNotFoundException("No mapper found for type [" + source.type() + "]");
  }
  ParsedDocument doc=docMapper.parse(source);
  return new Engine.Index(docMapper.uidMapper().term(doc.uid()),doc);
}
