{
synchronized (mutex) {
    if (this.state != IndexShardState.RECOVERING) {
      throw new IndexShardNotRecoveringException(shardId,state);
    }
    logger.debug("state: [{}]->[{}], restored after recovery",state,stateToRestore);
    this.state=stateToRestore;
  }
  return this;
}
