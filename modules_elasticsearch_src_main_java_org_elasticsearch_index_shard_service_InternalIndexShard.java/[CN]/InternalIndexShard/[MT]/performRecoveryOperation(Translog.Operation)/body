{
  if (state != IndexShardState.RECOVERING) {
    throw new IndexShardNotRecoveringException(shardId,state);
  }
switch (operation.opType()) {
case CREATE:
    Translog.Create create=(Translog.Create)operation;
  innerCreate(create.type(),create.id(),create.source());
break;
case SAVE:
Translog.Index index=(Translog.Index)operation;
innerIndex(index.type(),index.id(),index.source());
break;
case DELETE:
Translog.Delete delete=(Translog.Delete)operation;
innerDelete(delete.uid());
break;
case DELETE_BY_QUERY:
Translog.DeleteByQuery deleteByQuery=(Translog.DeleteByQuery)operation;
innerDeleteByQuery(deleteByQuery.source(),deleteByQuery.queryParserName(),deleteByQuery.types());
break;
default :
throw new ElasticSearchIllegalStateException("No operation defined for [" + operation + "]");
}
}
