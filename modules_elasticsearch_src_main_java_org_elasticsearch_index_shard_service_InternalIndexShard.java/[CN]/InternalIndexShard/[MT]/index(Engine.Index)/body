{
  writeAllowed();
  if (listeners != null) {
    for (    OperationListener listener : listeners) {
      index=listener.beforeIndex(index);
    }
  }
  if (logger.isTraceEnabled()) {
    logger.trace("index {}",index.doc());
  }
  engine.index(index);
  return index.parsedDoc();
}
