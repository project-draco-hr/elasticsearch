{
  DocumentMapper docMapper=mapperService.type(type);
  if (docMapper == null) {
    throw new DocumentMapperNotFoundException("No mapper found for type [" + type + "]");
  }
  ParsedDocument doc=docMapper.parse(type,id,source);
  if (logger.isTraceEnabled()) {
    logger.trace("index {}",doc);
  }
  engine.create(new Engine.Create(doc.doc(),docMapper.mappers().indexAnalyzer(),docMapper.type(),doc.id(),doc.source()));
  return doc;
}
