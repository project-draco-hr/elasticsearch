{
  super(settings);
  this.indicesService=indicesService;
  final long maxReuseBytes=settings.getAsBytesSize("indices.memory.memory_index.size_per_thread",new ByteSizeValue(1,ByteSizeUnit.MB)).bytes();
  cache=new CloseableThreadLocal<MemoryIndex>(){
    @Override protected MemoryIndex initialValue(){
      return new ExtendedMemoryIndex(false,maxReuseBytes);
    }
  }
;
}
