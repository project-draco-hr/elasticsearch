{
  long orderId=mappingUpdatedAction.generateNextMappingUpdateOrder();
  documentMapper.refreshSource();
  DiscoveryNode node=clusterService.localNode();
  final MappingUpdatedAction.MappingUpdatedRequest mappingRequest=new MappingUpdatedAction.MappingUpdatedRequest(request.index(),indexUUID,request.documentType(),documentMapper.mappingSource(),orderId,node != null ? node.id() : null);
  logger.trace("Sending mapping updated to master: {}",mappingRequest);
  mappingUpdatedAction.execute(mappingRequest,new ActionListener<MappingUpdatedAction.MappingUpdatedResponse>(){
    @Override public void onResponse(    MappingUpdatedAction.MappingUpdatedResponse mappingUpdatedResponse){
      logger.debug("Successfully updated master with mapping update: {}",mappingRequest);
    }
    @Override public void onFailure(    Throwable e){
      logger.warn("Failed to update master on updated mapping for {}",e,mappingRequest);
    }
  }
);
}
