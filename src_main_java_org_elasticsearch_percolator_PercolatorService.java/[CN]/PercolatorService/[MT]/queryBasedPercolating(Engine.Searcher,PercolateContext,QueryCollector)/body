{
  Filter percolatorTypeFilter=context.indexService().mapperService().documentMapper(TYPE_NAME).typeFilter();
  final Filter filter;
  if (context.aliasFilter() != null) {
    BooleanQuery booleanFilter=new BooleanQuery();
    booleanFilter.add(context.aliasFilter(),BooleanClause.Occur.MUST);
    booleanFilter.add(percolatorTypeFilter,BooleanClause.Occur.MUST);
    filter=new QueryWrapperFilter(booleanFilter);
  }
 else {
    filter=percolatorTypeFilter;
  }
  FilteredQuery query=new FilteredQuery(context.percolateQuery(),filter);
  percolatorSearcher.searcher().search(query,percolateCollector);
  percolateCollector.aggregatorCollector.postCollection();
  if (context.aggregations() != null) {
    aggregationPhase.execute(context);
  }
}
