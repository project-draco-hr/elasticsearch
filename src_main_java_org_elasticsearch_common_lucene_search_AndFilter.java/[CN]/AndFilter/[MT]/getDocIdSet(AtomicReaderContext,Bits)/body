{
  if (filters.size() == 1) {
    return filters.get(0).getDocIdSet(context,null);
  }
  List sets=Lists.newArrayListWithExpectedSize(filters.size());
  boolean allAreDocSet=true;
  for (  Filter filter : filters) {
    DocIdSet set=filter.getDocIdSet(context,null);
    if (set == null) {
      return DocSet.EMPTY_DOC_SET;
    }
    if (!(set instanceof DocSet)) {
      allAreDocSet=false;
    }
    sets.add(set);
  }
  if (allAreDocSet) {
    return new AndDocSet(sets);
  }
  return new AndDocIdSet(sets);
}
