{
  String masterId=state.getState().nodes().masterNodeId();
  Table table=new Table();
  table.startHeaders();
  table.addCell("id");
  table.addCell("pid");
  table.addCell("ip");
  table.addCell("port");
  table.addCell("jdk");
  table.addCell("diskfree","text-align:right;");
  table.addCell("heapmax","text-align:right;");
  table.addCell("memmax","text-align:right;");
  table.addCell("uptime","text-align:right;");
  table.addCell("data/client");
  table.addCell("master");
  table.addCell("node");
  table.endHeaders();
  for (  DiscoveryNode node : state.getState().nodes()) {
    NodeInfo info=nodesInfo.getNodesMap().get(node.id());
    NodeStats stats=nodesStats.getNodesMap().get(node.id());
    long availableDisk=-1;
    if (!(stats.getFs() == null)) {
      availableDisk=0;
      Iterator<FsStats.Info> it=stats.getFs().iterator();
      while (it.hasNext()) {
        availableDisk+=it.next().getAvailable().bytes();
      }
    }
    table.startRow();
    table.addCell(node.id());
    table.addCell(info.getProcess().id());
    table.addCell(((InetSocketTransportAddress)node.address()).address().getAddress().getHostAddress());
    table.addCell(((InetSocketTransportAddress)node.address()).address().getPort());
    table.addCell(info.getJvm().version());
    table.addCell(availableDisk < 0 ? null : ByteSizeValue.parseBytesSizeValue(new Long(availableDisk).toString()));
    table.addCell(info.getJvm().mem().heapMax());
    table.addCell(info.getOs().mem() == null ? null : info.getOs().mem().total());
    table.addCell(stats.getJvm().uptime());
    table.addCell(node.clientNode() ? "c" : node.dataNode() ? "d" : null);
    table.addCell(masterId.equals(node.id()) ? "*" : node.masterNode() ? "m" : null);
    table.addCell(node.name());
    table.endRow();
  }
  return table;
}
