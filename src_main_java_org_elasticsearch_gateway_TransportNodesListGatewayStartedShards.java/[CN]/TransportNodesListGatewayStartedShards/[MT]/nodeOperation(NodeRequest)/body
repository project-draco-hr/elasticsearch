{
  try {
    ShardId shardId=request.shardId;
    IndexMetaData indexMetaData=clusterService.state().getMetaData().indices().get(shardId.getIndex());
    Settings indexSettings=indexMetaData == null ? ImmutableSettings.EMPTY : indexMetaData.settings();
    ShardStateInfo shardStateInfo=shardsState.loadShardInfo(request.shardId,indexSettings);
    if (shardStateInfo != null) {
      return new NodeGatewayStartedShards(clusterService.localNode(),shardStateInfo.version);
    }
    return new NodeGatewayStartedShards(clusterService.localNode(),-1);
  }
 catch (  Exception e) {
    throw new ElasticsearchException("failed to load started shards",e);
  }
}
