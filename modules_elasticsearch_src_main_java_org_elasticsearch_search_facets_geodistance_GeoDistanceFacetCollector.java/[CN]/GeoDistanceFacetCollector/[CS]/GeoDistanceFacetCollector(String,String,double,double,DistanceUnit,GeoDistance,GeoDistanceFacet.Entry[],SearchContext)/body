{
  super(facetName);
  this.fieldName=fieldName;
  this.lat=lat;
  this.lon=lon;
  this.unit=unit;
  this.entries=entries;
  this.geoDistance=geoDistance;
  this.fieldDataCache=context.fieldDataCache();
  MapperService.SmartNameFieldMappers smartMappers=context.mapperService().smartName(fieldName + XContentGeoPointFieldMapper.Names.LAT_SUFFIX);
  if (smartMappers == null || !smartMappers.hasMapper()) {
    throw new FacetPhaseExecutionException(facetName,"No mapping found for field [" + fieldName + "]");
  }
  if (smartMappers.hasDocMapper()) {
    setFilter(context.filterCache().cache(new TermFilter(smartMappers.docMapper().typeMapper().term(smartMappers.docMapper().type()))));
  }
  this.indexLatFieldName=smartMappers.mapper().names().indexName();
  FieldMapper mapper=context.mapperService().smartNameFieldMapper(fieldName + XContentGeoPointFieldMapper.Names.LON_SUFFIX);
  if (mapper == null) {
    throw new FacetPhaseExecutionException(facetName,"No mapping found for field [" + fieldName + "]");
  }
  this.indexLonFieldName=mapper.names().indexName();
  this.fieldDataType=mapper.fieldDataType();
}
