{
  DocsStats docsStats=new DocsStats();
  StoreStats storeStats=new StoreStats();
  IndexingStats indexingStats=new IndexingStats();
  CacheStats cacheStats=new CacheStats();
  MergeStats mergeStats=new MergeStats();
  RefreshStats refreshStats=new RefreshStats();
  FlushStats flushStats=new FlushStats();
  if (includePrevious) {
    indexingStats.add(oldShardsStats.indexingStats);
    mergeStats.add(oldShardsStats.mergeStats);
    refreshStats.add(oldShardsStats.refreshStats);
    flushStats.add(oldShardsStats.flushStats);
  }
  for (  IndexService indexService : indices.values()) {
    for (    IndexShard indexShard : indexService) {
      storeStats.add(indexShard.storeStats());
      docsStats.add(indexShard.docStats());
      indexingStats.add(indexShard.indexingStats());
      mergeStats.add(indexShard.mergeStats());
      refreshStats.add(indexShard.refreshStats());
      flushStats.add(indexShard.flushStats());
    }
    cacheStats.add(indexService.cache().stats());
  }
  return new NodeIndicesStats(storeStats,docsStats,indexingStats,cacheStats,mergeStats,refreshStats,flushStats);
}
