{
  Settings settings=EMPTY_SETTINGS;
  Environment environment=new Environment(settings);
  ShardId shardId=new ShardId("test",1);
  AnalysisService analysisService=new AnalysisService(shardId.index());
  MapperService mapperService=new MapperService(shardId.index(),settings,environment,analysisService);
  IndexQueryParserService queryParserService=new IndexQueryParserService(shardId.index(),mapperService,new NoneFilterCache(shardId.index(),EMPTY_SETTINGS),analysisService);
  FilterCache filterCache=new NoneFilterCache(shardId.index(),settings);
  SnapshotDeletionPolicy policy=new SnapshotDeletionPolicy(new KeepOnlyLastDeletionPolicy(shardId,settings));
  Store store=new RamStore(shardId,settings);
  MemoryTranslog translog=new MemoryTranslog(shardId,settings);
  Engine engine=new RobinEngine(shardId,settings,store,policy,translog,new LogByteSizeMergePolicyProvider(store),new SerialMergeSchedulerProvider(shardId,settings),analysisService,new SimilarityService(shardId.index()));
  threadPool=new DynamicThreadPool();
  indexShard=new InternalIndexShard(shardId,EMPTY_SETTINGS,store,engine,translog,threadPool,mapperService,queryParserService,filterCache).start();
}
