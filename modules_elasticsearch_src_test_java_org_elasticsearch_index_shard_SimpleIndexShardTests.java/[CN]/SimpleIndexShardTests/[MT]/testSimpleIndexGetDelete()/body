{
  String source1="{ type1 : { _id : \"1\", name : \"test\", age : 35 } }";
  indexShard.index("type1","1",Unicode.fromStringAsBytes(source1));
  indexShard.refresh(new Engine.Refresh(true));
  String sourceFetched=Unicode.fromBytes(indexShard.get("type1","1"));
  assertThat(sourceFetched,equalTo(source1));
  assertThat(indexShard.count(0,termQuery("age",35).buildAsBytes(),null),equalTo(1l));
  assertThat(indexShard.count(0,queryString("name:test").buildAsBytes(),null),equalTo(1l));
  assertThat(indexShard.count(0,queryString("age:35").buildAsBytes(),null),equalTo(1l));
  indexShard.delete("type1","1");
  indexShard.refresh(new Engine.Refresh(true));
  assertThat(indexShard.get("type1","1"),nullValue());
  indexShard.index("type1","1",Unicode.fromStringAsBytes(source1));
  indexShard.refresh(new Engine.Refresh(true));
  sourceFetched=Unicode.fromBytes(indexShard.get("type1","1"));
  assertThat(sourceFetched,equalTo(source1));
  indexShard.deleteByQuery(termQuery("name","test").buildAsBytes(),null);
  indexShard.refresh(new Engine.Refresh(true));
  assertThat(indexShard.get("type1","1"),nullValue());
  indexShard.close();
}
