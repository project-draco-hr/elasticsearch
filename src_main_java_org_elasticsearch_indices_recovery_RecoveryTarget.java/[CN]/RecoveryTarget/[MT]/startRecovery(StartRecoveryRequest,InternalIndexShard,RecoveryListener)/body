{
  try {
    indexShard.recovering("from " + request.sourceNode());
  }
 catch (  IllegalIndexShardStateException e) {
    listener.onIgnoreRecovery(false,"already in recovering process, " + e.getMessage());
    return;
  }
  final RecoveryStatus recoveryStatus=new RecoveryStatus(request.recoveryId(),indexShard);
  recoveryStatus.recoveryState.setType(request.recoveryType());
  recoveryStatus.recoveryState.setSourceNode(request.sourceNode());
  recoveryStatus.recoveryState.setTargetNode(request.targetNode());
  recoveryStatus.recoveryState.setPrimary(indexShard.routingEntry().primary());
  onGoingRecoveries.put(recoveryStatus.recoveryId,recoveryStatus);
  threadPool.generic().execute(new Runnable(){
    @Override public void run(){
      doRecovery(request,recoveryStatus,listener);
    }
  }
);
}
