{
  if (onGoingRecovery == null) {
    throw new IndexShardClosedException(shardId);
  }
  if (onGoingRecovery.indexShard.state() == IndexShardState.CLOSED) {
    removeAndCleanOnGoingRecovery(onGoingRecovery);
    onGoingRecovery.sentCanceledToSource=true;
    throw new IndexShardClosedException(shardId);
  }
  if (onGoingRecovery.isCanceled()) {
    onGoingRecovery.sentCanceledToSource=true;
    throw new IndexShardClosedException(shardId);
  }
}
