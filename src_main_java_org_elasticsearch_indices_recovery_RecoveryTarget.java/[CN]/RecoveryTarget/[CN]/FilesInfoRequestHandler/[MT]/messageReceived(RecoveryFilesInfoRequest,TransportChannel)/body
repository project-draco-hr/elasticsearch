{
  InternalIndexShard shard=(InternalIndexShard)indicesService.indexServiceSafe(request.shardId.index().name()).shardSafe(request.shardId.id());
  RecoveryStatus onGoingRecovery=onGoingRecoveries.get(shard.shardId());
  if (onGoingRecovery == null) {
    throw new IndexShardClosedException(shard.shardId());
  }
  if (onGoingRecovery.canceled) {
    onGoingRecovery.sentCanceledToSource=true;
    throw new IndexShardClosedException(shard.shardId());
  }
  onGoingRecovery.phase1FileNames=request.phase1FileNames;
  onGoingRecovery.phase1FileSizes=request.phase1FileSizes;
  onGoingRecovery.phase1ExistingFileNames=request.phase1ExistingFileNames;
  onGoingRecovery.phase1ExistingFileSizes=request.phase1ExistingFileSizes;
  onGoingRecovery.phase1TotalSize=request.phase1TotalSize;
  onGoingRecovery.phase1ExistingTotalSize=request.phase1ExistingTotalSize;
  onGoingRecovery.stage=RecoveryStatus.Stage.INDEX;
  channel.sendResponse(VoidStreamable.INSTANCE);
}
