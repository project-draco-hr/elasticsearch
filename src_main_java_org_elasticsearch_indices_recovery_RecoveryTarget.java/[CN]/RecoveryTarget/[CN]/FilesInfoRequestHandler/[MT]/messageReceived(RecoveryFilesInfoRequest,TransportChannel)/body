{
  RecoveryStatus onGoingRecovery=onGoingRecoveries.get(request.recoveryId());
  validateRecoveryStatus(onGoingRecovery,request.shardId());
  final RecoveryState.Index index=onGoingRecovery.recoveryState().getIndex();
  index.addFileDetails(request.phase1FileNames,request.phase1FileSizes);
  index.addReusedFileDetails(request.phase1ExistingFileNames,request.phase1ExistingFileSizes);
  index.totalByteCount(request.phase1TotalSize);
  index.totalFileCount(request.phase1FileNames.size() + request.phase1ExistingFileNames.size());
  index.reusedByteCount(request.phase1ExistingTotalSize);
  index.reusedFileCount(request.phase1ExistingFileNames.size());
  onGoingRecovery.stage(RecoveryState.Stage.INDEX);
  channel.sendResponse(TransportResponse.Empty.INSTANCE);
}
