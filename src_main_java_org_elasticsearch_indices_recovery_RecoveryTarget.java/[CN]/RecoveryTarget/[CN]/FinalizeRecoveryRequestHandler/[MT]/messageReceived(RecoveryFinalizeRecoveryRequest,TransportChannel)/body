{
  RecoveryStatus onGoingRecovery=onGoingRecoveries.get(request.recoveryId());
  validateRecoveryStatus(onGoingRecovery,request.shardId());
  onGoingRecovery.stage(RecoveryState.Stage.FINALIZE);
  onGoingRecovery.indexShard.performRecoveryFinalization(false,onGoingRecovery);
  onGoingRecovery.recoveryState().getTimer().time(System.currentTimeMillis() - onGoingRecovery.recoveryState().getTimer().startTime());
  onGoingRecovery.stage(RecoveryState.Stage.DONE);
  channel.sendResponse(TransportResponse.Empty.INSTANCE);
}
