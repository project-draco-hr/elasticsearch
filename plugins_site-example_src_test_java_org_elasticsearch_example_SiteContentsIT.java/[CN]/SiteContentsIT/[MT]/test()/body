{
  TestCluster cluster=cluster();
  assumeTrue("this test will not work from an IDE unless you pass tests.cluster pointing to a running instance",cluster instanceof ExternalTestCluster);
  ExternalTestCluster externalCluster=(ExternalTestCluster)cluster;
  try (CloseableHttpClient httpClient=HttpClients.createMinimal(new PoolingHttpClientConnectionManager(15,TimeUnit.SECONDS))){
    for (    InetSocketAddress address : externalCluster.httpAddresses()) {
      RestResponse restResponse=new RestResponse(new HttpRequestBuilder(httpClient).host(address.getHostName()).port(address.getPort()).path("/_plugin/site-example/").method("GET").execute());
      assertEquals(200,restResponse.getStatusCode());
      String body=restResponse.getBodyAsString();
      assertTrue("unexpected body contents: " + body,body.contains("<body>Page body</body>"));
    }
  }
 }
