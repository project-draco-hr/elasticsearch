{
  XContentParser parser=JsonXContent.jsonXContent.createParser(brokenJson);
  try {
    new RestApiParser().parse(parser);
    fail("Expected to fail parsing but did not happen");
  }
 catch (  IOException e) {
    assertThat(e.getMessage(),containsString(expectedErrorMessage));
  }
}
