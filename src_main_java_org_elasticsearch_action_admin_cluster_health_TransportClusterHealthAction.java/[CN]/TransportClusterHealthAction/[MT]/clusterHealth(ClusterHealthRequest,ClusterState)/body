{
  if (logger.isTraceEnabled()) {
    logger.trace("Calculating health based on state version [{}]",clusterState.version());
  }
  String[] concreteIndices;
  try {
    concreteIndices=clusterState.metaData().concreteIndices(request.indices(),IndicesOptions.IGNORE_UNAVAILABLE_EXPAND_OPEN_ONLY);
  }
 catch (  IndexMissingException e) {
    ClusterHealthResponse response=new ClusterHealthResponse(clusterName.value(),Strings.EMPTY_ARRAY,clusterState);
    response.status=ClusterHealthStatus.RED;
    return response;
  }
  return new ClusterHealthResponse(clusterName.value(),concreteIndices,clusterState);
}
