{
  if (logger.isTraceEnabled()) {
    logger.trace("Calculating health based on state version [{}]",clusterState.version());
  }
  String[] concreteIndices;
  try {
    concreteIndices=clusterState.metaData().concreteIndices(request.indicesOptions(),request.indices());
  }
 catch (  IndexMissingException e) {
    ClusterHealthResponse response=new ClusterHealthResponse(clusterName.value(),Strings.EMPTY_ARRAY,clusterState,numberOfPendingTasks);
    response.status=ClusterHealthStatus.RED;
    return response;
  }
  return new ClusterHealthResponse(clusterName.value(),concreteIndices,clusterState,numberOfPendingTasks);
}
