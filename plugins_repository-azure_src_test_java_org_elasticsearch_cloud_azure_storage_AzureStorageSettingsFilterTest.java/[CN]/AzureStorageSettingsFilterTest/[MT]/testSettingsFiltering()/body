{
  SettingsFilter settingsFilter=new SettingsFilter(Settings.EMPTY);
  new AzureStorageSettingsFilter(Settings.EMPTY,settingsFilter);
  Settings filteredSettings=SettingsFilter.filterSettings(settingsFilter.getPatterns(),settings);
  assertThat(filteredSettings.getAsMap().keySet(),contains("cloud.azure.storage.azure1.default"));
  RestRequest request=new FakeRestRequest();
  settingsFilter.addFilterSettingParams(request);
  XContentBuilder xContentBuilder=XContentBuilder.builder(JsonXContent.jsonXContent);
  xContentBuilder.startObject();
  settings.toXContent(xContentBuilder,request);
  xContentBuilder.endObject();
  String filteredSettingsString=xContentBuilder.string();
  filteredSettings=Settings.builder().loadFromSource(filteredSettingsString).build();
  assertThat(filteredSettings.getAsMap().keySet(),contains("cloud.azure.storage.azure1.default"));
}
