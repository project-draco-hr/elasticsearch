{
  try {
    Path translogFile=getDataPath("/org/elasticsearch/index/translog/translog-v1-truncated.binary");
    assertThat("test file should exist",Files.exists(translogFile),equalTo(true));
    try (ImmutableTranslogReader reader=openReader(translogFile,0)){
      try (final Translog.Snapshot snapshot=reader.newSnapshot()){
        while (snapshot.next() != null) {
        }
      }
     }
     fail("should have thrown an exception about the body being truncated");
  }
 catch (  TranslogCorruptedException e) {
    assertThat("translog truncated: " + e.getMessage(),e.getMessage().contains("operation size is corrupted must be"),equalTo(true));
  }
}
