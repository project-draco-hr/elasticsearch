{
  logger.debug("listBlobsByPrefix container [{}], keyPath [{}], prefix [{}]",container,keyPath,prefix);
  ImmutableMap.Builder<String,BlobMetaData> blobsBuilder=ImmutableMap.builder();
  CloudBlobContainer blob_container=client.getContainerReference(container);
  if (blob_container.exists()) {
    Iterable<ListBlobItem> blobs=blob_container.listBlobs(keyPath + prefix);
    for (    ListBlobItem blob : blobs) {
      URI uri=blob.getUri();
      if (logger.isTraceEnabled()) {
        logger.trace("blob url [{}]",uri);
      }
      String blobpath=uri.getPath().substring(container.length() + 1);
      BlobProperties properties=service.getBlobProperties(container,blobpath).getProperties();
      String name=blobpath.substring(keyPath.length() + 1);
      if (logger.isTraceEnabled()) {
        logger.trace("blob url [{}], name [{}], size [{}]",uri,name,properties.getContentLength());
      }
      blobsBuilder.put(name,new PlainBlobMetaData(name,properties.getContentLength()));
    }
  }
  return blobsBuilder.build();
}
