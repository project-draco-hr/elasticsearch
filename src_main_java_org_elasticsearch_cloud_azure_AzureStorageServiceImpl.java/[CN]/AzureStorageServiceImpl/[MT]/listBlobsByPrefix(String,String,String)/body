{
  logger.debug("listing container [{}], keyPath [{}], prefix [{}]",container,keyPath,prefix);
  ImmutableMap.Builder<String,BlobMetaData> blobsBuilder=ImmutableMap.builder();
  CloudBlobContainer blob_container=client.getContainerReference(container);
  if (blob_container.exists()) {
    for (    ListBlobItem blobItem : blob_container.listBlobs(keyPath + prefix)) {
      URI uri=blobItem.getUri();
      logger.trace("blob url [{}]",uri);
      String blobpath=uri.getPath().substring(container.length() + 1);
      BlobProperties properties=blob_container.getBlockBlobReference(blobpath).getProperties();
      String name=blobpath.substring(keyPath.length() + 1);
      logger.trace("blob url [{}], name [{}], size [{}]",uri,name,properties.getLength());
      blobsBuilder.put(name,new PlainBlobMetaData(name,properties.getLength()));
    }
  }
  return blobsBuilder.build();
}
