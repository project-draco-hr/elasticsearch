{
  SearchRequest searchRequest=new SearchRequest();
  searchRequest.indices("_all");
  String templateString="{" + "  \"inline\" : \"{ \\\"query\\\":{\\\"match_all\\\":{}} {{#use_size}}, \\\"size\\\": \\\"{{size}}\\\" {{/use_size}} }\"," + "  \"params\":{"+ "    \"size\": 1,"+ "    \"use_size\": true"+ "  }"+ "}";
  BytesReference bytesRef=new BytesArray(templateString);
  searchRequest.templateSource(bytesRef);
  SearchResponse searchResponse=client().search(searchRequest).get();
  assertThat(searchResponse.getHits().hits().length,equalTo(1));
}
