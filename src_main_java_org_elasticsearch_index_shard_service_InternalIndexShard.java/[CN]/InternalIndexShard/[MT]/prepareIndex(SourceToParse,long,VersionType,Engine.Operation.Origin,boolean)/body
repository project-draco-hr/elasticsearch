{
  long startTime=System.nanoTime();
  DocumentMapper docMapper=mapperService.documentMapperWithAutoCreate(source.type());
  ParsedDocument doc=docMapper.parse(source);
  return new Engine.Index(docMapper,docMapper.uidMapper().term(doc.uid().stringValue()),doc,version,versionType,origin,startTime,state != IndexShardState.STARTED || canHaveDuplicates);
}
