{
  verifyStartedOrRecovering();
  if (logger.isTraceEnabled()) {
    logger.trace("flush with {}",request);
  }
  long time=System.nanoTime();
  engine.flush(request.full() ? Engine.FlushType.NEW_WRITER : Engine.FlushType.COMMIT_TRANSLOG,request.force(),request.waitIfOngoing());
  flushMetric.inc(System.nanoTime() - time);
}
