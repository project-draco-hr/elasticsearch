{
  long startTime=System.nanoTime();
  if (types == null) {
    types=Strings.EMPTY_ARRAY;
  }
  Query query=queryParserService.parse(querySource.bytes(),querySource.offset(),querySource.length()).query();
  query=filterQueryIfNeeded(query,types);
  Filter aliasFilter=indexAliasesService.aliasFilter(filteringAliases);
  return new Engine.DeleteByQuery(query,querySource,filteringAliases,aliasFilter,types).startTime(startTime);
}
