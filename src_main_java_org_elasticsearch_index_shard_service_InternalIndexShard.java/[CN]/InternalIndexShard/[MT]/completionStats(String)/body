{
  CompletionStats completionStats=new CompletionStats();
  try {
    final Engine.Searcher currentSearcher=acquireSearcher();
    try {
      PostingsFormat postingsFormat=this.codecService.postingsFormatService().get(Completion090PostingsFormat.CODEC_NAME).get();
      if (postingsFormat instanceof Completion090PostingsFormat) {
        Completion090PostingsFormat completionPostingsFormat=(Completion090PostingsFormat)postingsFormat;
        completionStats.add(completionPostingsFormat.completionStats(currentSearcher.reader(),fields));
      }
    }
  finally {
      currentSearcher.release();
    }
  }
 catch (  Throwable e) {
    logger.debug("Can not build 'completion stats' from engine shard state [{}]",e,state);
  }
  return completionStats;
}
