{
  if (!running) {
    return;
  }
  transportService.sendRequest(node,PingRequestHandler.ACTION,new PingRequest(node.id()),pingRetryTimeout,new BaseTransportResponseHandler<PingResponse>(){
    @Override public PingResponse newInstance(){
      return new PingResponse();
    }
    @Override public void handleResponse(    PingResponse response){
      if (!running) {
        return;
      }
      NodeFD nodeFD=nodesFD.get(node);
      if (nodeFD != null) {
        nodeFD.retryCount=0;
        threadPool.schedule(SendPingRequest.this,pingInterval);
      }
    }
    @Override public void handleException(    RemoteTransportException exp){
      if (!running) {
        return;
      }
      NodeFD nodeFD=nodesFD.get(node);
      if (nodeFD != null) {
        int retryCount=++nodeFD.retryCount;
        logger.trace("Node [{}] failed to ping, retry [{}] out of [{}]",exp,node,retryCount,pingRetryCount);
        if (retryCount >= pingRetryCount) {
          logger.debug("Node [{}] failed to ping, tried [{}] times, each with [{}] timeout",node,pingRetryCount,pingRetryTimeout);
          if (nodesFD.remove(node) != null) {
            notifyNodeFailure(node,"failed to ping, tried [" + pingRetryCount + "] times, each with ["+ pingRetryTimeout+ "] timeout");
          }
        }
 else {
          transportService.sendRequest(node,PingRequestHandler.ACTION,new PingRequest(node.id()),pingRetryTimeout,this);
        }
      }
    }
  }
);
}
