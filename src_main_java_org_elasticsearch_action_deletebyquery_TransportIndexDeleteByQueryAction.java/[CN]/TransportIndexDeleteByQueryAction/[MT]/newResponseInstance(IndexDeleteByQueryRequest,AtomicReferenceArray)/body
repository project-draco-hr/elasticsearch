{
  int successfulShards=0;
  int failedShards=0;
  List<ShardOperationFailedException> failures=new ArrayList<ShardOperationFailedException>(3);
  for (int i=0; i < shardsResponses.length(); i++) {
    Object shardResponse=shardsResponses.get(i);
    if (shardResponse instanceof Throwable) {
      failedShards++;
      failures.add(new DefaultShardOperationFailedException(request.index(),-1,(Throwable)shardResponse));
    }
 else {
      successfulShards++;
    }
  }
  return new IndexDeleteByQueryResponse(request.index(),successfulShards,failedShards,failures);
}
