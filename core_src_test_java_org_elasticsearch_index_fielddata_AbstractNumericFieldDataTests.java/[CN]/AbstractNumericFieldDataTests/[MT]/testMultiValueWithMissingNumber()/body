{
  fillMultiValueWithMissing();
  IndexNumericFieldData indexFieldData=getForField("value");
  AtomicNumericFieldData fieldData=indexFieldData.load(refreshReader());
  SortedNumericDocValues longValues=fieldData.getLongValues();
  assertThat(FieldData.isMultiValued(longValues),equalTo(true));
  longValues.setDocument(0);
  assertThat(longValues.count(),equalTo(2));
  assertThat(longValues.valueAt(0),equalTo(2l));
  assertThat(longValues.valueAt(1),equalTo(4l));
  longValues.setDocument(1);
  assertThat(longValues.count(),equalTo(0));
  longValues.setDocument(2);
  assertThat(longValues.count(),equalTo(1));
  assertThat(longValues.valueAt(0),equalTo(3l));
  SortedNumericDoubleValues doubleValues=fieldData.getDoubleValues();
  assertThat(FieldData.isMultiValued(doubleValues),equalTo(true));
  doubleValues.setDocument(0);
  assertThat(2,equalTo(doubleValues.count()));
  assertThat(doubleValues.valueAt(0),equalTo(2d));
  assertThat(doubleValues.valueAt(1),equalTo(4d));
  doubleValues.setDocument(1);
  assertThat(0,equalTo(doubleValues.count()));
  doubleValues.setDocument(2);
  assertThat(1,equalTo(doubleValues.count()));
  assertThat(doubleValues.valueAt(0),equalTo(3d));
}
