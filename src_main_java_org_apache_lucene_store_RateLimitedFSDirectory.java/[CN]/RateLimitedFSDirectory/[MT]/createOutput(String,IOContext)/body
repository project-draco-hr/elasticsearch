{
  ensureOpen();
  final IndexOutput output=delegate.createOutput(name,context);
  StoreRateLimiting rateLimiting=rateLimitingProvider.rateLimiting();
  StoreRateLimiting.Type type=rateLimiting.getType();
  RateLimiter limiter=rateLimiting.getRateLimiter();
  if (type == StoreRateLimiting.Type.NONE || limiter == null) {
    return output;
  }
  if (context.context == Context.MERGE) {
    return new RateLimitedIndexOutput(limiter,rateListener,output);
  }
  if (type == StoreRateLimiting.Type.ALL) {
    return new RateLimitedIndexOutput(limiter,rateListener,output);
  }
  return output;
}
