{
  MultiTermVectorsShardResponse response=new MultiTermVectorsShardResponse();
  for (int i=0; i < request.locations.size(); i++) {
    TermVectorRequest termVectorRequest=request.requests.get(i);
    try {
      IndexService indexService=indicesService.indexServiceSafe(request.index());
      IndexShard indexShard=indexService.shardSafe(shardId);
      TermVectorResponse termVectorResponse=indexShard.termVectorService().getTermVector(termVectorRequest);
      response.add(request.locations.get(i),termVectorResponse);
    }
 catch (    Throwable t) {
      logger.debug("[{}][{}] failed to execute multi term vectors for [{}]/[{}]",t,request.index(),shardId,termVectorRequest.type(),termVectorRequest.id());
      response.add(request.locations.get(i),new MultiTermVectorsResponse.Failure(request.index(),termVectorRequest.type(),termVectorRequest.id(),ExceptionsHelper.detailedMessage(t)));
    }
  }
  return response;
}
