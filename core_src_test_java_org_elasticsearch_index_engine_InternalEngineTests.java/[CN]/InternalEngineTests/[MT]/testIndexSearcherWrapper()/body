{
  final AtomicInteger counter=new AtomicInteger();
  IndexSearcherWrapper wrapper=new IndexSearcherWrapper(){
    @Override public DirectoryReader wrap(    DirectoryReader reader){
      counter.incrementAndGet();
      return reader;
    }
    @Override public IndexSearcher wrap(    IndexSearcher searcher) throws EngineException {
      counter.incrementAndGet();
      return searcher;
    }
  }
;
  Store store=createStore();
  Path translog=createTempDir("translog-test");
  InternalEngine engine=createEngine(store,translog,wrapper);
  Engine.Searcher searcher=engine.acquireSearcher("test");
  assertThat(counter.get(),equalTo(2));
  searcher.close();
  IOUtils.close(store,engine);
}
