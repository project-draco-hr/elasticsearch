{
  if (!parseUpperInclusive) {
    return parseStringValue(value);
  }
  try {
    MutableDateTime dateTime=new MutableDateTime(3000,12,31,23,59,59,999,DateTimeZone.UTC);
    dateTimeFormatter.parser().parseInto(dateTime,value,0);
    return dateTime.getMillis();
  }
 catch (  RuntimeException e) {
    try {
      long time=Long.parseLong(value);
      return timeUnit.toMillis(time);
    }
 catch (    NumberFormatException e1) {
      throw new MapperParsingException("failed to parse date field, tried both date format [" + dateTimeFormatter.format() + "], and timestamp number",e);
    }
  }
}
