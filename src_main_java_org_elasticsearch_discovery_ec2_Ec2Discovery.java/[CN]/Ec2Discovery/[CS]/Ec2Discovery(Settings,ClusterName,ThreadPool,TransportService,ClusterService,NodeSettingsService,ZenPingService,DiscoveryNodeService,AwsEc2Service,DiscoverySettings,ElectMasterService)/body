{
  super(settings,clusterName,threadPool,transportService,clusterService,nodeSettingsService,discoveryNodeService,pingService,electMasterService,Version.CURRENT,discoverySettings);
  if (settings.getAsBoolean("cloud.enabled",true)) {
    ImmutableList<? extends ZenPing> zenPings=pingService.zenPings();
    UnicastZenPing unicastZenPing=null;
    for (    ZenPing zenPing : zenPings) {
      if (zenPing instanceof UnicastZenPing) {
        unicastZenPing=(UnicastZenPing)zenPing;
        break;
      }
    }
    if (unicastZenPing != null) {
      unicastZenPing.addHostsProvider(new AwsEc2UnicastHostsProvider(settings,transportService,ec2Service.client()));
      pingService.zenPings(ImmutableList.of(unicastZenPing));
    }
 else {
      logger.warn("failed to apply ec2 unicast discovery, no unicast ping found");
    }
  }
}
