{
  boolean inPoly=false;
  boolean corrected=GeoUtils.correctPolyAmbiguity(points,false);
  GeoPoint p=(corrected) ? GeoUtils.convertToGreatCircle(lat,lon) : new GeoPoint(lat,lon);
  GeoPoint pp0=(corrected) ? GeoUtils.convertToGreatCircle(points[0]) : points[0];
  GeoPoint pp1;
  for (int i=1; i < points.length; i++) {
    pp1=points[i];
    if (pp1.x < p.x && pp0.x >= p.x || pp0.x < p.x && pp1.x >= p.x) {
      if (pp1.y + (p.x - pp1.x) / (pp0.x - pp1.x) * (pp0.y - pp1.y) < p.y) {
        inPoly=!inPoly;
      }
    }
    pp0=pp1;
  }
  return inPoly;
}
