{
  Engine.Searcher searchResult=engine.searcher();
  assertThat(searchResult,engineSearcherTotalHits(0));
  searchResult.release();
  engine.create(new Engine.Create(doc().add(field("_uid","1")).add(field("value","test")).build(),Lucene.STANDARD_ANALYZER,"test","1",B_1));
  searchResult=engine.searcher();
  assertThat(searchResult,engineSearcherTotalHits(0));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test")),0));
  searchResult.release();
  engine.refresh(new Engine.Refresh(true));
  searchResult=engine.searcher();
  assertThat(searchResult,engineSearcherTotalHits(1));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test")),1));
  searchResult.release();
  engine.index(new Engine.Index(newUid("1"),doc().add(field("_uid","1")).add(field("value","test1")).build(),Lucene.STANDARD_ANALYZER,"test","1",B_1));
  searchResult=engine.searcher();
  assertThat(searchResult,engineSearcherTotalHits(1));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test")),1));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test1")),0));
  searchResult.release();
  engine.refresh(new Engine.Refresh(true));
  searchResult=engine.searcher();
  assertThat(searchResult,engineSearcherTotalHits(1));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test")),0));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test1")),1));
  searchResult.release();
  engine.delete(new Engine.Delete(newUid("1")));
  searchResult=engine.searcher();
  assertThat(searchResult,engineSearcherTotalHits(1));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test")),0));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test1")),1));
  searchResult.release();
  engine.refresh(new Engine.Refresh(true));
  searchResult=engine.searcher();
  assertThat(searchResult,engineSearcherTotalHits(0));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test")),0));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test1")),0));
  searchResult.release();
  engine.create(new Engine.Create(doc().add(field("_uid","1")).add(field("value","test")).build(),Lucene.STANDARD_ANALYZER,"test","1",B_1));
  searchResult=engine.searcher();
  assertThat(searchResult,engineSearcherTotalHits(0));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test")),0));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test1")),0));
  searchResult.release();
  engine.refresh(new Engine.Refresh(true));
  searchResult=engine.searcher();
  assertThat(searchResult,engineSearcherTotalHits(1));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test")),1));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test1")),0));
  searchResult.release();
  engine.flush(new Engine.Flush());
  engine.index(new Engine.Index(newUid("1"),doc().add(field("_uid","1")).add(field("value","test1")).build(),Lucene.STANDARD_ANALYZER,"test","1",B_1));
  searchResult=engine.searcher();
  assertThat(searchResult,engineSearcherTotalHits(1));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test")),1));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test1")),0));
  searchResult.release();
  engine.refresh(new Engine.Refresh(true));
  searchResult=engine.searcher();
  assertThat(searchResult,engineSearcherTotalHits(1));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test")),0));
  assertThat(searchResult,engineSearcherTotalHits(new TermQuery(new Term("value","test1")),1));
  searchResult.release();
  engine.close();
}
