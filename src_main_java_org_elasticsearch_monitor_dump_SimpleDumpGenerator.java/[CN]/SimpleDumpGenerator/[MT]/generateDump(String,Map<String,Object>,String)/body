{
  long timestamp=System.currentTimeMillis();
  String fileName="";
  if (context.containsKey("localNode")) {
    DiscoveryNode localNode=(DiscoveryNode)context.get("localNode");
    if (localNode.name() != null) {
      fileName+=localNode.name() + "-";
    }
    fileName+=localNode.id() + "-";
  }
  File file=new File(dumpLocation,fileName + cause + "-"+ timestamp);
  FileSystemUtils.mkdirs(file);
  SimpleDump dump;
  try {
    dump=new SimpleDump(System.currentTimeMillis(),cause,context,file);
  }
 catch (  FileNotFoundException e) {
    throw new DumpGenerationFailedException("Failed to generate dump",e);
  }
  ArrayList<DumpContributionFailedException> failedContributors=new ArrayList<DumpContributionFailedException>();
  for (  String name : contributors) {
    DumpContributor contributor=this.contributors.get(name);
    if (contributor == null) {
      failedContributors.add(new DumpContributionFailedException(name,"No contributor"));
      continue;
    }
    try {
      contributor.contribute(dump);
    }
 catch (    DumpContributionFailedException e) {
      failedContributors.add(e);
    }
catch (    Exception e) {
      failedContributors.add(new DumpContributionFailedException(contributor.getName(),"Failed",e));
    }
  }
  dump.finish();
  return new Result(file,failedContributors);
}
