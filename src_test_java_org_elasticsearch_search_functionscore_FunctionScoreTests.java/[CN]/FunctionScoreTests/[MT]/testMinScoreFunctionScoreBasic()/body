{
  index(INDEX,TYPE,jsonBuilder().startObject().field("num",2).endObject());
  refresh();
  ensureYellow();
  float score=randomFloat();
  float minScore=randomFloat();
  SearchResponse searchResponse=client().search(searchRequest().source(searchSource().query(functionScoreQuery().add(scriptFunction(new Script(Float.toString(score)))).setMinScore(minScore)))).actionGet();
  if (score < minScore) {
    assertThat(searchResponse.getHits().getTotalHits(),is(0l));
  }
 else {
    assertThat(searchResponse.getHits().getTotalHits(),is(1l));
  }
  searchResponse=client().search(searchRequest().source(searchSource().query(functionScoreQuery().add(scriptFunction(new Script(Float.toString(score)))).add(scriptFunction(new Script(Float.toString(score)))).scoreMode("avg").setMinScore(minScore)))).actionGet();
  if (score < minScore) {
    assertThat(searchResponse.getHits().getTotalHits(),is(0l));
  }
 else {
    assertThat(searchResponse.getHits().getTotalHits(),is(1l));
  }
}
