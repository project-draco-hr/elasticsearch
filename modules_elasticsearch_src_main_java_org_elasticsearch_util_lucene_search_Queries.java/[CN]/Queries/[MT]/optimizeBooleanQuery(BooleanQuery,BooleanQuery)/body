{
  for (  BooleanClause clause : q.clauses()) {
    Query cq=clause.getQuery();
    cq.setBoost(cq.getBoost() * q.getBoost());
    if (cq instanceof BooleanQuery && !clause.isRequired() && !clause.isProhibited()) {
      optimizeBooleanQuery(optimized,(BooleanQuery)cq);
    }
 else {
      optimized.add(clause);
    }
  }
}
