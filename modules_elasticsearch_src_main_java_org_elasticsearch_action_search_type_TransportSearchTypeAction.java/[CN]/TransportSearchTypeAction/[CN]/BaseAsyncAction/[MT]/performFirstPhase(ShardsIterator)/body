{
  final ShardRouting shard=shardIt.nextActiveOrNull();
  if (shard == null) {
    onFirstPhaseResult(shard,shardIt,null);
  }
 else {
    DiscoveryNode node=nodes.get(shard.currentNodeId());
    sendExecuteFirstPhase(node,internalSearchRequest(shard,request),new SearchServiceListener<FirstResult>(){
      @Override public void onResult(      FirstResult result){
        onFirstPhaseResult(shard,result,shardIt);
      }
      @Override public void onFailure(      Throwable t){
        onFirstPhaseResult(shard,shardIt,t);
      }
    }
);
  }
}
