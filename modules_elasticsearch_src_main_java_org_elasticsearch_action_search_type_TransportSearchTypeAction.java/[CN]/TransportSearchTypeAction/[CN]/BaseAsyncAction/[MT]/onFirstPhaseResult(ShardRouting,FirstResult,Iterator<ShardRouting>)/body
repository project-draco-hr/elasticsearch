{
  processFirstPhaseResult(shard,result);
  while (shardIt.hasNext()) {
    totalOps.incrementAndGet();
    shardIt.next();
  }
  if (successulOps.incrementAndGet() == expectedSuccessfulOps || totalOps.incrementAndGet() == expectedTotalOps) {
    try {
      moveToSecondPhase();
    }
 catch (    Exception e) {
      listener.onFailure(new ReduceSearchPhaseException(firstPhaseName(),"",e));
    }
  }
}
