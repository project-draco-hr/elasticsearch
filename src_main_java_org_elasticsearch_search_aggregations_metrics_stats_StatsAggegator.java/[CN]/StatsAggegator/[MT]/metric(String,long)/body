{
switch (InternalStats.Metrics.resolve(name)) {
case count:
    return valuesSource == null ? 0 : counts.get(owningBucketOrd);
case sum:
  return valuesSource == null ? 0 : sums.get(owningBucketOrd);
case min:
return valuesSource == null ? Double.POSITIVE_INFINITY : mins.get(owningBucketOrd);
case max:
return valuesSource == null ? Double.NEGATIVE_INFINITY : maxes.get(owningBucketOrd);
case avg:
return valuesSource == null ? Double.NaN : sums.get(owningBucketOrd) / counts.get(owningBucketOrd);
default :
throw new IllegalArgumentException("Unknown value [" + name + "] in common stats aggregation");
}
}
