{
  int[] sizes={0,randomInt(PAGE_SIZE),PAGE_SIZE,randomIntBetween(2,PAGE_SIZE * randomIntBetween(2,5))};
  for (int i=0; i < sizes.length; i++) {
    BytesReference pbr=newBytesReference(sizes[i]);
    if (sizes[i] <= PAGE_SIZE) {
      byte[] array=pbr.array();
      assertNotNull(array);
      assertEquals(sizes[i],array.length);
      assertSame(array,pbr.array());
    }
 else {
      try {
        pbr.array();
        fail("expected IllegalStateException");
      }
 catch (      IllegalStateException isx) {
      }
    }
  }
}
