{
  int length=randomIntBetween(10,PAGE_SIZE * 4);
  BytesReference pbr=getRandomizedPagedBytesReference(length);
  Path tFile=createTempFile();
  try (FileChannel channel=FileChannel.open(tFile,StandardOpenOption.WRITE)){
    pbr.writeTo(channel);
    assertEquals(pbr.length(),channel.position());
  }
   assertArrayEquals(pbr.toBytes(),Files.readAllBytes(tFile));
}
