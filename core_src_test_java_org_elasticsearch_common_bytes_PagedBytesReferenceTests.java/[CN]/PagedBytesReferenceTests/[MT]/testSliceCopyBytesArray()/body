{
  int length=randomIntBetween(10,PAGE_SIZE * randomIntBetween(2,8));
  BytesReference pbr=getRandomizedPagedBytesReference(length);
  int sliceOffset=randomIntBetween(0,pbr.length());
  int sliceLength=randomIntBetween(pbr.length() - sliceOffset,pbr.length() - sliceOffset);
  BytesReference slice=pbr.slice(sliceOffset,sliceLength);
  BytesArray ba1=slice.copyBytesArray();
  BytesArray ba2=slice.copyBytesArray();
  assertNotNull(ba1);
  assertNotNull(ba2);
  assertNotSame(ba1.array(),ba2.array());
  assertArrayEquals(slice.toBytes(),ba1.array());
  assertArrayEquals(slice.toBytes(),ba2.array());
  assertArrayEquals(ba1.array(),ba2.array());
}
