{
  final IndicesAliasesClusterStateUpdateRequest updateRequest=new IndicesAliasesClusterStateUpdateRequest().ackTimeout(request.ackTimeout()).masterNodeTimeout(request.masterNodeTimeout());
  final AliasAction[] actions;
  if (request.getOptionalTargetAlias() != null) {
    actions=new AliasAction[3];
    actions[0]=new AliasAction(AliasAction.Type.ADD,targetIndex,request.getSourceAlias());
    actions[1]=new AliasAction(AliasAction.Type.ADD,targetIndex,request.getOptionalTargetAlias());
    actions[2]=new AliasAction(AliasAction.Type.REMOVE,concreteSourceIndex,request.getSourceAlias());
  }
 else {
    actions=new AliasAction[2];
    actions[0]=new AliasAction(AliasAction.Type.ADD,targetIndex,request.getSourceAlias());
    actions[1]=new AliasAction(AliasAction.Type.REMOVE,concreteSourceIndex,request.getSourceAlias());
  }
  updateRequest.actions(actions);
  return updateRequest;
}
