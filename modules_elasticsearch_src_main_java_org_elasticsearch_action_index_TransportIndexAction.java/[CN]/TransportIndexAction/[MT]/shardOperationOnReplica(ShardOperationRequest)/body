{
  IndexShard indexShard=indexShard(shardRequest);
  IndexRequest request=shardRequest.request;
  if (request.opType() == IndexRequest.OpType.INDEX) {
    Engine.Index index=indexShard.prepareIndex(request.type(),request.id(),request.source());
    index.refresh(request.refresh());
    indexShard.index(index);
  }
 else {
    Engine.Create create=indexShard.prepareCreate(request.type(),request.id(),request.source());
    create.refresh(request.refresh());
    indexShard.create(create);
  }
}
