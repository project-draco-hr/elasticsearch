{
  if (!Strings.hasLength(request.percolate())) {
    return;
  }
  IndexService indexService=indicesService.indexServiceSafe(request.index());
  try {
    PercolatorExecutor.Response percolate=indexService.percolateService().percolate(new PercolatorExecutor.DocAndSourceQueryRequest((ParsedDocument)response.payload(),request.percolate()));
    response.response().matches(percolate.matches());
  }
 catch (  Exception e) {
    logger.warn("failed to percolate [{}]",e,request);
  }
}
