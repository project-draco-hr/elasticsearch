{
  final IndexRequest request=shardRequest.request;
  ParsedDocument doc;
  if (request.opType() == IndexRequest.OpType.INDEX) {
    doc=indexShard(shardRequest).index(request.type(),request.id(),request.source());
  }
 else {
    doc=indexShard(shardRequest).create(request.type(),request.id(),request.source());
  }
  if (doc.mappersAdded()) {
    updateMappingOnMaster(request);
  }
  return new IndexResponse(request.index(),request.type(),request.id());
}
