{
  final float weightShard=node.numShards() - balancer.avgShardsPerNode();
  final float weightIndex=node.numShards(index) - balancer.avgShardsPerNode(index);
  final float weightPrimary=node.numPrimaries() - balancer.avgPrimariesPerNode();
  return theta[0] * weightShard + theta[1] * weightIndex + theta[2] * weightPrimary;
}
