{
  int compressedByte=in.read();
  if (compressedByte == -1) {
    return 0;
  }
  boolean compressed=compressedByte == 1;
  int length=in.readVInt();
  if (!compressed) {
    in.readBytes(out,0,length);
    return length;
  }
 else {
    in.readBytes(inputBuffer,0,length);
    return Snappy.rawUncompress(inputBuffer,0,length,out,0);
  }
}
