{
  TimeZoneRounding.Builder tzRoundingBuilder;
  if (dateHistogramInterval != null) {
    DateTimeUnit dateTimeUnit=DATE_FIELD_UNITS.get(dateHistogramInterval.toString());
    if (dateTimeUnit != null) {
      tzRoundingBuilder=TimeZoneRounding.builder(dateTimeUnit);
    }
 else {
      tzRoundingBuilder=TimeZoneRounding.builder(TimeValue.parseTimeValue(dateHistogramInterval.toString(),null,getClass().getSimpleName() + ".interval"));
    }
  }
 else {
    tzRoundingBuilder=TimeZoneRounding.builder(TimeValue.timeValueMillis(interval));
  }
  if (timeZone() != null) {
    tzRoundingBuilder.timeZone(timeZone());
  }
  Rounding rounding=tzRoundingBuilder.offset(offset).build();
  return rounding;
}
