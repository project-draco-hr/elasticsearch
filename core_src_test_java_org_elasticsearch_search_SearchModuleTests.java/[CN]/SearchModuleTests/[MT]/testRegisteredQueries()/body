{
  SearchModule module=new SearchModule(Settings.EMPTY,new NamedWriteableRegistry());
  List<String> allSupportedQueries=new ArrayList<>();
  Collections.addAll(allSupportedQueries,NON_DEPRECATED_QUERIES);
  Collections.addAll(allSupportedQueries,DEPRECATED_QUERIES);
  String[] supportedQueries=allSupportedQueries.toArray(new String[allSupportedQueries.size()]);
  assertThat(module.getRegisteredQueries(),containsInAnyOrder(supportedQueries));
  IndicesQueriesRegistry indicesQueriesRegistry=module.buildQueryParserRegistry();
  for (  String queryName : supportedQueries) {
    QueryParser<?> queryParser=indicesQueriesRegistry.getQueryParser(queryName,ParseFieldMatcher.EMPTY,new XContentLocation(-1,-1));
    assertThat(queryParser,notNullValue());
  }
  for (  String queryName : NON_DEPRECATED_QUERIES) {
    QueryParser<?> queryParser=indicesQueriesRegistry.getQueryParser(queryName,ParseFieldMatcher.STRICT,new XContentLocation(-1,-1));
    assertThat(queryParser,notNullValue());
  }
  for (  String queryName : DEPRECATED_QUERIES) {
    try {
      indicesQueriesRegistry.getQueryParser(queryName,ParseFieldMatcher.STRICT,new XContentLocation(-1,-1));
      fail("query is deprecated, getQueryParser should have failed in strict mode");
    }
 catch (    IllegalArgumentException e) {
      assertThat(e.getMessage(),containsString("Deprecated field [" + queryName + "] used"));
    }
  }
}
