{
  IndexMetaData indexMetaData=IndexMetaData.builder("test").settings(settings(Version.CURRENT)).numberOfShards(1).numberOfReplicas(0).build();
  assertThat(ActiveShardCount.ALL.resolve(indexMetaData),equalTo(1));
  assertThat(ActiveShardCount.DEFAULT.resolve(indexMetaData),equalTo(1));
  assertThat(ActiveShardCount.NONE.resolve(indexMetaData),equalTo(0));
  final int value=randomIntBetween(2,20);
  assertThat(ActiveShardCount.from(value).resolve(indexMetaData),equalTo(value));
  final int numNewShards=randomIntBetween(1,20);
  indexMetaData=IndexMetaData.builder("test").settings(settings(Version.CURRENT)).numberOfShards(1).numberOfReplicas(numNewShards).build();
  assertThat(ActiveShardCount.ALL.resolve(indexMetaData),equalTo(numNewShards + 1));
  assertThat(ActiveShardCount.DEFAULT.resolve(indexMetaData),equalTo(1));
  assertThat(ActiveShardCount.NONE.resolve(indexMetaData),equalTo(0));
  assertThat(ActiveShardCount.from(value).resolve(indexMetaData),equalTo(value));
}
