{
  if (globalOrdinals != null) {
    final long globalOrdinal=globalOrdinals.getOrd(doc);
    if (globalOrdinal != Ordinals.MISSING_ORDINAL) {
      long parentIdx=parentIdxs.add(globalOrdinal);
      if (parentIdx >= 0) {
        scores=bigArrays.grow(scores,parentIdx + 1);
        occurrences=bigArrays.grow(occurrences,parentIdx + 1);
        scores.set(parentIdx,scorer.score());
        occurrences.set(parentIdx,1);
      }
 else {
        parentIdx=-1 - parentIdx;
        scores.increment(parentIdx,scorer.score());
        occurrences.increment(parentIdx,1);
      }
    }
  }
}
