{
  if (values != null) {
    int ord=(int)ordinals.getOrd(doc);
    long parentIdx=parentIdsIndex.get(ord);
    if (parentIdx < 0) {
      final BytesRef bytes=values.getValueByOrd(ord);
      final int hash=values.currentValueHash();
      parentIdx=parentIds.add(bytes,hash);
      if (parentIdx < 0) {
        parentIdx=-parentIdx - 1;
        scores.increment(parentIdx,scorer.score());
        occurrences.increment(parentIdx,1);
      }
 else {
        scores=bigArrays.grow(scores,parentIdx + 1);
        scores.set(parentIdx,scorer.score());
        occurrences=bigArrays.grow(occurrences,parentIdx + 1);
        occurrences.set(parentIdx,1);
      }
      parentIdsIndex.set(ord,parentIdx);
    }
 else {
      scores.increment(parentIdx,scorer.score());
      occurrences.increment(parentIdx,1);
    }
  }
}
