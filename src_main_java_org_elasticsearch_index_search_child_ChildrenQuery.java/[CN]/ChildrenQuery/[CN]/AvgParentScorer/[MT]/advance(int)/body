{
  if (parentWeight.remaining == 0) {
    return currentDocId=NO_MORE_DOCS;
  }
  currentDocId=parentsIterator.advance(target);
  if (currentDocId == DocIdSetIterator.NO_MORE_DOCS) {
    return currentDocId;
  }
  final long globalOrdinal=globalOrdinals.getOrd(currentDocId);
  if (globalOrdinal == Ordinals.MISSING_ORDINAL) {
    return nextDoc();
  }
  final long parentIdx=parentIds.find(globalOrdinal);
  if (parentIdx != -1) {
    currentScore=scores.get(parentIdx);
    currentScore/=occurrences.get(parentIdx);
    parentWeight.remaining--;
    return currentDocId;
  }
 else {
    return nextDoc();
  }
}
