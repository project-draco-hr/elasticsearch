{
  if (parentWeight.remaining == 0) {
    return currentDocId=NO_MORE_DOCS;
  }
  currentDocId=parentsIterator.advance(target);
  if (currentDocId == DocIdSetIterator.NO_MORE_DOCS) {
    return currentDocId;
  }
  final long globalOrdinal=globalOrdinals.getOrd(currentDocId);
  if (globalOrdinal < 0) {
    return nextDoc();
  }
  final long parentIdx=parentIds.find(globalOrdinal);
  if (parentIdx != -1) {
    parentWeight.remaining--;
    if (acceptAndScore(parentIdx)) {
      return currentDocId;
    }
  }
  return nextDoc();
}
