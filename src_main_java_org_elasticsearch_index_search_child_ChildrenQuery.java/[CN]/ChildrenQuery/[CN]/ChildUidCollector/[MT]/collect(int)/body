{
  if (typeCache == null) {
    return;
  }
  HashedBytesArray parentUid=typeCache.parentIdByDoc(doc);
  float previousScore=uidToScore.get(parentUid);
  float currentScore=scorer.score();
  if (previousScore == 0) {
    uidToScore.put(parentUid,currentScore);
  }
 else {
switch (scoreType) {
case SUM:
      uidToScore.adjustValue(parentUid,currentScore);
    break;
case MAX:
  if (currentScore > previousScore) {
    uidToScore.put(parentUid,currentScore);
  }
break;
}
}
}
