{
  DocIdSet parentsSet=parentFilter.getDocIdSet(context,acceptDocs);
  if (parentsSet == null || parentsSet == DocIdSet.EMPTY_DOCIDSET) {
    return null;
  }
  IdReaderTypeCache idTypeCache=searchContext.idCache().reader(context.reader()).type(parentType);
  DocIdSetIterator parentsIterator=parentsSet.iterator();
switch (scoreType) {
case AVG:
    return new AvgParentScorer(this,idTypeCache,uidToScore,uidToCount,parentsIterator);
default :
  return new ParentScorer(this,idTypeCache,uidToScore,parentsIterator);
}
}
