{
  DocIdSet parentsSet=parentFilter.getDocIdSet(context,acceptDocs);
  if (DocIdSets.isEmpty(parentsSet) || remaining == 0) {
    return null;
  }
  BytesValues bytesValues=parentChildIndexFieldData.load(context).getBytesValues(parentType);
  if (bytesValues == null) {
    return null;
  }
  DocIdSetIterator parentsIterator=BitsFilteredDocIdSet.wrap(parentsSet,context.reader().getLiveDocs()).iterator();
switch (scoreType) {
case AVG:
    return new AvgParentScorer(this,bytesValues,parentIds,scores,occurrences,parentsIterator);
default :
  return new ParentScorer(this,bytesValues,parentIds,scores,parentsIterator);
}
}
