{
  DocIdSet parentsSet=parentFilter.getDocIdSet(context,acceptDocs);
  if (DocIdSets.isEmpty(parentsSet) || remaining == 0) {
    return null;
  }
  IdReaderTypeCache idTypeCache=searchContext.idCache().reader(context.reader()).type(parentType);
  DocIdSetIterator parentsIterator=parentsSet.iterator();
switch (scoreType) {
case AVG:
    return new AvgParentScorer(this,idTypeCache,parentsIterator);
default :
  return new ParentScorer(this,idTypeCache,parentsIterator);
}
}
