{
  DocIdSet parentsSet=parentFilter.getDocIdSet(context,acceptDocs);
  if (DocIdSets.isEmpty(parentsSet) || remaining == 0) {
    return null;
  }
  DocIdSetIterator parents=BitsFilteredDocIdSet.wrap(parentsSet,context.reader().getLiveDocs()).iterator();
  BytesValues.WithOrdinals bytesValues=collector.globalIfd.load(context).getBytesValues(false);
  if (bytesValues == null) {
    return null;
  }
switch (scoreType) {
case AVG:
    return new AvgParentScorer(this,parents,collector,bytesValues.ordinals());
default :
  return new ParentScorer(this,parents,collector,bytesValues.ordinals());
}
}
