{
  DocIdSet parentsSet=parentFilter.getDocIdSet(context,acceptDocs);
  if (DocIdSets.isEmpty(parentsSet) || remaining == 0) {
    return null;
  }
  DocIdSetIterator parents=BitsFilteredDocIdSet.wrap(parentsSet,context.reader().getLiveDocs()).iterator();
  if (parents != null) {
    BytesValues.WithOrdinals bytesValues=collector.globalIfd.load(context).getBytesValues();
    if (bytesValues == null) {
      return null;
    }
    Ordinals.Docs globalOrdinals=bytesValues.ordinals();
    if (minChildren > 0 || maxChildren != 0 || scoreType == ScoreType.NONE) {
switch (scoreType) {
case NONE:
        DocIdSetIterator parentIdIterator=new CountParentOrdIterator(this,parents,collector,globalOrdinals,minChildren,maxChildren);
      return ConstantScorer.create(parentIdIterator,this,queryWeight);
case AVG:
    return new AvgParentCountScorer(this,parents,collector,globalOrdinals,minChildren,maxChildren);
default :
  return new ParentCountScorer(this,parents,collector,globalOrdinals,minChildren,maxChildren);
}
}
switch (scoreType) {
case AVG:
return new AvgParentScorer(this,parents,collector,globalOrdinals);
default :
return new ParentScorer(this,parents,collector,globalOrdinals);
}
}
return null;
}
