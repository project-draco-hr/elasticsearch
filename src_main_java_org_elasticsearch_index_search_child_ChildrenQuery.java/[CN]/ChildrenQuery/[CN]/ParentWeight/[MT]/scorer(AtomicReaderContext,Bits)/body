{
  DocIdSet parentsSet=parentFilter.getDocIdSet(context,acceptDocs);
  if (DocIdSets.isEmpty(parentsSet) || remaining == 0) {
    return null;
  }
  DocIdSetIterator parents=BitsFilteredDocIdSet.wrap(parentsSet,context.reader().getLiveDocs()).iterator();
  if (parents != null) {
    SortedDocValues bytesValues=collector.globalIfd.load(context).getOrdinalsValues(parentType);
    if (bytesValues == null) {
      return null;
    }
    if (minChildren > 0 || maxChildren != 0 || scoreType == ScoreType.NONE) {
switch (scoreType) {
case NONE:
        DocIdSetIterator parentIdIterator=new CountParentOrdIterator(this,parents,collector,bytesValues,minChildren,maxChildren);
      return ConstantScorer.create(parentIdIterator,this,queryWeight);
case AVG:
    return new AvgParentCountScorer(this,parents,collector,bytesValues,minChildren,maxChildren);
default :
  return new ParentCountScorer(this,parents,collector,bytesValues,minChildren,maxChildren);
}
}
switch (scoreType) {
case AVG:
return new AvgParentScorer(this,parents,collector,bytesValues);
default :
return new ParentScorer(this,parents,collector,bytesValues);
}
}
return null;
}
