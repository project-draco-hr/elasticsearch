{
  if (remaining == 0) {
    return currentDocId=NO_MORE_DOCS;
  }
  currentDocId=parentsIterator.advance(target);
  if (currentDocId == DocIdSetIterator.NO_MORE_DOCS) {
    return currentDocId;
  }
  HashedBytesArray uid=idTypeCache.idByDoc(currentDocId);
  if (uidToScore.containsKey(uid)) {
    currentScore=uidToScore.lget();
    currentScore/=uidToCount.get(uid);
    remaining--;
    return currentDocId;
  }
 else {
    return nextDoc();
  }
}
