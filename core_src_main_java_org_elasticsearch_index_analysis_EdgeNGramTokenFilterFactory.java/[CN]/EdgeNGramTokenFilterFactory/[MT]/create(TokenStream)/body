{
  TokenStream result=tokenStream;
  if (side == SIDE_BACK) {
    result=new ReverseStringFilter(result);
  }
  if (version.onOrAfter(Version.LUCENE_4_3) && esVersion.onOrAfter(org.elasticsearch.Version.V_0_90_2)) {
    result=new EdgeNGramTokenFilter(result,minGram,maxGram);
  }
 else {
    result=new Lucene43EdgeNGramTokenFilter(result,minGram,maxGram);
  }
  if (side == SIDE_BACK) {
    result=new ReverseStringFilter(result);
  }
  return result;
}
