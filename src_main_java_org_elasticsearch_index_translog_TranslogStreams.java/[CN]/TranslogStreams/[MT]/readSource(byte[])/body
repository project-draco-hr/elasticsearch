{
  BytesStreamInput in=new BytesStreamInput(data);
  in.readInt();
  Translog.Operation.Type type=Translog.Operation.Type.fromId(in.readByte());
  Translog.Operation operation;
switch (type) {
case CREATE:
    operation=new Translog.Create();
  break;
case DELETE:
operation=new Translog.Delete();
break;
case DELETE_BY_QUERY:
operation=new Translog.DeleteByQuery();
break;
case SAVE:
operation=new Translog.Index();
break;
default :
throw new IOException("No type for [" + type + "]");
}
return operation.readSource(in);
}
