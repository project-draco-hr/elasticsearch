{
  super(numOfNodes,extraSettings);
  int[] unicastHostOrdinals;
  if (numOfUnicastHosts == numOfNodes) {
    unicastHostOrdinals=new int[numOfNodes];
    for (int i=0; i < numOfNodes; i++) {
      unicastHostOrdinals[i]=i;
    }
  }
 else {
    Set<Integer> ordinals=new HashSet<>(numOfUnicastHosts);
    while (ordinals.size() != numOfUnicastHosts) {
      ordinals.add(RandomizedTest.randomInt(numOfNodes - 1));
    }
    unicastHostOrdinals=Ints.toArray(ordinals);
  }
  this.localMode=nodeSettings.get("node.mode",InternalTestCluster.NODE_MODE).equals("local");
  this.unicastHosts=buildUnicastHostSetting(unicastHostOrdinals,localMode);
}
