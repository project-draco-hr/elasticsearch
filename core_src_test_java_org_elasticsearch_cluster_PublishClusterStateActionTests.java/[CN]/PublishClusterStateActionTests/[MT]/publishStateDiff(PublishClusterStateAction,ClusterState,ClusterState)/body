{
  AssertingAckListener assertingAckListener=new AssertingAckListener(state.nodes().getSize() - 1);
  ClusterChangedEvent changedEvent=new ClusterChangedEvent("test update",state,previousState);
  int requiredNodes=randomIntBetween(-1,state.nodes().getSize() - 1);
  action.publish(changedEvent,requiredNodes,assertingAckListener);
  return assertingAckListener;
}
