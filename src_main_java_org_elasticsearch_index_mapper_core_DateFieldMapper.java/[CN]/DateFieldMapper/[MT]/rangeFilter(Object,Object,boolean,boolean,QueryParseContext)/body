{
  long now=context == null ? System.currentTimeMillis() : context.nowInMillis();
  return NumericRangeFilter.newLongRange(names.indexName(),precisionStep,lowerTerm == null ? null : dateMathParser.parse(convertToString(lowerTerm),now),upperTerm == null ? null : (includeUpper && parseUpperInclusive) ? dateMathParser.parseUpperInclusive(convertToString(upperTerm),now) : dateMathParser.parse(convertToString(upperTerm),now),includeLower,includeUpper);
}
