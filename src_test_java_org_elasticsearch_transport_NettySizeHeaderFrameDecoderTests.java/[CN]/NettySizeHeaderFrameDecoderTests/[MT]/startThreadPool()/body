{
  threadPool=new ThreadPool(settings);
  threadPool.setNodeSettingsService(new NodeSettingsService(settings));
  NetworkService networkService=new NetworkService(settings);
  BigArrays bigArrays=new MockBigArrays(new MockPageCacheRecycler(settings,threadPool),new NoneCircuitBreakerService());
  nettyTransport=new NettyTransport(settings,threadPool,networkService,bigArrays,Version.CURRENT);
  nettyTransport.start();
  TransportService transportService=new TransportService(nettyTransport,threadPool);
  nettyTransport.transportServiceAdapter(transportService.createAdapter());
  InetSocketTransportAddress transportAddress=(InetSocketTransportAddress)nettyTransport.boundAddress().boundAddress();
  port=transportAddress.address().getPort();
  host=transportAddress.address().getHostString();
}
