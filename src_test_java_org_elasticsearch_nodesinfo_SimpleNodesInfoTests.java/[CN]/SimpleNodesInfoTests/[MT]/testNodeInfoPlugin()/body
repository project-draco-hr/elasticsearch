{
  String server1NodeId=startNodeWithPlugins("node1");
  String server2NodeId=startNodeWithPlugins("node2");
  String server3NodeId=startNodeWithPlugins("node3",TestPlugin.class.getName());
  String server4NodeId=startNodeWithPlugins("node4",TestNoVersionPlugin.class.getName());
  ClusterHealthResponse clusterHealth=client("node4").admin().cluster().health(clusterHealthRequest().waitForGreenStatus()).actionGet();
  logger.info("--> done cluster_health, status " + clusterHealth.getStatus());
  NodesInfoResponse response=client("node1").admin().cluster().prepareNodesInfo().setPlugin(true).execute().actionGet();
  logger.info("--> full json answer, status " + response.toString());
  assertNodeContainsPlugins(response,server1NodeId,Collections.EMPTY_LIST,Collections.EMPTY_LIST,Collections.EMPTY_LIST,Collections.EMPTY_LIST);
  assertNodeContainsPlugins(response,server2NodeId,Collections.EMPTY_LIST,Collections.EMPTY_LIST,Lists.newArrayList(Fields.SITE_PLUGIN),Lists.newArrayList(Fields.SITE_PLUGIN_DESCRIPTION));
  assertNodeContainsPlugins(response,server3NodeId,Lists.newArrayList(TestPlugin.Fields.NAME),Lists.newArrayList(TestPlugin.Fields.DESCRIPTION),Collections.EMPTY_LIST,Collections.EMPTY_LIST);
  assertNodeContainsPlugins(response,server4NodeId,Lists.newArrayList(TestNoVersionPlugin.Fields.NAME),Lists.newArrayList(TestNoVersionPlugin.Fields.DESCRIPTION),Lists.newArrayList(Fields.SITE_PLUGIN,TestNoVersionPlugin.Fields.NAME),Lists.newArrayList(Fields.SITE_PLUGIN_NO_DESCRIPTION,TestNoVersionPlugin.Fields.DESCRIPTION));
}
