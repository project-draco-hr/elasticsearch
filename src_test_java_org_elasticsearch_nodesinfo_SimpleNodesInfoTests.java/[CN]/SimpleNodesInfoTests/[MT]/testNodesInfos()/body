{
  final String node_1=cluster().startNode();
  final String node_2=cluster().startNode();
  ClusterHealthResponse clusterHealth=client().admin().cluster().health(clusterHealthRequest().waitForGreenStatus()).actionGet();
  logger.info("--> done cluster_health, status " + clusterHealth.getStatus());
  String server1NodeId=cluster().getInstance(ClusterService.class,node_1).state().nodes().localNodeId();
  String server2NodeId=cluster().getInstance(ClusterService.class,node_2).state().nodes().localNodeId();
  logger.info("--> started nodes: " + server1NodeId + " and "+ server2NodeId);
  NodesInfoResponse response=client().admin().cluster().prepareNodesInfo().execute().actionGet();
  assertThat(response.getNodes().length,is(2));
  assertThat(response.getNodesMap().get(server1NodeId),notNullValue());
  assertThat(response.getNodesMap().get(server2NodeId),notNullValue());
  response=client().admin().cluster().nodesInfo(nodesInfoRequest()).actionGet();
  assertThat(response.getNodes().length,is(2));
  assertThat(response.getNodesMap().get(server1NodeId),notNullValue());
  assertThat(response.getNodesMap().get(server2NodeId),notNullValue());
  response=client().admin().cluster().nodesInfo(nodesInfoRequest(server1NodeId)).actionGet();
  assertThat(response.getNodes().length,is(1));
  assertThat(response.getNodesMap().get(server1NodeId),notNullValue());
  response=client().admin().cluster().nodesInfo(nodesInfoRequest(server1NodeId)).actionGet();
  assertThat(response.getNodes().length,is(1));
  assertThat(response.getNodesMap().get(server1NodeId),notNullValue());
  response=client().admin().cluster().nodesInfo(nodesInfoRequest(server2NodeId)).actionGet();
  assertThat(response.getNodes().length,is(1));
  assertThat(response.getNodesMap().get(server2NodeId),notNullValue());
  response=client().admin().cluster().nodesInfo(nodesInfoRequest(server2NodeId)).actionGet();
  assertThat(response.getNodes().length,is(1));
  assertThat(response.getNodesMap().get(server2NodeId),notNullValue());
}
