{
  if (emd.from == null) {
    throw new IllegalStateException(error(emd.source) + "From cast type should never be null.");
  }
  if (emd.to != null) {
    emd.cast=getLegalCast(emd.source,emd.from,emd.to,emd.explicit || !emd.typesafe);
    if (emd.preConst != null && emd.to.sort.constant) {
      emd.postConst=constCast(emd.source,emd.preConst,emd.cast);
    }
  }
 else {
    throw new IllegalStateException(error(emd.source) + "To cast type should never be null.");
  }
}
