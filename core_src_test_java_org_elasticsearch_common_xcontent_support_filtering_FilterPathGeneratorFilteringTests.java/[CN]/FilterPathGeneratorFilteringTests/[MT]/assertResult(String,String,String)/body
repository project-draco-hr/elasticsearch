{
  try (BytesStreamOutput os=new BytesStreamOutput()){
    try (FilteringGeneratorDelegate generator=new FilteringGeneratorDelegate(JSON_FACTORY.createGenerator(os),new FilterPathBasedFilter(new String[]{filter}),true,true)){
      try (JsonParser parser=JSON_FACTORY.createParser(replaceQuotes(input))){
        while (parser.nextToken() != null) {
          generator.copyCurrentStructure(parser);
        }
      }
     }
     assertThat(os.bytes().toUtf8(),equalTo(replaceQuotes(expected)));
  }
 }
