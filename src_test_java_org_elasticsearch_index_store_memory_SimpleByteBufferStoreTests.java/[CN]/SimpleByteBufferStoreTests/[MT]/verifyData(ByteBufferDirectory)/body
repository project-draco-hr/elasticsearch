{
  byte[] test=new byte[]{1,2,3,4,5,6,7,8};
  assertThat(dir.fileExists("value1"),equalTo(true));
  assertThat(dir.fileLength("value1"),equalTo(38l));
  IndexInput indexInput=dir.openInput("value1",IOContext.DEFAULT);
  indexInput.readBytes(test,0,5);
  assertThat(test[0],equalTo((byte)8));
  assertThat(indexInput.readInt(),equalTo(-1));
  assertThat(indexInput.readLong(),equalTo((long)10));
  assertThat(indexInput.readInt(),equalTo(0));
  assertThat(indexInput.readInt(),equalTo(0));
  indexInput.readBytes(test,0,8);
  assertThat(test[0],equalTo((byte)1));
  assertThat(test[7],equalTo((byte)8));
  indexInput.readBytes(test,0,5);
  assertThat(test[0],equalTo((byte)1));
  assertThat(test[4],equalTo((byte)5));
  indexInput.seek(28);
  assertThat(indexInput.readByte(),equalTo((byte)4));
  indexInput.seek(30);
  assertThat(indexInput.readByte(),equalTo((byte)6));
  indexInput.seek(0);
  indexInput.readBytes(test,0,5);
  assertThat(test[0],equalTo((byte)8));
  indexInput.close();
  indexInput=dir.openInput("value1",IOContext.DEFAULT);
  for (int i=0; i < 38; i++) {
    indexInput.readByte();
  }
  indexInput.close();
}
