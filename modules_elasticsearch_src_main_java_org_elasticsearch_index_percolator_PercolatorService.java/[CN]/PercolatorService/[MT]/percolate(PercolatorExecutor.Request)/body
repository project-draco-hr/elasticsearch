{
  IndexService percolatorIndex=indicesService.indexService(INDEX_NAME);
  if (percolatorIndex == null) {
    throw new PercolateIndexUnavailable(new Index(INDEX_NAME));
  }
  if (percolatorIndex.numberOfShards() == 0) {
    throw new PercolateIndexUnavailable(new Index(INDEX_NAME));
  }
  IndexShard percolatorShard=percolatorIndex.shard(0);
  return percolator.percolate(request,percolatorIndex,percolatorShard);
}
