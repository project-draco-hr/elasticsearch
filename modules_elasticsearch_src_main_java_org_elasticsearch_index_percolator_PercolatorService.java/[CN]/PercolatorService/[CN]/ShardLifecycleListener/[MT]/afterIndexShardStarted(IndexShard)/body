{
  if (indexShard.shardId().index().name().equals(INDEX_NAME)) {
synchronized (mutex) {
      if (initialQueriesFetchDone) {
        return;
      }
      for (      IndexService indexService : indicesService) {
        if (indexService.index().equals(index())) {
          logger.debug("loading percolator queries for index [{}]...",indexService.index().name());
          loadQueries(indexService.index().name());
          logger.trace("done loading percolator queries for index [{}]",indexService.index().name());
        }
      }
      initialQueriesFetchDone=true;
    }
  }
  if (!indexShard.shardId().index().equals(index())) {
    return;
  }
  if (!percolatorAllocated()) {
    return;
  }
  IndexService indexService=indicesService.indexService(indexShard.shardId().index().name());
  if (indexService == null) {
    return;
  }
  if (indexService.numberOfShards() != 1) {
    return;
  }
synchronized (mutex) {
    if (initialQueriesFetchDone) {
      return;
    }
    logger.debug("loading percolator queries for index [{}]...",indexService.index().name());
    loadQueries(index.name());
    logger.trace("done loading percolator queries for index [{}]",indexService.index().name());
    initialQueriesFetchDone=true;
  }
}
