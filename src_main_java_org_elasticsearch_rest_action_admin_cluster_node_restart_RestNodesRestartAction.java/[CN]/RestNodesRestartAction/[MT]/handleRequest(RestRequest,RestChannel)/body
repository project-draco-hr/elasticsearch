{
  String[] nodesIds=Strings.splitStringByCommaToArray(request.param("nodeId"));
  NodesRestartRequest nodesRestartRequest=new NodesRestartRequest(nodesIds);
  nodesRestartRequest.listenerThreaded(false);
  nodesRestartRequest.delay(request.paramAsTime("delay",nodesRestartRequest.delay()));
  client.admin().cluster().nodesRestart(nodesRestartRequest,new RestBuilderListener<NodesRestartResponse>(channel){
    @Override public RestResponse buildResponse(    NodesRestartResponse result,    XContentBuilder builder) throws Exception {
      builder.startObject();
      builder.field("cluster_name",result.getClusterName().value());
      builder.startObject("nodes");
      for (      NodesRestartResponse.NodeRestartResponse nodeInfo : result) {
        builder.startObject(nodeInfo.getNode().id());
        builder.field("name",nodeInfo.getNode().name());
        builder.endObject();
      }
      builder.endObject();
      builder.endObject();
      return new BytesRestResponse(RestStatus.OK,builder);
    }
  }
);
}
