{
  for (  AtomicReaderContext readerContext : context.searcher().getTopReaderContext().leaves()) {
    int maxDoc=readerContext.reader().maxDoc();
    if (indexFieldData instanceof IndexOrdinalsFieldData) {
      RandomAccessOrds values=((IndexOrdinalsFieldData)indexFieldData).load(readerContext).getOrdinalsValues();
      for (long ord=0; ord < values.getValueCount(); ord++) {
        BytesRef value=values.lookupOrd(ord);
        aggregator.addValue(value,value.hashCode());
      }
    }
 else {
      SortedBinaryDocValues values=indexFieldData.load(readerContext).getBytesValues();
      for (int docId=0; docId < maxDoc; docId++) {
        values.setDocument(docId);
        final int size=values.count();
        for (int i=0; i < size; i++) {
          final BytesRef value=values.valueAt(i);
          aggregator.addValue(value,value.hashCode());
        }
      }
    }
  }
}
