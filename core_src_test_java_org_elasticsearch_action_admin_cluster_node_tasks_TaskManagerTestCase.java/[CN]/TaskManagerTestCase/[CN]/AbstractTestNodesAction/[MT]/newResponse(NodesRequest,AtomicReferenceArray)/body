{
  final List<NodeResponse> nodesList=new ArrayList<>();
  int failureCount=0;
  for (int i=0; i < responses.length(); i++) {
    Object resp=responses.get(i);
    if (resp instanceof NodeResponse) {
      nodesList.add((NodeResponse)resp);
    }
 else     if (resp instanceof FailedNodeException) {
      failureCount++;
    }
 else {
      logger.warn("unknown response type [{}], expected NodeLocalGatewayMetaState or FailedNodeException",resp);
    }
  }
  return new NodesResponse(clusterName,nodesList.toArray(new NodeResponse[nodesList.size()]),failureCount);
}
