{
  final Index index=indexMetaData.getIndex();
  logger.trace("[{}] writing state, reason [{}]",index,reason);
  try {
    IndexMetaData.FORMAT.write(indexMetaData,indexMetaData.getVersion(),locations);
  }
 catch (  Throwable ex) {
    logger.warn("[{}]: failed to write index state",ex,index);
    throw new IOException("failed to write state for [" + index + "]",ex);
  }
}
