{
  logger.trace("[{}] writing state, reason [{}]",indexMetaData.getIndex(),reason);
  try {
    indexStateFormat.write(indexMetaData,indexMetaData.getVersion(),nodeEnv.indexPaths(indexMetaData.getIndex().getName()));
  }
 catch (  Throwable ex) {
    logger.warn("[{}]: failed to write index state",ex,indexMetaData.getIndex());
    throw new IOException("failed to write state for [" + indexMetaData.getIndex() + "]",ex);
  }
}
