{
  if (allocation.ignoreDisable()) {
    return Decision.YES;
  }
  Settings indexSettings=allocation.routingNodes().metaData().index(shardRouting.index()).settings();
  String enableIndexValue=indexSettings.get(INDEX_ROUTING_ALLOCATION_ENABLE);
  final Allocation enable;
  if (enableIndexValue != null) {
    enable=Allocation.parse(enableIndexValue);
  }
 else {
    enable=this.enable;
  }
switch (enable) {
case ALL:
    return Decision.YES;
case NONE:
  return Decision.NO;
case NEW_PRIMARIES:
if (shardRouting.primary() && !allocation.routingNodes().routingTable().index(shardRouting.index()).shard(shardRouting.id()).primaryAllocatedPostApi()) {
  return Decision.YES;
}
 else {
  return Decision.NO;
}
case PRIMARIES:
return shardRouting.primary() ? Decision.YES : Decision.NO;
default :
throw new ElasticsearchIllegalStateException("Unknown allocation option");
}
}
