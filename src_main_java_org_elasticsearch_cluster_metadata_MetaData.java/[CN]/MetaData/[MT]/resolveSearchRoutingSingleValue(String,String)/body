{
  Map<String,Set<String>> routings=null;
  Set<String> paramRouting=null;
  if (routing != null) {
    paramRouting=Strings.splitStringByCommaToSet(routing);
  }
  Map<String,AliasMetaData> indexToRoutingMap=aliases.get(aliasOrIndex);
  if (indexToRoutingMap != null && !indexToRoutingMap.isEmpty()) {
    for (    Map.Entry<String,AliasMetaData> indexRouting : indexToRoutingMap.entrySet()) {
      if (!indexRouting.getValue().searchRoutingValues().isEmpty()) {
        Set<String> r=new THashSet<String>(indexRouting.getValue().searchRoutingValues());
        if (paramRouting != null) {
          r.retainAll(paramRouting);
        }
        if (!r.isEmpty()) {
          if (routings == null) {
            routings=newHashMap();
          }
          routings.put(indexRouting.getKey(),r);
        }
      }
 else {
        if (paramRouting != null) {
          Set<String> r=new THashSet<String>(paramRouting);
          if (routings == null) {
            routings=newHashMap();
          }
          routings.put(indexRouting.getKey(),r);
        }
      }
    }
  }
 else {
    if (paramRouting != null) {
      routings=ImmutableMap.of(aliasOrIndex,paramRouting);
    }
  }
  return routings;
}
