{
  IndexMetaData indexMetaData=indices.get(aliasOrIndex);
  if (indexMetaData != null) {
    if (indexMetaData.getState() == IndexMetaData.State.CLOSE && failClosed) {
      throw new IndexClosedException(new Index(aliasOrIndex));
    }
 else {
      return new String[]{aliasOrIndex};
    }
  }
  String[] indices=aliasAndIndexToIndexMap.getOrDefault(aliasOrIndex,Strings.EMPTY_ARRAY);
  if (indices.length == 0 && !allowNoIndices) {
    throw new IndexMissingException(new Index(aliasOrIndex));
  }
  if (indices.length > 1 && !allowMultipleIndices) {
    throw new ElasticsearchIllegalArgumentException("Alias [" + aliasOrIndex + "] has more than one indices associated with it ["+ Arrays.toString(indices)+ "], can't execute a single index op");
  }
  indexMetaData=this.indices.get(aliasOrIndex);
  if (indexMetaData != null && indexMetaData.getState() == IndexMetaData.State.CLOSE && failClosed) {
    throw new IndexClosedException(new Index(aliasOrIndex));
  }
  return indices;
}
