{
  NodesInfoResponse nodeInfos=null;
  try {
    nodeInfos=getTransportClient().admin().cluster().prepareNodesInfo().execute().actionGet();
  }
 catch (  NoNodeAvailableException e) {
    nodeInfos=getNodeClient().admin().cluster().prepareNodesInfo().execute().actionGet();
  }
  Assert.assertNotNull(nodeInfos);
  Assert.assertNotNull(nodeInfos.getNodes());
  if (fail) {
    Assert.assertEquals(expected,nodeInfos.getNodes().length);
  }
 else {
    if (nodeInfos.getNodes().length != expected) {
      logger.warn("expected {} node(s) but found {}. Could be due to no local IP address available.",expected,nodeInfos.getNodes().length);
    }
  }
}
