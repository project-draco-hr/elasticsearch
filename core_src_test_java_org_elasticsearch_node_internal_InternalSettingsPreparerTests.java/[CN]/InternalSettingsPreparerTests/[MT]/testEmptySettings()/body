{
  Settings settings=InternalSettingsPreparer.prepareSettings(Settings.EMPTY);
  assertNotNull(settings.get("name"));
  assertNotNull(settings.get(ClusterName.SETTING));
  assertEquals(settings.toString(),2,settings.names().size());
  Tuple<Settings,Environment> settingsAndEnv=InternalSettingsPreparer.prepareSettingsAndEnvironment(baseEnvSettings,null);
  settings=settingsAndEnv.v1();
  assertNotNull(settings.get("name"));
  assertNotNull(settings.get(ClusterName.SETTING));
  assertEquals(settings.toString(),3,settings.names().size());
  String home=baseEnvSettings.get("path.home");
  String configDir=settingsAndEnv.v2().configFile().toString();
  assertTrue(configDir,configDir.startsWith(home));
}
