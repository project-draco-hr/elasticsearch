{
  while (true) {
    if (closed.get()) {
      throw new TranslogException(shardId,"translog is already closed");
    }
    FsChannelSnapshot snapshot=current.snapshot();
    if (snapshot != null) {
      return snapshot;
    }
    Thread.yield();
  }
}
