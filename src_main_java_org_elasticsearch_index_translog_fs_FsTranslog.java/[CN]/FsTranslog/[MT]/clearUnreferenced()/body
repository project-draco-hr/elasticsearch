{
  rwl.writeLock().lock();
  int deleted=0;
  try {
    for (    Path location : locations) {
      try (DirectoryStream<Path> stream=Files.newDirectoryStream(location,TRANSLOG_FILE_PREFIX + "[0-9]*")){
        for (        Path file : stream) {
          if (isReferencedTranslogFile(file) == false) {
            try {
              logger.trace("delete unreferenced translog file: " + file);
              Files.delete(file);
              deleted++;
            }
 catch (            Exception ex) {
              logger.debug("failed to delete " + file,ex);
            }
          }
        }
      }
     }
  }
 catch (  IOException ex) {
    logger.debug("failed to clear unreferenced files ",ex);
  }
 finally {
    rwl.writeLock().unlock();
  }
  return deleted;
}
