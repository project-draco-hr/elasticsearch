{
  FsTranslogFile newFile;
  long size=Long.MAX_VALUE;
  try {
    long id=idGenerator++;
    newFile=type.create(shardId,id,new InternalChannelReference(id,location.resolve(getFilename(id)),StandardOpenOption.READ,StandardOpenOption.WRITE,StandardOpenOption.CREATE_NEW),bufferSize);
  }
 catch (  IOException e) {
    throw new TranslogException(shardId,"failed to create new translog file",e);
  }
  if (reuse != null) {
    newFile.reuse(reuse);
  }
  return newFile;
}
