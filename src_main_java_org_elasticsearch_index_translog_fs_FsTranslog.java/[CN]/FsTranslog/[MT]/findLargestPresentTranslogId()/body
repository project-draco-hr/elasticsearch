{
  rwl.readLock().lock();
  try {
    long maxId=this.currentId();
    for (    Path location : locations()) {
      try (DirectoryStream<Path> stream=Files.newDirectoryStream(location,TRANSLOG_FILE_PREFIX + "[0-9]*")){
        for (        Path translogFile : stream) {
          try {
            final String fileName=translogFile.getFileName().toString();
            final Matcher matcher=PARSE_ID_PATTERN.matcher(fileName);
            if (matcher.matches()) {
              maxId=Math.max(maxId,Long.parseLong(matcher.group(1)));
            }
          }
 catch (          NumberFormatException ex) {
            logger.warn("Couldn't parse translog id from file " + translogFile + " skipping");
          }
        }
      }
     }
    return maxId;
  }
  finally {
    rwl.readLock().unlock();
  }
}
