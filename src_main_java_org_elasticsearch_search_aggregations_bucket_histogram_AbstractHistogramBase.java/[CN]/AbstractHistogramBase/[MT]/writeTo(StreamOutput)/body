{
  out.writeString(name);
  InternalOrder.Streams.writeOrder(order,out);
  if (emptyBucketInfo == null) {
    out.writeBoolean(false);
  }
 else {
    out.writeBoolean(true);
    EmptyBucketInfo.writeTo(emptyBucketInfo,out);
  }
  ValueFormatterStreams.writeOptional(formatter,out);
  out.writeBoolean(keyed);
  out.writeVInt(buckets.size());
  for (  HistogramBase.Bucket bucket : buckets) {
    out.writeLong(((Bucket)bucket).key);
    out.writeVLong(((Bucket)bucket).docCount);
    ((Bucket)bucket).aggregations.writeTo(out);
  }
}
