{
  double longitudeDifference=lon2 - lon1;
  double a=Math.toRadians(90D - lat1);
  double c=Math.toRadians(90D - lat2);
  double factor=(Math.cos(a) * Math.cos(c)) + (Math.sin(a) * Math.sin(c) * Math.cos(Math.toRadians(longitudeDifference)));
  if (factor < -1D) {
    return Math.PI * GeoUtils.EARTH_MEAN_RADIUS;
  }
 else   if (factor >= 1D) {
    return 0;
  }
 else {
    return Math.acos(factor) * GeoUtils.EARTH_MEAN_RADIUS;
  }
}
