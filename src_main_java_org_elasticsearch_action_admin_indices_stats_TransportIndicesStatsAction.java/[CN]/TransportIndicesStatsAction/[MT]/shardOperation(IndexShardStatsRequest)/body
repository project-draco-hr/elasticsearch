{
  InternalIndexService indexService=(InternalIndexService)indicesService.indexServiceSafe(request.getIndex());
  InternalIndexShard indexShard=(InternalIndexShard)indexService.shardSafe(request.getShardId());
  ShardStats stats=new ShardStats(indexShard.routingEntry());
  if (request.request.isDocs()) {
    stats.stats.docs=indexShard.docStats();
  }
  if (request.request.isStore()) {
    stats.stats.store=indexShard.storeStats();
  }
  if (request.request.isIndexing()) {
    stats.stats.indexing=indexShard.indexingStats(request.request.getTypes());
  }
  if (request.request.isGet()) {
    stats.stats.get=indexShard.getStats();
  }
  if (request.request.isSearch()) {
    stats.getStats().search=indexShard.searchStats(request.request.getGroups());
  }
  if (request.request.isMerge()) {
    stats.stats.merge=indexShard.mergeStats();
  }
  if (request.request.isRefresh()) {
    stats.stats.refresh=indexShard.refreshStats();
  }
  if (request.request.isFlush()) {
    stats.stats.flush=indexShard.flushStats();
  }
  if (request.request.isWarmer()) {
    stats.stats.warmer=indexShard.warmerStats();
  }
  return stats;
}
