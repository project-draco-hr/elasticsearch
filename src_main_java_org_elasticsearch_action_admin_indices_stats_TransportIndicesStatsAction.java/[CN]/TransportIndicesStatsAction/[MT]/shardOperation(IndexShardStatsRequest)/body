{
  InternalIndexService indexService=(InternalIndexService)indicesService.indexServiceSafe(request.index());
  InternalIndexShard indexShard=(InternalIndexShard)indexService.shardSafe(request.shardId());
  ShardStats stats=new ShardStats(indexShard.routingEntry());
  if (request.request.docs()) {
    stats.stats.docs=indexShard.docStats();
  }
  if (request.request.store()) {
    stats.stats.store=indexShard.storeStats();
  }
  if (request.request.indexing()) {
    stats.stats.indexing=indexShard.indexingStats(request.request.types());
  }
  if (request.request.get()) {
    stats.stats.get=indexShard.getStats();
  }
  if (request.request.search()) {
    stats.getStats().search=indexShard.searchStats(request.request.groups());
  }
  if (request.request.merge()) {
    stats.stats.merge=indexShard.mergeStats();
  }
  if (request.request.refresh()) {
    stats.stats.refresh=indexShard.refreshStats();
  }
  if (request.request.flush()) {
    stats.stats.flush=indexShard.flushStats();
  }
  if (request.request.warmer()) {
    stats.stats.warmer=indexShard.warmerStats();
  }
  if (request.request.filterCache()) {
    stats.stats.filterCache=indexShard.filterCacheStats();
  }
  if (request.request.idCache()) {
    stats.stats.idCache=indexShard.idCacheStats();
  }
  return stats;
}
