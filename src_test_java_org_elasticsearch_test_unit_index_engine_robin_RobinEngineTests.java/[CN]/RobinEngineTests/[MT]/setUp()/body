{
  defaultSettings=ImmutableSettings.builder().put(RobinEngine.INDEX_COMPOUND_ON_FLUSH,getRandom().nextBoolean()).build();
  threadPool=new ThreadPool();
  store=createStore();
  store.deleteContent();
  storeReplica=createStoreReplica();
  storeReplica.deleteContent();
  engineSettingsService=new IndexSettingsService(shardId.index(),EMPTY_SETTINGS);
  engine=createEngine(engineSettingsService,store,createTranslog());
  engine.start();
  replicaSettingsService=new IndexSettingsService(shardId.index(),EMPTY_SETTINGS);
  replicaEngine=createEngine(replicaSettingsService,storeReplica,createTranslogReplica());
  replicaEngine.start();
}
