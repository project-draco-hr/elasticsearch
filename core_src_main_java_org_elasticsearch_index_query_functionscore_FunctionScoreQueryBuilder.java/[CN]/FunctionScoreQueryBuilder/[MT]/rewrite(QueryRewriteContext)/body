{
  QueryBuilder<?> queryBuilder=this.query.rewrite(queryShardContext);
  if (queryBuilder != query) {
    FunctionScoreQueryBuilder newQueryBuilder=new FunctionScoreQueryBuilder(queryBuilder,filterFunctionBuilders);
    newQueryBuilder.scoreMode=scoreMode;
    newQueryBuilder.minScore=minScore;
    newQueryBuilder.maxBoost=maxBoost;
    return newQueryBuilder.queryName(queryName()).boost(boost());
  }
  return this;
}
