{
  Map<String,Object> sourceAsMap=indexRequest.sourceAsMap();
  Data data=new Data(indexRequest.index(),indexRequest.type(),indexRequest.id(),sourceAsMap);
  executionService.execute(data,pipelineId,new PipelineExecutionService.Listener(){
    @Override public void executed(    Data data){
      if (data.isModified()) {
        indexRequest.source(data.getDocument());
      }
      chain.proceed(action,indexRequest,listener);
    }
    @Override public void failed(    Exception e){
      logger.error("failed to execute pipeline [{}]",e,pipelineId);
      listener.onFailure(e);
    }
  }
);
}
