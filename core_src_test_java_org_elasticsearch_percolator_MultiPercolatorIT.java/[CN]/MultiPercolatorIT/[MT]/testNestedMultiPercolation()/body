{
  initNestedIndexAndPercolation();
  MultiPercolateRequestBuilder mpercolate=client().prepareMultiPercolate();
  mpercolate.add(client().preparePercolate().setPercolateDoc(new PercolateSourceBuilder.DocBuilder().setDoc(getNotMatchingNestedDoc())).setIndices("nestedindex").setDocumentType("company"));
  mpercolate.add(client().preparePercolate().setPercolateDoc(new PercolateSourceBuilder.DocBuilder().setDoc(getMatchingNestedDoc())).setIndices("nestedindex").setDocumentType("company"));
  MultiPercolateResponse response=mpercolate.get();
  assertEquals(response.getItems()[0].getResponse().getMatches().length,0);
  assertEquals(response.getItems()[1].getResponse().getMatches().length,1);
  assertEquals(response.getItems()[1].getResponse().getMatches()[0].getId().string(),"Q");
}
