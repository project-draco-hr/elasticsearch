{
  final List<URL> jars=new ArrayList<>();
  ClassLoader loader=PluginManager.class.getClassLoader();
  if (loader instanceof URLClassLoader) {
    Collections.addAll(jars,((URLClassLoader)loader).getURLs());
  }
  List<Bundle> bundles=PluginsService.getPluginBundles(environment.pluginsFile());
  if (isolated == false) {
    jars.addAll(bundles.get(0).urls);
  }
  Path pluginJars[]=FileSystemUtils.files(candidate,"*.jar");
  for (  Path jar : pluginJars) {
    jars.add(jar.toUri().toURL());
  }
  try {
    JarHell.checkJarHell(jars.toArray(new URL[jars.size()]));
  }
 catch (  Exception ex) {
    throw new RuntimeException(ex);
  }
}
