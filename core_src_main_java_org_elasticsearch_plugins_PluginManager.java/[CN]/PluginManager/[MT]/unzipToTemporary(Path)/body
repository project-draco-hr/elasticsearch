{
  Path tmp=Files.createTempDirectory(environment.tmpFile(),null);
  try (ZipInputStream zipInput=new ZipInputStream(Files.newInputStream(zip))){
    ZipEntry entry;
    byte[] buffer=new byte[8192];
    while ((entry=zipInput.getNextEntry()) != null) {
      Path targetFile=tmp.resolve(entry.getName());
      Files.createDirectories(targetFile.getParent());
      if (!entry.isDirectory()) {
        OutputStream out=Files.newOutputStream(targetFile);
        int len;
        while ((len=zipInput.read(buffer)) >= 0) {
          out.write(buffer,0,len);
        }
        out.close();
      }
      zipInput.closeEntry();
    }
  }
   return tmp;
}
