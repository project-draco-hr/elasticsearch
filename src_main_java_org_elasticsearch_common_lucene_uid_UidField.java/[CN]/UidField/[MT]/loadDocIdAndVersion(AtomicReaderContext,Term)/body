{
  int docId=Lucene.NO_DOC;
  try {
    Terms terms=context.reader().terms(term.field());
    if (terms == null) {
      return null;
    }
    if (terms instanceof BloomFilterPostingsFormat.BloomFilteredFieldsProducer.BloomFilteredTerms) {
      if (!((BloomFilterPostingsFormat.BloomFilteredFieldsProducer.BloomFilteredTerms)terms).getFilter().mightContain(term.bytes())) {
        return null;
      }
    }
    TermsEnum termsEnum=terms.iterator(null);
    if (termsEnum == null) {
      return null;
    }
    if (!termsEnum.seekExact(term.bytes(),true)) {
      return null;
    }
    DocsAndPositionsEnum uid=termsEnum.docsAndPositions(context.reader().getLiveDocs(),null,DocsAndPositionsEnum.FLAG_PAYLOADS);
    if (uid == null || uid.nextDoc() == DocIdSetIterator.NO_MORE_DOCS) {
      return null;
    }
    do {
      docId=uid.docID();
      uid.nextPosition();
      if (uid.getPayload() == null) {
        continue;
      }
      if (uid.getPayload().length < 8) {
        continue;
      }
      byte[] payload=new byte[uid.getPayload().length];
      System.arraycopy(uid.getPayload().bytes,uid.getPayload().offset,payload,0,uid.getPayload().length);
      return new DocIdAndVersion(docId,Numbers.bytesToLong(payload),context);
    }
 while (uid.nextDoc() != DocIdSetIterator.NO_MORE_DOCS);
    return new DocIdAndVersion(docId,-2,context);
  }
 catch (  Exception e) {
    return new DocIdAndVersion(docId,-2,context);
  }
}
