{
  List<InternalAggregations> aggregationsList=new ArrayList<>(buckets.size());
  long docCount=0;
  double cLon=0;
  double cLat=0;
  for (  Bucket bucket : buckets) {
    docCount+=bucket.docCount;
    cLon+=(bucket.docCount * bucket.centroid.lon());
    cLat+=(bucket.docCount * bucket.centroid.lat());
    aggregationsList.add(bucket.aggregations);
  }
  final InternalAggregations aggs=InternalAggregations.reduce(aggregationsList,context);
  return new Bucket(geohashAsLong,docCount,new GeoPoint(cLat / docCount,cLon / docCount),aggs);
}
