{
  LogDocMergePolicy mergePolicy;
  if (asyncMerge) {
    mergePolicy=new EnableMergeLogDocMergePolicy(indexWriter);
  }
 else {
    mergePolicy=new LogDocMergePolicy(indexWriter);
  }
  mergePolicy.setMinMergeDocs(minMergeDocs);
  mergePolicy.setMaxMergeDocs(maxMergeDocs);
  mergePolicy.setMergeFactor(mergeFactor);
  mergePolicy.setCalibrateSizeByDeletes(calibrateSizeByDeletes);
  return mergePolicy;
}
