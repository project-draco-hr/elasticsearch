{
  StringHelper.randomId();
  InputStream config=Security.class.getResourceAsStream(POLICY_RESOURCE);
  if (config == null) {
    throw new NoSuchFileException(POLICY_RESOURCE);
  }
  Path newConfig=processTemplate(config,environment);
  System.setProperty("java.security.policy",newConfig.toString());
  try {
    Policy policy=Policy.getInstance("JavaPolicy",new URIParameter(newConfig.toUri()));
    System.out.println(policy.getPermissions(Security.class.getProtectionDomain()));
  }
 catch (  NoSuchAlgorithmException e) {
    throw new RuntimeException();
  }
  System.setSecurityManager(new SecurityManager());
  try {
    Files.delete(newConfig);
  }
 catch (  IOException ignore) {
  }
}
