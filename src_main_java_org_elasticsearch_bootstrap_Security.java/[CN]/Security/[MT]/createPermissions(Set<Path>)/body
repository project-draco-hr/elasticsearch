{
  ByteArrayOutputStream stream=new ByteArrayOutputStream();
  try (Writer writer=new OutputStreamWriter(stream,StandardCharsets.UTF_8)){
    writer.write(System.lineSeparator());
    writer.write("grant {");
    writer.write(System.lineSeparator());
    for (    Path path : paths) {
      addPath(writer,encode(path),"read,readlink,write,delete");
      addRecursivePath(writer,encode(path),"read,readlink,write,delete");
    }
    if (!Constants.WINDOWS) {
      Set<String> stores=new HashSet<>();
      for (      FileStore store : PathUtils.getDefaultFileSystem().getFileStores()) {
        try {
          String mount=NodeEnvironment.getMountPoint(store);
          if (mount.startsWith("/")) {
            stores.add(mount);
          }
          if (store.name().startsWith("/")) {
            stores.add(store.name());
          }
        }
 catch (        Throwable t) {
        }
      }
      for (      String store : stores) {
        addPath(writer,encode(store),"read,readlink");
      }
      addRecursivePath(writer,"/sys/block","read,readlink");
      addRecursivePath(writer,"/sys/devices","read,readlink");
      addRecursivePath(writer,"/dev","read,readlink");
      addRecursivePath(writer,"/devices","read,readlink");
    }
    writer.write("};");
    writer.write(System.lineSeparator());
  }
   return stream.toByteArray();
}
