{
  Permissions policy=new Permissions();
  if (addTempDir) {
    addPath(policy,PathUtils.get(System.getProperty("java.io.tmpdir")),"read,readlink,write,delete");
  }
  addPath(policy,environment.homeFile(),"read,readlink,write,delete");
  addPath(policy,environment.configFile(),"read,readlink,write,delete");
  addPath(policy,environment.logsFile(),"read,readlink,write,delete");
  addPath(policy,environment.pluginsFile(),"read,readlink,write,delete");
  for (  Path path : environment.dataFiles()) {
    addPath(policy,path,"read,readlink,write,delete");
  }
  for (  Path path : environment.dataWithClusterFiles()) {
    addPath(policy,path,"read,readlink,write,delete");
  }
  return policy;
}
