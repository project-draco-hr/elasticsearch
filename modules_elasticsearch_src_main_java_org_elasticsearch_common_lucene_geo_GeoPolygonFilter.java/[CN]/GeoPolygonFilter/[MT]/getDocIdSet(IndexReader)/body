{
  final GeoPointFieldData fieldData=(GeoPointFieldData)fieldDataCache.cache(GeoPointFieldDataType.TYPE,reader,fieldName);
  return new GetDocSet(reader.maxDoc()){
    @Override public boolean get(    int doc) throws IOException {
      if (!fieldData.hasValue(doc)) {
        return false;
      }
      if (fieldData.multiValued()) {
        GeoPoint[] docPoints=fieldData.values(doc);
        for (        GeoPoint docPoint : docPoints) {
          if (pointInPolygon(points,docPoint.lat(),docPoint.lon())) {
            return true;
          }
        }
      }
 else {
        GeoPoint point=fieldData.value(doc);
        return pointInPolygon(points,point.lat(),point.lon());
      }
      return false;
    }
  }
;
}
