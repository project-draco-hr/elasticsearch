{
  final NumericFieldData latFieldData=(NumericFieldData)fieldDataCache.cache(fieldDataType,reader,latFieldName);
  final NumericFieldData lonFieldData=(NumericFieldData)fieldDataCache.cache(fieldDataType,reader,lonFieldName);
  return new GetDocSet(reader.maxDoc()){
    @Override public boolean get(    int doc) throws IOException {
      if (!latFieldData.hasValue(doc) || !lonFieldData.hasValue(doc)) {
        return false;
      }
      if (latFieldData.multiValued()) {
        double[] lats=latFieldData.doubleValues(doc);
        double[] lons=latFieldData.doubleValues(doc);
        for (int i=0; i < lats.length; i++) {
          if (pointInPolygon(points,lats[i],lons[i])) {
            return true;
          }
        }
      }
 else {
        double lat=latFieldData.doubleValue(doc);
        double lon=lonFieldData.doubleValue(doc);
        return pointInPolygon(points,lat,lon);
      }
      return false;
    }
  }
;
}
