{
  int i;
  int j=points.length - 1;
  boolean inPoly=false;
  for (i=0; i < points.length; i++) {
    if (points[i].lon < lon && points[j].lon >= lon || points[j].lon < lon && points[i].lon >= lon) {
      if (points[i].lat + (lon - points[i].lon) / (points[j].lon - points[i].lon) * (points[j].lat - points[i].lat) < lat) {
        inPoly=!inPoly;
      }
    }
    j=i;
  }
  return inPoly;
}
