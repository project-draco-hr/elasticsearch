{
  result.length=0;
  result.offset=0;
  for (int i=0; i < toJoin.length - 1; i++) {
    BytesRef br=toJoin[i];
    System.arraycopy(br.bytes,br.offset,result.bytes,result.offset,br.length);
    result.offset+=br.length;
    System.arraycopy(separator.bytes,separator.offset,result.bytes,result.offset,separator.length);
    result.offset+=separator.length;
  }
  final BytesRef br=toJoin[toJoin.length - 1];
  System.arraycopy(br.bytes,br.offset,result.bytes,result.offset,br.length);
  result.length=result.offset + br.length;
  result.offset=0;
  return result;
}
