{
  delegate=canonicalize(delegate);
  if (delegate == getSystemClassLoaderOrNull()) {
    return delegate;
  }
  if (delegate instanceof BridgeClassLoader) {
    return delegate;
  }
  if (HOOK_ENABLED && Visibility.forType(type) == Visibility.PUBLIC) {
    return CLASS_LOADER_CACHE.get(delegate);
  }
  return delegate;
}
