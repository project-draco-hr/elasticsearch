{
  final Directory directory=getDirectory(source);
  final Directory targetDir=nameDirMapping.get(dest);
  if (targetDir != null && targetDir != directory) {
    throw new IOException("Can't rename file from " + source + " to: "+ dest+ ": target file already exists in a different directory");
  }
  directory.renameFile(source,dest);
  nameDirMapping.remove(source);
  nameDirMapping.put(dest,directory);
}
