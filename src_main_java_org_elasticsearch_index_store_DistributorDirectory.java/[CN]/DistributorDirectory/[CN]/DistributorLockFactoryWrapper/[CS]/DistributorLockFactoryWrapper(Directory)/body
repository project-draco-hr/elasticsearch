{
  this.dir=dir;
  final FSDirectory leaf=DirectoryUtils.getLeaf(dir,FSDirectory.class);
  if (leaf != null) {
    writesFiles=leaf.getLockFactory() instanceof FSLockFactory;
  }
 else {
    writesFiles=false;
  }
  this.delegate=dir.getLockFactory();
}
