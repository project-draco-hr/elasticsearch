{
switch (random.nextInt(2)) {
case 0:
    return new RamDirectoryService(shardId,indexSettings);
default :
  return new ByteBufferDirectoryService(shardId,indexSettings,byteBufferCache);
}
}
