{
  super(settings);
  this.indicesService=indicesService;
  String indexingBuffer=componentSettings.get("index_buffer_size","40%");
  if (indexingBuffer.endsWith("%")) {
    double percent=Double.parseDouble(indexingBuffer.substring(0,indexingBuffer.length() - 1));
    this.indexingBuffer=new ByteSizeValue((long)(((double)JvmInfo.jvmInfo().mem().heapMax().bytes()) * (percent / 100)));
  }
 else {
    this.indexingBuffer=ByteSizeValue.parseBytesSizeValue(indexingBuffer,null);
  }
  this.minShardIndexBufferSize=componentSettings.getAsBytesSize("min_shard_index_buffer_size",new ByteSizeValue(4,ByteSizeUnit.MB));
  logger.debug("using index_buffer_size [{}], with min_shard_index_buffer_size [{}]",this.indexingBuffer,this.minShardIndexBufferSize);
  indicesService.indicesLifecycle().addListener(listener);
}
