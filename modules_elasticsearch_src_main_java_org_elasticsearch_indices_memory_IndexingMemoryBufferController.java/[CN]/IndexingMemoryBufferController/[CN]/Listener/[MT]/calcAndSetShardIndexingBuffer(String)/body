{
  int shardsCount=countShards();
  if (shardsCount == 0) {
    return;
  }
  ByteSizeValue shardIndexingBuffer=calcShardIndexingBuffer(shardsCount);
  if (shardIndexingBuffer == null) {
    return;
  }
  logger.debug("recalculating shard indexing buffer (reason={}), total is [{}] with [{}] shards, each shard set to [{}]",reason,indexingBuffer,shardsCount,shardIndexingBuffer);
  for (  IndexService indexService : indicesService) {
    for (    IndexShard indexShard : indexService) {
      ((InternalIndexShard)indexShard).engine().indexingBuffer(shardIndexingBuffer);
    }
  }
}
