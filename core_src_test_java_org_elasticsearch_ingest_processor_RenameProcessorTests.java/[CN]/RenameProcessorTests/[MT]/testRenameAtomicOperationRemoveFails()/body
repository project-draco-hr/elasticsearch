{
  Map<String,Object> source=new HashMap<String,Object>(){
    private static final long serialVersionUID=362498820763181265L;
    @Override public Object remove(    Object key){
      if (key.equals("list")) {
        throw new UnsupportedOperationException();
      }
      return super.remove(key);
    }
  }
;
  source.put("list",Collections.singletonList("item"));
  IngestDocument ingestDocument=new IngestDocument(source,Collections.emptyMap());
  Processor processor=new RenameProcessor("list","new_field");
  try {
    processor.execute(ingestDocument);
    fail("processor execute should have failed");
  }
 catch (  UnsupportedOperationException e) {
    assertThat(ingestDocument.getSourceAndMetadata().containsKey("list"),equalTo(true));
    assertThat(ingestDocument.getSourceAndMetadata().containsKey("new_field"),equalTo(false));
  }
}
