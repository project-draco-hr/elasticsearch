{
  this.standardPolicy=new ESPolicy(standard,Collections.emptyMap());
  this.extraPermissions=extra;
  excludedSources=new HashSet<CodeSource>();
  excludedSources.add(Bootstrap.class.getProtectionDomain().getCodeSource());
  excludedSources.add(getClass().getProtectionDomain().getCodeSource());
  excludedSources.add(LuceneTestCase.class.getProtectionDomain().getCodeSource());
  excludedSources.add(RandomizedRunner.class.getProtectionDomain().getCodeSource());
  excludedSources.add(Assert.class.getProtectionDomain().getCodeSource());
  excludedSources.add(new CodeSource(new URL("file:" + BootstrapInfo.UNTRUSTED_CODEBASE),(Certificate[])null));
  Loggers.getLogger(getClass()).debug("Apply extra permissions [{}] excluding codebases [{}]",extraPermissions,excludedSources);
}
