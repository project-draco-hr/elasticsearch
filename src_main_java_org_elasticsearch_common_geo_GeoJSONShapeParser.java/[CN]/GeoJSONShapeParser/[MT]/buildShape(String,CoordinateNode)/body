{
  if ("point".equals(shapeType)) {
    return new JtsPoint(GEOMETRY_FACTORY.createPoint(node.coordinate),GeoShapeConstants.SPATIAL_CONTEXT);
  }
 else   if ("linestring".equals(shapeType)) {
    return new JtsGeometry(GEOMETRY_FACTORY.createLineString(toCoordinates(node)),GeoShapeConstants.SPATIAL_CONTEXT,true);
  }
 else   if ("polygon".equals(shapeType)) {
    LinearRing shell=GEOMETRY_FACTORY.createLinearRing(toCoordinates(node.children.get(0)));
    LinearRing[] holes=null;
    if (node.children.size() > 1) {
      holes=new LinearRing[node.children.size() - 1];
      for (int i=0; i < node.children.size() - 1; i++) {
        holes[i]=GEOMETRY_FACTORY.createLinearRing(toCoordinates(node.children.get(i + 1)));
      }
    }
    return new JtsGeometry(GEOMETRY_FACTORY.createPolygon(shell,holes),GeoShapeConstants.SPATIAL_CONTEXT,true);
  }
 else   if ("multipoint".equals(shapeType)) {
    return new JtsGeometry(GEOMETRY_FACTORY.createMultiPoint(toCoordinates(node)),GeoShapeConstants.SPATIAL_CONTEXT,true);
  }
 else   if ("envelope".equals(shapeType)) {
    Coordinate[] coordinates=toCoordinates(node);
    return new RectangleImpl(coordinates[0].x,coordinates[1].x,coordinates[1].y,coordinates[0].y,GeoShapeConstants.SPATIAL_CONTEXT);
  }
  throw new UnsupportedOperationException("ShapeType [" + shapeType + "] not supported");
}
