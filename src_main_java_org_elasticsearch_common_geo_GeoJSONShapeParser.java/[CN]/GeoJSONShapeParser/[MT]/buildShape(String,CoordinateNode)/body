{
  if ("point".equals(shapeType)) {
    return new JtsPoint(GEOMETRY_FACTORY.createPoint(node.coordinate),GeoShapeConstants.SPATIAL_CONTEXT);
  }
 else   if ("linestring".equals(shapeType)) {
    return new JtsGeometry(GEOMETRY_FACTORY.createLineString(toCoordinates(node)),GeoShapeConstants.SPATIAL_CONTEXT,true);
  }
 else   if ("polygon".equals(shapeType)) {
    return new JtsGeometry(buildPolygon(node),GeoShapeConstants.SPATIAL_CONTEXT,true);
  }
 else   if ("multipoint".equals(shapeType)) {
    return new JtsGeometry(GEOMETRY_FACTORY.createMultiPoint(toCoordinates(node)),GeoShapeConstants.SPATIAL_CONTEXT,true);
  }
 else   if ("envelope".equals(shapeType)) {
    Coordinate[] coordinates=toCoordinates(node);
    return new RectangleImpl(coordinates[0].x,coordinates[1].x,coordinates[1].y,coordinates[0].y,GeoShapeConstants.SPATIAL_CONTEXT);
  }
 else   if ("multipolygon".equals(shapeType)) {
    Polygon[] polygons=new Polygon[node.children.size()];
    for (int i=0; i < node.children.size(); i++) {
      polygons[i]=buildPolygon(node.children.get(i));
    }
    return new JtsGeometry(GEOMETRY_FACTORY.createMultiPolygon(polygons),GeoShapeConstants.SPATIAL_CONTEXT,true);
  }
  throw new UnsupportedOperationException("ShapeType [" + shapeType + "] not supported");
}
