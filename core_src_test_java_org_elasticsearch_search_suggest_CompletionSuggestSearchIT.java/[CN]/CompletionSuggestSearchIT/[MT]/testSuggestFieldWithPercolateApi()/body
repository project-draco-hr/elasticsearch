{
  createIndexAndMapping(completionMappingBuilder);
  String[][] inputs={{"Foo Fighters"},{"Foo Fighters"},{"Foo Fighters"},{"Foo Fighters"},{"Generator","Foo Fighters Generator"},{"Learn to Fly","Foo Fighters Learn to Fly"},{"The Prodigy"},{"The Prodigy"},{"The Prodigy"},{"Firestarter","The Prodigy Firestarter"},{"Turbonegro"},{"Turbonegro"},{"Get it on","Turbonegro Get it on"}};
  for (int i=0; i < inputs.length; i++) {
    XContentBuilder source=jsonBuilder().startObject().startObject(FIELD).startArray("input");
    for (    String input : inputs[i]) {
      source.value(input);
    }
    source.endArray().endObject().endObject();
    client().prepareIndex(INDEX,TYPE,"" + i).setSource(source).execute().actionGet();
  }
  client().prepareIndex(INDEX,PercolatorService.TYPE_NAME,"4").setSource(jsonBuilder().startObject().field("query",matchAllQuery()).endObject()).execute().actionGet();
  refresh();
  PercolateResponse response=client().preparePercolate().setIndices(INDEX).setDocumentType(TYPE).setGetRequest(Requests.getRequest(INDEX).type(TYPE).id("1")).execute().actionGet();
  assertThat(response.getCount(),equalTo(1l));
}
