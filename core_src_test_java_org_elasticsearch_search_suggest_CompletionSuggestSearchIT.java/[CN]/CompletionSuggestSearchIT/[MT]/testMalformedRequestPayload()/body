{
  final CompletionMappingBuilder mapping=new CompletionMappingBuilder();
  createIndexAndMapping(mapping);
  SuggestRequest request=new SuggestRequest(INDEX);
  XContentBuilder suggest=jsonBuilder().startObject().startObject("bad-payload").field("prefix","sug").startObject("completion").field("field",FIELD).startArray("payload").startObject().field("payload","field").endObject().endArray().endObject().endObject().endObject();
  request.suggest(suggest.bytes());
  ensureGreen();
  SuggestResponse suggestResponse=client().suggest(request).get();
  assertThat(suggestResponse.getSuccessfulShards(),equalTo(0));
  for (  ShardOperationFailedException exception : suggestResponse.getShardFailures()) {
    assertThat(exception.reason(),containsString("expected string values in [payload] array"));
  }
}
