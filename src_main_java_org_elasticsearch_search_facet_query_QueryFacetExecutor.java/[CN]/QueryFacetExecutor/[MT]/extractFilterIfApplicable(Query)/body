{
  if (query instanceof XFilteredQuery) {
    XFilteredQuery fQuery=(XFilteredQuery)query;
    if (Queries.isConstantMatchAllQuery(fQuery.getQuery())) {
      return fQuery.getFilter();
    }
  }
 else   if (query instanceof XConstantScoreQuery) {
    return ((XConstantScoreQuery)query).getFilter();
  }
 else   if (query instanceof ConstantScoreQuery) {
    ConstantScoreQuery constantScoreQuery=(ConstantScoreQuery)query;
    if (constantScoreQuery.getFilter() != null) {
      return constantScoreQuery.getFilter();
    }
  }
 else   if (query instanceof XLuceneConstantScoreQuery) {
    return ((XLuceneConstantScoreQuery)query).getFilter();
  }
  return null;
}
