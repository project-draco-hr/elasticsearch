{
  byte[] data=Streams.copyToBytesFromClasspath("/org/elasticsearch/test/unit/action/search/simple-msearch1.json");
  MultiSearchRequest request=new MultiSearchRequest().add(data,0,data.length,false,null,null,null);
  assertThat(request.getRequests().size(),equalTo(5));
  assertThat(request.getRequests().get(0).getIndices()[0],equalTo("test"));
  assertThat(request.getRequests().get(0).getTypes().length,equalTo(0));
  assertThat(request.getRequests().get(1).getIndices()[0],equalTo("test"));
  assertThat(request.getRequests().get(1).getTypes()[0],equalTo("type1"));
  assertThat(request.getRequests().get(2).getIndices(),nullValue());
  assertThat(request.getRequests().get(2).getTypes().length,equalTo(0));
  assertThat(request.getRequests().get(3).getIndices(),nullValue());
  assertThat(request.getRequests().get(3).getTypes().length,equalTo(0));
  assertThat(request.getRequests().get(3).getSearchType(),equalTo(SearchType.COUNT));
  assertThat(request.getRequests().get(4).getIndices(),nullValue());
  assertThat(request.getRequests().get(4).getTypes().length,equalTo(0));
}
