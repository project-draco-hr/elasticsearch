{
  final String uniqueContextSuffix="/testPathPrefixUnknownPath";
  final String pathPrefix="dne/" + randomAsciiOfLengthBetween(1,5) + "/";
  final int statusCode=randomStatusCode(getRandom());
  try (final RestClient client=RestClient.builder(new HttpHost(httpServer.getAddress().getHostString(),httpServer.getAddress().getPort())).setPathPrefix((randomBoolean() ? "/" : "") + pathPrefix).build()){
    for (    final String method : getHttpMethods()) {
      Response esResponse;
      try {
        esResponse=client.performRequest(method,"/" + statusCode + uniqueContextSuffix);
        if ("HEAD".equals(method) == false) {
          fail("only HEAD requests should not throw an exception; 404 is expected");
        }
      }
 catch (      ResponseException e) {
        esResponse=e.getResponse();
      }
      assertThat(esResponse.getRequestLine().getUri(),equalTo("/" + pathPrefix + statusCode+ uniqueContextSuffix));
      assertThat(esResponse.getStatusLine().getStatusCode(),equalTo(404));
    }
  }
 }
