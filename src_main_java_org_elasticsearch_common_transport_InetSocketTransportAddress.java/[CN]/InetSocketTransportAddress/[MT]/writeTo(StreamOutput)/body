{
  if (!resolveAddress && address.getAddress() != null) {
    out.writeByte((byte)0);
    byte[] bytes=address().getAddress().getAddress();
    out.writeByte((byte)bytes.length);
    out.write(bytes,0,bytes.length);
    if (address().getAddress() instanceof Inet6Address)     out.writeInt(((Inet6Address)address.getAddress()).getScopeId());
  }
 else {
    out.writeByte((byte)1);
    out.writeString(address.getHostName());
  }
  out.writeInt(address.getPort());
}
