{
  Settings settings=settingsBuilder().put("cluster.name",internalCluster().getClusterName()).build();
  try (TransportClient transportClient=new TransportClient(settings)){
    transportClient.addTransportAddress(new InetSocketTransportAddress("localhost",randomPort));
    ClusterHealthResponse response=transportClient.admin().cluster().prepareHealth().get();
    assertThat(response.getStatus(),is(ClusterHealthStatus.GREEN));
  }
 }
