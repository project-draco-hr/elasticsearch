{
  if (missing == null) {
    return new ExtendedFieldComparatorSource(){
      @Override public FieldComparator newComparator(      String fieldname,      int numHits,      int sortPos,      boolean reversed) throws IOException {
        return new DoubleFieldDataComparator(numHits,fieldname,cache);
      }
      @Override public int reducedType(){
        return SortField.DOUBLE;
      }
    }
;
  }
  if (missing.equals("_last")) {
    return new ExtendedFieldComparatorSource(){
      @Override public FieldComparator newComparator(      String fieldname,      int numHits,      int sortPos,      boolean reversed) throws IOException {
        return new DoubleFieldDataMissingComparator(numHits,fieldname,cache,reversed ? Double.NEGATIVE_INFINITY : Double.POSITIVE_INFINITY);
      }
      @Override public int reducedType(){
        return SortField.DOUBLE;
      }
    }
;
  }
  if (missing.equals("_first")) {
    return new ExtendedFieldComparatorSource(){
      @Override public FieldComparator newComparator(      String fieldname,      int numHits,      int sortPos,      boolean reversed) throws IOException {
        return new DoubleFieldDataMissingComparator(numHits,fieldname,cache,reversed ? Double.POSITIVE_INFINITY : Double.NEGATIVE_INFINITY);
      }
      @Override public int reducedType(){
        return SortField.DOUBLE;
      }
    }
;
  }
  return new ExtendedFieldComparatorSource(){
    @Override public FieldComparator newComparator(    String fieldname,    int numHits,    int sortPos,    boolean reversed) throws IOException {
      return new DoubleFieldDataMissingComparator(numHits,fieldname,cache,Double.parseDouble(missing));
    }
    @Override public int reducedType(){
      return SortField.DOUBLE;
    }
  }
;
}
