{
  if (connectMode) {
    TransportResponseHandler transportResponseHandler=transportServiceAdapter.remove(requestId);
    NodeInfo nodeInfo=new NodeInfo(Version.CURRENT,Build.CURRENT,node,null,null,null,null,null,null,null,null,null,null);
    NodesInfoResponse nodesInfoResponse=new NodesInfoResponse(ClusterName.DEFAULT,new NodeInfo[]{nodeInfo});
    transportResponseHandler.handleResponse(nodesInfoResponse);
    return;
  }
  triedNodes.add(node);
  if (RandomInts.randomInt(random,100) > 10) {
    connectTransportExceptions.incrementAndGet();
    throw new ConnectTransportException(node,"node not available");
  }
 else {
    if (random.nextBoolean()) {
      failures.incrementAndGet();
      throw new IllegalStateException();
    }
 else {
      TransportResponseHandler transportResponseHandler=transportServiceAdapter.remove(requestId);
      if (random.nextBoolean()) {
        successes.incrementAndGet();
        transportResponseHandler.handleResponse(newResponse());
      }
 else {
        failures.incrementAndGet();
        transportResponseHandler.handleException(new TransportException("transport exception"));
      }
    }
  }
}
