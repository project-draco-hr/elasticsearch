{
  Map<String,PipelineAggregatorFactory> pipelineAggregatorFactoriesMap=new HashMap<>();
  for (  PipelineAggregatorFactory factory : pipelineAggregatorFactories) {
    pipelineAggregatorFactoriesMap.put(factory.getName(),factory);
  }
  Set<String> aggFactoryNames=new HashSet<>();
  for (  AggregatorFactory aggFactory : aggFactories) {
    aggFactoryNames.add(aggFactory.name);
  }
  List<PipelineAggregatorFactory> orderedPipelineAggregatorrs=new LinkedList<>();
  List<PipelineAggregatorFactory> unmarkedFactories=new ArrayList<PipelineAggregatorFactory>(pipelineAggregatorFactories);
  Set<PipelineAggregatorFactory> temporarilyMarked=new HashSet<PipelineAggregatorFactory>();
  while (!unmarkedFactories.isEmpty()) {
    PipelineAggregatorFactory factory=unmarkedFactories.get(0);
    resolvePipelineAggregatorOrder(aggFactoryNames,pipelineAggregatorFactoriesMap,orderedPipelineAggregatorrs,unmarkedFactories,temporarilyMarked,factory);
  }
  return orderedPipelineAggregatorrs;
}
