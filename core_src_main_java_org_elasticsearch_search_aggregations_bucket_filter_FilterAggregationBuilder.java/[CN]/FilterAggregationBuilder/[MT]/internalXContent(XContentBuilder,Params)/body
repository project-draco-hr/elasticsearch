{
  if (filter == null) {
    throw new SearchSourceBuilderException("filter must be set on filter aggregation [" + getName() + "]");
  }
  filter.toXContent(builder,params);
  return builder;
}
