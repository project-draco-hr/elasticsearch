{
{
    StringWriter writer=new StringWriter();
    JsonEscapingMustacheFactory.escape("hello \n world",writer);
    assertThat(writer.toString(),equalTo("hello \\\n world"));
  }
{
    StringWriter writer=new StringWriter();
    JsonEscapingMustacheFactory.escape("\n",writer);
    assertThat(writer.toString(),equalTo("\\\n"));
  }
  Character[] specialChars=new Character[]{'\f','\n','\r','"','\\',(char)11,'\t','\b'};
  int iters=scaledRandomIntBetween(100,1000);
  for (int i=0; i < iters; i++) {
    int rounds=scaledRandomIntBetween(1,20);
    StringWriter escaped=new StringWriter();
    StringWriter writer=new StringWriter();
    for (int j=0; j < rounds; j++) {
      String s=getChars();
      writer.write(s);
      escaped.write(s);
      char c=RandomPicks.randomFrom(getRandom(),specialChars);
      writer.append(c);
      escaped.append('\\');
      escaped.append(c);
    }
    StringWriter target=new StringWriter();
    assertThat(escaped.toString(),equalTo(JsonEscapingMustacheFactory.escape(writer.toString(),target).toString()));
  }
}
