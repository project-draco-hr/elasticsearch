{
  ByteBufferAllocator.Type allocatorType=ByteBufferAllocator.Type.LARGE;
  if (name.contains("segments") || name.endsWith(".del")) {
    allocatorType=ByteBufferAllocator.Type.SMALL;
  }
  ByteBufferFile file=new ByteBufferFile(this,allocator.sizeInBytes(allocatorType));
  ByteBufferFile existing=files.put(name,file);
  if (existing != null) {
    existing.clean();
  }
  return new ByteBufferIndexOutput(allocator,allocatorType,file);
}
