{
  String multiPolygonGeoJson=XContentFactory.jsonBuilder().startObject().field("type","MultiPolygon").startArray("coordinates").startArray().startArray().startArray().value(102.0).value(2.0).endArray().startArray().value(103.0).value(2.0).endArray().startArray().value(103.0).value(3.0).endArray().startArray().value(102.0).value(3.0).endArray().startArray().value(102.0).value(2.0).endArray().endArray().endArray().startArray().startArray().startArray().value(100.0).value(0.0).endArray().startArray().value(101.0).value(0.0).endArray().startArray().value(101.0).value(1.0).endArray().startArray().value(100.0).value(1.0).endArray().startArray().value(100.0).value(0.0).endArray().endArray().startArray().startArray().value(100.2).value(0.8).endArray().startArray().value(100.2).value(0.2).endArray().startArray().value(100.8).value(0.2).endArray().startArray().value(100.8).value(0.8).endArray().startArray().value(100.2).value(0.8).endArray().endArray().endArray().endArray().endObject().string();
  List<GeoPoint> shellCoordinates=new ArrayList<>();
  shellCoordinates.add(new GeoPoint(0,100));
  shellCoordinates.add(new GeoPoint(0,101));
  shellCoordinates.add(new GeoPoint(1,101));
  shellCoordinates.add(new GeoPoint(1,100));
  shellCoordinates.add(new GeoPoint(0,100));
  List<GeoPoint> holeCoordinates=new ArrayList<>();
  holeCoordinates.add(new GeoPoint(0.2,100.2));
  holeCoordinates.add(new GeoPoint(0.2,100.8));
  holeCoordinates.add(new GeoPoint(0.8,100.8));
  holeCoordinates.add(new GeoPoint(0.8,100.2));
  holeCoordinates.add(new GeoPoint(0.2,100.2));
  LinearRing shell=GEOMETRY_FACTORY.createLinearRing(shellCoordinates.toArray(new GeoPoint[shellCoordinates.size()]));
  LinearRing[] holes=new LinearRing[1];
  holes[0]=GEOMETRY_FACTORY.createLinearRing(holeCoordinates.toArray(new GeoPoint[holeCoordinates.size()]));
  Polygon withHoles=GEOMETRY_FACTORY.createPolygon(shell,holes);
  shellCoordinates=new ArrayList<>();
  shellCoordinates.add(new GeoPoint(3,102));
  shellCoordinates.add(new GeoPoint(3,103));
  shellCoordinates.add(new GeoPoint(2,103));
  shellCoordinates.add(new GeoPoint(2,102));
  shellCoordinates.add(new GeoPoint(3,102));
  shell=GEOMETRY_FACTORY.createLinearRing(shellCoordinates.toArray(new GeoPoint[shellCoordinates.size()]));
  Polygon withoutHoles=GEOMETRY_FACTORY.createPolygon(shell,null);
  Shape expected=shapeCollection(withoutHoles,withHoles);
  assertGeometryEquals(expected,multiPolygonGeoJson);
  multiPolygonGeoJson=XContentFactory.jsonBuilder().startObject().field("type","MultiPolygon").startArray("coordinates").startArray().startArray().startArray().value(100.0).value(1.0).endArray().startArray().value(101.0).value(1.0).endArray().startArray().value(101.0).value(0.0).endArray().startArray().value(100.0).value(0.0).endArray().startArray().value(100.0).value(1.0).endArray().endArray().startArray().startArray().value(100.2).value(0.8).endArray().startArray().value(100.2).value(0.2).endArray().startArray().value(100.8).value(0.2).endArray().startArray().value(100.8).value(0.8).endArray().startArray().value(100.2).value(0.8).endArray().endArray().endArray().endArray().endObject().string();
  shellCoordinates=new ArrayList<>();
  shellCoordinates.add(new GeoPoint(1,100));
  shellCoordinates.add(new GeoPoint(1,101));
  shellCoordinates.add(new GeoPoint(0,101));
  shellCoordinates.add(new GeoPoint(0,100));
  shellCoordinates.add(new GeoPoint(1,100));
  holeCoordinates=new ArrayList<>();
  holeCoordinates.add(new GeoPoint(0.8,100.2));
  holeCoordinates.add(new GeoPoint(0.2,100.2));
  holeCoordinates.add(new GeoPoint(0.2,100.8));
  holeCoordinates.add(new GeoPoint(0.8,100.8));
  holeCoordinates.add(new GeoPoint(0.8,100.2));
  shell=GEOMETRY_FACTORY.createLinearRing(shellCoordinates.toArray(new GeoPoint[shellCoordinates.size()]));
  holes=new LinearRing[1];
  holes[0]=GEOMETRY_FACTORY.createLinearRing(holeCoordinates.toArray(new GeoPoint[holeCoordinates.size()]));
  withHoles=GEOMETRY_FACTORY.createPolygon(shell,holes);
  assertGeometryEquals(jtsGeom(withHoles),multiPolygonGeoJson);
}
