{
  DiscoveryNodes discoveryNodes=clusterService.state().nodes();
  assertThat(discoveryNodes.prettyPrint() + "\nexpected: " + expectedNodes.toString(),discoveryNodes.size(),equalTo(expectedNodes.size()));
  for (  DiscoveryNode node : expectedNodes) {
    assertThat("missing " + node + "\n"+ discoveryNodes.prettyPrint(),discoveryNodes.get(node.id()),equalTo(node));
  }
}
