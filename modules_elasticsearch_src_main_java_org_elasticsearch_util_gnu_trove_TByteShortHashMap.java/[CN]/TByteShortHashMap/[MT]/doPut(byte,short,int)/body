{
  byte previousState;
  short previous=(short)0;
  boolean isNewMapping=true;
  if (index < 0) {
    index=-index - 1;
    previous=_values[index];
    isNewMapping=false;
  }
  previousState=_states[index];
  _set[index]=key;
  _states[index]=FULL;
  _values[index]=value;
  if (isNewMapping) {
    postInsertHook(previousState == FREE);
  }
  return previous;
}
