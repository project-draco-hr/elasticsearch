{
  String dateAsString;
  if (context.externalValueSet()) {
    dateAsString=(String)context.externalValue();
    if (dateAsString == null) {
      dateAsString=nullValue;
    }
  }
 else {
    if (context.parser().currentToken() == XContentParser.Token.VALUE_NULL) {
      dateAsString=nullValue;
    }
 else {
      dateAsString=context.parser().text();
    }
  }
  if (dateAsString == null) {
    return null;
  }
  if (includeInAll == null || includeInAll) {
    context.allEntries().addText(names.fullName(),dateAsString,boost);
  }
  final long value=parseStringValue(dateAsString);
  return new CustomNumericField(names.indexName(),indexed(),stored() ? Numbers.longToBytes(value) : null){
    @Override public TokenStream tokenStreamValue(){
      if (indexed()) {
        return popCachedStream(precisionStep).setLongValue(value);
      }
 else {
        return null;
      }
    }
  }
;
}
