{
  final Thread currentThread=Thread.currentThread();
  final String oldThreadName=currentThread.getName();
  final String newThreadName=getNewThreadName(oldThreadName);
  boolean renamed=false;
  if (!oldThreadName.equals(newThreadName)) {
    try {
      currentThread.setName(newThreadName);
      renamed=true;
    }
 catch (    SecurityException e) {
      logger.debug("Failed to rename a thread due to security restriction.",e);
    }
  }
  try {
    runnable.run();
  }
  finally {
    if (renamed) {
      currentThread.setName(oldThreadName);
    }
  }
}
