{
  String[] stringAddresses=clusterAddresses.split(",");
  TransportAddress[] transportAddresses=new TransportAddress[stringAddresses.length];
  int i=0;
  for (  String stringAddress : stringAddresses) {
    String[] split=stringAddress.split(":");
    if (split.length < 2) {
      throw new IllegalArgumentException("address [" + clusterAddresses + "] not valid");
    }
    try {
      transportAddresses[i++]=new InetSocketTransportAddress(split[0],Integer.valueOf(split[1]));
    }
 catch (    NumberFormatException e) {
      throw new IllegalArgumentException("port is not valid, expected number but was [" + split[1] + "]");
    }
  }
  return new ExternalTestCluster(createTempDir(),transportAddresses);
}
