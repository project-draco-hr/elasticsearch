{
  Float requestsPerSecond=parseRequestsPerSecond(request);
  if (requestsPerSecond != null) {
    internalRequest.setRequestsPerSecond(requestsPerSecond);
  }
  if (request.paramAsBoolean("wait_for_completion",true)) {
    Map<String,String> params=new HashMap<>();
    params.put(BulkByScrollTask.Status.INCLUDE_CREATED,Boolean.toString(includeCreated));
    params.put(BulkByScrollTask.Status.INCLUDE_UPDATED,Boolean.toString(includeUpdated));
    params.put(BulkByScrollTask.Status.INCLUDE_DELETED,Boolean.toString(includeDeleted));
    action.execute(internalRequest,new BulkIndexByScrollResponseContentListener<>(channel,params));
    return;
  }
  ActionRequestValidationException validationException=internalRequest.validate();
  if (validationException != null) {
    channel.sendResponse(new BytesRestResponse(channel,validationException));
    return;
  }
  Task task=action.execute(internalRequest,LoggingTaskListener.instance());
  sendTask(channel,task);
}
