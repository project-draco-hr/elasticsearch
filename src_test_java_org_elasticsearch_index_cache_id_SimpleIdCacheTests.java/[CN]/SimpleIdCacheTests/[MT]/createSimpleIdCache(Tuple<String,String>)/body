{
  Settings settings=ImmutableSettings.EMPTY;
  Index index=new Index("test");
  SimpleIdCache idCache=new SimpleIdCache(index,settings);
  MapperService mapperService=MapperTestUtils.newMapperService();
  idCache.setIndexService(new StubIndexService(mapperService));
  for (  Tuple<String,String> documentType : documentTypes) {
    String defaultMapping=XContentFactory.jsonBuilder().startObject().startObject(documentType.v1()).startObject("_parent").field("type",documentType.v2()).endObject().endObject().endObject().string();
    mapperService.merge(documentType.v1(),new CompressedString(defaultMapping),true);
  }
  return idCache;
}
