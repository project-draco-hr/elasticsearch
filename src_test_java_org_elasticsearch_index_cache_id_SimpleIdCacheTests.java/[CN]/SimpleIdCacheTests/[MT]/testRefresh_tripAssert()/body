{
  assumeTrue(ASSERTIONS_ENABLED);
  SimpleIdCache idCache=createSimpleIdCache(Tuple.tuple("child","parent"));
  IndexWriter writer=createIndexWriter();
  writer.addDocument(doc("parent","1"));
  writer.addDocument(childDoc("child","1","parent","1"));
  writer.addDocument(childDoc("child","2","parent","1"));
  writer.addDocument(childDoc("child","3","parent","1"));
  writer.addDocument(childDoc("child","4","parent","1"));
  Document document=new Document();
  document.add(new StringField(UidFieldMapper.NAME,"parent",Field.Store.NO));
  writer.addDocument(document);
  writer.commit();
  writer.close();
  DirectoryReader topLevelReader=DirectoryReader.open(writer.getDirectory());
  List<AtomicReaderContext> leaves=topLevelReader.getContext().leaves();
  idCache.refresh(leaves);
}
