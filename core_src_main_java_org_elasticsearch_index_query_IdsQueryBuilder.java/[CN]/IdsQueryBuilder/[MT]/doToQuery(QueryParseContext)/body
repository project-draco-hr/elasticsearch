{
  Query query;
  if (this.ids.isEmpty()) {
    query=Queries.newMatchNoDocsQuery();
  }
 else {
    Collection<String> typesForQuery;
    if (types == null || types.length == 0) {
      typesForQuery=parseContext.queryTypes();
    }
 else     if (types.length == 1 && MetaData.ALL.equals(types[0])) {
      typesForQuery=parseContext.mapperService().types();
    }
 else {
      typesForQuery=Sets.newHashSet(types);
    }
    query=new TermsQuery(UidFieldMapper.NAME,Uid.createUidsForTypesAndIds(typesForQuery,ids));
  }
  return query;
}
