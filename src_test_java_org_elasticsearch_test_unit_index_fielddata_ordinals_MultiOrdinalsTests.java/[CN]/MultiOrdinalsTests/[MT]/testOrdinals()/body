{
  int maxDoc=7;
  int maxOrds=32;
  OrdinalsBuilder builder=new OrdinalsBuilder(maxDoc);
  builder.nextOrdinal();
  builder.addDoc(1).addDoc(4).addDoc(5).addDoc(6);
  builder.nextOrdinal();
  builder.addDoc(0).addDoc(5).addDoc(6);
  builder.nextOrdinal();
  builder.addDoc(2).addDoc(4).addDoc(5).addDoc(6);
  builder.nextOrdinal();
  builder.addDoc(0).addDoc(4).addDoc(5).addDoc(6);
  builder.nextOrdinal();
  builder.addDoc(4).addDoc(5).addDoc(6);
  int ord=builder.nextOrdinal();
  builder.addDoc(4).addDoc(5).addDoc(6);
  for (int i=ord; i < maxOrds; i++) {
    builder.nextOrdinal();
    builder.addDoc(5).addDoc(6);
  }
  Ordinals ordinals=creationMultiOrdinals(builder);
  Ordinals.Docs docs=ordinals.ordinals();
  assertThat(docs.getNumDocs(),equalTo(maxDoc));
  assertThat(docs.getNumOrds(),equalTo(maxOrds));
  assertThat(docs.isMultiValued(),equalTo(true));
  assertThat(docs.getOrd(0),equalTo(2));
  IntArrayRef ref=docs.getOrds(0);
  assertThat(ref.start,equalTo(0));
  assertThat(ref.values[0],equalTo(2));
  assertThat(ref.values[1],equalTo(4));
  assertThat(ref.end,equalTo(2));
  assertIter(docs.getIter(0),2,4);
  docs.forEachOrdinalInDoc(0,assertOrdinalInProcDoc(2,4));
  assertThat(docs.getOrd(1),equalTo(1));
  ref=docs.getOrds(1);
  assertThat(ref.start,equalTo(0));
  assertThat(ref.values[0],equalTo(1));
  assertThat(ref.end,equalTo(1));
  assertIter(docs.getIter(1),1);
  docs.forEachOrdinalInDoc(1,assertOrdinalInProcDoc(1));
  assertThat(docs.getOrd(2),equalTo(3));
  ref=docs.getOrds(2);
  assertThat(ref.start,equalTo(0));
  assertThat(ref.values[0],equalTo(3));
  assertThat(ref.end,equalTo(1));
  assertIter(docs.getIter(2),3);
  docs.forEachOrdinalInDoc(2,assertOrdinalInProcDoc(3));
  assertThat(docs.getOrd(3),equalTo(0));
  ref=docs.getOrds(3);
  assertThat(ref.start,equalTo(0));
  assertThat(ref.end,equalTo(0));
  assertIter(docs.getIter(3));
  docs.forEachOrdinalInDoc(3,assertOrdinalInProcDoc(0));
  assertThat(docs.getOrd(4),equalTo(1));
  ref=docs.getOrds(4);
  assertThat(ref.start,equalTo(0));
  assertThat(ref.values[0],equalTo(1));
  assertThat(ref.values[1],equalTo(3));
  assertThat(ref.values[2],equalTo(4));
  assertThat(ref.values[3],equalTo(5));
  assertThat(ref.values[4],equalTo(6));
  assertThat(ref.end,equalTo(5));
  assertIter(docs.getIter(4),1,3,4,5,6);
  docs.forEachOrdinalInDoc(4,assertOrdinalInProcDoc(1,3,4,5,6));
  assertThat(docs.getOrd(5),equalTo(1));
  ref=docs.getOrds(5);
  assertThat(ref.start,equalTo(0));
  int[] expectedOrds=new int[maxOrds];
  for (int i=0; i < maxOrds; i++) {
    expectedOrds[i]=i + 1;
    assertThat(ref.values[i],equalTo(i + 1));
  }
  assertIter(docs.getIter(5),expectedOrds);
  docs.forEachOrdinalInDoc(5,assertOrdinalInProcDoc(expectedOrds));
  assertThat(ref.end,equalTo(maxOrds));
  assertThat(docs.getOrd(6),equalTo(1));
  ref=docs.getOrds(6);
  assertThat(ref.start,equalTo(0));
  expectedOrds=new int[maxOrds];
  for (int i=0; i < maxOrds; i++) {
    expectedOrds[i]=i + 1;
    assertThat(ref.values[i],equalTo(i + 1));
  }
  assertIter(docs.getIter(6),expectedOrds);
  docs.forEachOrdinalInDoc(6,assertOrdinalInProcDoc(expectedOrds));
  assertThat(ref.end,equalTo(maxOrds));
}
