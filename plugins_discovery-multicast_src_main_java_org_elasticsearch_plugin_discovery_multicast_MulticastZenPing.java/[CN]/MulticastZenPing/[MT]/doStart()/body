{
  try {
    boolean shared=settings.getAsBoolean("discovery.zen.ping.multicast.shared",Constants.MAC_OS_X);
    boolean deferToInterface=settings.getAsBoolean("discovery.zen.ping.multicast.defer_group_to_set_interface",Constants.MAC_OS_X);
    List<InetAddress> addresses=Arrays.asList(networkService.resolveBindHostAddresses(address == null ? null : new String[]{address}));
    NetworkUtils.sortAddresses(addresses);
    final MulticastChannel.Config config=new MulticastChannel.Config(port,group,bufferSize,ttl,addresses.get(0),deferToInterface);
    SecurityManager sm=System.getSecurityManager();
    if (sm != null) {
      sm.checkPermission(new SpecialPermission());
    }
    multicastChannel=AccessController.doPrivileged(new PrivilegedExceptionAction<MulticastChannel>(){
      @Override public MulticastChannel run() throws Exception {
        return MulticastChannel.getChannel(nodeName(),shared,config,new Receiver());
      }
    }
);
  }
 catch (  Throwable t) {
    String msg="multicast failed to start [{}], disabling. Consider using IPv4 only (by defining env. variable `ES_USE_IPV4`)";
    logger.info(msg,t,ExceptionsHelper.detailedMessage(t));
  }
}
