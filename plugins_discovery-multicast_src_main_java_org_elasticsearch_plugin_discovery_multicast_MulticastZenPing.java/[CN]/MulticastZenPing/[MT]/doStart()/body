{
  try {
    boolean shared=settings.getAsBoolean("discovery.zen.ping.multicast.shared",Constants.MAC_OS_X);
    boolean deferToInterface=settings.getAsBoolean("discovery.zen.ping.multicast.defer_group_to_set_interface",Constants.MAC_OS_X);
    List<InetAddress> addresses=Arrays.asList(networkService.resolveBindHostAddresses(address == null ? null : new String[]{address}));
    NetworkUtils.sortAddresses(addresses);
    multicastChannel=MulticastChannel.getChannel(nodeName(),shared,new MulticastChannel.Config(port,group,bufferSize,ttl,addresses.get(0),deferToInterface),new Receiver());
  }
 catch (  Throwable t) {
    String msg="multicast failed to start [{}], disabling. Consider using IPv4 only (by defining env. variable `ES_USE_IPV4`)";
    if (logger.isDebugEnabled()) {
      logger.debug(msg,t,ExceptionsHelper.detailedMessage(t));
    }
 else {
      logger.info(msg,ExceptionsHelper.detailedMessage(t));
    }
  }
}
