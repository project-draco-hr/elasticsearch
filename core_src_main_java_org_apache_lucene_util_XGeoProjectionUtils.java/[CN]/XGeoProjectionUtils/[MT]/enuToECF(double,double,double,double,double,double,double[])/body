{
  if (ecf == null) {
    ecf=new double[3];
  }
  double[][] phi=createTransposedPhiTransform(centerLon,centerLat,null);
  double[] ecfOrigin=llaToECF(centerLon,centerLat,centerAlt,null);
  ecf[0]=(phi[0][0] * x + phi[0][1] * y + phi[0][2] * z) + ecfOrigin[0];
  ecf[1]=(phi[1][0] * x + phi[1][1] * y + phi[1][2] * z) + ecfOrigin[1];
  ecf[2]=(phi[2][0] * x + phi[2][1] * y + phi[2][2] * z) + ecfOrigin[2];
  return ecf;
}
