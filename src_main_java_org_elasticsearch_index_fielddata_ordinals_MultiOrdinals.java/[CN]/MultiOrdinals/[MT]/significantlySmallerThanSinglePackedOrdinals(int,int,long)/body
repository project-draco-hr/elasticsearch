{
  final int bitsPerOrd=PackedInts.bitsRequired(numOrds);
  final float avgValuesPerDoc=(float)numDocsWithValue / maxDoc;
  final int maxDelta=(int)Math.ceil(OFFSETS_PAGE_SIZE * (1 - avgValuesPerDoc) * avgValuesPerDoc);
  final int bitsPerOffset=PackedInts.bitsRequired(maxDelta) + 1;
  final long expectedMultiSizeInBytes=(long)numDocsWithValue * bitsPerOrd + (long)maxDoc * bitsPerOffset;
  final long expectedSingleSizeInBytes=(long)maxDoc * bitsPerOrd;
  return expectedMultiSizeInBytes < 0.8f * expectedSingleSizeInBytes;
}
