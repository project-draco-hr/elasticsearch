{
  ImmutableSettings.Builder builder=ImmutableSettings.settingsBuilder();
  if (randomBoolean()) {
    ScriptType scriptType=randomFrom(ScriptType.values());
    builder.put(ScriptModes.SCRIPT_SETTINGS_PREFIX + scriptType,randomFrom(ScriptMode.values()));
  }
 else {
    ScriptContext scriptContext=randomFrom(ScriptContext.values());
    builder.put(ScriptModes.SCRIPT_SETTINGS_PREFIX + scriptContext,randomFrom(ScriptMode.values()));
  }
  Settings settings=builder.build();
  Environment environment=new Environment(settings);
  ResourceWatcherService resourceWatcherService=new ResourceWatcherService(settings,null);
  Map<String,NativeScriptFactory> nativeScriptFactoryMap=new HashMap<>();
  nativeScriptFactoryMap.put("my",new MyNativeScriptFactory());
  Set<ScriptEngineService> scriptEngineServices=ImmutableSet.<ScriptEngineService>of(new NativeScriptEngineService(settings,nativeScriptFactoryMap));
  ScriptService scriptService=new ScriptService(settings,environment,scriptEngineServices,resourceWatcherService,new NodeSettingsService(settings));
  for (  ScriptContext scriptContext : ScriptContext.values()) {
    assertThat(scriptService.compile(NativeScriptEngineService.NAME,"my",ScriptType.INLINE,scriptContext),notNullValue());
  }
}
