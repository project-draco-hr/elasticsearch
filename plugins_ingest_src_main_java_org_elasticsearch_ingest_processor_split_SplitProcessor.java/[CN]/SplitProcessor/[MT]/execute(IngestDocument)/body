{
  for (  Map.Entry<String,String> entry : fields.entrySet()) {
    String oldVal=document.getFieldValue(entry.getKey(),String.class);
    if (oldVal == null) {
      throw new IllegalArgumentException("field [" + entry.getKey() + "] is null, cannot split.");
    }
    document.setFieldValue(entry.getKey(),Arrays.asList(oldVal.split(entry.getValue())));
  }
}
