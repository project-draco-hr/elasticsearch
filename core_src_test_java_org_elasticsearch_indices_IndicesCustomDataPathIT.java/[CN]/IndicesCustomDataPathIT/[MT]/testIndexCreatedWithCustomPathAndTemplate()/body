{
  final String INDEX="myindex2";
  internalCluster().startNodesAsync(1,nodeSettings(path));
  logger.info("--> creating an index with data_path [{}]",path);
  Settings.Builder sb=Settings.builder().put(IndexMetaData.SETTING_DATA_PATH,path).put(IndexMetaData.SETTING_NUMBER_OF_REPLICAS,0);
  client().admin().indices().prepareCreate(INDEX).setSettings(sb).get();
  ensureGreen(INDEX);
  indexRandom(true,client().prepareIndex(INDEX,"doc","1").setSource("{\"body\": \"foo\"}"));
  SearchResponse resp=client().prepareSearch(INDEX).setQuery(matchAllQuery()).get();
  assertThat("found the hit",resp.getHits().getTotalHits(),equalTo(1L));
  assertAcked(client().admin().indices().prepareDelete(INDEX));
  assertPathHasBeenCleared(path);
}
