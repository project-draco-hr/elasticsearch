{
  if (left != null) {
    Preconditions.checkState(Math.abs(left.depth() - right.depth()) < 2,"Imbalanced");
    int l=left.depth();
    int r=right.depth();
    Preconditions.checkState(depth == Math.max(l,r) + 1,"Depth doesn't match children");
    Preconditions.checkState(size == left.size + right.size,"Sizes don't match children");
    Preconditions.checkState(count == left.count + right.count,"Counts don't match children");
    Preconditions.checkState(leaf.compareTo(right.first()) == 0,"Split is wrong %.5d != %.5d or %d != %d",leaf.mean(),right.first().mean(),leaf.id(),right.first().id());
    left.checkBalance();
    right.checkBalance();
  }
}
