{
  Preconditions.checkState(size > 0,"Cannot remove from empty set");
  if (size == 1) {
    Preconditions.checkArgument(base.compareTo(leaf) == 0,"Element %s not found",base);
    count=size=0;
    leaf=null;
  }
 else {
    if (base.compareTo(leaf) < 0) {
      if (left.size > 1) {
        left.remove(base);
        count-=base.count();
        size--;
        rebalance();
      }
 else {
        size=right.size;
        count=right.count;
        depth=right.depth;
        leaf=right.leaf;
        left=right.left;
        right=right.right;
      }
    }
 else {
      if (right.size > 1) {
        right.remove(base);
        leaf=right.first();
        count-=base.count();
        size--;
        rebalance();
      }
 else {
        size=left.size;
        count=left.count;
        depth=left.depth;
        leaf=left.leaf;
        right=left.right;
        left=left.left;
      }
    }
  }
}
