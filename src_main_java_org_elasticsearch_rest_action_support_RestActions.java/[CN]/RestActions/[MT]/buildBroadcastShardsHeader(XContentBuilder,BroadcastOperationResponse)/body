{
  builder.startObject("_shards");
  builder.field("total",response.getTotalShards());
  builder.field("successful",response.getSuccessfulShards());
  builder.field("failed",response.getFailedShards());
  if (!response.getShardFailures().isEmpty()) {
    builder.startArray("failures");
    for (    ShardOperationFailedException shardFailure : response.getShardFailures()) {
      builder.startObject();
      if (shardFailure.index() != null) {
        builder.field("index",shardFailure.index(),XContentBuilder.FieldCaseConversion.NONE);
      }
      if (shardFailure.shardId() != -1) {
        builder.field("shard",shardFailure.shardId());
      }
      builder.field("reason",shardFailure.reason());
      builder.endObject();
    }
    builder.endArray();
  }
  builder.endObject();
}
