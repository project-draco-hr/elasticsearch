{
  final ShardId shardId=request.shardId();
  IndexService indexService=indicesService.indexServiceSafe(shardId.getIndex());
  IndexShard indexShard=indexService.getShard(shardId.id());
  final Engine.Index operation=executeIndexRequestOnReplica(request,indexShard);
  processAfterWrite(request.refresh(),indexShard,operation.getTranslogLocation());
}
