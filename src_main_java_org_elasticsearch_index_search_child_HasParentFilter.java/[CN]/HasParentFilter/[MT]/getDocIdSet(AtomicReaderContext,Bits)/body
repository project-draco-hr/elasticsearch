{
  if (parents == null) {
    throw new ElasticSearchIllegalStateException("has_parent filter hasn't executed properly");
  }
  DocIdSet childrenDocIdSet=childrenFilter.getDocIdSet(readerContext,null);
  if (DocIdSets.isEmpty(childrenDocIdSet)) {
    return null;
  }
  Bits childrenBits=DocIdSets.toSafeBits(readerContext.reader(),childrenDocIdSet);
  IdReaderTypeCache idReaderTypeCache=context.idCache().reader(readerContext.reader()).type(parentType);
  if (idReaderTypeCache != null) {
    return new ChildrenDocSet(readerContext.reader(),childrenBits,parents,idReaderTypeCache);
  }
 else {
    return null;
  }
}
