{
  ClusterHealthRequest request=Requests.clusterHealthRequest().waitForRelocatingShards(0);
  if (status != null) {
    request.waitForStatus(status);
  }
  ClusterHealthResponse actionGet=client().admin().cluster().health(request).actionGet();
  assertThat(actionGet.isTimedOut(),equalTo(false));
  if (status != null) {
    assertThat(actionGet.getStatus(),equalTo(status));
  }
  return actionGet.getStatus();
}
