{
  logger.info("Cleaning up after test.");
  MetaData metaData=client().admin().cluster().prepareState().execute().actionGet().getState().getMetaData();
  assertThat("test leaves persistent cluster metadata behind: " + metaData.persistentSettings().getAsMap(),metaData.persistentSettings().getAsMap().size(),equalTo(0));
  assertThat("test leaves transient cluster metadata behind: " + metaData.transientSettings().getAsMap(),metaData.persistentSettings().getAsMap().size(),equalTo(0));
  wipeIndices();
  wipeTemplates();
}
