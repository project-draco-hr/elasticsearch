{
  String fieldName=key.toString();
  FieldData fieldData=localCacheFieldData.get(fieldName);
  if (fieldData == null) {
    FieldMapper mapper=mapperService.smartNameFieldMapper(fieldName,types);
    if (mapper == null) {
      throw new ElasticSearchIllegalArgumentException("No field found for [" + fieldName + "] in mapping with types "+ Arrays.toString(types)+ "");
    }
    try {
      fieldData=fieldDataCache.cache(mapper.fieldDataType(),reader,mapper.names().indexName());
    }
 catch (    IOException e) {
      throw new ElasticSearchException("Failed to load field data for [" + fieldName + "]",e);
    }
    localCacheFieldData.put(fieldName,fieldData);
  }
  return fieldData.docFieldData(docId);
}
