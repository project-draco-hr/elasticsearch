{
  super(settings,clusterService,createIndexService);
  this.closeFileSystem=componentSettings.getAsBoolean("close_fs",true);
  String uri=componentSettings.get("uri");
  if (uri == null) {
    throw new ElasticSearchIllegalArgumentException("hdfs gateway requires the 'uri' setting to be set");
  }
  String path=componentSettings.get("path");
  if (path == null) {
    throw new ElasticSearchIllegalArgumentException("hdfs gateway requires the 'path' path setting to be set");
  }
  Path hPath=new Path(new Path(path),clusterName.value());
  logger.debug("Using uri [{}], path [{}]",uri,hPath);
  Configuration conf=new Configuration();
  Settings hdfsSettings=settings.getByPrefix("hdfs.conf.");
  for (  Map.Entry<String,String> entry : hdfsSettings.getAsMap().entrySet()) {
    conf.set(entry.getKey(),entry.getValue());
  }
  fileSystem=FileSystem.get(URI.create(uri),conf);
  initialize(new HdfsBlobStore(settings,fileSystem,threadPool.cached(),hPath),clusterName,null);
}
