{
  super(settings);
  String path=componentSettings.get("path");
  if (path == null) {
    throw new ElasticSearchIllegalArgumentException("hdfs gateway requires the 'path' path setting to be set");
  }
  this.path=new Path(new Path(path),clusterName.value());
  this.metaDataPath=new Path(this.path,"metadata");
  Configuration conf=new Configuration();
  Settings hdfsSettings=settings.getByPrefix("hdfs.conf.");
  for (  Map.Entry<String,String> entry : hdfsSettings.getAsMap().entrySet()) {
    conf.set(entry.getKey(),entry.getValue());
  }
  fileSystem=FileSystem.get(conf);
  fileSystem.mkdirs(metaDataPath);
  this.currentIndex=findLatestIndex();
  logger.debug("Latest metadata found at index [" + currentIndex + "]");
}
