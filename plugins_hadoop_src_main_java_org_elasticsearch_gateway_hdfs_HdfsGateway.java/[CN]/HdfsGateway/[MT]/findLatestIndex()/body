{
  FileStatus[] files=fileSystem.listStatus(metaDataPath,new PathFilter(){
    @Override public boolean accept(    Path path){
      return path.getName().startsWith("metadata-");
    }
  }
);
  if (files == null || files.length == 0) {
    return -1;
  }
  int index=-1;
  for (  FileStatus file : files) {
    if (logger.isTraceEnabled()) {
      logger.trace("[findLatestMetadata]: Processing file [" + file + "]");
    }
    String name=file.getPath().getName();
    int fileIndex=Integer.parseInt(name.substring(name.indexOf('-') + 1));
    if (fileIndex >= index) {
      try {
        readMetaData(file.getPath());
        index=fileIndex;
      }
 catch (      Exception e) {
        logger.warn("[findLatestMetadata]: Failed to read metadata from [" + file + "], ignoring...",e);
      }
    }
  }
  return index;
}
