{
  String yaml="foo: bar\nfoo: baz";
  try {
    settingsBuilder().loadFromSource(yaml).build();
    fail("expected exception");
  }
 catch (  SettingsException e) {
    assertEquals(e.getCause().getClass(),ElasticsearchParseException.class);
    assertTrue(e.toString().contains("duplicate settings key [foo] found at line number [2], column number [6], previous value [bar], current value [baz]"));
  }
}
