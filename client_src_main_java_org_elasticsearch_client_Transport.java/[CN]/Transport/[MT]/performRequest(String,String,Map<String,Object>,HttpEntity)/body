{
  URI uri=buildUri(endpoint,params);
  HttpRequestBase request=createHttpRequest(method,uri,entity);
  Iterator<Connection> connectionIterator=connectionPool.nextConnection().iterator();
  if (connectionIterator.hasNext() == false) {
    Connection connection=connectionPool.lastResortConnection();
    logger.info("no healthy nodes available, trying " + connection.getHost());
    return performRequest(request,Stream.of(connection).iterator());
  }
  return performRequest(request,connectionIterator);
}
