{
  super(index,indexSettings);
  Path path=null;
  String pathSetting=componentSettings.get("path");
  if (pathSetting != null) {
    path=new Path(pathSetting);
  }
  if (gateway instanceof HdfsGateway) {
    HdfsGateway hdfsGateway=(HdfsGateway)gateway;
    fileSystem=hdfsGateway.fileSystem();
    if (path == null) {
      path=hdfsGateway.path();
    }
  }
 else {
    throw new ElasticSearchIllegalArgumentException("Must configure an hdfs gateway to use index hdfs gateway");
  }
  this.indexPath=new Path(new Path(path,"indices"),index.name());
}
