{
  try {
    if (LZF.isCompressed(data,offset,length)) {
      BytesStreamInput siBytes=new BytesStreamInput(data,offset,length);
      LZFStreamInput siLzf=CachedStreamInput.cachedLzf(siBytes);
      XContentType contentType=XContentFactory.xContentType(siLzf);
      siLzf.resetToBufferStart();
      return Tuple.create(contentType,XContentFactory.xContent(contentType).createParser(siLzf).mapAndClose());
    }
 else {
      XContentType contentType=XContentFactory.xContentType(data,offset,length);
      return Tuple.create(contentType,XContentFactory.xContent(contentType).createParser(data,offset,length).mapAndClose());
    }
  }
 catch (  IOException e) {
    throw new ElasticSearchParseException("Failed to parse content to map",e);
  }
}
