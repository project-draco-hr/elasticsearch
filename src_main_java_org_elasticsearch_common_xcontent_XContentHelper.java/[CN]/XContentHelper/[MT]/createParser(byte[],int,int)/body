{
  Compressor compressor=CompressorFactory.compressor(data,offset,length);
  if (compressor != null) {
    CompressedStreamInput compressedInput=compressor.streamInput(new BytesStreamInput(data,offset,length));
    XContentType contentType=XContentFactory.xContentType(compressedInput);
    compressedInput.resetToBufferStart();
    return XContentFactory.xContent(contentType).createParser(compressedInput);
  }
 else {
    return XContentFactory.xContent(data,offset,length).createParser(data,offset,length);
  }
}
