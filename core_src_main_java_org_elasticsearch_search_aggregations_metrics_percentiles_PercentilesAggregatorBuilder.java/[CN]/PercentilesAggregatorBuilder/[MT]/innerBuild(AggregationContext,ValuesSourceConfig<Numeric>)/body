{
switch (method) {
case TDIGEST:
    return new TDigestPercentilesAggregatorFactory(name,type,config,percents,compression,keyed);
case HDR:
  return new HDRPercentilesAggregatorFactory(name,type,config,percents,numberOfSignificantValueDigits,keyed);
default :
throw new IllegalStateException("Illegal method [" + method.getName() + "]");
}
}
