{
  Explanation exp;
  if (script instanceof ExplainableSearchScript) {
    script.setNextDocId(docId);
    scorer.docid=docId;
    scorer.score=subQueryScore;
    exp=((ExplainableSearchScript)script).explain(subQueryScore);
  }
 else {
    double score=score(docId,subQueryScore);
    String explanation="script score function, computed with script:\"" + sScript;
    if (params != null) {
      explanation+="\" and parameters: \n" + params.toString();
    }
    exp=new Explanation(CombineFunction.toFloat(score),explanation);
  }
  return exp;
}
