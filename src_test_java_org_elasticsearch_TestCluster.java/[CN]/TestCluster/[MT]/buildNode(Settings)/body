{
  ensureOpen();
  String name=buildNodeName();
  String settingsSource=getClass().getName().replace('.','/') + ".yml";
  Settings finalSettings=settingsBuilder().loadFromClasspath(settingsSource).put(defaultSettings).put(settings).put("name",name).put("discovery.id.seed",random.nextLong()).build();
  Node node=nodeBuilder().settings(finalSettings).build();
  nodes.put(name,new NodeAndClient(name,node,clientFactory));
  return node;
}
