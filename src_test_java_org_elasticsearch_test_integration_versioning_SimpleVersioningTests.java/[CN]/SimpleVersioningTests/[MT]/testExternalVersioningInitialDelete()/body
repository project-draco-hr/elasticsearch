{
  client.admin().indices().prepareDelete().execute().actionGet();
  client.admin().indices().prepareCreate("test").execute().actionGet();
  client.admin().cluster().prepareHealth("test").setWaitForGreenStatus().execute().actionGet();
  DeleteResponse deleteResponse=client2.prepareDelete("test","type","1").setVersion(17).setVersionType(VersionType.EXTERNAL).execute().actionGet();
  assertThat(deleteResponse.isNotFound(),equalTo(true));
  try {
    client.prepareIndex("test","type","1").setSource("field1","value1_1").setVersion(13).setVersionType(VersionType.EXTERNAL).execute().actionGet();
  }
 catch (  ElasticSearchException e) {
    assertThat(e.unwrapCause(),instanceOf(VersionConflictEngineException.class));
  }
  client.prepareIndex("test","type","1").setSource("field1","value1_1").setVersion(18).setVersionType(VersionType.EXTERNAL).execute().actionGet();
}
