{
  fieldType.setNames(buildNames(context));
  if (fieldType.indexAnalyzer() == null && fieldType.tokenized() == false && fieldType.indexOptions() != IndexOptions.NONE) {
    fieldType.setIndexAnalyzer(Lucene.KEYWORD_ANALYZER);
    fieldType.setSearchAnalyzer(Lucene.KEYWORD_ANALYZER);
  }
  if (fieldDataSettings != null) {
    Settings settings=Settings.builder().put(fieldType.fieldDataType().getSettings()).put(fieldDataSettings).build();
    fieldType.setFieldDataType(new FieldDataType(fieldType.fieldDataType().getType(),settings));
  }
  boolean defaultDocValues=false;
  if (context.indexCreatedVersion().onOrAfter(Version.V_2_0_0_beta1)) {
    defaultDocValues=fieldType.tokenized() == false && fieldType.indexOptions() != IndexOptions.NONE;
  }
  boolean fieldDataDocValues=fieldType.fieldDataType() != null && FieldDataType.DOC_VALUES_FORMAT_VALUE.equals(fieldType.fieldDataType().getFormat(context.indexSettings()));
  if (fieldDataDocValues && docValuesSet && fieldType.hasDocValues() == false) {
    defaultDocValues=true;
  }
  defaultFieldType.setHasDocValues(defaultDocValues);
  if (docValuesSet == false) {
    fieldType.setHasDocValues(defaultDocValues || fieldDataDocValues);
  }
}
