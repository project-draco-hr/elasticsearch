{
  final long nextTranslogId=Math.max(0,translog.findLargestPresentTranslogId()) + 1;
  final Map<String,String> commitUserData=writer.getCommitData();
  if (commitUserData.containsKey(Translog.TRANSLOG_ID_KEY)) {
    final long currentTranslogId=Long.parseLong(commitUserData.get(Translog.TRANSLOG_ID_KEY));
    return new Tuple<>(currentTranslogId,nextTranslogId);
  }
  writer.setCommitData(Collections.singletonMap(Translog.TRANSLOG_ID_KEY,Long.toString(nextTranslogId)));
  commitIndexWriter(writer);
  logger.debug("no translog ID present in the current commit - creating one");
  return new Tuple<>(null,nextTranslogId);
}
