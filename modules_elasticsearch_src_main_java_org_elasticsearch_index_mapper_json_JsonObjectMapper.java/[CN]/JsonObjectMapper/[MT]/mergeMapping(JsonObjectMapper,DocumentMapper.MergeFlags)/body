{
synchronized (mutex) {
    for (    JsonMapper mapper : mergeWith.mappers.values()) {
      if (mapper instanceof JsonObjectMapper) {
        JsonObjectMapper mergeWithMapper=(JsonObjectMapper)mapper;
        JsonMapper mergeIntoMapper=mappers.get(mergeWithMapper.name());
        if (mergeIntoMapper != null) {
          if (!(mergeIntoMapper instanceof JsonObjectMapper)) {
            throw new MergeMappingException("Can't merge an object mapping [" + mergeWithMapper.name() + "] into a non object mapper");
          }
          ((JsonObjectMapper)mergeIntoMapper).mergeMapping(mergeWithMapper,mergeFlags);
        }
 else {
          if (!mergeFlags.simulate()) {
            putMapper(mergeWithMapper);
          }
        }
      }
 else {
        if (mappers.containsKey(mapper.name())) {
          if (mappers.get(mapper.name()) instanceof InternalMapper) {
          }
 else {
            if (!mergeFlags.ignoreDuplicates()) {
              throw new MergeMappingException("Mapper [" + mapper.name() + "] exists, can't merge");
            }
          }
        }
 else {
          if (!mergeFlags.simulate()) {
            putMapper(mapper);
          }
        }
      }
    }
  }
}
