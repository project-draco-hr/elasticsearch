{
  if (requiredSize > buckets.size()) {
    for (    Bucket bucket : buckets) {
      bucket.aggregations.reduce(cacheRecycler);
    }
    return;
  }
  List<Bucket> trimmedBuckets=new ArrayList<Bucket>(requiredSize);
  for (  Bucket bucket : buckets) {
    if (trimmedBuckets.size() >= requiredSize) {
      break;
    }
    bucket.aggregations.reduce(cacheRecycler);
    trimmedBuckets.add(bucket);
  }
  buckets=trimmedBuckets;
}
