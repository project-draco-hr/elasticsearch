{
  this.index=index;
  this.shards=ImmutableMap.copyOf(shards);
  ImmutableList.Builder<ShardRouting> allShards=ImmutableList.builder();
  for (  IndexShardRoutingTable indexShardRoutingTable : shards.values()) {
    for (    ShardRouting shardRouting : indexShardRoutingTable) {
      allShards.add(shardRouting);
    }
  }
  this.allShards=allShards.build();
}
