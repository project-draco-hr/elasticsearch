{
  this.index=index;
  this.shards=ImmutableMap.copyOf(shards);
  ImmutableList.Builder<ShardRouting> allShards=ImmutableList.builder();
  ImmutableList.Builder<ShardRouting> allActiveShards=ImmutableList.builder();
  for (  IndexShardRoutingTable indexShardRoutingTable : shards.values()) {
    for (    ShardRouting shardRouting : indexShardRoutingTable) {
      allShards.add(shardRouting);
      if (shardRouting.active()) {
        allActiveShards.add(shardRouting);
      }
    }
  }
  this.allShards=allShards.build();
  this.allActiveShards=allActiveShards.build();
}
