{
  System.setProperty("es.logger.prefix","");
  int numberOfShards=1;
  int numberOfReplicas=1;
  int numberOfIndices=1000;
  int numberOfDocs=0;
  Node node=NodeBuilder.nodeBuilder().client(true).node();
  for (int i=0; i < numberOfIndices; i++) {
    logger.info("START index [{}] ...",i);
    node.client().admin().indices().prepareCreate("index_" + i).setSettings(ImmutableSettings.settingsBuilder().put("index.number_of_shards",numberOfShards).put("index.number_of_replicas",numberOfReplicas)).execute().actionGet();
    for (int j=0; j < numberOfDocs; j++) {
      node.client().prepareIndex("index_" + i,"type").setSource("field1","test","field2",2,"field3",new Date()).execute().actionGet();
    }
    logger.info("DONE  index [{}]",i);
  }
  node.client().admin().indices().prepareGatewaySnapshot().execute().actionGet();
  logger.info("closing node...");
  node.close();
  logger.info("node closed");
}
