{
  builder.startObject();
  builder.field("_index",shard.index());
  builder.field("_type",type());
  builder.field("_id",id());
  if (source() != null) {
    if (XContentFactory.xContentType(source()) == builder.contentType()) {
      builder.field("_source");
      builder.value(source());
    }
 else {
      builder.rawField("_source",source());
    }
  }
  if (fields != null && !fields.isEmpty()) {
    builder.startObject("fields");
    for (    SearchHitField field : fields.values()) {
      if (field.values().isEmpty()) {
        continue;
      }
      if (field.values().size() == 1) {
        builder.field(field.name(),field.values().get(0));
      }
 else {
        builder.field(field.name());
        builder.startArray();
        for (        Object value : field.values()) {
          builder.value(value);
        }
        builder.endArray();
      }
    }
    builder.endObject();
  }
  if (highlightFields != null && !highlightFields.isEmpty()) {
    builder.startObject("highlight");
    for (    HighlightField field : highlightFields.values()) {
      builder.field(field.name());
      if (field.fragments() == null) {
        builder.nullValue();
      }
 else {
        builder.startArray();
        for (        String fragment : field.fragments()) {
          builder.value(fragment);
        }
        builder.endArray();
      }
    }
    builder.endObject();
  }
  if (explanation() != null) {
    builder.field("_explanation");
    buildExplanation(builder,explanation());
  }
  builder.endObject();
}
