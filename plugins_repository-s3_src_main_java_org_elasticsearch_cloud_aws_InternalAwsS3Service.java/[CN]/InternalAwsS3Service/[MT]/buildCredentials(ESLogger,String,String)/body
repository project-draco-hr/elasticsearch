{
  AWSCredentialsProvider credentials;
  if (key.isEmpty() && secret.isEmpty()) {
    logger.debug("Using either environment variables, system properties or instance profile credentials");
    credentials=new AWSCredentialsProviderChain(new EnvironmentVariableCredentialsProvider(),new SystemPropertiesCredentialsProvider(),new InstanceProfileCredentialsProvider());
  }
 else {
    logger.debug("Using basic key/secret credentials");
    credentials=new AWSCredentialsProviderChain(new StaticCredentialsProvider(new BasicAWSCredentials(key,secret)));
  }
  return credentials;
}
