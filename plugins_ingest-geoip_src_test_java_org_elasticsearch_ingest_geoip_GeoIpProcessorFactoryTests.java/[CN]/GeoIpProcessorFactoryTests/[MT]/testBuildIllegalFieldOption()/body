{
  GeoIpProcessor.Factory factory=new GeoIpProcessor.Factory(databaseReaders);
  Map<String,Object> config=new HashMap<>();
  config.put("source_field","_field");
  config.put("fields",Collections.singletonList("invalid"));
  try {
    factory.create(config);
    fail("exception expected");
  }
 catch (  ConfigurationPropertyException e) {
    assertThat(e.getMessage(),equalTo("[fields] illegal field option [invalid]. valid values are [[IP, COUNTRY_ISO_CODE, COUNTRY_NAME, CONTINENT_NAME, REGION_NAME, CITY_NAME, TIMEZONE, LATITUDE, LONGITUDE, LOCATION]]"));
  }
  config=new HashMap<>();
  config.put("source_field","_field");
  config.put("fields","invalid");
  try {
    factory.create(config);
    fail("exception expected");
  }
 catch (  ConfigurationPropertyException e) {
    assertThat(e.getMessage(),equalTo("[fields] property isn't a list, but of type [java.lang.String]"));
  }
}
