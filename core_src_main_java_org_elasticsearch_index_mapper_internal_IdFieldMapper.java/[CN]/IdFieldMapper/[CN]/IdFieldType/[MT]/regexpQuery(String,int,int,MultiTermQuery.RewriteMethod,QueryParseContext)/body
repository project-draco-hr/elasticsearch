{
  if (indexOptions() != IndexOptions.NONE || context == null) {
    return super.regexpQuery(value,flags,maxDeterminizedStates,method,context);
  }
  Collection<String> queryTypes=context.queryTypes();
  if (queryTypes.size() == 1) {
    RegexpQuery regexpQuery=new RegexpQuery(new Term(UidFieldMapper.NAME,Uid.createUidAsBytes(Iterables.getFirst(queryTypes,null),BytesRefs.toBytesRef(value))),flags,maxDeterminizedStates);
    if (method != null) {
      regexpQuery.setRewriteMethod(method);
    }
    return regexpQuery;
  }
  BooleanQuery.Builder query=new BooleanQuery.Builder();
  for (  String queryType : queryTypes) {
    RegexpQuery regexpQuery=new RegexpQuery(new Term(UidFieldMapper.NAME,Uid.createUidAsBytes(queryType,BytesRefs.toBytesRef(value))),flags,maxDeterminizedStates);
    if (method != null) {
      regexpQuery.setRewriteMethod(method);
    }
    query.add(regexpQuery,BooleanClause.Occur.SHOULD);
  }
  return query.build();
}
