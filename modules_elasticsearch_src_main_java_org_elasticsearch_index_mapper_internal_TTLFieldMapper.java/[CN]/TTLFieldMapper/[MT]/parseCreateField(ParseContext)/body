{
  if (enabled) {
    long ttl=context.sourceToParse().ttl();
    if (ttl <= 0 && defaultTTL > 0) {
      ttl=defaultTTL;
    }
    if (ttl > 0) {
      long timestamp=context.sourceToParse().timestamp();
      long expire=new Date(timestamp + ttl).getTime();
      long now=System.currentTimeMillis();
      if (now >= expire) {
        throw new AlreadyExpiredException(context.index(),context.type(),context.id(),timestamp,ttl,now);
      }
      return new CustomLongNumericField(this,expire);
    }
  }
  return null;
}
