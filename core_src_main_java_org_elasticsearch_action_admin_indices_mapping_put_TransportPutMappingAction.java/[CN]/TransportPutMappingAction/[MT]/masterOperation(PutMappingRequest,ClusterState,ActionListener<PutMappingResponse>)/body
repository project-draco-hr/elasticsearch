{
  final String[] concreteIndices=clusterService.state().metaData().concreteIndices(request.indicesOptions(),request.indices());
  PutMappingClusterStateUpdateRequest updateRequest=new PutMappingClusterStateUpdateRequest().ackTimeout(request.timeout()).masterNodeTimeout(request.masterNodeTimeout()).indices(concreteIndices).type(request.type()).updateAllTypes(request.updateAllTypes()).source(request.source());
  metaDataMappingService.putMapping(updateRequest,new ActionListener<ClusterStateUpdateResponse>(){
    @Override public void onResponse(    ClusterStateUpdateResponse response){
      listener.onResponse(new PutMappingResponse(response.isAcknowledged()));
    }
    @Override public void onFailure(    Throwable t){
      logger.debug("failed to put mappings on indices [{}], type [{}]",t,concreteIndices,request.type());
      listener.onFailure(t);
    }
  }
);
}
