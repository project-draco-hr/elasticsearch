{
  logger.info("--> creating indices [foobar, test, test123, foobarbaz, bazbar]");
  createIndex("foobar");
  createIndex("test");
  createIndex("test123");
  createIndex("foobarbaz");
  createIndex("bazbar");
  assertAcked(client().admin().indices().preparePutMapping("foobar","test","test123","foobarbaz","bazbar").setType("type").setSource("field","type=string"));
  ensureGreen();
  logger.info("--> creating aliases [alias1, alias2]");
  assertAcked(admin().indices().prepareAliases().addAlias("foobar","alias1").addAlias("foobar","alias2"));
  logger.info("--> getting alias1");
  GetAliasesResponse getResponse=admin().indices().prepareGetAliases("alias1").get();
  assertThat(getResponse,notNullValue());
  assertThat(getResponse.getAliases().size(),equalTo(1));
  assertThat(getResponse.getAliases().get("foobar").size(),equalTo(1));
  assertThat(getResponse.getAliases().get("foobar").get(0),notNullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).alias(),equalTo("alias1"));
  assertThat(getResponse.getAliases().get("foobar").get(0).getFilter(),nullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).getIndexRouting(),nullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).getSearchRouting(),nullValue());
  AliasesExistResponse existsResponse=admin().indices().prepareAliasesExist("alias1").get();
  assertThat(existsResponse.exists(),equalTo(true));
  logger.info("--> getting all aliases that start with alias*");
  getResponse=admin().indices().prepareGetAliases("alias*").get();
  assertThat(getResponse,notNullValue());
  assertThat(getResponse.getAliases().size(),equalTo(1));
  assertThat(getResponse.getAliases().get("foobar").size(),equalTo(2));
  assertThat(getResponse.getAliases().get("foobar").get(0),notNullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).alias(),equalTo("alias1"));
  assertThat(getResponse.getAliases().get("foobar").get(0).getFilter(),nullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).getIndexRouting(),nullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).getSearchRouting(),nullValue());
  assertThat(getResponse.getAliases().get("foobar").get(1),notNullValue());
  assertThat(getResponse.getAliases().get("foobar").get(1).alias(),equalTo("alias2"));
  assertThat(getResponse.getAliases().get("foobar").get(1).getFilter(),nullValue());
  assertThat(getResponse.getAliases().get("foobar").get(1).getIndexRouting(),nullValue());
  assertThat(getResponse.getAliases().get("foobar").get(1).getSearchRouting(),nullValue());
  existsResponse=admin().indices().prepareAliasesExist("alias*").get();
  assertThat(existsResponse.exists(),equalTo(true));
  logger.info("--> creating aliases [bar, baz, foo]");
  assertAcked(admin().indices().prepareAliases().addAlias("bazbar","bar").addAlias("bazbar","bac",termQuery("field","value")).addAlias("foobar","foo"));
  assertAcked(admin().indices().prepareAliases().addAliasAction(new AliasAction(AliasAction.Type.ADD,"foobar","bac").routing("bla")));
  logger.info("--> getting bar and baz for index bazbar");
  getResponse=admin().indices().prepareGetAliases("bar","bac").addIndices("bazbar").get();
  assertThat(getResponse,notNullValue());
  assertThat(getResponse.getAliases().size(),equalTo(1));
  assertThat(getResponse.getAliases().get("bazbar").size(),equalTo(2));
  assertThat(getResponse.getAliases().get("bazbar").get(0),notNullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(0).alias(),equalTo("bac"));
  assertThat(getResponse.getAliases().get("bazbar").get(0).getFilter().string(),containsString("term"));
  assertThat(getResponse.getAliases().get("bazbar").get(0).getFilter().string(),containsString("field"));
  assertThat(getResponse.getAliases().get("bazbar").get(0).getFilter().string(),containsString("value"));
  assertThat(getResponse.getAliases().get("bazbar").get(0).getIndexRouting(),nullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(0).getSearchRouting(),nullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(1),notNullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(1).alias(),equalTo("bar"));
  assertThat(getResponse.getAliases().get("bazbar").get(1).getFilter(),nullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(1).getIndexRouting(),nullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(1).getSearchRouting(),nullValue());
  existsResponse=admin().indices().prepareAliasesExist("bar","bac").addIndices("bazbar").get();
  assertThat(existsResponse.exists(),equalTo(true));
  logger.info("--> getting *b* for index baz*");
  getResponse=admin().indices().prepareGetAliases("*b*").addIndices("baz*").get();
  assertThat(getResponse,notNullValue());
  assertThat(getResponse.getAliases().size(),equalTo(1));
  assertThat(getResponse.getAliases().get("bazbar").size(),equalTo(2));
  assertThat(getResponse.getAliases().get("bazbar").get(0),notNullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(0).alias(),equalTo("bac"));
  assertThat(getResponse.getAliases().get("bazbar").get(0).getFilter().string(),containsString("term"));
  assertThat(getResponse.getAliases().get("bazbar").get(0).getFilter().string(),containsString("field"));
  assertThat(getResponse.getAliases().get("bazbar").get(0).getFilter().string(),containsString("value"));
  assertThat(getResponse.getAliases().get("bazbar").get(0).getIndexRouting(),nullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(0).getSearchRouting(),nullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(1),notNullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(1).alias(),equalTo("bar"));
  assertThat(getResponse.getAliases().get("bazbar").get(1).getFilter(),nullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(1).getIndexRouting(),nullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(1).getSearchRouting(),nullValue());
  existsResponse=admin().indices().prepareAliasesExist("*b*").addIndices("baz*").get();
  assertThat(existsResponse.exists(),equalTo(true));
  logger.info("--> getting *b* for index *bar");
  getResponse=admin().indices().prepareGetAliases("b*").addIndices("*bar").get();
  assertThat(getResponse,notNullValue());
  assertThat(getResponse.getAliases().size(),equalTo(2));
  assertThat(getResponse.getAliases().get("bazbar").size(),equalTo(2));
  assertThat(getResponse.getAliases().get("bazbar").get(0),notNullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(0).alias(),equalTo("bac"));
  assertThat(getResponse.getAliases().get("bazbar").get(0).getFilter().string(),containsString("term"));
  assertThat(getResponse.getAliases().get("bazbar").get(0).getFilter().string(),containsString("field"));
  assertThat(getResponse.getAliases().get("bazbar").get(0).getFilter().string(),containsString("value"));
  assertThat(getResponse.getAliases().get("bazbar").get(0).getIndexRouting(),nullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(0).getSearchRouting(),nullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(1),notNullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(1).alias(),equalTo("bar"));
  assertThat(getResponse.getAliases().get("bazbar").get(1).getFilter(),nullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(1).getIndexRouting(),nullValue());
  assertThat(getResponse.getAliases().get("bazbar").get(1).getSearchRouting(),nullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0),notNullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).alias(),equalTo("bac"));
  assertThat(getResponse.getAliases().get("foobar").get(0).getFilter(),nullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).getIndexRouting(),equalTo("bla"));
  assertThat(getResponse.getAliases().get("foobar").get(0).getSearchRouting(),equalTo("bla"));
  existsResponse=admin().indices().prepareAliasesExist("b*").addIndices("*bar").get();
  assertThat(existsResponse.exists(),equalTo(true));
  logger.info("--> getting f* for index *bar");
  getResponse=admin().indices().prepareGetAliases("f*").addIndices("*bar").get();
  assertThat(getResponse,notNullValue());
  assertThat(getResponse.getAliases().size(),equalTo(1));
  assertThat(getResponse.getAliases().get("foobar").get(0),notNullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).alias(),equalTo("foo"));
  assertThat(getResponse.getAliases().get("foobar").get(0).getFilter(),nullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).getIndexRouting(),nullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).getSearchRouting(),nullValue());
  existsResponse=admin().indices().prepareAliasesExist("f*").addIndices("*bar").get();
  assertThat(existsResponse.exists(),equalTo(true));
  logger.info("--> getting f* for index *bac");
  getResponse=admin().indices().prepareGetAliases("foo").addIndices("*bac").get();
  assertThat(getResponse,notNullValue());
  assertThat(getResponse.getAliases().size(),equalTo(1));
  assertThat(getResponse.getAliases().get("foobar").size(),equalTo(1));
  assertThat(getResponse.getAliases().get("foobar").get(0),notNullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).alias(),equalTo("foo"));
  assertThat(getResponse.getAliases().get("foobar").get(0).getFilter(),nullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).getIndexRouting(),nullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).getSearchRouting(),nullValue());
  existsResponse=admin().indices().prepareAliasesExist("foo").addIndices("*bac").get();
  assertThat(existsResponse.exists(),equalTo(true));
  logger.info("--> getting foo for index foobar");
  getResponse=admin().indices().prepareGetAliases("foo").addIndices("foobar").get();
  assertThat(getResponse,notNullValue());
  assertThat(getResponse.getAliases().size(),equalTo(1));
  assertThat(getResponse.getAliases().get("foobar").get(0),notNullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).alias(),equalTo("foo"));
  assertThat(getResponse.getAliases().get("foobar").get(0).getFilter(),nullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).getIndexRouting(),nullValue());
  assertThat(getResponse.getAliases().get("foobar").get(0).getSearchRouting(),nullValue());
  existsResponse=admin().indices().prepareAliasesExist("foo").addIndices("foobar").get();
  assertThat(existsResponse.exists(),equalTo(true));
  logger.info("--> getting * for index *bac");
  getResponse=admin().indices().prepareGetAliases("*").addIndices("*bac").get();
  assertThat(getResponse,notNullValue());
  assertThat(getResponse.getAliases().size(),equalTo(2));
  assertThat(getResponse.getAliases().get("foobar").size(),equalTo(4));
  assertThat(getResponse.getAliases().get("bazbar").size(),equalTo(2));
  existsResponse=admin().indices().prepareAliasesExist("*").addIndices("*bac").get();
  assertThat(existsResponse.exists(),equalTo(true));
  assertAcked(admin().indices().prepareAliases().removeAlias("foobar","foo"));
  getResponse=admin().indices().prepareGetAliases("foo").addIndices("foobar").get();
  assertThat(getResponse.getAliases().isEmpty(),equalTo(true));
  existsResponse=admin().indices().prepareAliasesExist("foo").addIndices("foobar").get();
  assertThat(existsResponse.exists(),equalTo(false));
}
