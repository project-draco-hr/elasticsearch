{
  Number keyValue=(Number)keyScript.execute(doc);
  long bucket;
  if (interval == 0) {
    bucket=keyValue.longValue();
  }
 else {
    bucket=bucket(keyValue.doubleValue(),interval);
  }
  double value=((Number)valueScript.execute(doc)).doubleValue();
  counts.adjustOrPutValue(bucket,1,1);
  totals.adjustOrPutValue(bucket,value,value);
}
