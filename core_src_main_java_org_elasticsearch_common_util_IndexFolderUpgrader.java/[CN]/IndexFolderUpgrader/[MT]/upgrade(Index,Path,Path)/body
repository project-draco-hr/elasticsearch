{
  boolean success=false;
  try {
    Files.move(source,target,StandardCopyOption.ATOMIC_MOVE);
    success=true;
  }
 catch (  NoSuchFileException|FileNotFoundException exception) {
    logger.error("multiple nodes trying to upgrade [{}] in parallel, retry upgrading with single node",exception,target);
    throw exception;
  }
 finally {
    if (success) {
      logger.info("{} moved from [{}] to [{}]",index,source,target);
      logger.trace("{} syncing directory [{}]",index,target);
      IOUtils.fsync(target,true);
    }
  }
}
