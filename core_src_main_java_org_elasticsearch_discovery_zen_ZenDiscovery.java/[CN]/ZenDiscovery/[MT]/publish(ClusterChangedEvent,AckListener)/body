{
  if (!clusterChangedEvent.state().getNodes().localNodeMaster()) {
    throw new IllegalStateException("Shouldn't publish state when not master");
  }
  nodesFD.updateNodesAndPing(clusterChangedEvent.state());
  publishClusterState.publish(clusterChangedEvent,ackListener);
}
