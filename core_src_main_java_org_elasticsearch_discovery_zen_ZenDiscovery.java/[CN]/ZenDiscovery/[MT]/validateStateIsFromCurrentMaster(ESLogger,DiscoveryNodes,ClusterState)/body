{
  if (currentNodes.masterNodeId() == null) {
    return;
  }
  if (!currentNodes.masterNodeId().equals(newClusterState.nodes().masterNodeId())) {
    logger.warn("received a cluster state from a different master than the current one, rejecting (received {}, current {})",newClusterState.nodes().masterNode(),currentNodes.masterNode());
    throw new IllegalStateException("cluster state from a different master than the current one, rejecting (received " + newClusterState.nodes().masterNode() + ", current "+ currentNodes.masterNode()+ ")");
  }
}
