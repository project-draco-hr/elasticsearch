{
  nodesFD.setLocalNode(clusterService.localNode());
  joinThreadControl.start();
  pingService.start();
  clusterService.submitStateUpdateTask("initial_join",new ClusterStateNonMasterUpdateTask(){
    @Override public ClusterState execute(    ClusterState currentState) throws Exception {
      joinThreadControl.startNewThreadIfNotRunning();
      return currentState;
    }
    @Override public void onFailure(    String source,    @org.elasticsearch.common.Nullable Throwable t){
      logger.warn("failed to start initial join process",t);
    }
  }
);
}
