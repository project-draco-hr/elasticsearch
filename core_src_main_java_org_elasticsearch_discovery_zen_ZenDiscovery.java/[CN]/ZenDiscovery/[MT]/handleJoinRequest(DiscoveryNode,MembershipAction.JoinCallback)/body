{
  if (!transportService.addressSupported(node.address().getClass())) {
    logger.warn("received a wrong address type from [{}], ignoring...",node);
  }
 else   if (nodeJoinController == null) {
    throw new IllegalStateException("discovery module is not yet started");
  }
 else {
    Version minimumNodeJoinVersion=localNode().getVersion().minimumCompatibilityVersion();
    if (node.getVersion().before(minimumNodeJoinVersion)) {
      callback.onFailure(new IllegalStateException("Can't handle join request from a node with a version [" + node.getVersion() + "] that is lower than the minimum compatible version ["+ minimumNodeJoinVersion.minimumCompatibilityVersion()+ "]"));
      return;
    }
    transportService.connectToNode(node);
    membership.sendValidateJoinRequestBlocking(node,joinTimeout);
    nodeJoinController.handleJoinRequest(node,callback);
  }
}
