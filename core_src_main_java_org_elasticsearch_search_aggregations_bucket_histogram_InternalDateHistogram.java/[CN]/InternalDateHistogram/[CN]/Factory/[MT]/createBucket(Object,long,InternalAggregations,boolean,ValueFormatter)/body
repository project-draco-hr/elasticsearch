{
  if (key instanceof Number) {
    return new Bucket(((Number)key).longValue(),docCount,aggregations,keyed,formatter,this);
  }
 else   if (key instanceof DateTime) {
    return new Bucket(((DateTime)key).getMillis(),docCount,aggregations,keyed,formatter,this);
  }
 else {
    throw new AggregationExecutionException("Expected key of type Number or DateTime but got [" + key + "]");
  }
}
