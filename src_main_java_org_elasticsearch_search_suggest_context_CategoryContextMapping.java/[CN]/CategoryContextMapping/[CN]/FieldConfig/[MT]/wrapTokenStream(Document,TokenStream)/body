{
  if (values != null) {
    return new PrefixAnalyzer.PrefixTokenFilter(stream,ContextMapping.SEPARATOR,values);
  }
 else {
    IndexableField[] fields=doc.getFields(fieldname);
    ArrayList<CharSequence> values=new ArrayList<CharSequence>(fields.length);
    for (int i=0; i < fields.length; i++) {
      values.add(fields[i].stringValue());
    }
    return new PrefixAnalyzer.PrefixTokenFilter(stream,ContextMapping.SEPARATOR,values);
  }
}
