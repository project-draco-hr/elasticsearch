{
  RoutingNodes routingNodes=clusterState.routingNodes();
  boolean changed=applyStartedShards(routingNodes,startedShards);
  nodeAllocations.applyStartedShards(nodeAllocations,routingNodes,clusterState.nodes(),startedShards);
  if (!changed) {
    return clusterState.routingTable();
  }
  reroute(routingNodes,clusterState.nodes());
  return new RoutingTable.Builder().updateNodes(routingNodes).build().validateRaiseException(clusterState.metaData());
}
