{
  ensureGreen();
  List<String> requests=Arrays.asList("/","/_nodes/stats","/","/_cluster/state","/","/_nodes","/");
  HttpServerTransport httpServerTransport=internalCluster().getInstance(HttpServerTransport.class);
  InetSocketTransportAddress inetSocketTransportAddress=(InetSocketTransportAddress)httpServerTransport.boundAddress().boundAddress();
  try (NettyHttpClient nettyHttpClient=new NettyHttpClient()){
    Collection<HttpResponse> responses=nettyHttpClient.sendRequests(inetSocketTransportAddress.address(),requests.toArray(new String[]{}));
    assertThat(responses,hasSize(requests.size()));
    List<String> opaqueIds=Lists.newArrayList(returnOpaqueIds(responses));
    assertResponsesOutOfOrder(opaqueIds);
  }
 }
