{
  final Path tempDir=createTempDir().resolve("foo").resolve("0");
  FsDirectoryService service=new FsDirectoryService(IndexSettingsModule.newIndexSettings(new Index("foo"),Settings.settingsBuilder().put(IndexMetaData.SETTING_VERSION_CREATED,Version.CURRENT).build(),Collections.EMPTY_LIST),null,new ShardPath(false,tempDir,tempDir,"foo",new ShardId("foo",0)));
  try (final Directory directory=service.newFSDirectory(tempDir,NoLockFactory.INSTANCE)){
    if (Constants.WINDOWS) {
      assertTrue(directory.toString(),directory instanceof MMapDirectory || directory instanceof SimpleFSDirectory);
    }
 else {
      assertTrue(directory.toString(),directory instanceof FileSwitchDirectory);
    }
  }
 }
