{
  final Path tempDir=createTempDir().resolve("foo").resolve("0");
  FsDirectoryService service=new FsDirectoryService(IndexSettingsModule.newIndexSettings("foo",Settings.settingsBuilder().put(IndexMetaData.SETTING_VERSION_CREATED,Version.CURRENT).build()),null,new ShardPath(false,tempDir,tempDir,"foo",new ShardId("foo","_na_",0)));
  try (final Directory directory=service.newFSDirectory(tempDir,NoLockFactory.INSTANCE)){
    if (Constants.WINDOWS) {
      assertTrue(directory.toString(),directory instanceof MMapDirectory || directory instanceof SimpleFSDirectory);
    }
 else     if (Constants.JRE_IS_64BIT) {
      assertTrue(directory.toString(),directory instanceof FileSwitchDirectory);
    }
 else {
      assertTrue(directory.toString(),directory instanceof NIOFSDirectory);
    }
  }
 }
