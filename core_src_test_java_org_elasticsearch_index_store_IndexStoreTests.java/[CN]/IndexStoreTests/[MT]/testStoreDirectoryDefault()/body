{
  Index index=new Index("bar","foo");
  final Path tempDir=createTempDir().resolve(index.getUUID()).resolve("0");
  FsDirectoryService service=new FsDirectoryService(IndexSettingsModule.newIndexSettings("bar",Settings.builder().put(IndexMetaData.SETTING_VERSION_CREATED,Version.CURRENT).build()),null,new ShardPath(false,tempDir,tempDir,new ShardId(index,0)));
  try (final Directory directory=service.newFSDirectory(tempDir,NoLockFactory.INSTANCE)){
    if (Constants.WINDOWS) {
      assertTrue(directory.toString(),directory instanceof MMapDirectory || directory instanceof SimpleFSDirectory);
    }
 else     if (Constants.JRE_IS_64BIT) {
      assertTrue(directory.toString(),directory instanceof FileSwitchDirectory);
    }
 else {
      assertTrue(directory.toString(),directory instanceof NIOFSDirectory);
    }
  }
 }
