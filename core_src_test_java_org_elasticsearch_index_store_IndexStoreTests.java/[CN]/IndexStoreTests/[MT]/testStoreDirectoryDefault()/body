{
  final Path tempDir=createTempDir().resolve("foo").resolve("0");
  Settings settings=Settings.EMPTY;
  FsDirectoryService service=new FsDirectoryService(settings,null,new ShardPath(false,tempDir,tempDir,"foo",new ShardId("foo",0)));
  try (final Directory directory=service.newFSDirectory(tempDir,NoLockFactory.INSTANCE)){
    if (Constants.WINDOWS) {
      assertTrue(directory.toString(),directory instanceof MMapDirectory || directory instanceof SimpleFSDirectory);
    }
 else {
      assertTrue(directory.toString(),directory instanceof FileSwitchDirectory);
    }
  }
 }
