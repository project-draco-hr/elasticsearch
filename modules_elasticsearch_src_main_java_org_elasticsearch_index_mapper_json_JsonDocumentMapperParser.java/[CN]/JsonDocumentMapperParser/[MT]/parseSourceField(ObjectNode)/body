{
  String name=sourceNode.get("name") == null ? JsonSourceFieldMapper.Defaults.NAME : sourceNode.get("name").getTextValue();
  JsonSourceFieldMapper.Builder builder=source(name);
  for (Iterator<Map.Entry<String,JsonNode>> fieldsIt=sourceNode.getFields(); fieldsIt.hasNext(); ) {
    Map.Entry<String,JsonNode> entry=fieldsIt.next();
    String fieldName=entry.getKey();
    JsonNode fieldNode=entry.getValue();
    if (fieldName.equals("compressionThreshold")) {
      builder.compressionThreshold(fieldNode.getNumberValue().intValue());
    }
 else     if (fieldName.equals("compressionType")) {
      String compressionType=fieldNode.getTextValue();
      if ("zip".equals(compressionType)) {
        builder.compressor(new ZipCompressor());
      }
 else       if ("gzip".equals(compressionType)) {
        builder.compressor(new GZIPCompressor());
      }
 else       if ("lzf".equals(compressionType)) {
        builder.compressor(new LzfCompressor());
      }
 else {
        throw new MapperParsingException("No compressor registed under [" + compressionType + "]");
      }
    }
  }
  return builder;
}
