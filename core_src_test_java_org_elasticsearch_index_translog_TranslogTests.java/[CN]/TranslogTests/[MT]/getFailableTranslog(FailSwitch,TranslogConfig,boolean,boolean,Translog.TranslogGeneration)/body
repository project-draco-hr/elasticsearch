{
  return new Translog(config,generation){
    @Override TranslogWriter.ChannelFactory getChannelFactory(){
      final TranslogWriter.ChannelFactory factory=super.getChannelFactory();
      return new TranslogWriter.ChannelFactory(){
        @Override public FileChannel open(        Path file) throws IOException {
          FileChannel channel=factory.open(file);
          boolean success=false;
          try {
            ThrowingFileChannel throwingFileChannel=new ThrowingFileChannel(fail,paritalWrites,throwUnknownException,channel);
            success=true;
            return throwingFileChannel;
          }
  finally {
            if (success == false) {
              IOUtils.closeWhileHandlingException(channel);
            }
          }
        }
      }
;
    }
    @Override protected boolean assertBytesAtLocation(    Location location,    BytesReference expectedBytes) throws IOException {
      return true;
    }
  }
;
}
