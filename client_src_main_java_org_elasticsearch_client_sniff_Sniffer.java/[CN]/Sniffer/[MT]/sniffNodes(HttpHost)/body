{
  HttpGet httpGet=new HttpGet("/_nodes/http?timeout=" + sniffRequestTimeout + "ms");
  httpGet.setConfig(sniffRequestConfig);
  try (CloseableHttpResponse response=client.execute(host,httpGet)){
    StatusLine statusLine=response.getStatusLine();
    if (statusLine.getStatusCode() >= 300) {
      RequestLogger.log(logger,"sniff failed",httpGet,host,response);
      String responseBody=null;
      if (response.getEntity() != null) {
        responseBody=EntityUtils.toString(response.getEntity());
      }
      throw new ElasticsearchResponseException(httpGet.getRequestLine(),host,response.getStatusLine(),responseBody);
    }
 else {
      List<HttpHost> nodes=readHosts(response.getEntity());
      RequestLogger.log(logger,"sniff succeeded",httpGet,host,response);
      return nodes;
    }
  }
 catch (  IOException e) {
    RequestLogger.log(logger,"sniff failed",httpGet,host,e);
    throw e;
  }
}
