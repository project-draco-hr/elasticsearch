{
  KeyStore keyStore=KeyStore.getInstance(config.keyStoreType);
  InputStream keystoreInputStream=new FileInputStream(config.keyStoreLocation);
  try {
    keyStore.load(keystoreInputStream,(config.keyStorePassword == null) ? null : config.keyStorePassword.toCharArray());
  }
  finally {
    keystoreInputStream.close();
  }
  KeyManagerFactory keyManagerFactory=KeyManagerFactory.getInstance(config.keyManagerAlgorithm);
  keyManagerFactory.init(keyStore,(config.keyManagerPassword == null) ? null : config.keyManagerPassword.toCharArray());
  KeyManager[] keyManagers=keyManagerFactory.getKeyManagers();
  KeyStore trustStore=KeyStore.getInstance(config.trustStoreType);
  InputStream truststoreInputStream=new FileInputStream(config.trustStoreLocation);
  try {
    trustStore.load(truststoreInputStream,(config.trustStorePassword == null) ? null : config.trustStorePassword.toCharArray());
  }
  finally {
    truststoreInputStream.close();
  }
  TrustManagerFactory trustManagerFactory=TrustManagerFactory.getInstance(config.trustManagerAlgorithm);
  trustManagerFactory.init(trustStore);
  TrustManager[] trustManagers=trustManagerFactory.getTrustManagers();
  SSLContext context=SSLContext.getInstance("TLS");
  context.init(keyManagers,trustManagers,null);
  return context;
}
