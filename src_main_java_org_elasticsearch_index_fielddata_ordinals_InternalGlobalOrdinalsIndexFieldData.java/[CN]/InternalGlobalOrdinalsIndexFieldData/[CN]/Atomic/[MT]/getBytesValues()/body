{
  BytesValues.WithOrdinals values=afd.getBytesValues();
  Ordinals.Docs segmentOrdinals=values.ordinals();
  final Ordinals.Docs globalOrdinals;
  if (segmentOrdToGlobalOrdLookup != null) {
    globalOrdinals=segmentOrdToGlobalOrdLookup.globalOrdinals(segmentOrdinals);
  }
 else {
    globalOrdinals=segmentOrdinals;
  }
  final BytesValues.WithOrdinals[] bytesValues=new BytesValues.WithOrdinals[atomicReaders.length];
  for (int i=0; i < bytesValues.length; i++) {
    bytesValues[i]=atomicReaders[i].afd.getBytesValues();
  }
  return new BytesValues.WithOrdinals(globalOrdinals){
    int readerIndex;
    @Override public BytesRef getValueByOrd(    long globalOrd){
      final long segmentOrd=globalOrd - globalOrdToFirstSegmentDelta.get(globalOrd);
      readerIndex=(int)globalOrdToFirstSegment.get(globalOrd);
      return bytesValues[readerIndex].getValueByOrd(segmentOrd);
    }
    @Override public BytesRef copyShared(){
      return bytesValues[readerIndex].copyShared();
    }
  }
;
}
