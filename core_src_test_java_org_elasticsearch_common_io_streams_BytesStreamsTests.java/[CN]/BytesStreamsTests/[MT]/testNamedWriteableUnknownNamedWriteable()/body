{
  BytesStreamOutput out=new BytesStreamOutput();
  NamedWriteableRegistry namedWriteableRegistry=new NamedWriteableRegistry();
  out.writeNamedWriteable(new MatchAllQueryBuilder());
  StreamInput in=StreamInput.wrap(out.bytes().toBytes());
  if (randomBoolean()) {
    in=new FilterStreamInput(in,namedWriteableRegistry);
  }
  try {
    in.readNamedWriteable();
    fail("read should have failed");
  }
 catch (  IllegalArgumentException e) {
    assertThat(e.getMessage(),equalTo("unknown named writeable with name [" + MatchAllQueryBuilder.NAME + "]"));
  }
}
