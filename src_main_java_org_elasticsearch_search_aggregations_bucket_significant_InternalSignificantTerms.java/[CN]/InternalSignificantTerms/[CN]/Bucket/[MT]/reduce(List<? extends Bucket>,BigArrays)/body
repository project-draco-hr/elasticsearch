{
  if (buckets.size() == 1) {
    return buckets.get(0);
  }
  Bucket reduced=null;
  List<InternalAggregations> aggregationsList=new ArrayList<>(buckets.size());
  for (  Bucket bucket : buckets) {
    if (reduced == null) {
      reduced=bucket;
    }
 else {
      reduced.subsetDf+=bucket.subsetDf;
      reduced.supersetDf+=bucket.supersetDf;
      reduced.updateScore();
    }
    aggregationsList.add(bucket.aggregations);
  }
  reduced.aggregations=InternalAggregations.reduce(aggregationsList,bigArrays);
  return reduced;
}
