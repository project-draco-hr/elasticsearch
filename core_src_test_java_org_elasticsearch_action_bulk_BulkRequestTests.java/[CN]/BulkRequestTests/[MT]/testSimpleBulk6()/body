{
  String bulkAction=copyToStringFromClasspath("/org/elasticsearch/action/bulk/simple-bulk6.json");
  BulkRequest bulkRequest=new BulkRequest();
  try {
    bulkRequest.add(bulkAction.getBytes(StandardCharsets.UTF_8),0,bulkAction.length(),null,null);
    fail("should have thrown an exception about the wrong format of line 1");
  }
 catch (  IllegalArgumentException e) {
    assertThat("message contains error about the wrong format of line 1: " + e.getMessage(),e.getMessage().contains("Malformed action/metadata line [1], expected a simple value for field [_source] but found [START_OBJECT]"),equalTo(true));
  }
}
