{
  XContentBuilder expectedRawField=newXContentBuilder().startObject().field("foo",0).startObject("raw").field("content","hello world!").endObject().endObject();
  XContentBuilder expectedRawFieldFiltered=newXContentBuilder().startObject().field("foo",0).endObject();
  XContentBuilder expectedRawFieldNotFiltered=newXContentBuilder().startObject().startObject("raw").field("content","hello world!").endObject().endObject();
  BytesReference raw=newXContentBuilder().startObject().field("content","hello world!").endObject().bytes();
  assertXContentBuilder(expectedRawField,newXContentBuilder().startObject().field("foo",0).rawField("raw",raw).endObject());
  assertXContentBuilder(expectedRawFieldFiltered,newXContentBuilder("f*",true).startObject().field("foo",0).rawField("raw",raw).endObject());
  assertXContentBuilder(expectedRawFieldFiltered,newXContentBuilder("r*",false).startObject().field("foo",0).rawField("raw",raw).endObject());
  assertXContentBuilder(expectedRawFieldNotFiltered,newXContentBuilder("r*",true).startObject().field("foo",0).rawField("raw",raw).endObject());
  assertXContentBuilder(expectedRawFieldNotFiltered,newXContentBuilder("f*",false).startObject().field("foo",0).rawField("raw",raw).endObject());
  assertXContentBuilder(expectedRawField,newXContentBuilder().startObject().field("foo",0).rawField("raw",raw.streamInput()).endObject());
  assertXContentBuilder(expectedRawFieldFiltered,newXContentBuilder("f*",true).startObject().field("foo",0).rawField("raw",raw.streamInput()).endObject());
  assertXContentBuilder(expectedRawFieldFiltered,newXContentBuilder("r*",false).startObject().field("foo",0).rawField("raw",raw.streamInput()).endObject());
  assertXContentBuilder(expectedRawFieldNotFiltered,newXContentBuilder("r*",true).startObject().field("foo",0).rawField("raw",raw.streamInput()).endObject());
  assertXContentBuilder(expectedRawFieldNotFiltered,newXContentBuilder("f*",false).startObject().field("foo",0).rawField("raw",raw.streamInput()).endObject());
}
