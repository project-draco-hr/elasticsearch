{
  XContentBuilder expectedRawField=newXContentBuilder().startObject().field("foo",0).startObject("raw").field("content","hello world!").endObject().endObject();
  XContentBuilder expectedRawFieldFiltered=newXContentBuilder().startObject().field("foo",0).endObject();
  XContentBuilder expectedRawFieldNotFiltered=newXContentBuilder().startObject().startObject("raw").field("content","hello world!").endObject().endObject();
  BytesReference raw=newXContentBuilder().startObject().field("content","hello world!").endObject().bytes();
  assertXContentBuilder(expectedRawField,newXContentBuilder().startObject().field("foo",0).rawField("raw",raw).endObject());
  assertXContentBuilder(expectedRawFieldFiltered,newXContentBuilder("f*").startObject().field("foo",0).rawField("raw",raw).endObject());
  assertXContentBuilder(expectedRawFieldNotFiltered,newXContentBuilder("r*").startObject().field("foo",0).rawField("raw",raw).endObject());
  assertXContentBuilder(expectedRawField,newXContentBuilder().startObject().field("foo",0).rawField("raw",raw.toBytes()).endObject());
  assertXContentBuilder(expectedRawFieldFiltered,newXContentBuilder("f*").startObject().field("foo",0).rawField("raw",raw.toBytes()).endObject());
  assertXContentBuilder(expectedRawFieldNotFiltered,newXContentBuilder("r*").startObject().field("foo",0).rawField("raw",raw.toBytes()).endObject());
  assertXContentBuilder(expectedRawField,newXContentBuilder().startObject().field("foo",0).rawField("raw",new ByteArrayInputStream(raw.toBytes())).endObject());
  assertXContentBuilder(expectedRawFieldFiltered,newXContentBuilder("f*").startObject().field("foo",0).rawField("raw",new ByteArrayInputStream(raw.toBytes())).endObject());
  assertXContentBuilder(expectedRawFieldNotFiltered,newXContentBuilder("r*").startObject().field("foo",0).rawField("raw",new ByteArrayInputStream(raw.toBytes())).endObject());
}
