{
  XContentBuilder expected=newXContentBuilder(true).startObject().startArray("tags").value("lorem").value("ipsum").value("dolor").endArray().endObject();
  assertXContentBuilder(expected,newXContentBuilder(true,"t*").startObject().startArray("tags").value("lorem").value("ipsum").value("dolor").endArray().endObject());
  assertXContentBuilder(expected,newXContentBuilder(true,"tags").startObject().startArray("tags").value("lorem").value("ipsum").value("dolor").endArray().endObject());
  assertXContentBuilder(expected,newXContentBuilder(false,"a").startObject().startArray("tags").value("lorem").value("ipsum").value("dolor").endArray().endObject());
  assertXContentBuilder(newXContentBuilder(true).startObject().endObject(),newXContentBuilder(true,"foo").startObject().startArray("tags").value("lorem").value("ipsum").value("dolor").endArray().endObject());
  assertXContentBuilder(newXContentBuilder(true).startObject().endObject(),newXContentBuilder(false,"t*").startObject().startArray("tags").value("lorem").value("ipsum").value("dolor").endArray().endObject());
  assertXContentBuilder(newXContentBuilder(true).startObject().endObject(),newXContentBuilder(false,"tags").startObject().startArray("tags").value("lorem").value("ipsum").value("dolor").endArray().endObject());
  expected=newXContentBuilder(true).startObject().startArray("tags").startObject().field("lastname","lorem").endObject().startObject().field("firstname","ipsum").endObject().endArray().endObject();
  assertXContentBuilder(expected,newXContentBuilder(true,"t*").startObject().startArray("tags").startObject().field("lastname","lorem").endObject().startObject().field("firstname","ipsum").endObject().endArray().endObject());
  assertXContentBuilder(expected,newXContentBuilder(true,"tags").startObject().startArray("tags").startObject().field("lastname","lorem").endObject().startObject().field("firstname","ipsum").endObject().endArray().endObject());
  assertXContentBuilder(expected,newXContentBuilder(false,"a").startObject().startArray("tags").startObject().field("lastname","lorem").endObject().startObject().field("firstname","ipsum").endObject().endArray().endObject());
  assertXContentBuilder(newXContentBuilder(true).startObject().endObject(),newXContentBuilder(true,"foo").startObject().startArray("tags").startObject().field("lastname","lorem").endObject().startObject().field("firstname","ipsum").endObject().endArray().endObject());
  assertXContentBuilder(newXContentBuilder(true).startObject().endObject(),newXContentBuilder(false,"t*").startObject().startArray("tags").startObject().field("lastname","lorem").endObject().startObject().field("firstname","ipsum").endObject().endArray().endObject());
  assertXContentBuilder(newXContentBuilder(true).startObject().endObject(),newXContentBuilder(false,"tags").startObject().startArray("tags").startObject().field("lastname","lorem").endObject().startObject().field("firstname","ipsum").endObject().endArray().endObject());
  expected=newXContentBuilder(true).startObject().startArray("tags").startObject().field("firstname","ipsum").endObject().endArray().endObject();
  assertXContentBuilder(expected,newXContentBuilder(true,"t*.firstname").startObject().startArray("tags").startObject().field("lastname","lorem").endObject().startObject().field("firstname","ipsum").endObject().endArray().endObject());
  assertXContentBuilder(expected,newXContentBuilder(false,"t*.lastname").startObject().startArray("tags").startObject().field("lastname","lorem").endObject().startObject().field("firstname","ipsum").endObject().endArray().endObject());
}
