{
  createIndex("test");
  ensureGreen();
  PutWarmerResponse putWarmerResponse=client().admin().indices().preparePutWarmer("custom_warmer").setSearchRequest(client().prepareSearch("test").setTypes("test").setQuery(QueryBuilders.matchAllQuery())).execute().actionGet();
  assertThat(putWarmerResponse.isAcknowledged(),equalTo(true));
  client().prepareIndex("test","test","1").setSource("foo","bar").setRefresh(true).execute().actionGet();
  logger.info("--> Disabling warmers execution");
  client().admin().indices().prepareUpdateSettings("test").setSettings(ImmutableSettings.builder().put("index.warmer.enabled",false)).execute().actionGet();
  long warmerRunsAfterDisabling=getWarmerRuns();
  assertThat(warmerRunsAfterDisabling,greaterThanOrEqualTo(1L));
  client().prepareIndex("test","test","2").setSource("foo2","bar2").setRefresh(true).execute().actionGet();
  assertThat(getWarmerRuns(),equalTo(warmerRunsAfterDisabling));
}
