{
  createIndex("test");
  ensureGreen();
  PutWarmerResponse putWarmerResponse=client().admin().indices().preparePutWarmer("custom_warmer").setSearchRequest(client().prepareSearch("test").setTypes("test").setQuery(QueryBuilders.matchAllQuery())).get();
  assertThat(putWarmerResponse.isAcknowledged(),equalTo(true));
  for (  Client client : clients()) {
    GetWarmersResponse getWarmersResponse=client.admin().indices().prepareGetWarmers().setLocal(true).get();
    assertThat(getWarmersResponse.warmers().size(),equalTo(1));
    Map.Entry<String,ImmutableList<IndexWarmersMetaData.Entry>> entry=getWarmersResponse.warmers().entrySet().iterator().next();
    assertThat(entry.getKey(),equalTo("test"));
    assertThat(entry.getValue().size(),equalTo(1));
    assertThat(entry.getValue().get(0).name(),equalTo("custom_warmer"));
  }
}
