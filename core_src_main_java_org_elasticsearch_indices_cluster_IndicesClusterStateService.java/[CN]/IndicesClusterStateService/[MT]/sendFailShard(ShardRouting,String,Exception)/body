{
  try {
    logger.warn(new ParameterizedMessage("[{}] marking and sending shard failed due to [{}]",shardRouting.shardId(),message),failure);
    failedShardsCache.put(shardRouting.shardId(),shardRouting);
    shardStateAction.localShardFailed(shardRouting,message,failure,SHARD_STATE_ACTION_LISTENER);
  }
 catch (  Exception inner) {
    if (failure != null)     inner.addSuppressed(failure);
    logger.warn(new ParameterizedMessage("[{}][{}] failed to mark shard as failed (because of [{}])",shardRouting.getIndexName(),shardRouting.getId(),message),inner);
  }
}
