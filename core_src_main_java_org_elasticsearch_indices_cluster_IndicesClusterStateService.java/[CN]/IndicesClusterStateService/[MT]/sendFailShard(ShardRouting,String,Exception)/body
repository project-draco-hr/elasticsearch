{
  try {
    logger.warn("[{}] marking and sending shard failed due to [{}]",failure,shardRouting.shardId(),message);
    failedShardsCache.put(shardRouting.shardId(),shardRouting);
    shardStateAction.localShardFailed(shardRouting,message,failure,SHARD_STATE_ACTION_LISTENER);
  }
 catch (  Exception inner) {
    if (failure != null)     inner.addSuppressed(failure);
    logger.warn("[{}][{}] failed to mark shard as failed (because of [{}])",inner,shardRouting.getIndexName(),shardRouting.getId(),message);
  }
}
