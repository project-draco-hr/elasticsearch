{
  if (disableSites) {
    channel.sendResponse(new StringRestResponse(FORBIDDEN));
    return;
  }
  if (request.method() != RestRequest.Method.GET) {
    channel.sendResponse(new StringRestResponse(FORBIDDEN));
    return;
  }
  int i1=request.rawPath().indexOf('/',9);
  if (i1 == -1) {
    channel.sendResponse(new StringRestResponse(NOT_FOUND));
    return;
  }
  String pluginName=request.rawPath().substring(9,i1);
  String sitePath=request.rawPath().substring(i1 + 1);
  if (sitePath.length() == 0) {
    sitePath="/index.html";
  }
  sitePath=sitePath.replace('/',File.separatorChar);
  File siteFile=new File(new File(environment.pluginsFile(),pluginName),"_site");
  File file=new File(siteFile,sitePath);
  if (!file.exists() || file.isHidden()) {
    channel.sendResponse(new StringRestResponse(NOT_FOUND));
    return;
  }
  if (!file.isFile()) {
    channel.sendResponse(new StringRestResponse(FORBIDDEN));
    return;
  }
  if (!file.getAbsolutePath().startsWith(siteFile.getAbsolutePath())) {
    channel.sendResponse(new StringRestResponse(FORBIDDEN));
    return;
  }
  try {
    byte[] data=Streams.copyToByteArray(file);
    channel.sendResponse(new BytesRestResponse(data,""));
  }
 catch (  IOException e) {
    channel.sendResponse(new StringRestResponse(INTERNAL_SERVER_ERROR));
  }
}
