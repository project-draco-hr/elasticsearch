{
  byte[] html=copyToBytesFromClasspath("/org/elasticsearch/index/mapper/attachment/test/sample-files/" + filename);
  BytesReference json=jsonBuilder().startObject().startObject("file").field("_name",filename).field("_content",html).endObject().endObject().bytes();
  ParseContext.Document doc=docMapper.parse("person","person","1",json).rootDoc();
  if (!errorExpected) {
    assertThat(doc.get(docMapper.mappers().getMapper("file.content").fieldType().names().indexName()),not(isEmptyOrNullString()));
    logger.debug("-> extracted content: {}",doc.get(docMapper.mappers().getMapper("file").fieldType().names().indexName()));
    logger.debug("-> extracted metadata:");
    printMetadataContent(doc,AUTHOR);
    printMetadataContent(doc,CONTENT_LENGTH);
    printMetadataContent(doc,CONTENT_TYPE);
    printMetadataContent(doc,DATE);
    printMetadataContent(doc,KEYWORDS);
    printMetadataContent(doc,LANGUAGE);
    printMetadataContent(doc,NAME);
    printMetadataContent(doc,TITLE);
  }
}
