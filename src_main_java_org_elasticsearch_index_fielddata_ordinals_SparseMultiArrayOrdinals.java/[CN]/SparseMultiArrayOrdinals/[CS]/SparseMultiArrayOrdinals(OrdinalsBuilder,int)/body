{
  int blockShift=Math.min(floorPow2(builder.getTotalNumOrds() << 1),floorPow2(maxSize));
  this.pool=new PositiveIntPool(Math.max(4,blockShift));
  this.numDocs=builder.maxDoc();
  this.lookup=new int[numDocs];
  this.numOrds=builder.getNumOrds();
  this.maxOrd=numOrds + 1;
  IntArrayRef spare;
  for (int doc=0; doc < numDocs; doc++) {
    spare=builder.docOrds(doc);
    int size=spare.size();
    if (size == 0) {
      lookup[doc]=0;
    }
 else     if (size == 1) {
      lookup[doc]=spare.values[spare.start];
    }
 else {
      int offset=pool.put(spare);
      lookup[doc]=-(offset) - 1;
    }
  }
}
