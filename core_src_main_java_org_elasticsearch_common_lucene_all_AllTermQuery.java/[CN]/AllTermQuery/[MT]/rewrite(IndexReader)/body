{
  boolean fieldExists=false;
  boolean hasPayloads=false;
  for (  LeafReaderContext context : reader.leaves()) {
    final Terms terms=context.reader().terms(term.field());
    if (terms != null) {
      fieldExists=true;
      if (terms.hasPayloads()) {
        hasPayloads=true;
        break;
      }
    }
  }
  if (fieldExists == false) {
    Query rewritten=new MatchNoDocsQuery();
    rewritten.setBoost(getBoost());
    return rewritten;
  }
  if (hasPayloads == false) {
    TermQuery rewritten=new TermQuery(term);
    rewritten.setBoost(getBoost());
    return rewritten;
  }
  return this;
}
