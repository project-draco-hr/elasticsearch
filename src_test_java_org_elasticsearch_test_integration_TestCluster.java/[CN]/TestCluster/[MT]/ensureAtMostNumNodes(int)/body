{
  if (nodes.size() <= num) {
    return;
  }
  Collection<NodeAndClient> values=nodes.values();
  Iterator<NodeAndClient> limit=Iterators.limit(values.iterator(),nodes.size() - num);
  logger.info("reducing cluster size from {} to {}",nodes.size() - num,num);
  while (limit.hasNext()) {
    NodeAndClient next=limit.next();
    limit.remove();
    next.close();
  }
}
