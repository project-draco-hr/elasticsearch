{
  if (percolateTypeQuery != null && queriesMetaDataQuery != null) {
    throw new IllegalStateException("Either filter by deprecated percolator type or by query metadata");
  }
  BooleanQuery.Builder builder=new BooleanQuery.Builder();
  if (percolateTypeQuery != null) {
    builder.add(percolateTypeQuery,FILTER);
  }
  if (queriesMetaDataQuery != null) {
    builder.add(queriesMetaDataQuery,FILTER);
  }
  return new PercolatorQuery(docType,queryRegistry,documentSource,builder.build(),percolatorIndexSearcher);
}
