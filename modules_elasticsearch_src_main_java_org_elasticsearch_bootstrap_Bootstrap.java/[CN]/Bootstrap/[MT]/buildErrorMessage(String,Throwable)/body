{
  StringBuilder errorMessage=new StringBuilder("{").append(Version.full()).append("}: ");
  try {
    if (ANSI.isEnabled()) {
      errorMessage.append(attrib(ANSI.Code.FG_RED)).append(stage).append(" Failed ...").append(attrib(ANSI.Code.OFF)).append("\n");
    }
 else {
      errorMessage.append(stage).append(" Failed ...\n");
    }
  }
 catch (  Throwable t) {
    errorMessage.append(stage).append(" Failed ...\n");
  }
  if (e instanceof CreationException) {
    CreationException createException=(CreationException)e;
    Set<String> seenMessages=newHashSet();
    int counter=1;
    for (    Message message : createException.getErrorMessages()) {
      String detailedMessage;
      if (message.getCause() == null) {
        detailedMessage=message.getMessage();
      }
 else {
        detailedMessage=ExceptionsHelper.detailedMessage(message.getCause(),true,0);
      }
      if (detailedMessage == null) {
        detailedMessage=message.getMessage();
      }
      if (seenMessages.contains(detailedMessage)) {
        continue;
      }
      seenMessages.add(detailedMessage);
      errorMessage.append("").append(counter++).append(") ").append(detailedMessage);
    }
  }
 else {
    errorMessage.append("- ").append(ExceptionsHelper.detailedMessage(e,true,0));
  }
  return errorMessage.toString();
}
