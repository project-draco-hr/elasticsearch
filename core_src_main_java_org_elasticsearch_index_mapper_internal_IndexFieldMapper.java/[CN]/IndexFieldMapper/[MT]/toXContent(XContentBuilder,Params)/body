{
  boolean includeDefaults=params.paramAsBoolean("include_defaults",false);
  if (!includeDefaults && fieldType().stored() == Defaults.FIELD_TYPE.stored() && enabledState == Defaults.ENABLED_STATE && customFieldDataSettings == null) {
    return builder;
  }
  builder.startObject(CONTENT_TYPE);
  if (indexCreatedBefore2x && (includeDefaults || fieldType().stored() != Defaults.FIELD_TYPE.stored())) {
    builder.field("store",fieldType().stored());
  }
  if (includeDefaults || enabledState != Defaults.ENABLED_STATE) {
    builder.field("enabled",enabledState.enabled);
  }
  if (indexCreatedBefore2x) {
    if (customFieldDataSettings != null) {
      builder.field("fielddata",(Map)customFieldDataSettings.getAsMap());
    }
 else     if (includeDefaults) {
      builder.field("fielddata",(Map)fieldType().fieldDataType().getSettings().getAsMap());
    }
  }
  builder.endObject();
  return builder;
}
