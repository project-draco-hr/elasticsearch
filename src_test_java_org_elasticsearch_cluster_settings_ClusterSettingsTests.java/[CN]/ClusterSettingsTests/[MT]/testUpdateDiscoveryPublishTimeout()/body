{
  ClusterUpdateSettingsResponse response=client().admin().cluster().prepareUpdateSettings().setTransientSettings(ImmutableSettings.builder().put(DiscoverySettings.PUBLISH_TIMEOUT,"1s").build()).get();
  assertThat(response.getTransientSettings().getAsMap().get(DiscoverySettings.PUBLISH_TIMEOUT),equalTo("1s"));
  response=client().admin().cluster().prepareUpdateSettings().setTransientSettings(ImmutableSettings.builder().put(DiscoverySettings.PUBLISH_TIMEOUT,"whatever").build()).get();
  assertThat(response.getTransientSettings().getAsMap().entrySet(),Matchers.emptyIterable());
  response=client().admin().cluster().prepareUpdateSettings().setTransientSettings(ImmutableSettings.builder().put(DiscoverySettings.PUBLISH_TIMEOUT,-1).build()).get();
  assertThat(response.getTransientSettings().getAsMap().entrySet(),Matchers.emptyIterable());
}
