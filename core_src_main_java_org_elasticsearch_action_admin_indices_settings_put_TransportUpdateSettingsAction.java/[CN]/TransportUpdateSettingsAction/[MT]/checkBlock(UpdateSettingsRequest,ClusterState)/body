{
  ClusterBlockException globalBlock=state.blocks().globalBlockedException(ClusterBlockLevel.METADATA_WRITE);
  if (globalBlock != null) {
    return globalBlock;
  }
  if (request.settings().getAsMap().size() == 1 && (request.settings().get(IndexMetaData.SETTING_BLOCKS_METADATA) != null || request.settings().get(IndexMetaData.SETTING_READ_ONLY) != null)) {
    return null;
  }
  return state.blocks().indicesBlockedException(ClusterBlockLevel.METADATA_WRITE,indexNameExpressionResolver.concreteIndices(state,request));
}
