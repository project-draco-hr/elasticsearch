{
  assertCorsSettingRegex("/foo/",Pattern.compile("foo"));
  assertCorsSettingRegex("/.*/",Pattern.compile(".*"));
  assertCorsSettingRegex("/https?:\\/\\/localhost(:[0-9]+)?/",Pattern.compile("https?:\\/\\/localhost(:[0-9]+)?"));
  assertCorsSettingRegexMatches("/https?:\\/\\/localhost(:[0-9]+)?/",true,"http://localhost:9200","http://localhost:9215","https://localhost:9200","https://localhost");
  assertCorsSettingRegexMatches("/https?:\\/\\/localhost(:[0-9]+)?/",false,"htt://localhost:9200","http://localhost:9215/foo","localhost:9215");
  assertCorsSettingRegexIsNull("//");
  assertCorsSettingRegexIsNull("/");
  assertCorsSettingRegexIsNull("/foo");
  assertCorsSettingRegexIsNull("foo");
  assertCorsSettingRegexIsNull("");
  assertThat(RestUtils.getCorsSettingRegex(Settings.EMPTY),is(nullValue()));
}
