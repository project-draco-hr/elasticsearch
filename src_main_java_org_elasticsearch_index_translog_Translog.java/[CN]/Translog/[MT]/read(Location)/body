{
  try (ReleasableLock lock=readLock.acquire()){
    final TranslogReader reader;
    final long currentGeneration=current.getGeneration();
    if (currentGeneration == location.generation) {
      reader=current;
    }
 else     if (currentCommittingTranslog != null && currentCommittingTranslog.getGeneration() == location.generation) {
      reader=currentCommittingTranslog;
    }
 else     if (currentGeneration < location.generation) {
      throw new IllegalStateException("location generation [" + location.generation + "] is greater than the current generation ["+ currentGeneration+ "]");
    }
 else {
      return null;
    }
    return reader.read(location);
  }
 catch (  IOException e) {
    throw new ElasticsearchException("failed to read source from translog location " + location,e);
  }
}
