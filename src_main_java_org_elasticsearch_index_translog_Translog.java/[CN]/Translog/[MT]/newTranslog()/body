{
  try (ReleasableLock lock=writeLock.acquire()){
    final TranslogFile old=current;
    final TranslogFile newFile=createTranslogFile(old);
    current=newFile;
    ChannelImmutableReader reader=old.immutableReader();
    uncommittedTranslogs.add(reader);
    for (    FsView view : outstandingViews) {
      view.onNewTranslog(old.immutableReader(),current.reader());
    }
    IOUtils.close(old);
    logger.trace("current translog set to [{}]",current.translogId());
    return current.translogId();
  }
 }
