{
  String fieldName=randomBoolean() ? STRING_FIELD_NAME : randomAsciiOfLengthBetween(1,10);
  String value=randomAsciiOfLengthBetween(1,10);
  RegexpQueryBuilder query=new RegexpQueryBuilder(fieldName,value);
  if (randomBoolean()) {
    List<RegexpFlag> flags=new ArrayList<>();
    int iter=randomInt(5);
    for (int i=0; i < iter; i++) {
      flags.add(randomFrom(RegexpFlag.values()));
    }
    query.flags(flags.toArray(new RegexpFlag[flags.size()]));
  }
  if (randomBoolean()) {
    query.maxDeterminizedStates(randomInt(50000));
  }
  if (randomBoolean()) {
    query.rewrite(randomFrom(getRandomRewriteMethod()));
  }
  return query;
}
