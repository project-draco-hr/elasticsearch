{
  logger.warn(reason + ", current nodes: {}",clusterState.nodes());
  nodesFD.stop();
  masterFD.stop(reason);
  master=false;
  ClusterBlocks clusterBlocks=ClusterBlocks.builder().blocks(clusterState.blocks()).addGlobalBlock(NO_MASTER_BLOCK).addGlobalBlock(GatewayService.STATE_NOT_RECOVERED_BLOCK).build();
  RoutingTable routingTable=RoutingTable.builder().build();
  MetaData metaData=MetaData.builder().build();
  latestDiscoNodes=new DiscoveryNodes.Builder().put(localNode).localNodeId(localNode.id()).build();
  asyncJoinCluster();
  return newClusterStateBuilder().state(clusterState).blocks(clusterBlocks).nodes(latestDiscoNodes).routingTable(routingTable).metaData(metaData).build();
}
