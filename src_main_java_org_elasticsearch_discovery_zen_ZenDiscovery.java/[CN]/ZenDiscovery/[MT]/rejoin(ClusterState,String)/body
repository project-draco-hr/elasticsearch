{
  logger.warn(reason + ", current nodes: {}",clusterState.nodes());
  nodesFD.stop();
  masterFD.stop(reason);
  master=false;
  ClusterBlocks clusterBlocks=ClusterBlocks.builder().blocks(clusterState.blocks()).addGlobalBlock(NO_MASTER_BLOCK).build();
  latestDiscoNodes=new DiscoveryNodes.Builder(latestDiscoNodes).masterNodeId(null).build();
  asyncJoinCluster();
  return ClusterState.builder(clusterState).blocks(clusterBlocks).nodes(latestDiscoNodes).build();
}
