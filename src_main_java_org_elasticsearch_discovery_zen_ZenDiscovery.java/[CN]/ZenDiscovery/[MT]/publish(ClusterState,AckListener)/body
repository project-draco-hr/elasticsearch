{
  if (!clusterState.getNodes().localNodeMaster()) {
    throw new IllegalStateException("Shouldn't publish state when not master");
  }
  nodesFD.updateNodesAndPing(clusterState);
  publishClusterState.publish(clusterState,ackListener);
}
