{
  assertClusterStateThread();
  if (joinThreadActive()) {
    return;
  }
  threadPool.generic().execute(new Runnable(){
    @Override public void run(){
      Thread currentThread=Thread.currentThread();
      if (!currentJoinThread.compareAndSet(null,currentThread)) {
        return;
      }
      while (joinThreadActive(currentThread)) {
        try {
          innerJoinCluster();
          return;
        }
 catch (        Throwable t) {
          logger.error("unexpected error while joining cluster, trying again",t);
        }
      }
    }
  }
);
}
