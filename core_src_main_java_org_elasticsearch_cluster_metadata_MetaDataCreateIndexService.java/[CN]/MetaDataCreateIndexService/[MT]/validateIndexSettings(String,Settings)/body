{
  String customPath=settings.get(IndexMetaData.SETTING_DATA_PATH,null);
  List<String> validationErrors=Lists.newArrayList();
  if (customPath != null && nodeEnv.isCustomPathsEnabled() == false) {
    validationErrors.add("custom data_paths for indices is disabled");
  }
  Integer number_of_primaries=settings.getAsInt(IndexMetaData.SETTING_NUMBER_OF_SHARDS,null);
  Integer number_of_replicas=settings.getAsInt(IndexMetaData.SETTING_NUMBER_OF_REPLICAS,null);
  if (number_of_primaries != null && number_of_primaries <= 0) {
    validationErrors.add("index must have 1 or more primary shards");
  }
  if (number_of_replicas != null && number_of_replicas < 0) {
    validationErrors.add("index must have 0 or more replica shards");
  }
  if (validationErrors.isEmpty() == false) {
    throw new IndexCreationException(new Index(indexName),new IllegalArgumentException(getMessage(validationErrors)));
  }
}
