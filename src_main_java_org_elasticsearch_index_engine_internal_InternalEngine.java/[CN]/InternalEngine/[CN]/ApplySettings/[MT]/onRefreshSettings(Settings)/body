{
  long gcDeletesInMillis=settings.getAsTime(INDEX_GC_DELETES,TimeValue.timeValueMillis(InternalEngine.this.gcDeletesInMillis)).millis();
  if (gcDeletesInMillis != InternalEngine.this.gcDeletesInMillis) {
    logger.info("updating index.gc_deletes from [{}] to [{}]",TimeValue.timeValueMillis(InternalEngine.this.gcDeletesInMillis),TimeValue.timeValueMillis(gcDeletesInMillis));
    InternalEngine.this.gcDeletesInMillis=gcDeletesInMillis;
  }
  final boolean compoundOnFlush=settings.getAsBoolean(INDEX_COMPOUND_ON_FLUSH,InternalEngine.this.compoundOnFlush);
  if (compoundOnFlush != InternalEngine.this.compoundOnFlush) {
    logger.info("updating {} from [{}] to [{}]",InternalEngine.INDEX_COMPOUND_ON_FLUSH,InternalEngine.this.compoundOnFlush,compoundOnFlush);
    InternalEngine.this.compoundOnFlush=compoundOnFlush;
    indexWriter.getConfig().setUseCompoundFile(compoundOnFlush);
  }
  InternalEngine.this.failEngineOnCorruption=indexSettings.getAsBoolean(ENGINE_FAIL_ON_CORRUPTION,InternalEngine.this.failEngineOnCorruption);
  int indexConcurrency=settings.getAsInt(INDEX_INDEX_CONCURRENCY,InternalEngine.this.indexConcurrency);
  boolean failOnMergeFailure=settings.getAsBoolean(INDEX_FAIL_ON_MERGE_FAILURE,InternalEngine.this.failOnMergeFailure);
  String codecName=settings.get(INDEX_CODEC,InternalEngine.this.codecName);
  final boolean codecBloomLoad=settings.getAsBoolean(CodecService.INDEX_CODEC_BLOOM_LOAD,codecService.isLoadBloomFilter());
  boolean requiresFlushing=false;
  if (indexConcurrency != InternalEngine.this.indexConcurrency || !codecName.equals(InternalEngine.this.codecName) || failOnMergeFailure != InternalEngine.this.failOnMergeFailure || codecBloomLoad != codecService.isLoadBloomFilter()) {
    try (InternalLock _=readLock.acquire()){
      if (indexConcurrency != InternalEngine.this.indexConcurrency) {
        logger.info("updating index.index_concurrency from [{}] to [{}]",InternalEngine.this.indexConcurrency,indexConcurrency);
        InternalEngine.this.indexConcurrency=indexConcurrency;
        requiresFlushing=true;
      }
      if (!codecName.equals(InternalEngine.this.codecName)) {
        logger.info("updating index.codec from [{}] to [{}]",InternalEngine.this.codecName,codecName);
        InternalEngine.this.codecName=codecName;
        requiresFlushing=true;
      }
      if (failOnMergeFailure != InternalEngine.this.failOnMergeFailure) {
        logger.info("updating {} from [{}] to [{}]",InternalEngine.INDEX_FAIL_ON_MERGE_FAILURE,InternalEngine.this.failOnMergeFailure,failOnMergeFailure);
        InternalEngine.this.failOnMergeFailure=failOnMergeFailure;
      }
      if (codecBloomLoad != codecService.isLoadBloomFilter()) {
        logger.info("updating {} from [{}] to [{}]",CodecService.INDEX_CODEC_BLOOM_LOAD,codecService.isLoadBloomFilter(),codecBloomLoad);
        codecService.setLoadBloomFilter(codecBloomLoad);
        requiresFlushing=true;
      }
    }
     if (requiresFlushing) {
      flush(new Flush().type(Flush.Type.NEW_WRITER));
    }
  }
}
