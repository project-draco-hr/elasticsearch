{
  rwl.readLock().lock();
  try {
    ensureOpen();
    Searcher searcher=acquireSearcher("segments_stats");
    try {
      SegmentsStats stats=new SegmentsStats();
      for (      AtomicReaderContext reader : searcher.reader().leaves()) {
        stats.add(1,getReaderRamBytesUsed(reader));
      }
      return stats;
    }
  finally {
      searcher.release();
    }
  }
  finally {
    rwl.readLock().unlock();
  }
}
