{
  if (closedOrFailed == false) {
    final LiveIndexWriterConfig iwc=indexWriter.getConfig();
    iwc.setUseCompoundFile(engineConfig.isCompoundOnFlush());
    final boolean concurrencyNeedsUpdate=iwc.getMaxThreadStates() != engineConfig.getIndexConcurrency();
    final boolean codecNeedsUpdate=iwc.getCodec().equals(engineConfig.getCodec()) == false;
    if (codecNeedsUpdate || concurrencyNeedsUpdate) {
      flush(FlushType.NEW_WRITER,false,false);
    }
  }
}
