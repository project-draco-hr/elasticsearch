{
  rwl.writeLock().lock();
  try {
    innerClose();
  }
  finally {
    rwl.writeLock().unlock();
  }
  try {
    int ongoingRecoveries=onGoingRecoveries.awaitNoRecoveries(5000);
    if (ongoingRecoveries > 0) {
      logger.debug("Waiting for ongoing recoveries timed out on close currently ongoing disoveries: [{}]",ongoingRecoveries);
    }
  }
 catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
  }
}
