{
  final List<NodeStoreFilesMetaData> nodeStoreFilesMetaDatas=Lists.newArrayList();
  final List<FailedNodeException> failures=Lists.newArrayList();
  for (int i=0; i < responses.length(); i++) {
    Object resp=responses.get(i);
    if (resp instanceof NodeStoreFilesMetaData) {
      nodeStoreFilesMetaDatas.add((NodeStoreFilesMetaData)resp);
    }
 else     if (resp instanceof FailedNodeException) {
      failures.add((FailedNodeException)resp);
    }
 else {
      logger.warn("unknown response type [{}], expected NodeStoreFilesMetaData or FailedNodeException",resp);
    }
  }
  return new NodesStoreFilesMetaData(clusterName,nodeStoreFilesMetaDatas.toArray(new NodeStoreFilesMetaData[nodeStoreFilesMetaDatas.size()]),failures.toArray(new FailedNodeException[failures.size()]));
}
