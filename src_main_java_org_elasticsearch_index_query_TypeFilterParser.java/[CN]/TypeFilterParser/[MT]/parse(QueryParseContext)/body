{
  XContentParser parser=parseContext.parser();
  XContentParser.Token token=parser.nextToken();
  if (token != XContentParser.Token.FIELD_NAME) {
    throw new QueryParsingException(parseContext.index(),"[type] filter should have a value field, and the type name");
  }
  String fieldName=parser.currentName();
  if (!fieldName.equals("value")) {
    throw new QueryParsingException(parseContext.index(),"[type] filter should have a value field, and the type name");
  }
  token=parser.nextToken();
  if (token != XContentParser.Token.VALUE_STRING) {
    throw new QueryParsingException(parseContext.index(),"[type] filter should have a value field, and the type name");
  }
  BytesRef type=parser.utf8Bytes();
  parser.nextToken();
  Filter filter;
  DocumentMapper documentMapper=parseContext.mapperService().documentMapper(type.utf8ToString());
  if (documentMapper == null) {
    filter=new TermFilter(new Term(TypeFieldMapper.NAME,type));
  }
 else {
    filter=documentMapper.typeFilter();
  }
  return parseContext.cacheFilter(filter,null,parseContext.autoFilterCachePolicy());
}
