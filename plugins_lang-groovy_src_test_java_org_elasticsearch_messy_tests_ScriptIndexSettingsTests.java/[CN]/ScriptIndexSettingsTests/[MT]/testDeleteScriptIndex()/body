{
  PutIndexedScriptResponse putIndexedScriptResponse=client().preparePutIndexedScript().setId("foobar").setScriptLang("groovy").setSource("{ \"script\": 1 }").get();
  assertTrue(putIndexedScriptResponse.isCreated());
  DeleteIndexResponse deleteResponse=client().admin().indices().prepareDelete(ScriptService.SCRIPT_INDEX).get();
  assertTrue(deleteResponse.isAcknowledged());
  ensureGreen();
  try {
    client().prepareGetIndexedScript("groovy","foobar").get();
    fail("Expected IndexNotFoundException");
  }
 catch (  IndexNotFoundException e) {
    assertThat(e.getMessage(),is("no such index"));
  }
}
