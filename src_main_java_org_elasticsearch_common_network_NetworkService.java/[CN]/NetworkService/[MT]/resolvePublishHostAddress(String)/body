{
  InetAddress address=resolvePublishHostAddress(publishHost,InetAddress.getLoopbackAddress().getHostAddress());
  if (address == null || address.isAnyLocalAddress()) {
    address=NetworkUtils.getFirstNonLoopbackAddress(NetworkUtils.StackType.IPv4);
    if (address == null) {
      address=NetworkUtils.getFirstNonLoopbackAddress(NetworkUtils.getIpStackType());
      if (address == null) {
        address=NetworkUtils.getLocalAddress();
        if (address == null) {
          return NetworkUtils.getLocalhost(NetworkUtils.StackType.IPv4);
        }
      }
    }
  }
  return address;
}
