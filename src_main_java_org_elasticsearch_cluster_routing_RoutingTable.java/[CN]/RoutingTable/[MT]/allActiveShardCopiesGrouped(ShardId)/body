{
  ArrayList<ShardIterator> set=new ArrayList<>();
  IndexRoutingTable indexRoutingTable=index(shardId.index().name());
  if (indexRoutingTable == null) {
    throw new IndexMissingException(new Index(shardId.index().name()));
  }
  IndexShardRoutingTable copiesRoutingTable=indexRoutingTable.shard(shardId.id());
  if (copiesRoutingTable != null) {
    for (    ShardRouting shardRouting : copiesRoutingTable) {
      if (shardRouting.active()) {
        set.add(shardRouting.shardsIt());
      }
    }
  }
 else {
    throw new ElasticsearchIllegalStateException(shardId + " does not exist");
  }
  return new GroupShardsIterator(set);
}
