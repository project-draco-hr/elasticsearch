{
  super(store);
  Preconditions.checkNotNull(store,"Store must be provided to merge policy");
  this.indexSettingsService=indexSettingsService;
  ByteSizeValue minMergeSize=indexSettings.getAsBytesSize("index.merge.policy.min_merge_size",DEFAULT_MIN_MERGE_SIZE);
  ByteSizeValue maxMergeSize=indexSettings.getAsBytesSize("index.merge.policy.max_merge_size",DEFAULT_MAX_MERGE_SIZE);
  int mergeFactor=indexSettings.getAsInt("index.merge.policy.merge_factor",LogByteSizeMergePolicy.DEFAULT_MERGE_FACTOR);
  int maxMergeDocs=indexSettings.getAsInt("index.merge.policy.max_merge_docs",LogByteSizeMergePolicy.DEFAULT_MAX_MERGE_DOCS);
  boolean calibrateSizeByDeletes=indexSettings.getAsBoolean("index.merge.policy.calibrate_size_by_deletes",true);
  mergePolicy.setMinMergeMB(minMergeSize.mbFrac());
  mergePolicy.setMaxMergeMB(maxMergeSize.mbFrac());
  mergePolicy.setMergeFactor(mergeFactor);
  mergePolicy.setMaxMergeDocs(maxMergeDocs);
  mergePolicy.setCalibrateSizeByDeletes(calibrateSizeByDeletes);
  mergePolicy.setNoCFSRatio(noCFSRatio);
  logger.debug("using [log_bytes_size] merge policy with merge_factor[{}], min_merge_size[{}], max_merge_size[{}], max_merge_docs[{}], calibrate_size_by_deletes[{}]",mergeFactor,minMergeSize,maxMergeSize,maxMergeDocs,calibrateSizeByDeletes);
  indexSettingsService.addListener(applySettings);
}
