{
  String uriAsString="/" + randomStatusCode(random());
  URIBuilder uriBuilder=new URIBuilder(uriAsString);
  Map<String,String> params=Collections.emptyMap();
  if (random().nextBoolean()) {
    int numParams=RandomInts.randomIntBetween(random(),1,3);
    params=new HashMap<>(numParams);
    for (int i=0; i < numParams; i++) {
      String paramKey="param-" + i;
      String paramValue=RandomStrings.randomAsciiOfLengthBetween(random(),3,10);
      params.put(paramKey,paramValue);
      uriBuilder.addParameter(paramKey,paramValue);
    }
  }
  URI uri=uriBuilder.build();
  HttpUriRequest request;
switch (method) {
case "DELETE":
    request=new HttpDeleteWithEntity(uri);
  break;
case "GET":
request=new HttpGetWithEntity(uri);
break;
case "HEAD":
request=new HttpHead(uri);
break;
case "OPTIONS":
request=new HttpOptions(uri);
break;
case "PATCH":
request=new HttpPatch(uri);
break;
case "POST":
request=new HttpPost(uri);
break;
case "PUT":
request=new HttpPut(uri);
break;
case "TRACE":
request=new HttpTrace(uri);
break;
default :
throw new UnsupportedOperationException("method not supported: " + method);
}
HttpEntity entity=null;
if (request instanceof HttpEntityEnclosingRequest && random().nextBoolean()) {
entity=new StringEntity(RandomStrings.randomAsciiOfLengthBetween(random(),10,100));
((HttpEntityEnclosingRequest)request).setEntity(entity);
}
Header[] headers=new Header[0];
for (Header defaultHeader : defaultHeaders) {
request.setHeader(defaultHeader);
}
if (random().nextBoolean()) {
int numHeaders=RandomInts.randomIntBetween(random(),1,5);
headers=new Header[numHeaders];
for (int i=0; i < numHeaders; i++) {
String headerName="Header" + (random().nextBoolean() ? i : "");
String headerValue=RandomStrings.randomAsciiOfLengthBetween(random(),3,10);
BasicHeader basicHeader=new BasicHeader(headerName,headerValue);
headers[i]=basicHeader;
request.setHeader(basicHeader);
}
}
try {
restClient.performRequest(method,uriAsString,params,entity,headers);
}
 catch (ElasticsearchResponseException e) {
}
return request;
}
