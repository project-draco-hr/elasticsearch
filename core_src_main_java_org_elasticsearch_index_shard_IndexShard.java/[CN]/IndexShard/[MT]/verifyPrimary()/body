{
  if (shardRouting.primary() == false) {
    throw new IllegalStateException("shard is not a primary " + shardRouting);
  }
}
