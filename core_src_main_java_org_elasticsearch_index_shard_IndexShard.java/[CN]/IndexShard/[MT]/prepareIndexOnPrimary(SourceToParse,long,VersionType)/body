{
  try {
    verifyPrimary();
    return prepareIndex(docMapper(source.type()),source,version,versionType,Engine.Operation.Origin.PRIMARY);
  }
 catch (  Exception e) {
    verifyNotClosed(e);
    throw e;
  }
}
