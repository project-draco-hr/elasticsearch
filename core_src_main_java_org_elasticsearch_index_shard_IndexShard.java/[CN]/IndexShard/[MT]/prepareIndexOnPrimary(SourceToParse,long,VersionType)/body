{
  try {
    verifyPrimary();
    return prepareIndex(docMapper(source.type()),source,version,versionType,Engine.Operation.Origin.PRIMARY);
  }
 catch (  Throwable t) {
    verifyNotClosed(t);
    throw t;
  }
}
