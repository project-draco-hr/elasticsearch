{
  verifyNotClosed();
  long ramBytesUsed=getEngine().indexBufferRAMBytesUsed();
  indexingMemoryController.addRefreshingBytes(shardId,ramBytesUsed);
  try {
    if (logger.isTraceEnabled()) {
      logger.trace("refresh with source: {} indexBufferRAMBytesUsed={}",source,ramBytesUsed);
    }
    long time=System.nanoTime();
    getEngine().refresh(source);
    refreshMetric.inc(System.nanoTime() - time);
  }
  finally {
    indexingMemoryController.removeRefreshingBytes(shardId,ramBytesUsed);
  }
}
