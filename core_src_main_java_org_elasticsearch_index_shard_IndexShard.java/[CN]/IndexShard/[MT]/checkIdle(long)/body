{
  if (System.nanoTime() - lastWriteNS >= inactiveTimeNS) {
    boolean wasActive=active.getAndSet(false);
    engineConfig.setFlushWhenLastMergeFinished(true);
    if (wasActive) {
      updateBufferSize(IndexingMemoryController.INACTIVE_SHARD_INDEXING_BUFFER,IndexingMemoryController.INACTIVE_SHARD_TRANSLOG_BUFFER);
      logger.debug("shard is now inactive");
      indexEventListener.onShardInactive(this);
    }
  }
  return active.get() == false;
}
