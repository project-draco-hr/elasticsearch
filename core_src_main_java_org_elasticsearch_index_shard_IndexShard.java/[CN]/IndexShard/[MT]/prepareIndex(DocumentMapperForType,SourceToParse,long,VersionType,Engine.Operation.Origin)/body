{
  long startTime=System.nanoTime();
  ParsedDocument doc=docMapper.getDocumentMapper().parse(source);
  if (docMapper.getMapping() != null) {
    doc.addDynamicMappingsUpdate(docMapper.getMapping());
  }
  MappedFieldType uidFieldType=docMapper.getDocumentMapper().uidMapper().fieldType();
  Query uidQuery=uidFieldType.termQuery(doc.uid(),null);
  Term uid=MappedFieldType.extractTerm(uidQuery);
  return new Engine.Index(uid,doc,version,versionType,origin,startTime);
}
