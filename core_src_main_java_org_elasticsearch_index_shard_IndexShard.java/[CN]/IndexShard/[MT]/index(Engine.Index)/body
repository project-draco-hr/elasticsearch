{
  writeAllowed(index.origin());
  index=indexingService.preIndex(index);
  final boolean created;
  try {
    if (logger.isTraceEnabled()) {
      logger.trace("index [{}][{}]{}",index.type(),index.id(),index.docs());
    }
    created=engine().index(index);
    index.endTime(System.nanoTime());
  }
 catch (  Throwable ex) {
    indexingService.postIndex(index,ex);
    throw ex;
  }
  indexingService.postIndex(index);
  return created;
}
