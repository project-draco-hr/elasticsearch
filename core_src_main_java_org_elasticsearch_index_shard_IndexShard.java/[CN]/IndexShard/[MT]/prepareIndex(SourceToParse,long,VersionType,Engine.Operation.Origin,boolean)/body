{
  try {
    return prepareIndex(docMapper(source.type()),source,version,versionType,origin,state != IndexShardState.STARTED || canHaveDuplicates);
  }
 catch (  Throwable t) {
    verifyNotClosed(t);
    throw t;
  }
}
