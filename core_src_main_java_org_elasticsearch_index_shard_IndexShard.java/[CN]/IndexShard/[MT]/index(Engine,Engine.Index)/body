{
  active.set(true);
  index=indexingOperationListeners.preIndex(index);
  final boolean created;
  try {
    if (logger.isTraceEnabled()) {
      logger.trace("index [{}][{}]{}",index.type(),index.id(),index.docs());
    }
    created=engine.index(index);
    index.endTime(System.nanoTime());
  }
 catch (  Throwable ex) {
    indexingOperationListeners.postIndex(index,ex);
    throw ex;
  }
  indexingOperationListeners.postIndex(index,created);
  return created;
}
