{
  int i=0;
  while (i < docs.length) {
    if (!in.next())     return i;
    int doc=in.doc();
    if (versionedMap.beforeVersion(doc,version)) {
      docs[i]=doc;
      freqs[i]=in.freq();
      i++;
    }
  }
  return i;
}
