{
  List<String> dataNodeIds=Lists.newArrayList();
  for (  String nodeId : nodesIds) {
    if (nodes.get(nodeId).dataNode()) {
      dataNodeIds.add(nodeId);
    }
  }
  return dataNodeIds.toArray(new String[dataNodeIds.size()]);
}
