{
  Set<String> onlyDataNodeIds=Sets.newHashSet();
  for (  String nodeId : nodesIds) {
    if (nodes.nodeExists(nodeId) && nodes.get(nodeId).dataNode()) {
      onlyDataNodeIds.add(nodeId);
    }
  }
  return onlyDataNodeIds.toArray(new String[onlyDataNodeIds.size()]);
}
