{
  ClusterState state=clusterService.state();
  Set<String> nodesIds=Sets.newHashSet();
  for (  DiscoveryNode node : state.nodes()) {
    if (node.dataNode()) {
      nodesIds.add(node.id());
    }
  }
  return execute(new Request(shardId,onlyUnallocated,nodesIds.toArray(new String[nodesIds.size()])));
}
