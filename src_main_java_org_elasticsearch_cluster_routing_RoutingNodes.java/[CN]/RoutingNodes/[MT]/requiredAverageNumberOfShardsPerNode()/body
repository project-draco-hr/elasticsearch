{
  int totalNumberOfShards=0;
  for (  IndexMetaData indexMetaData : metaData.indices().values()) {
    if (indexMetaData.state() == IndexMetaData.State.OPEN) {
      totalNumberOfShards+=indexMetaData.totalNumberOfShards();
    }
  }
  return totalNumberOfShards / nodesToShards.size();
}
