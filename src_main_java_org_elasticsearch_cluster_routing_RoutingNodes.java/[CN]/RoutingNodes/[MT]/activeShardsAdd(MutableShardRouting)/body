{
  if (shard.unassigned()) {
    return;
  }
  Set<MutableShardRouting> replicaSet=assignedShards.get(shard.shardId());
  if (replicaSet == null) {
    replicaSet=new IdentityHashSet<MutableShardRouting>();
    assignedShards.put(shard.shardId(),replicaSet);
  }
  replicaSet.add(shard);
}
