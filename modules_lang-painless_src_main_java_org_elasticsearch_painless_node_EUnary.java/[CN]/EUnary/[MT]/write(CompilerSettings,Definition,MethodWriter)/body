{
  if (operation == Operation.NOT) {
    if (tru == null && fals == null) {
      final Label localfals=new Label();
      final Label end=new Label();
      child.fals=localfals;
      child.write(settings,definition,adapter);
      adapter.push(false);
      adapter.goTo(end);
      adapter.mark(localfals);
      adapter.push(true);
      adapter.mark(end);
    }
 else {
      child.tru=fals;
      child.fals=tru;
      child.write(settings,definition,adapter);
    }
  }
 else {
    final org.objectweb.asm.Type type=actual.type;
    final Sort sort=actual.sort;
    child.write(settings,definition,adapter);
    if (operation == Operation.BWNOT) {
      if (sort == Sort.DEF) {
        adapter.invokeStatic(Definition.defobjType.type,DEF_NOT_CALL);
      }
 else {
        if (sort == Sort.INT) {
          adapter.push(-1);
        }
 else         if (sort == Sort.LONG) {
          adapter.push(-1L);
        }
 else {
          throw new IllegalStateException(error("Illegal tree structure."));
        }
        adapter.math(MethodWriter.XOR,type);
      }
    }
 else     if (operation == Operation.SUB) {
      if (sort == Sort.DEF) {
        adapter.invokeStatic(Definition.defobjType.type,DEF_NEG_CALL);
      }
 else {
        adapter.math(MethodWriter.NEG,type);
      }
    }
 else     if (operation != Operation.ADD) {
      throw new IllegalStateException(error("Illegal tree structure."));
    }
    adapter.writeBranch(tru,fals);
  }
}
