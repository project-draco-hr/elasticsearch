{
  StringBuilder sb=new StringBuilder().append(type).append(';');
  sb.append(searchPhaseResults.size()).append(';');
  for (  SearchPhaseResult searchPhaseResult : searchPhaseResults) {
    sb.append(searchPhaseResult.id()).append(':').append(searchPhaseResult.shardTarget().nodeId()).append(';');
  }
  if (attributes == null) {
    sb.append("0;");
  }
 else {
    sb.append(attributes.size()).append(";");
    for (    Map.Entry<String,String> entry : attributes.entrySet()) {
      sb.append(entry.getKey()).append(':').append(entry.getValue()).append(';');
    }
  }
  BytesRef bytesRef=new BytesRef();
  UnicodeUtil.UTF16toUTF8(sb,0,sb.length(),bytesRef);
  return Base64.encodeBytes(bytesRef.bytes,bytesRef.offset,bytesRef.length,Base64.URL_SAFE);
}
