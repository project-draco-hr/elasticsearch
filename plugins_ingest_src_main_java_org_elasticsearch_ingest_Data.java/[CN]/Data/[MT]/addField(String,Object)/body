{
  modified=true;
  String[] pathElements=Strings.splitStringToArray(path,'.');
  String writeKey=pathElements[pathElements.length - 1];
  Map<String,Object> inner=document;
  for (int i=0; i < pathElements.length - 1; i++) {
    if (!inner.containsKey(pathElements[i])) {
      inner.put(pathElements[i],new HashMap<String,Object>());
    }
    inner=(HashMap<String,Object>)inner.get(pathElements[i]);
  }
  inner.put(writeKey,value);
}
