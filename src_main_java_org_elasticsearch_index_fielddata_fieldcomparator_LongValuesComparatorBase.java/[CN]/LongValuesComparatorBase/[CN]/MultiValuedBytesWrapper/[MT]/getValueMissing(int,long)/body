{
  LongValues.Iter iter=delegate.getIter(docId);
  if (!iter.hasNext()) {
    return missing;
  }
  long currentVal=iter.next();
  long relevantVal=currentVal;
  int counter=1;
  while (iter.hasNext()) {
    currentVal=iter.next();
switch (sortMode) {
case SUM:
      relevantVal+=currentVal;
    break;
case AVG:
  relevantVal+=currentVal;
counter++;
break;
case MAX:
if (currentVal > relevantVal) {
relevantVal=currentVal;
}
break;
case MIN:
if (currentVal < relevantVal) {
relevantVal=currentVal;
}
}
}
if (sortMode == SortMode.AVG) {
return relevantVal / counter;
}
 else {
return relevantVal;
}
}
