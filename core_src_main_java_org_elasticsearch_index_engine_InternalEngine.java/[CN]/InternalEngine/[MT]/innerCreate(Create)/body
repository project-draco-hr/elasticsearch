{
  if (engineConfig.isOptimizeAutoGenerateId() && create.autoGeneratedId() && !create.canHaveDuplicates()) {
    innerCreateNoLock(create,Versions.NOT_FOUND,null);
  }
 else {
synchronized (dirtyLock(create.uid())) {
      final long currentVersion;
      final VersionValue versionValue;
      versionValue=versionMap.getUnderLock(create.uid().bytes());
      if (versionValue == null) {
        currentVersion=loadCurrentVersionFromIndex(create.uid());
      }
 else {
        if (engineConfig.isEnableGcDeletes() && versionValue.delete() && (engineConfig.getThreadPool().estimatedTimeInMillis() - versionValue.time()) > engineConfig.getGcDeletesInMillis()) {
          currentVersion=Versions.NOT_FOUND;
        }
 else {
          currentVersion=versionValue.version();
        }
      }
      innerCreateNoLock(create,currentVersion,versionValue);
    }
  }
}
