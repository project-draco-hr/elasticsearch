{
  int maxNumMerges=mergeScheduler.getMaxMergeCount();
  if (numMergesInFlight.decrementAndGet() < maxNumMerges) {
    if (isThrottling.getAndSet(false)) {
      logger.info("stop throttling indexing: numMergesInFlight={}, maxNumMerges={}",numMergesInFlight,maxNumMerges);
      indexingService.throttlingDeactivated();
      deactivateThrottling();
    }
  }
  if (engineConfig.isFlushWhenLastMergeFinished() && indexWriter.hasPendingMerges() == false) {
    try {
      if (tryRenewSyncCommit() == false) {
        flush();
      }
    }
 catch (    EngineClosedException|EngineException ex) {
      if (isClosed.get() == false) {
        logger.warn("failed to flush after merge has finished");
      }
    }
  }
}
