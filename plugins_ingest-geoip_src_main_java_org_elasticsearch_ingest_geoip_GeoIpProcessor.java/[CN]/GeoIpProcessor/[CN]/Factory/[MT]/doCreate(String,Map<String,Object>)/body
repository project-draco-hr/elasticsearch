{
  String ipField=readStringProperty(TYPE,processorTag,config,"field");
  String targetField=readStringProperty(TYPE,processorTag,config,"target_field","geoip");
  String databaseFile=readStringProperty(TYPE,processorTag,config,"database_file","GeoLite2-City.mmdb");
  List<String> propertyNames=readOptionalList(TYPE,processorTag,config,"properties");
  final Set<Property> properties;
  if (propertyNames != null) {
    properties=EnumSet.noneOf(Property.class);
    for (    String fieldName : propertyNames) {
      try {
        properties.add(Property.parse(fieldName));
      }
 catch (      Exception e) {
        throw newConfigurationException(TYPE,processorTag,"properties","illegal field option [" + fieldName + "]. valid values are ["+ Arrays.toString(Property.values())+ "]");
      }
    }
  }
 else {
    properties=DEFAULT_PROPERTIES;
  }
  DatabaseReader databaseReader=databaseReaders.get(databaseFile);
  if (databaseReader == null) {
    throw newConfigurationException(TYPE,processorTag,"database_file","database file [" + databaseFile + "] doesn't exist");
  }
  return new GeoIpProcessor(processorTag,ipField,databaseReader,targetField,properties);
}
