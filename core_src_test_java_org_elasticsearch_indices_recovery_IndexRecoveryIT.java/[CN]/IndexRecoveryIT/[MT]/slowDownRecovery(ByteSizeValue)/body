{
  long chunkSize=Math.max(1,shardSize.bytes() / 10);
  for (  RecoverySettings settings : internalCluster().getInstances(RecoverySettings.class)) {
    setChunkSize(settings,new ByteSizeValue(chunkSize,ByteSizeUnit.BYTES));
  }
  assertTrue(client().admin().cluster().prepareUpdateSettings().setTransientSettings(Settings.builder().put(RecoverySettings.INDICES_RECOVERY_MAX_BYTES_PER_SEC,chunkSize,ByteSizeUnit.BYTES)).get().isAcknowledged());
}
