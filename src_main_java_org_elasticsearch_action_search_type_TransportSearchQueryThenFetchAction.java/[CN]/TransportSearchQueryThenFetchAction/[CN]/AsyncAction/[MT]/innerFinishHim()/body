{
  InternalSearchResponse internalResponse=searchPhaseController.merge(sortedShardList,queryResults,fetchResults);
  String scrollId=null;
  if (request.getScroll() != null) {
    scrollId=TransportSearchHelper.buildScrollId(request.getSearchType(),queryResults.values(),null);
  }
  listener.onResponse(new SearchResponse(internalResponse,scrollId,expectedSuccessfulOps,successulOps.get(),buildTookInMillis(),buildShardFailures()));
}
