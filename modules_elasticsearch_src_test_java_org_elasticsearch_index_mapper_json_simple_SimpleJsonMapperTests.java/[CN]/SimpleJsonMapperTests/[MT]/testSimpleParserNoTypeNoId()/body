{
  String mapping=copyToStringFromClasspath("/org/elasticsearch/index/mapper/json/simple/test-mapping.json");
  JsonDocumentMapper docMapper=(JsonDocumentMapper)new JsonDocumentMapperParser(new AnalysisService(new Index("test"))).parse(mapping);
  String json=copyToStringFromClasspath("/org/elasticsearch/index/mapper/json/simple/test1-notype-noid.json");
  Document doc=docMapper.parse("person","1",json).doc();
  assertThat(doc.get(docMapper.uidMapper().names().indexName()),equalTo(Uid.createUid("person","1")));
  assertThat((double)doc.getBoost(),closeTo(3.7,0.01));
  assertThat(doc.get(docMapper.mappers().name("first").mapper().names().indexName()),equalTo("shay"));
  assertThat(doc.getFields(docMapper.idMapper().names().indexName()).length,equalTo(1));
}
