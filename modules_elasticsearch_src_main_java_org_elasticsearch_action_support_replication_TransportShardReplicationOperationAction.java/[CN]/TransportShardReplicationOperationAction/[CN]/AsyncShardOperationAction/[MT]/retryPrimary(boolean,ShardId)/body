{
  if (!fromClusterEvent) {
    request.operationThreaded(true);
    clusterService.add(request.timeout(),new TimeoutClusterStateListener(){
      @Override public void postAdded(){
        if (start(true)) {
          clusterService.remove(this);
        }
      }
      @Override public void onClose(){
        clusterService.remove(this);
        listener.onFailure(new NodeCloseException(nodes.localNode()));
      }
      @Override public void clusterChanged(      ClusterChangedEvent event){
        if (start(true)) {
          clusterService.remove(this);
        }
      }
      @Override public void onTimeout(      TimeValue timeValue){
        if (start(true)) {
          clusterService.remove(this);
          return;
        }
        clusterService.remove(this);
        final PrimaryNotStartedActionException failure=new PrimaryNotStartedActionException(shardId,"Timeout waiting for [" + timeValue + "]");
        if (request.listenerThreaded()) {
          threadPool.execute(new Runnable(){
            @Override public void run(){
              listener.onFailure(failure);
            }
          }
);
        }
 else {
          listener.onFailure(failure);
        }
      }
    }
);
  }
}
