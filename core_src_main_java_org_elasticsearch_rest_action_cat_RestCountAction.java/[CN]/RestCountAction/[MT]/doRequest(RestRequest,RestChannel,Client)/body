{
  String[] indices=Strings.splitStringByCommaToArray(request.param("index"));
  CountRequest countRequest=new CountRequest(indices);
  String source=request.param("source");
  if (source != null) {
    countRequest.source(source);
  }
 else {
    QueryBuilder<?> queryBuilder=RestActions.parseQuerySource(request);
    if (queryBuilder != null) {
      QuerySourceBuilder querySourceBuilder=new QuerySourceBuilder();
      querySourceBuilder.setQuery(queryBuilder);
      countRequest.source(querySourceBuilder.buildAsBytes());
    }
  }
  client.count(countRequest,new RestResponseListener<CountResponse>(channel){
    @Override public RestResponse buildResponse(    CountResponse countResponse) throws Exception {
      return RestTable.buildResponse(buildTable(request,countResponse),channel);
    }
  }
);
}
