{
  Constructor<? extends Module> constructor;
  try {
    constructor=moduleClass.getConstructor(Settings.class);
    try {
      return constructor.newInstance(settings);
    }
 catch (    Exception e) {
      throw new ElasticSearchException("Failed to create module [" + moduleClass + "]",e);
    }
  }
 catch (  NoSuchMethodException e) {
    try {
      constructor=moduleClass.getConstructor();
      try {
        return constructor.newInstance();
      }
 catch (      Exception e1) {
        throw new ElasticSearchException("Failed to create module [" + moduleClass + "]",e);
      }
    }
 catch (    NoSuchMethodException e1) {
      throw new ElasticSearchException("No constructor for [" + moduleClass + "]");
    }
  }
}
