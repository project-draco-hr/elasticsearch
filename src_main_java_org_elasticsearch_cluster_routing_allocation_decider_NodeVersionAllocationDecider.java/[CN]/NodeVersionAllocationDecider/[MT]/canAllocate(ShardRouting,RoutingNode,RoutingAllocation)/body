{
  String sourceNodeId=shardRouting.currentNodeId();
  if (sourceNodeId == null) {
    if (shardRouting.primary()) {
      return Decision.YES;
    }
    final MutableShardRouting primary=allocation.routingNodes().activePrimary(shardRouting);
    if (primary == null) {
      return Decision.YES;
    }
    sourceNodeId=primary.currentNodeId();
  }
  return isVersionCompatible(allocation.routingNodes(),sourceNodeId,node);
}
