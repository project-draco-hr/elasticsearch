{
  if (closed) {
    return;
  }
  String title=stripTitle(page.getTitle());
  if (logger.isTraceEnabled()) {
    logger.trace("page {} : {}",page.getID(),page.getTitle());
  }
  try {
    XContentBuilder builder=XContentFactory.jsonBuilder().startObject();
    builder.field("title",title);
    builder.field("text",page.getText());
    builder.field("redirect",page.isRedirect());
    builder.field("special",page.isSpecialPage());
    builder.field("stub",page.isStub());
    builder.field("disambiguation",page.isDisambiguationPage());
    builder.startArray("category");
    for (    String s : page.getCategories()) {
      builder.value(s);
    }
    builder.endArray();
    builder.startArray("link");
    for (    String s : page.getLinks()) {
      builder.value(s);
    }
    builder.endArray();
    builder.endObject();
    currentRequest.add(Requests.indexRequest(indexName).type(typeName).id(page.getID()).create(false).source(builder));
    processBulkIfNeeded();
  }
 catch (  Exception e) {
    logger.warn("failed to construct index request",e);
  }
}
