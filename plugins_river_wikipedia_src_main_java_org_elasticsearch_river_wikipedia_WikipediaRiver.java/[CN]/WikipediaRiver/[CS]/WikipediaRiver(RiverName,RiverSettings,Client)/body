{
  super(riverName,settings);
  this.client=client;
  String url="http://download.wikimedia.org/enwiki/latest/enwiki-latest-pages-articles.xml.bz2";
  if (settings.settings().containsKey("wikipedia")) {
    Map<String,Object> wikipediaSettings=(Map<String,Object>)settings.settings().get("wikipedia");
    url=XContentMapValues.nodeStringValue(wikipediaSettings.get("url"),url);
  }
  logger.info("creating wikipedia stream river for [{}]",url);
  this.url=new URL(url);
  if (settings.settings().containsKey("index")) {
    Map<String,Object> indexSettings=(Map<String,Object>)settings.settings().get("index");
    indexName=XContentMapValues.nodeStringValue(indexSettings.get("index"),riverName.name());
    typeName=XContentMapValues.nodeStringValue(indexSettings.get("type"),"status");
    this.bulkSize=XContentMapValues.nodeIntegerValue(settings.settings().get("bulk_size"),100);
    this.dropThreshold=XContentMapValues.nodeIntegerValue(settings.settings().get("drop_threshold"),10);
  }
 else {
    indexName=riverName.name();
    typeName="page";
    bulkSize=100;
    dropThreshold=10;
  }
}
