{
  InternalBinaryRange.Bucket[] buckets=new InternalBinaryRange.Bucket[ranges.length];
  for (int i=0; i < buckets.length; ++i) {
    long bucketOrd=bucket * ranges.length + i;
    buckets[i]=new InternalBinaryRange.Bucket(format,keyed,ranges[i].key,ranges[i].from,ranges[i].to,bucketDocCount(bucketOrd),bucketAggregations(bucketOrd));
  }
  return new InternalBinaryRange(name,format,keyed,buckets,pipelineAggregators(),metaData());
}
