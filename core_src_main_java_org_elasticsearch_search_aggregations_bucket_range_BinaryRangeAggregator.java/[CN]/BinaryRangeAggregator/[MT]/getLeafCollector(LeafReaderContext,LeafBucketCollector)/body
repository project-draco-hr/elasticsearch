{
  if (valuesSource == null) {
    return LeafBucketCollector.NO_OP_COLLECTOR;
  }
  if (valuesSource instanceof ValuesSource.Bytes.WithOrdinals) {
    SortedSetDocValues values=((ValuesSource.Bytes.WithOrdinals)valuesSource).ordinalsValues(ctx);
    return new SortedSetRangeLeafCollector(values,ranges,sub){
      @Override protected void doCollect(      LeafBucketCollector sub,      int doc,      long bucket) throws IOException {
        collectBucket(sub,doc,bucket);
      }
    }
;
  }
  throw new IllegalArgumentException("binary range aggregation expects a values source that supports ordinals");
}
