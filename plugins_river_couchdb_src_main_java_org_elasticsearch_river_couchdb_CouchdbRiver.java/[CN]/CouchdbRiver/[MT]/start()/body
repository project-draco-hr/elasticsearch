{
  logger.info("starting couchdb stream: host [{}], port [{}], filter [{}], db [{}], indexing to [{}]/[{}]",couchHost,couchPort,couchFilter,couchDb,indexName,typeName);
  try {
    client.admin().indices().prepareCreate(indexName).execute().actionGet();
  }
 catch (  Exception e) {
    if (ExceptionsHelper.unwrapCause(e) instanceof IndexAlreadyExistsException) {
    }
 else     if (ExceptionsHelper.unwrapCause(e) instanceof ClusterBlockException) {
    }
 else {
      logger.warn("failed to create index [{}], disabling river...",e,indexName);
      return;
    }
  }
  slurperThread=EsExecutors.daemonThreadFactory(settings.globalSettings(),"couchdb_river_slurper").newThread(new Slurper());
  indexerThread=EsExecutors.daemonThreadFactory(settings.globalSettings(),"couchdb_river_indexer").newThread(new Indexer());
  indexerThread.start();
  slurperThread.start();
}
