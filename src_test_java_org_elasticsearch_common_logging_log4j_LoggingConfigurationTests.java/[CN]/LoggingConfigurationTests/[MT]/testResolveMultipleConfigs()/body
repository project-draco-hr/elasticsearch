{
  String level=Log4jESLoggerFactory.getLogger("test").getLevel();
  try {
    Path configDir=getDataPath("config");
    Settings settings=ImmutableSettings.builder().put("path.conf",configDir.toAbsolutePath()).build();
    LogConfigurator.configure(settings);
    ESLogger esLogger=Log4jESLoggerFactory.getLogger("test");
    Logger logger=((Log4jESLogger)esLogger).logger();
    Appender appender=logger.getAppender("console");
    assertThat(appender,notNullValue());
    esLogger=Log4jESLoggerFactory.getLogger("second");
    logger=((Log4jESLogger)esLogger).logger();
    appender=logger.getAppender("console2");
    assertThat(appender,notNullValue());
    esLogger=Log4jESLoggerFactory.getLogger("third");
    logger=((Log4jESLogger)esLogger).logger();
    appender=logger.getAppender("console3");
    assertThat(appender,notNullValue());
  }
  finally {
    Log4jESLoggerFactory.getLogger("test").setLevel(level);
  }
}
