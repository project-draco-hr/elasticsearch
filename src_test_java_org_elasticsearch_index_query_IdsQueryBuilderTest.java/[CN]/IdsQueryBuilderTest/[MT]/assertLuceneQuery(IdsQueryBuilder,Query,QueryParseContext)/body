{
  if (testQuery.ids().size() == 0) {
    assertThat(query,is(instanceOf(BooleanQuery.class)));
  }
 else {
    assertThat(query,is(instanceOf(TermsQuery.class)));
    TermsQuery termQuery=(TermsQuery)query;
    assertThat(termQuery.getBoost(),is(testQuery.boost()));
    String[] parts=termQuery.toString().split(" ");
    assertThat(parts.length,is(queryBuilder.ids().size() * queryBuilder.types().size()));
    assertThat(parts[0].substring(0,parts[0].indexOf(":")),is(UidFieldMapper.NAME));
  }
}
