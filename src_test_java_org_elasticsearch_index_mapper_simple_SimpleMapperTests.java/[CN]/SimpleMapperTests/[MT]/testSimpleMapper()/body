{
  IndexService indexService=createIndex("test");
  Settings settings=indexService.settingsService().getSettings();
  DocumentMapperParser mapperParser=indexService.mapperService().documentMapperParser();
  DocumentMapper docMapper=doc("test",settings,rootObject("person").add(object("name").add(stringField("first").store(true).index(false)))).build(mapperParser);
  BytesReference json=new BytesArray(copyToBytesFromClasspath("/org/elasticsearch/index/mapper/simple/test1.json"));
  Document doc=docMapper.parse("person","1",json).rootDoc();
  assertThat(doc.get(docMapper.mappers().name("first").mapper().names().indexName()),equalTo("shay"));
  assertThat(docMapper.mappers().name("first").mapper().names().fullName(),equalTo("name.first"));
  doc=docMapper.parse(json).rootDoc();
}
