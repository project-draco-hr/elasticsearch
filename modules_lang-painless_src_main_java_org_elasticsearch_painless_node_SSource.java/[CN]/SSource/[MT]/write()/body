{
  int classFrames=ClassWriter.COMPUTE_FRAMES | ClassWriter.COMPUTE_MAXS;
  int classVersion=Opcodes.V1_8;
  int classAccess=Opcodes.ACC_PUBLIC | Opcodes.ACC_SUPER | Opcodes.ACC_FINAL;
  String classBase=BASE_CLASS_TYPE.getInternalName();
  String className=CLASS_TYPE.getInternalName();
  String classInterfaces[]=reserved.usesScore() ? new String[]{WriterConstants.NEEDS_SCORE_TYPE.getInternalName()} : null;
  ClassWriter writer=new ClassWriter(classFrames);
  writer.visit(classVersion,classAccess,className,null,classBase,classInterfaces);
  writer.visitSource(Location.computeSourceName(name,source),null);
  expressions=new BitSet(source.length());
  MethodWriter execute=new MethodWriter(Opcodes.ACC_PUBLIC,EXECUTE,writer,expressions);
  MethodWriter constructor=execute.newMethodWriter(Opcodes.ACC_PUBLIC,CONSTRUCTOR);
  constructor.loadThis();
  constructor.loadArgs();
  constructor.invokeConstructor(org.objectweb.asm.Type.getType(Executable.class),CONSTRUCTOR);
  constructor.returnValue();
  constructor.endMethod();
  write(execute);
  execute.endMethod();
  if (!functions.isEmpty()) {
    for (    SFunction function : functions) {
      writer.visitField(Opcodes.ACC_PRIVATE | Opcodes.ACC_STATIC,"handle$" + function.name + "$"+ function.parameters.size(),Type.getDescriptor(MethodHandle.class),null,null).visitEnd();
    }
    MethodWriter clinit=new MethodWriter(Opcodes.ACC_PUBLIC | Opcodes.ACC_STATIC,WriterConstants.CLINIT,writer,expressions);
    for (    SFunction function : functions) {
      Handle handle=new Handle(Opcodes.H_INVOKESTATIC,CLASS_TYPE.getInternalName(),function.name,function.method.method.getDescriptor(),false);
      clinit.push(handle);
      clinit.putStatic(CLASS_TYPE,"handle$" + function.name + "$"+ function.parameters.size(),Type.getType(MethodHandle.class));
    }
    clinit.returnValue();
    clinit.endMethod();
  }
  writer.visitEnd();
  bytes=writer.toByteArray();
}
