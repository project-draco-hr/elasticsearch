{
  boolean success=false;
  final IndexSearcher searcher;
  try {
    searcher=searcherFactory.newSearcher(reader);
    if (searcher.getIndexReader() != reader) {
      throw new IllegalStateException("SearcherFactory must wrap exactly the provided reader (got " + searcher.getIndexReader() + " but expected "+ reader+ ")");
    }
    success=true;
  }
  finally {
    if (!success) {
      reader.decRef();
    }
  }
  return searcher;
}
