{
  if (snapshotScheduleFuture != null) {
    snapshotScheduleFuture.cancel(true);
    snapshotScheduleFuture=null;
  }
  if (snapshotOnClose) {
    logger.debug("Snapshotting on close ...");
    snapshot();
  }
  shardGateway.close();
}
