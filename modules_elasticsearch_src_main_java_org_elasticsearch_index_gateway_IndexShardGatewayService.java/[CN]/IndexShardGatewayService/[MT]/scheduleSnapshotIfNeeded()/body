{
  if (!shardGateway.requiresSnapshot()) {
    return;
  }
  if (!shardGateway.requiresSnapshotScheduling()) {
    return;
  }
  if (!indexShard.routingEntry().primary()) {
    return;
  }
  if (!indexShard.routingEntry().started()) {
    return;
  }
  if (snapshotScheduleFuture != null) {
    return;
  }
  if (snapshotInterval.millis() != -1) {
    if (logger.isDebugEnabled()) {
      logger.debug("scheduling snapshot every [{}]",snapshotInterval);
    }
    snapshotScheduleFuture=threadPool.schedule(snapshotInterval,ThreadPool.Names.SNAPSHOT,new SnapshotRunnable());
  }
}
