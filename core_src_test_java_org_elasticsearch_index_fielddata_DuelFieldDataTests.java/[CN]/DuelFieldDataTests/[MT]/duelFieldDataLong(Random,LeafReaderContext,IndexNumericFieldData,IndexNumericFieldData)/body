{
  AtomicNumericFieldData leftData=random.nextBoolean() ? left.load(context) : left.loadDirect(context);
  AtomicNumericFieldData rightData=random.nextBoolean() ? right.load(context) : right.loadDirect(context);
  int numDocs=context.reader().maxDoc();
  SortedNumericDocValues leftLongValues=leftData.getLongValues();
  SortedNumericDocValues rightLongValues=rightData.getLongValues();
  for (int i=0; i < numDocs; i++) {
    leftLongValues.setDocument(i);
    rightLongValues.setDocument(i);
    int numValues=leftLongValues.count();
    long previous=0;
    assertThat(numValues,equalTo(rightLongValues.count()));
    for (int j=0; j < numValues; j++) {
      long current;
      assertThat(leftLongValues.valueAt(j),equalTo(current=rightLongValues.valueAt(j)));
      if (j > 0) {
        assertThat(previous,lessThan(current));
      }
      previous=current;
    }
  }
}
