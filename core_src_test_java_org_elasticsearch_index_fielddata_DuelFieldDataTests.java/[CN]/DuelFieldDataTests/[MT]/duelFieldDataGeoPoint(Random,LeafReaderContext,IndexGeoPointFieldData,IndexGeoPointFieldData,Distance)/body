{
  AtomicGeoPointFieldData leftData=random.nextBoolean() ? left.load(context) : left.loadDirect(context);
  AtomicGeoPointFieldData rightData=random.nextBoolean() ? right.load(context) : right.loadDirect(context);
  int numDocs=context.reader().maxDoc();
  MultiGeoPointValues leftValues=leftData.getGeoPointValues();
  MultiGeoPointValues rightValues=rightData.getGeoPointValues();
  for (int i=0; i < numDocs; ++i) {
    leftValues.setDocument(i);
    final int numValues=leftValues.count();
    rightValues.setDocument(i);
    ;
    assertEquals(numValues,rightValues.count());
    List<GeoPoint> leftPoints=Lists.newArrayList();
    List<GeoPoint> rightPoints=Lists.newArrayList();
    for (int j=0; j < numValues; ++j) {
      GeoPoint l=leftValues.valueAt(j);
      leftPoints.add(new GeoPoint(l.getLat(),l.getLon()));
      GeoPoint r=rightValues.valueAt(j);
      rightPoints.add(new GeoPoint(r.getLat(),r.getLon()));
    }
    for (    GeoPoint l : leftPoints) {
      assertTrue("Couldn't find " + l + " among "+ rightPoints,contains(l,rightPoints,precision));
    }
    for (    GeoPoint r : rightPoints) {
      assertTrue("Couldn't find " + r + " among "+ leftPoints,contains(r,leftPoints,precision));
    }
  }
}
