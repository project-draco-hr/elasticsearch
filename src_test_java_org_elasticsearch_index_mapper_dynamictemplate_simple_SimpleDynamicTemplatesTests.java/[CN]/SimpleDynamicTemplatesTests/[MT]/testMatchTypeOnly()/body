{
  XContentBuilder builder=JsonXContent.contentBuilder();
  builder.startObject().startObject("person").startArray("dynamic_templates").startObject().startObject("test").field("match_mapping_type","string").startObject("mapping").field("index","no").endObject().endObject().endObject().endArray().endObject().endObject();
  DocumentMapper docMapper=createIndex("test").mapperService().documentMapperParser().parse(builder.string());
  builder=JsonXContent.contentBuilder();
  builder.startObject().field("_id","1").field("s","hello").field("l",1).endObject();
  docMapper.parse(builder.bytes());
  DocumentFieldMappers mappers=docMapper.mappers();
  assertThat(mappers.smartNameFieldMapper("s"),Matchers.notNullValue());
  assertEquals(IndexOptions.NONE,mappers.smartNameFieldMapper("s").fieldType().indexOptions());
  assertThat(mappers.smartNameFieldMapper("l"),Matchers.notNullValue());
  assertNotSame(IndexOptions.NONE,mappers.smartNameFieldMapper("l").fieldType().indexOptions());
}
