{
  XContentBuilder builder=JsonXContent.contentBuilder();
  builder.startObject().startObject("person").startArray("dynamic_templates").startObject().startObject("test").field("match_mapping_type","string").startObject("mapping").field("index","no").endObject().endObject().endObject().endArray().endObject().endObject();
  DocumentMapper docMapper=createIndex("test").mapperService().documentMapperParser().parse(builder.string());
  builder=JsonXContent.contentBuilder();
  builder.startObject().field("_id","1").field("s","hello").field("l",1).endObject();
  docMapper.parse(builder.bytes());
  DocumentFieldMappers mappers=docMapper.mappers();
  assertThat(mappers.smartName("s"),Matchers.notNullValue());
  assertThat(mappers.smartName("s").mapper().fieldType().indexed(),equalTo(false));
  assertThat(mappers.smartName("l"),Matchers.notNullValue());
  assertThat(mappers.smartName("l").mapper().fieldType().indexed(),equalTo(true));
}
