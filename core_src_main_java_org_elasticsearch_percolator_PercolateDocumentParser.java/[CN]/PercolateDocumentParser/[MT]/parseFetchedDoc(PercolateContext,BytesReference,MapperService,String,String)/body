{
  DocumentMapperForType docMapper=mapperService.documentMapperWithAutoCreate(type);
  ParsedDocument doc=docMapper.getDocumentMapper().parse(source(fetchedDoc).index(index).type(type).id("_id_for_percolate_api"));
  if (doc == null) {
    throw new ElasticsearchParseException("No doc to percolate in the request");
  }
  if (context.highlight() != null) {
    doc.setSource(fetchedDoc);
  }
  return doc;
}
