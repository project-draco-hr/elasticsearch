{
  Request request=new Request(new String[]{TEST_INDEX});
  PlainActionFuture<Response> listener=new PlainActionFuture<>();
  ClusterBlocks.Builder block=ClusterBlocks.builder().addGlobalBlock(new ClusterBlock(1,"",false,true,RestStatus.SERVICE_UNAVAILABLE,ClusterBlockLevel.ALL));
  clusterService.setState(ClusterState.builder(clusterService.state()).blocks(block));
  try {
    action.new AsyncAction(request,listener).start();
    fail("expected ClusterBlockException");
  }
 catch (  ClusterBlockException expected) {
  }
}
