{
  additionalNodes=Arrays.asList("127.0.0.2:9200 c","127.0.0.3:9200 d");
  HttpHost httpHost=new HttpHost("127.0.0.1",server.getAddress().getPort(),"http");
  try (RestClient client=new RestClient(httpHost)){
    client.setNodes(client.fetchNodes(httpHost,true,true,false));
    HttpResponse httpResponse=client.httpGet("/_cat/health",Collections.emptyMap());
    assertEquals(httpResponse.getStatusLine().getStatusCode(),200);
    server.stop(0);
    try {
      client.httpGet("/_cat/health",Collections.emptyMap());
      fail();
    }
 catch (    IOException ex) {
      assertTrue(ex.getMessage(),ex.getMessage().endsWith("failed: connect timed out") || ex.getMessage().endsWith("failed: Connection refused"));
    }
  }
 }
