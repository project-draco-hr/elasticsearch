{
  final Scorer childScorer=childWeight.scorer(reader,true,false);
  if (childScorer == null) {
    return null;
  }
  final int firstChildDoc=childScorer.nextDoc();
  if (firstChildDoc == DocIdSetIterator.NO_MORE_DOCS) {
    return null;
  }
  DocIdSet parents=parentsFilter.getDocIdSet(reader);
  if (parents == null) {
    return null;
  }
  if (parents instanceof FixedBitDocSet) {
    parents=((FixedBitDocSet)parents).set();
  }
  if (!(parents instanceof FixedBitSet)) {
    throw new IllegalStateException("parentFilter must return OpenBitSet; got " + parents);
  }
  if (childCollector != null) {
    childCollector.setNextReader(reader,0);
    childCollector.setScorer(childScorer);
  }
  return new BlockJoinScorer(this,childScorer,(FixedBitSet)parents,firstChildDoc,scoreMode,childCollector);
}
