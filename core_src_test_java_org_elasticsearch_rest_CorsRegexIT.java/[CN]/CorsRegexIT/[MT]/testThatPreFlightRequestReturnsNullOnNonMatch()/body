{
  try {
    getRestClient().performRequest("OPTIONS","/",Collections.emptyMap(),null,new BasicHeader("User-Agent","Mozilla Bar"),new BasicHeader("Origin","http://evil-host:9200"),new BasicHeader(HttpHeaders.Names.ACCESS_CONTROL_REQUEST_METHOD,"GET"));
    fail("request should have failed");
  }
 catch (  ElasticsearchResponseException e) {
    ElasticsearchResponse response=e.getElasticsearchResponse();
    assertThat(response.getStatusLine().getStatusCode(),is(403));
    assertThat(response.getFirstHeader("Access-Control-Allow-Origin"),nullValue());
    assertThat(response.getFirstHeader("Access-Control-Allow-Methods"),nullValue());
  }
}
