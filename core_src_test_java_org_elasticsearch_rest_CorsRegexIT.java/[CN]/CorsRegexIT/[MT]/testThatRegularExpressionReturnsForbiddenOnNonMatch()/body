{
  try (RestClient client=restClient()){
    client.performRequest("GET","/",Collections.emptyMap(),null,new BasicHeader("User-Agent","Mozilla Bar"),new BasicHeader("Origin","http://evil-host:9200"));
    fail("request should have failed");
  }
 catch (  ElasticsearchResponseException e) {
    ElasticsearchResponse response=e.getElasticsearchResponse();
    assertThat(response.getStatusLine().getStatusCode(),is(403));
    assertThat(response.getFirstHeader("Access-Control-Allow-Origin"),nullValue());
  }
}
