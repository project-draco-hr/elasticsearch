def verify_lucene_version():
    s = open('pom.xml', encoding='utf-8').read()
    if ('download.elasticsearch.org/lucenesnapshots' in s):
        raise RuntimeError('pom.xml contains download.elasticsearch.org/lucenesnapshots repository: remove that before releasing')
    m = re.search('<lucene.version>(.*?)</lucene.version>', s)
    if (m is None):
        raise RuntimeError('unable to locate lucene.version in pom.xml')
    lucene_version = m.group(1)
    m = re.search('<lucene.maven.version>(.*?)</lucene.maven.version>', s)
    if (m is None):
        raise RuntimeError('unable to locate lucene.maven.version in pom.xml')
    lucene_maven_version = m.group(1)
    if (lucene_version != lucene_maven_version):
        raise RuntimeError(('pom.xml is still using a snapshot release of lucene (%s): cutover to a real lucene release before releasing' % lucene_maven_version))
