{
  try {
    client.admin().indices().prepareDelete("test").execute().actionGet();
  }
 catch (  IndexMissingException e) {
  }
  client.admin().indices().prepareCreate("test").execute().actionGet();
  client.admin().cluster().prepareHealth("test").setWaitForGreenStatus().execute().actionGet();
  BulkResponse bulkResponse=client.prepareBulk().add(client.prepareIndex("test","type","1").setSource("field1","value1_1")).execute().actionGet();
  assertThat(bulkResponse.hasFailures(),equalTo(false));
  assertThat(bulkResponse.items().length,equalTo(1));
  IndexResponse indexResponse=bulkResponse.items()[0].response();
  assertThat(indexResponse.version(),equalTo(1l));
}
