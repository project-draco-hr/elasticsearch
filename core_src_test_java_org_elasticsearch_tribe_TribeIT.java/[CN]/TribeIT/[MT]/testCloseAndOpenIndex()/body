{
  assertAcked(internalCluster().client().admin().indices().prepareCreate("test1"));
  ensureGreen(internalCluster());
  assertAcked(internalCluster().client().admin().indices().prepareClose("test1"));
  setupTribeNode(Settings.EMPTY);
  awaitSameNodeCounts();
  ClusterState tribeState=tribeNode.client().admin().cluster().prepareState().get().getState();
  assertThat(tribeState.getMetaData().hasIndex("test1"),equalTo(false));
  assertAcked(internalCluster().client().admin().indices().prepareOpen("test1"));
  awaitIndicesInClusterState("test1");
  ensureGreen(internalCluster());
  assertAcked(cluster2.client().admin().indices().prepareCreate("test2"));
  awaitIndicesInClusterState("test1","test2");
  ensureGreen(cluster2);
  assertAcked(cluster2.client().admin().indices().prepareClose("test2"));
  awaitIndicesNotInClusterState("test2");
  assertAcked(cluster2.client().admin().indices().prepareOpen("test2"));
  awaitIndicesInClusterState("test1","test2");
  ensureGreen(cluster2);
}
