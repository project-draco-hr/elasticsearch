{
  Map<String,String> asMap=internalCluster().getDefaultSettings().getAsMap();
  Settings.Builder tribe1Defaults=Settings.builder();
  Settings.Builder tribe2Defaults=Settings.builder();
  for (  Map.Entry<String,String> entry : asMap.entrySet()) {
    tribe1Defaults.put("tribe.t1." + entry.getKey(),entry.getValue());
    tribe2Defaults.put("tribe.t2." + entry.getKey(),entry.getValue());
  }
  tribe1Defaults.putArray("tribe.t1." + UnicastZenPing.DISCOVERY_ZEN_PING_UNICAST_HOSTS,getUnicastHosts(internalCluster().client()));
  tribe1Defaults.putArray("tribe.t2." + UnicastZenPing.DISCOVERY_ZEN_PING_UNICAST_HOSTS,getUnicastHosts(cluster2.client()));
  Settings merged=Settings.builder().put("tribe.t1.cluster.name",internalCluster().getClusterName()).put("tribe.t2.cluster.name",cluster2.getClusterName()).put("tribe.blocks.write",false).put("tribe.blocks.read",false).put(settings).put(tribe1Defaults.build()).put(tribe2Defaults.build()).put(internalCluster().getDefaultSettings()).put("node.name","tribe_node").build();
  tribeNode=new Node(merged).start();
  tribeClient=tribeNode.client();
}
