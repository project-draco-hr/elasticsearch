{
  assertBusy(new Runnable(){
    @Override public void run(){
      DiscoveryNodes tribeNodes=tribeNode.client().admin().cluster().prepareState().get().getState().getNodes();
      assertThat(countDataNodesForTribe("t1",tribeNodes),equalTo(internalCluster().client().admin().cluster().prepareState().get().getState().getNodes().getDataNodes().size()));
      assertThat(countDataNodesForTribe("t2",tribeNodes),equalTo(cluster2.client().admin().cluster().prepareState().get().getState().getNodes().getDataNodes().size()));
    }
  }
);
}
