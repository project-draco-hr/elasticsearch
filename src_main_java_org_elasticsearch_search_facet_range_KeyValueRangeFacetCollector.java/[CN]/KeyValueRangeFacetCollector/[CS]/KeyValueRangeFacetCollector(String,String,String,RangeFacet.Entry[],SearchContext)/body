{
  super(facetName);
  this.entries=entries;
  this.fieldDataCache=context.fieldDataCache();
  MapperService.SmartNameFieldMappers smartMappers=context.smartFieldMappers(keyFieldName);
  if (smartMappers == null || !smartMappers.hasMapper()) {
    throw new FacetPhaseExecutionException(facetName,"No mapping found for field [" + keyFieldName + "]");
  }
  if (smartMappers.hasDocMapper() && smartMappers.explicitTypeInName()) {
    setFilter(context.filterCache().cache(smartMappers.docMapper().typeFilter()));
  }
  keyIndexFieldName=smartMappers.mapper().names().indexName();
  keyFieldDataType=smartMappers.mapper().fieldDataType();
  smartMappers=context.smartFieldMappers(valueFieldName);
  if (smartMappers == null || !smartMappers.hasMapper()) {
    throw new FacetPhaseExecutionException(facetName,"No mapping found for value_field [" + valueFieldName + "]");
  }
  valueIndexFieldName=smartMappers.mapper().names().indexName();
  valueFieldDataType=smartMappers.mapper().fieldDataType();
  this.rangeProc=new RangeProc(entries);
}
