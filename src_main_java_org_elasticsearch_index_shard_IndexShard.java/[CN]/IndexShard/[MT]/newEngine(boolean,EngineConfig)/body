{
  final FsTranslog translog;
  try {
    translog=new FsTranslog(shardId,indexSettingsService,bigArrays,path,threadPool);
  }
 catch (  IOException e) {
    throw new EngineCreationFailureException(shardId,"failed to create translog",e);
  }
  Engine engine=null;
  try {
    engine=engineFactory.newReadWriteEngine(config,translog,skipTranslogRecovery);
  }
  finally {
    if (engine == null) {
      IOUtils.closeWhileHandlingException(translog);
    }
  }
  return engine;
}
