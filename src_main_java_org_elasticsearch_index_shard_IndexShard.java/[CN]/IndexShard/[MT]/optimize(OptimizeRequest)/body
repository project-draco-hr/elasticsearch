{
  verifyStarted();
  if (logger.isTraceEnabled()) {
    logger.trace("optimize with {}",optimize);
  }
  engine().forceMerge(optimize.flush(),optimize.maxNumSegments(),optimize.onlyExpungeDeletes(),optimize.upgrade(),optimize.upgradeOnlyAncientSegments());
}
