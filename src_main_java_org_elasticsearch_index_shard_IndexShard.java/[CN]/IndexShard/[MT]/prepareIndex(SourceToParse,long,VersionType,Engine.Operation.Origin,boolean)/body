{
  long startTime=System.nanoTime();
  Tuple<DocumentMapper,Boolean> docMapper=mapperService.documentMapperWithAutoCreate(source.type());
  ParsedDocument doc=docMapper.v1().parse(source).setMappingsModified(docMapper);
  return new Engine.Index(docMapper.v1(),docMapper.v1().mappers().indexAnalyzer(),docMapper.v1().uidMapper().term(doc.uid().stringValue()),doc,version,versionType,origin,startTime,state != IndexShardState.STARTED || canHaveDuplicates);
}
