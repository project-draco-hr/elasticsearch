{
synchronized (mutex) {
    if (state == IndexShardState.CLOSED) {
      throw new IndexShardClosedException(shardId);
    }
    if (state == IndexShardState.STARTED) {
      throw new IndexShardStartedException(shardId);
    }
    if (state == IndexShardState.RELOCATED) {
      throw new IndexShardRelocatedException(shardId);
    }
    if (Booleans.parseBoolean(checkIndexOnStartup,false)) {
      checkIndex(true);
    }
    createNewEngine();
    startScheduledTasksIfNeeded();
    changeState(IndexShardState.POST_RECOVERY,reason);
  }
  indicesLifecycle.afterIndexShardPostRecovery(this);
  return this;
}
