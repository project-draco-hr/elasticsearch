{
  long startTime=System.nanoTime();
  try {
    ParsedDocument doc=docMapper.v1().parse(source).setMappingsModified(docMapper);
    return new Engine.Create(docMapper.v1(),docMapper.v1().uidMapper().term(doc.uid().stringValue()),doc,version,versionType,origin,startTime,canHaveDuplicates,autoGeneratedId);
  }
 catch (  Throwable t) {
    if (docMapper.v2() || (t instanceof MapperParsingException && ((MapperParsingException)t).isMappingsModified())) {
      throw new WriteFailureException(t,docMapper.v1().type());
    }
 else {
      throw t;
    }
  }
}
