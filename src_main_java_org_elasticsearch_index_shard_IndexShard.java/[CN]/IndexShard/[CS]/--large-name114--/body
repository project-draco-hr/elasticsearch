{
  super(shardId,indexSettings);
  Preconditions.checkNotNull(store,"Store must be provided to the index shard");
  Preconditions.checkNotNull(deletionPolicy,"Snapshot deletion policy must be provided to the index shard");
  Preconditions.checkNotNull(translog,"Translog must be provided to the index shard");
  this.engineFactory=factory;
  this.indicesLifecycle=(InternalIndicesLifecycle)indicesLifecycle;
  this.indexSettingsService=indexSettingsService;
  this.store=store;
  this.mergeScheduler=mergeScheduler;
  this.translog=translog;
  this.threadPool=threadPool;
  this.mapperService=mapperService;
  this.queryParserService=queryParserService;
  this.indexCache=indexCache;
  this.indexAliasesService=indexAliasesService;
  this.indexingService=indexingService;
  this.getService=getService.setIndexShard(this);
  this.termVectorsService=termVectorsService.setIndexShard(this);
  this.searchService=searchService;
  this.shardWarmerService=shardWarmerService;
  this.shardFilterCache=shardFilterCache;
  this.shardQueryCache=shardQueryCache;
  this.shardFieldData=shardFieldData;
  this.percolatorQueriesRegistry=percolatorQueriesRegistry;
  this.shardPercolateService=shardPercolateService;
  this.indexFieldDataService=indexFieldDataService;
  this.indexService=indexService;
  this.codecService=codecService;
  this.shardSuggestService=shardSuggestService;
  this.shardBitsetFilterCache=shardBitsetFilterCache;
  state=IndexShardState.CREATED;
  this.refreshInterval=indexSettings.getAsTime(INDEX_REFRESH_INTERVAL,EngineConfig.DEFAULT_REFRESH_INTERVAL);
  indexSettingsService.addListener(applyRefreshSettings);
  this.config=new EngineConfig(shardId,indexSettings.getAsBoolean(EngineConfig.INDEX_OPTIMIZE_AUTOGENERATED_ID_SETTING,false),threadPool,indexingService,indexSettingsService,warmer,store,deletionPolicy,translog,mergePolicyProvider,mergeScheduler,analysisService.defaultIndexAnalyzer(),similarityService.similarity(),codecService,failedEngineListener);
  logger.debug("state: [CREATED]");
  this.checkIndexOnStartup=indexSettings.get("index.shard.check_on_startup","false");
}
