{
  InternalIndexShard shard=(InternalIndexShard)indicesService.indexServiceSafe(request.shardId().index().name()).shardSafe(request.shardId().id());
  for (  String existingFile : shard.store().directory().listAll()) {
    if (!request.snapshotFiles().contains(existingFile)) {
      shard.store().directory().deleteFile(existingFile);
    }
  }
  channel.sendResponse(VoidStreamable.INSTANCE);
}
