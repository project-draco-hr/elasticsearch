{
  try {
    SnapshotInfo blobStoreSnapshot=new SnapshotInfo(snapshotId,indices,startTime,failure,System.currentTimeMillis(),totalShards,shardFailures);
    snapshotFormat.write(blobStoreSnapshot,snapshotsBlobContainer,blobId(snapshotId));
    List<SnapshotId> snapshotIds=getSnapshots();
    if (!snapshotIds.contains(snapshotId)) {
      snapshotIds=new ArrayList<>(snapshotIds);
      snapshotIds.add(snapshotId);
      snapshotIds=Collections.unmodifiableList(snapshotIds);
      writeSnapshotsToIndexGen(snapshotIds);
    }
    return blobStoreSnapshot;
  }
 catch (  IOException ex) {
    throw new RepositoryException(this.repositoryName,"failed to update snapshot in repository",ex);
  }
}
