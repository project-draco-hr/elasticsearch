{
  try (InputStream blob=snapshotsBlobContainer.readBlob(SNAPSHOTS_FILE)){
    BytesStreamOutput out=new BytesStreamOutput();
    Streams.copy(blob,out);
    ArrayList<SnapshotId> snapshots=new ArrayList<>();
    try (XContentParser parser=XContentHelper.createParser(out.bytes())){
      if (parser.nextToken() == XContentParser.Token.START_OBJECT) {
        if (parser.nextToken() == XContentParser.Token.FIELD_NAME) {
          String currentFieldName=parser.currentName();
          if ("snapshots".equals(currentFieldName)) {
            if (parser.nextToken() == XContentParser.Token.START_ARRAY) {
              while (parser.nextToken() != XContentParser.Token.END_ARRAY) {
                snapshots.add(new SnapshotId(repositoryName,parser.text()));
              }
            }
          }
        }
      }
    }
     return Collections.unmodifiableList(snapshots);
  }
 }
