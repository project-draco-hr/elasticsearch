{
  try (InputStream blob=snapshotsBlobContainer.readBlob(SNAPSHOTS_FILE)){
    final byte[] data=ByteStreams.toByteArray(blob);
    ArrayList<SnapshotId> snapshots=new ArrayList<>();
    try (XContentParser parser=XContentHelper.createParser(new BytesArray(data))){
      if (parser.nextToken() == XContentParser.Token.START_OBJECT) {
        if (parser.nextToken() == XContentParser.Token.FIELD_NAME) {
          String currentFieldName=parser.currentName();
          if ("snapshots".equals(currentFieldName)) {
            if (parser.nextToken() == XContentParser.Token.START_ARRAY) {
              while (parser.nextToken() != XContentParser.Token.END_ARRAY) {
                snapshots.add(new SnapshotId(repositoryName,parser.text()));
              }
            }
          }
        }
      }
    }
     return Collections.unmodifiableList(snapshots);
  }
 }
