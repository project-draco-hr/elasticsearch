{
  final long indexGen=latestIndexBlobId();
  final String snapshotsIndexBlobName;
  final boolean legacyFormat;
  if (indexGen == -1) {
    snapshotsIndexBlobName=SNAPSHOTS_FILE;
    legacyFormat=true;
  }
 else {
    snapshotsIndexBlobName=INDEX_FILE_PREFIX + Long.toString(indexGen);
    legacyFormat=false;
  }
  try (InputStream blob=snapshotsBlobContainer.readBlob(snapshotsIndexBlobName)){
    BytesStreamOutput out=new BytesStreamOutput();
    Streams.copy(blob,out);
    try (XContentParser parser=XContentHelper.createParser(out.bytes())){
      return RepositoryData.fromXContent(parser,legacyFormat);
    }
   }
 }
