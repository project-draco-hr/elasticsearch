{
  if (useSortedNumericDocValues) {
    fields.add(new SortedNumericDocValuesField(names().indexName(),value));
  }
 else {
    CustomLongNumericDocValuesField field=(CustomLongNumericDocValuesField)context.doc().getByKey(names().indexName());
    if (field != null) {
      field.add(value);
    }
 else {
      field=new CustomLongNumericDocValuesField(names().indexName(),value);
      context.doc().addWithKey(names().indexName(),field);
    }
  }
}
