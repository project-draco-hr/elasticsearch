{
  logger.info("create 2 indices, test1 on t1, and test2 on t2");
  internalCluster().client().admin().indices().prepareCreate("test1").get();
  assertAcked(cluster2.client().admin().indices().prepareCreate("test2"));
  setupTribeNode(ImmutableSettings.builder().put("tribe.blocks.write",true).put("tribe.blocks.metadata",true).build());
  logger.info("wait till tribe has the same nodes as the 2 clusters");
  awaitSameNodeCounts();
  logger.info("wait till test1 and test2 exists in the tribe node state");
  awaitIndicesInClusterState("test1","test2");
  try {
    tribeClient.prepareIndex("test1","type1","1").setSource("field1","value1").execute().actionGet();
    fail("cluster block should be thrown");
  }
 catch (  ClusterBlockException e) {
  }
  try {
    tribeClient.admin().indices().prepareOptimize("test1").execute().actionGet();
    fail("cluster block should be thrown");
  }
 catch (  ClusterBlockException e) {
  }
  try {
    tribeClient.admin().indices().prepareOptimize("test2").execute().actionGet();
    fail("cluster block should be thrown");
  }
 catch (  ClusterBlockException e) {
  }
}
