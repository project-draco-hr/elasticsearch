{
  logger.info("create 2 indices, test1 on t1, and test2 on t2");
  assertAcked(internalCluster().client().admin().indices().prepareCreate("test1"));
  assertAcked(internalCluster().client().admin().indices().prepareCreate("block_test1"));
  assertAcked(cluster2.client().admin().indices().prepareCreate("test2"));
  assertAcked(cluster2.client().admin().indices().prepareCreate("block_test2"));
  setupTribeNode(ImmutableSettings.builder().put("tribe.blocks.write.indices","block_*").build());
  logger.info("wait till tribe has the same nodes as the 2 clusters");
  awaitSameNodeCounts();
  logger.info("wait till test1 and test2 exists in the tribe node state");
  awaitIndicesInClusterState("test1","test2","block_test1","block_test2");
  tribeClient.prepareIndex("test1","type1","1").setSource("field1","value1").get();
  try {
    tribeClient.prepareIndex("block_test1","type1","1").setSource("field1","value1").get();
    fail("cluster block should be thrown");
  }
 catch (  ClusterBlockException e) {
  }
  tribeClient.prepareIndex("test2","type1","1").setSource("field1","value1").get();
  try {
    tribeClient.prepareIndex("block_test2","type1","1").setSource("field1","value1").get();
    fail("cluster block should be thrown");
  }
 catch (  ClusterBlockException e) {
  }
}
