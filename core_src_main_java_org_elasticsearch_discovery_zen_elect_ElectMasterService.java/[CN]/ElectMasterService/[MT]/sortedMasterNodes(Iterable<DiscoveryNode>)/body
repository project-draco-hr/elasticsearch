{
  List<DiscoveryNode> possibleNodes=CollectionUtils.iterableAsArrayList(nodes);
  if (possibleNodes.isEmpty()) {
    return null;
  }
  for (Iterator<DiscoveryNode> it=possibleNodes.iterator(); it.hasNext(); ) {
    DiscoveryNode node=it.next();
    if (!node.isMasterNode()) {
      it.remove();
    }
  }
  CollectionUtil.introSort(possibleNodes,nodeComparator);
  return possibleNodes;
}
