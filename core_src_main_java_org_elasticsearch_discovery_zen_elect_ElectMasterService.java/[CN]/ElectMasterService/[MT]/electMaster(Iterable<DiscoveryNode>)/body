{
  List<DiscoveryNode> sortedNodes=sortedMasterNodes(nodes);
  if (sortedNodes == null || sortedNodes.isEmpty()) {
    return null;
  }
  DiscoveryNode masterNode=sortedNodes.get(0);
  if (masterNode.getVersion().before(minMasterVersion)) {
    logger.warn("ignoring master [{}], because the version [{}] is lower than the minimum compatible version [{}]",masterNode,masterNode.getVersion(),minMasterVersion);
    return null;
  }
 else {
    return masterNode;
  }
}
