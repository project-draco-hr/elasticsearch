{
  if (formatter != ValueFormatter.RAW) {
    Text keyTxt=new Text(formatter.format(key));
    if (keyed) {
      builder.startObject(keyTxt.string());
    }
 else {
      builder.startObject();
    }
    builder.field(CommonFields.KEY_AS_STRING,keyTxt);
  }
 else {
    if (keyed) {
      builder.startObject(String.valueOf(getKey()));
    }
 else {
      builder.startObject();
    }
  }
  builder.field(CommonFields.KEY,key);
  builder.field(CommonFields.DOC_COUNT,docCount);
  aggregations.toXContentInternal(builder,params);
  builder.endObject();
  return builder;
}
