{
  Directory directory=null;
  long size=Long.MIN_VALUE;
  int sameSize=0;
  for (  Directory delegate : delegates) {
    long currentSize=getUsableSpace(delegate);
    if (currentSize > size) {
      size=currentSize;
      directory=delegate;
      sameSize=1;
    }
 else     if (currentSize == size) {
      sameSize++;
      if (ThreadLocalRandom.current().nextDouble() < 1.0 / sameSize) {
        directory=delegate;
      }
    }
  }
  return directory;
}
