{
  XContentBuilder builder=XContentFactory.contentBuilder(type);
  builder.startObject();
  builder.field("field1","value1");
  builder.endObject();
  assertThat(XContentFactory.xContentType(builder.bytes()),equalTo(type));
  BytesArray bytesArray=builder.bytes().toBytesArray();
  assertThat(XContentFactory.xContentType(new BytesStreamInput(bytesArray.array(),bytesArray.arrayOffset(),bytesArray.length(),false)),equalTo(type));
  if (type != XContentType.CBOR) {
    assertThat(XContentFactory.xContentType(builder.string()),equalTo(type));
  }
}
