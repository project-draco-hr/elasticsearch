{
  IngestDocument ingestDocument=RandomDocumentPicks.randomIngestDocument(random());
  Map<String,Type> fields=new HashMap<>();
  Map<String,Boolean> expectedResult=new HashMap<>();
  boolean randomBoolean=randomBoolean();
  String booleanString=Boolean.toString(randomBoolean);
  if (randomBoolean) {
    booleanString=booleanString.toUpperCase(Locale.ROOT);
  }
  String fieldName=RandomDocumentPicks.addRandomField(random(),ingestDocument,booleanString);
  Processor processor=new ConvertProcessor(fieldName,Type.BOOLEAN);
  processor.execute(ingestDocument);
  assertThat(ingestDocument.getFieldValue(fieldName,Boolean.class),equalTo(randomBoolean));
}
