{
  Node node=newNode();
  try {
    Client client=node.client();
    try {
      canCreateIndex(client,"ro");
      canIndexDocument(client,"ro");
      canIndexExists(client,"ro");
      setIndexReadOnly(client,"ro","true");
      canNotIndexDocument(client,"ro");
      canNotIndexExists(client,"ro");
      canCreateIndex(client,"rw");
      canIndexDocument(client,"rw");
      canIndexExists(client,"rw");
      setIndexReadOnly(client,"ro","false");
      canIndexDocument(client,"ro");
      canIndexExists(client,"ro");
    }
  finally {
      client.close();
    }
  }
  finally {
    node.close();
  }
}
