{
  Node node=newNode();
  try {
    Client client=node.client();
    try {
      canCreateIndex(client,"test1");
      canIndexDocument(client,"test1");
      setIndexReadOnly(client,"test1","false");
      canIndexExists(client,"test1");
      setClusterReadOnly(client,"true");
      canNotCreateIndex(client,"test2");
      canNotIndexDocument(client,"test1");
      canNotIndexExists(client,"test1");
      setClusterReadOnly(client,"false");
      canCreateIndex(client,"test2");
      canIndexDocument(client,"test2");
      canIndexDocument(client,"test1");
      canIndexExists(client,"test1");
    }
  finally {
      client.close();
    }
  }
  finally {
    node.close();
  }
}
