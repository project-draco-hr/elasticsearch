{
  long totalQueryTime;
  client.admin().indices().prepareClearCache().setFieldDataCache(true).execute().actionGet();
  System.gc();
  System.out.println("--> Warmup (" + name + ")...");
  for (int j=0; j < QUERY_WARMUP; j++) {
    SearchResponse searchResponse=method.addTermsStatsAgg(client.prepareSearch().setSize(0).setQuery(matchAllQuery()),name,keyField,valueField).execute().actionGet();
    if (j == 0) {
      System.out.println("--> Loading (" + name + "): took: "+ searchResponse.getTook());
    }
    if (searchResponse.getHits().totalHits() != COUNT) {
      System.err.println("--> mismatch on hits");
    }
  }
  System.out.println("--> Warmup (" + name + ") DONE");
  System.out.println("--> Running (" + name + ")...");
  totalQueryTime=0;
  for (int j=0; j < QUERY_COUNT; j++) {
    SearchResponse searchResponse=method.addTermsStatsAgg(client.prepareSearch().setSize(0).setQuery(matchAllQuery()),name,keyField,valueField).execute().actionGet();
    if (searchResponse.getHits().totalHits() != COUNT) {
      System.err.println("--> mismatch on hits");
    }
    totalQueryTime+=searchResponse.getTookInMillis();
  }
  System.out.println("--> Terms stats agg (" + name + "): "+ (totalQueryTime / QUERY_COUNT)+ "ms");
  return new StatsResult(name,totalQueryTime,ByteSizeValue.parseBytesSizeValue("0b"));
}
