{
  if (currentBufferIndex >= file.numberOfBuffers()) {
    if (enforceEOF)     throw new IOException("Read past EOF");
 else {
      currentBufferIndex--;
      bufferPosition=bufferSize;
    }
  }
 else {
    currentBuffer=file.buffer(currentBufferIndex);
    bufferPosition=0;
    bufferStart=(long)bufferSize * (long)currentBufferIndex;
    long buflen=length - bufferStart;
    bufferLength=buflen > bufferSize ? bufferSize : (int)buflen;
  }
}
