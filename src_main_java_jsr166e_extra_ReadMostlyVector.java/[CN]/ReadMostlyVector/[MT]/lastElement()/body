{
  final SequenceLock lock=this.lock;
  for (; ; ) {
    long seq=lock.awaitAvailability();
    Object[] items=array;
    int n=count;
    @SuppressWarnings("unchecked") E e=(n > 0 && items.length >= n) ? (E)items[n - 1] : null;
    if (lock.getSequence() == seq) {
      if (n <= 0)       throw new NoSuchElementException();
      return e;
    }
  }
}
