{
  builder.field("cluster_name",clusterName().value());
  builder.startObject("nodes");
  for (  NodeStats nodeStats : this) {
    builder.startObject(nodeStats.node().id(),XContentBuilder.FieldCaseConversion.NONE);
    builder.field("name",nodeStats.node().name(),XContentBuilder.FieldCaseConversion.NONE);
    builder.field("transport_address",nodeStats.node().address().toString());
    if (nodeStats.hostname() != null) {
      builder.field("hostname",nodeStats.hostname(),XContentBuilder.FieldCaseConversion.NONE);
    }
    if (!nodeStats.node().attributes().isEmpty()) {
      builder.startObject("attributes");
      for (      Map.Entry<String,String> attr : nodeStats.node().attributes().entrySet()) {
        builder.field(attr.getKey(),attr.getValue());
      }
      builder.endObject();
    }
    if (nodeStats.indices() != null) {
      nodeStats.indices().toXContent(builder,params);
    }
    if (nodeStats.os() != null) {
      nodeStats.os().toXContent(builder,params);
    }
    if (nodeStats.process() != null) {
      nodeStats.process().toXContent(builder,params);
    }
    if (nodeStats.jvm() != null) {
      nodeStats.jvm().toXContent(builder,params);
    }
    if (nodeStats.threadPool() != null) {
      nodeStats.threadPool().toXContent(builder,params);
    }
    if (nodeStats.network() != null) {
      nodeStats.network().toXContent(builder,params);
    }
    if (nodeStats.transport() != null) {
      nodeStats.transport().toXContent(builder,params);
    }
    if (nodeStats.http() != null) {
      nodeStats.http().toXContent(builder,params);
    }
    builder.endObject();
  }
  builder.endObject();
  return builder;
}
