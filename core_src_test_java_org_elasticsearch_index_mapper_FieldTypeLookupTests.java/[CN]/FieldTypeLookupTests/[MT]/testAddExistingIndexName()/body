{
  FakeFieldMapper f=new FakeFieldMapper("foo","foo");
  FakeFieldMapper f2=new FakeFieldMapper("bar","foo");
  FieldTypeLookup lookup=new FieldTypeLookup();
  lookup=lookup.copyAndAddAll("type1",newList(f),randomBoolean());
  FieldTypeLookup lookup2=lookup.copyAndAddAll("type2",newList(f2),randomBoolean());
  assertSame(f.fieldType(),lookup2.get("foo"));
  assertSame(f2.fieldType(),lookup2.get("bar"));
  assertSame(f2.fieldType(),lookup2.getByIndexName("foo"));
  assertEquals(2,size(lookup2.iterator()));
}
