{
  FakeFieldMapper f=new FakeFieldMapper("foo","foo");
  FakeFieldMapper f2=new FakeFieldMapper("foo","bar");
  MappedFieldType originalFieldType=f.fieldType();
  FieldTypeLookup lookup=new FieldTypeLookup();
  lookup=lookup.copyAndAddAll("type1",newList(f));
  FieldTypeLookup lookup2=lookup.copyAndAddAll("type2",newList(f2));
  assertNotSame(originalFieldType,f.fieldType());
  assertSame(f.fieldType(),f2.fieldType());
  assertSame(f.fieldType(),lookup2.get("foo"));
  assertSame(f.fieldType(),lookup2.getByIndexName("foo"));
  assertSame(f.fieldType(),lookup2.getByIndexName("bar"));
  assertEquals(1,size(lookup2.iterator()));
}
