{
  super(settings);
  this.knownDicitionaries=knownDicitionaries;
  this.hunspellDir=resolveHunspellDirectory(settings,env);
  this.defaultIgnoreCase=settings.getAsBoolean("indices.analysis.hunspell.dictionary.ignore_case",false);
  this.defaultStrictAffixParsing=settings.getAsBoolean("indices.analysis.hunspell.dictionary.strict_affix_parsing",false);
  final Version version=Lucene.parseVersion(settings.get("version"),Lucene.ANALYZER_VERSION,logger);
  dictionaries=CacheBuilder.newBuilder().build(new CacheLoader<String,HunspellDictionary>(){
    @Override public HunspellDictionary load(    String locale) throws Exception {
      HunspellDictionary dictionary=knownDicitionaries.get(locale);
      if (dictionary == null) {
        dictionary=loadDictionary(locale,settings,env,version);
      }
      return dictionary;
    }
  }
);
  scanAndLoadDictionaries();
}
