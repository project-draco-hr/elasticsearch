{
  this.request=request;
  this.listener=listener;
  clusterState=clusterService.state();
  nodes=clusterState.nodes();
  shards=clusterState.routingTable().allShards(processIndices(clusterState,request.indices()));
  shardsResponses=new AtomicReferenceArray<Object>(shards.size());
}
