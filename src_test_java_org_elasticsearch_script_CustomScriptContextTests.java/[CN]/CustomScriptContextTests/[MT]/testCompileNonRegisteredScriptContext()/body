{
  ScriptService scriptService=internalCluster().getInstance(ScriptService.class);
  try {
    scriptService.compile(new Script(randomFrom(LANG_SET.toArray(new String[LANG_SET.size()])),"test",randomFrom(ScriptService.ScriptType.values()),null),new ScriptContext(){
      @Override public String getKey(){
        return "test";
      }
    }
);
    fail("script compilation should have been rejected");
  }
 catch (  ElasticsearchIllegalArgumentException e) {
    assertThat(e.getMessage(),containsString("script context [test] not supported"));
  }
}
