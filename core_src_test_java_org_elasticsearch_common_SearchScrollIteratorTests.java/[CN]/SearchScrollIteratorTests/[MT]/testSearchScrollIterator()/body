{
  createIndex("index");
  int numDocs=scaledRandomIntBetween(0,128);
  for (int i=0; i < numDocs; i++) {
    client().prepareIndex("index","type",Integer.toString(i)).setSource("field","value" + i).get();
  }
  client().admin().indices().prepareRefresh().get();
  int i=0;
  SearchRequest searchRequest=new SearchRequest("index");
  SearchSourceBuilder sourceBuilder=new SearchSourceBuilder();
  sourceBuilder.size(scaledRandomIntBetween(1,10));
  searchRequest.source(sourceBuilder);
  Iterable<SearchHit> hits=SearchScrollIterator.createIterator(client(),TimeValue.timeValueSeconds(10),searchRequest);
  for (  SearchHit hit : hits) {
    assertThat(hit.getId(),equalTo(Integer.toString(i)));
    assertThat(hit.getSource().get("field"),equalTo("value" + i));
    i++;
  }
  assertThat(i,equalTo(numDocs));
}
