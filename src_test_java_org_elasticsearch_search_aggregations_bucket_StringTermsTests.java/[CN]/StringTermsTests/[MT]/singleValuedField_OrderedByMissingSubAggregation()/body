{
  try {
    client().prepareSearch("idx").setTypes("type").addAggregation(terms("terms").executionHint(randomExecutionHint()).field("value").order(Terms.Order.aggregation("avg_i",true))).execute().actionGet();
    fail("Expected search to fail when trying to sort terms aggregation by sug-aggregation that doesn't exist");
  }
 catch (  ElasticsearchException e) {
  }
}
