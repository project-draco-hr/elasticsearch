{
  MockBigArrays.discardNextCheck();
  try {
    client().prepareSearch("idx").setTypes("type").addAggregation(terms("terms").executionHint(randomExecutionHint()).field(SINGLE_VALUED_FIELD_NAME).order(Terms.Order.aggregation("stats",true)).subAggregation(stats("stats").field("i"))).execute().actionGet();
    fail("Expected search to fail when trying to sort terms aggregation by multi-valued sug-aggregation " + "where the metric name is not specified");
  }
 catch (  ElasticsearchException e) {
  }
}
