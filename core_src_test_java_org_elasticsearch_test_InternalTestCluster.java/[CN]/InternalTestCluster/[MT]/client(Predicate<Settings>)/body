{
  ensureOpen();
  final NodeAndClient randomNodeAndClient=getRandomNodeAndClient(new Predicate<NodeAndClient>(){
    @Override public boolean apply(    NodeAndClient nodeAndClient){
      return filterPredicate.apply(nodeAndClient.node.settings());
    }
  }
);
  if (randomNodeAndClient != null) {
    return randomNodeAndClient.client(random);
  }
  return null;
}
