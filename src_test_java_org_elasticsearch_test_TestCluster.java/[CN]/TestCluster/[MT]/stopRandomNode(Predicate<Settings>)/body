{
  ensureOpen();
  NodeAndClient nodeAndClient=getRandomNodeAndClient(new Predicate<TestCluster.NodeAndClient>(){
    @Override public boolean apply(    NodeAndClient nodeAndClient){
      return filter.apply(nodeAndClient.node.settings());
    }
  }
);
  if (nodeAndClient != null) {
    logger.info("Closing filtered random node [{}] ",nodeAndClient.name);
    nodes.remove(nodeAndClient.name);
    nodeAndClient.close();
  }
}
