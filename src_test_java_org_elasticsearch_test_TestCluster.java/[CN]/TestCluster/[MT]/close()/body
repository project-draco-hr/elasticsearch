{
  ensureOpen();
  if (this.open.compareAndSet(true,false)) {
    IOUtils.closeWhileHandlingException(nodes.values());
    nodes.clear();
    executor.shutdownNow();
  }
}
