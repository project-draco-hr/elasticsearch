{
  ensureOpen();
  NodeAndClient randomNodeAndClient=getRandomNodeAndClient(new ClientNodePredicate());
  if (randomNodeAndClient != null) {
    return randomNodeAndClient.client(random);
  }
  startNodeClient(ImmutableSettings.EMPTY);
  return getRandomNodeAndClient(new ClientNodePredicate()).client(random);
}
