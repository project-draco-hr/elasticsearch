{
  final FieldMapper.Names names=buildNames(context);
  if (Names.TREE_GEOHASH.equals(tree)) {
    prefixTree=new GeohashPrefixTree(ShapeBuilder.SPATIAL_CONTEXT,getLevels(treeLevels,precisionInMeters,Defaults.GEOHASH_LEVELS,true));
  }
 else   if (Names.TREE_QUADTREE.equals(tree)) {
    prefixTree=new QuadPrefixTree(ShapeBuilder.SPATIAL_CONTEXT,getLevels(treeLevels,precisionInMeters,Defaults.QUADTREE_LEVELS,false));
  }
 else {
    throw new ElasticSearchIllegalArgumentException("Unknown prefix tree type [" + tree + "]");
  }
  return new GeoShapeFieldMapper(names,prefixTree,strategyName,distanceErrorPct,fieldType,provider);
}
