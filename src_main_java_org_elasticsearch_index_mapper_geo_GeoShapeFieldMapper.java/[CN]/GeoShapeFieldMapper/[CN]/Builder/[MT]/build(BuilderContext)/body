{
  if (tree.equals(Names.GEOHASH)) {
    int levels=treeLevels != 0 ? treeLevels : Defaults.GEOHASH_LEVELS;
    prefixTree=new GeohashPrefixTree(GeoShapeConstants.SPATIAL_CONTEXT,levels);
  }
 else   if (tree.equals(Names.QUADTREE)) {
    int levels=treeLevels != 0 ? treeLevels : Defaults.QUADTREE_LEVELS;
    prefixTree=new QuadPrefixTree(GeoShapeConstants.SPATIAL_CONTEXT,levels);
  }
 else {
    throw new ElasticSearchIllegalArgumentException("Unknown prefix tree type [" + tree + "]");
  }
  return new GeoShapeFieldMapper(buildNames(context),prefixTree,distanceErrorPct,fieldType,provider);
}
