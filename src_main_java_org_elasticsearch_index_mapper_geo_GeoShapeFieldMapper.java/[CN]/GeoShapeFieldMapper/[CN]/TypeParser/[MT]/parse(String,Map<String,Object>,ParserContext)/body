{
  Builder builder=geoShapeField(name);
  builder.distErrPctDefined=parserContext.indexVersionCreated().before(Version.V_1_6_0);
  for (Iterator<Map.Entry<String,Object>> iterator=node.entrySet().iterator(); iterator.hasNext(); ) {
    Map.Entry<String,Object> entry=iterator.next();
    String fieldName=Strings.toUnderscoreCase(entry.getKey());
    Object fieldNode=entry.getValue();
    if (Names.TREE.equals(fieldName)) {
      builder.tree(fieldNode.toString());
      iterator.remove();
    }
 else     if (Names.TREE_LEVELS.equals(fieldName)) {
      builder.treeLevels(Integer.parseInt(fieldNode.toString()));
      iterator.remove();
    }
 else     if (Names.TREE_PRESISION.equals(fieldName)) {
      builder.treeLevelsByDistance(DistanceUnit.parse(fieldNode.toString(),DistanceUnit.DEFAULT,DistanceUnit.DEFAULT));
      iterator.remove();
    }
 else     if (Names.DISTANCE_ERROR_PCT.equals(fieldName)) {
      builder.distanceErrorPct(Double.parseDouble(fieldNode.toString()));
      builder.distErrPctDefined=true;
      iterator.remove();
    }
 else     if (Names.ORIENTATION.equals(fieldName)) {
      builder.orientation(ShapeBuilder.orientationFromString(fieldNode.toString()));
      iterator.remove();
    }
 else     if (Names.STRATEGY.equals(fieldName)) {
      builder.strategy(fieldNode.toString());
      iterator.remove();
    }
  }
  return builder;
}
