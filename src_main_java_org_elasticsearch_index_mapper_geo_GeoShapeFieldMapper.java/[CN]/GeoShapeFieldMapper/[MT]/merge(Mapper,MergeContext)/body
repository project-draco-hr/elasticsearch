{
  super.merge(mergeWith,mergeContext);
  if (!this.getClass().equals(mergeWith.getClass())) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different field type");
    return;
  }
  final GeoShapeFieldMapper fieldMergeWith=(GeoShapeFieldMapper)mergeWith;
  final PrefixTreeStrategy mergeWithStrategy=fieldMergeWith.defaultStrategy;
  if (!(this.defaultStrategy.getClass().equals(mergeWithStrategy.getClass()))) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different strategy");
  }
  final SpatialPrefixTree grid=this.defaultStrategy.getGrid();
  final SpatialPrefixTree mergeGrid=mergeWithStrategy.getGrid();
  if (!grid.getClass().equals(mergeGrid.getClass())) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different tree");
  }
  if (grid.getMaxLevels() != mergeGrid.getMaxLevels()) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different tree_levels or precision");
  }
  if (mergeContext.hasConflicts() || mergeContext.mergeFlags().simulate()) {
    return;
  }
  this.defaultStrategy.setDistErrPct(mergeWithStrategy.getDistErrPct());
  this.shapeOrientation=fieldMergeWith.shapeOrientation;
}
