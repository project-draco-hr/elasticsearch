{
  ensureNotFrozen();
  version++;
  if (primary) {
    throw new IllegalShardRoutingStateException(this,"Already primary, can't move to primary");
  }
  primary=true;
}
