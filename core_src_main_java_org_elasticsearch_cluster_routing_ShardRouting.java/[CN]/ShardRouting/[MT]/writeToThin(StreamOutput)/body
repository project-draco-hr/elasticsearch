{
  out.writeOptionalString(currentNodeId);
  out.writeOptionalString(relocatingNodeId);
  out.writeBoolean(primary);
  out.writeByte(state.value());
  out.writeOptionalStreamable(restoreSource);
  out.writeOptionalWriteable(unassignedInfo);
  out.writeOptionalWriteable(allocationId);
  if (state == ShardRoutingState.RELOCATING || state == ShardRoutingState.INITIALIZING) {
    out.writeLong(expectedShardSize);
  }
}
