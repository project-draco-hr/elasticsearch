{
  version=in.readLong();
  if (in.readBoolean()) {
    currentNodeId=in.readString();
  }
  if (in.readBoolean()) {
    relocatingNodeId=in.readString();
  }
  primary=in.readBoolean();
  state=ShardRoutingState.fromValue(in.readByte());
  restoreSource=RestoreSource.readOptionalRestoreSource(in);
  if (in.readBoolean()) {
    unassignedInfo=new UnassignedInfo(in);
  }
  if (in.readBoolean()) {
    allocationId=new AllocationId(in);
  }
  if (relocating() || initializing()) {
    expectedShardSize=in.readLong();
  }
 else {
    expectedShardSize=UNAVAILABLE_EXPECTED_SHARD_SIZE;
  }
  freeze();
}
