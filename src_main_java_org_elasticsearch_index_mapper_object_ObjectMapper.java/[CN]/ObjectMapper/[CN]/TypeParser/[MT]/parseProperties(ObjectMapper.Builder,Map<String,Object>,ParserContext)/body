{
  for (  Map.Entry<String,Object> entry : propsNode.entrySet()) {
    String propName=entry.getKey();
    boolean isEmptyList=entry.getValue() instanceof List && ((List<?>)entry.getValue()).isEmpty();
    if (entry.getValue() instanceof Map) {
      @SuppressWarnings("unchecked") Map<String,Object> propNode=(Map<String,Object>)entry.getValue();
      String type;
      Object typeNode=propNode.get("type");
      if (typeNode != null) {
        type=typeNode.toString();
      }
 else {
        if (propNode.get("properties") != null) {
          type=ObjectMapper.CONTENT_TYPE;
        }
 else         if (propNode.size() == 1 && propNode.get("enabled") != null) {
          type=ObjectMapper.CONTENT_TYPE;
        }
 else {
          throw new MapperParsingException("No type specified for property [" + propName + "]");
        }
      }
      Mapper.TypeParser typeParser=parserContext.typeParser(type);
      if (typeParser == null) {
        throw new MapperParsingException("No handler for type [" + type + "] declared on field ["+ propName+ "]");
      }
      objBuilder.add(typeParser.parse(propName,propNode,parserContext));
    }
 else     if (!isEmptyList) {
      throw new MapperParsingException("Expected map for property [fields] on field [" + propName + "] but got a "+ propName.getClass());
    }
  }
}
