{
  TopDocsCollector topDocsCollector=topDocsCollectors.get(bucketOrdinal);
  if (topDocsCollector == null) {
    Sort sort=topHitsContext.sort();
    int topN=topHitsContext.from() + topHitsContext.size();
    topDocsCollectors.put(bucketOrdinal,topDocsCollector=sort != null ? TopFieldCollector.create(sort,topN,true,topHitsContext.trackScores(),topHitsContext.trackScores(),false) : TopScoreDocCollector.create(topN,false));
    topDocsCollector.setNextReader(currentContext);
    topDocsCollector.setScorer(currentScorer);
  }
  topDocsCollector.collect(docId);
}
