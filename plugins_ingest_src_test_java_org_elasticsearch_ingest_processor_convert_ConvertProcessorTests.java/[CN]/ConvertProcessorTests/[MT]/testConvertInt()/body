{
  IngestDocument ingestDocument=RandomDocumentPicks.randomIngestDocument(random());
  Map<String,ConvertProcessor.Type> fields=new HashMap<>();
  Map<String,Integer> expectedResult=new HashMap<>();
  int numFields=randomIntBetween(1,5);
  for (int i=0; i < numFields; i++) {
    int randomInt=randomInt();
    String fieldName=RandomDocumentPicks.addRandomField(random(),ingestDocument,randomInt);
    fields.put(fieldName,Type.INTEGER);
    expectedResult.put(fieldName,randomInt);
  }
  Processor processor=new ConvertProcessor(fields);
  processor.execute(ingestDocument);
  for (  Map.Entry<String,Integer> entry : expectedResult.entrySet()) {
    assertThat(ingestDocument.getPropertyValue(entry.getKey(),Integer.class),equalTo(entry.getValue()));
  }
}
