{
  IngestDocument ingestDocument=RandomDocumentPicks.randomIngestDocument(random());
  Map<String,Type> fields=new HashMap<>();
  Map<String,List<Boolean>> expectedResult=new HashMap<>();
  int numFields=randomIntBetween(1,5);
  for (int i=0; i < numFields; i++) {
    int numItems=randomIntBetween(1,10);
    List<String> fieldValue=new ArrayList<>();
    List<Boolean> expectedList=new ArrayList<>();
    for (int j=0; j < numItems; j++) {
      boolean randomBoolean=randomBoolean();
      String booleanString=Boolean.toString(randomBoolean);
      if (randomBoolean) {
        booleanString=booleanString.toUpperCase(Locale.ROOT);
      }
      fieldValue.add(booleanString);
      expectedList.add(randomBoolean);
    }
    String fieldName=RandomDocumentPicks.addRandomField(random(),ingestDocument,fieldValue);
    fields.put(fieldName,Type.BOOLEAN);
    expectedResult.put(fieldName,expectedList);
  }
  Processor processor=new ConvertProcessor(fields);
  processor.execute(ingestDocument);
  for (  Map.Entry<String,List<Boolean>> entry : expectedResult.entrySet()) {
    assertThat(ingestDocument.getPropertyValue(entry.getKey(),List.class),equalTo(entry.getValue()));
  }
}
