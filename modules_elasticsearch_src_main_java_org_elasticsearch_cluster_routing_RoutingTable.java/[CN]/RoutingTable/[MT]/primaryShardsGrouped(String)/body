{
  GroupShardsIterator its=new GroupShardsIterator();
  if (indices == null || indices.length == 0) {
    indices=indicesRouting.keySet().toArray(new String[indicesRouting.keySet().size()]);
  }
  for (  String index : indices) {
    IndexRoutingTable indexRoutingTable=index(index);
    if (indexRoutingTable == null) {
      throw new IndexMissingException(new Index(index));
    }
    for (    IndexShardRoutingTable indexShardRoutingTable : indexRoutingTable) {
      its.add(indexShardRoutingTable.primaryShard().shardsIt());
    }
  }
  return its;
}
