{
  try {
    client().prepareSearch("idx").addAggregation(filters("tags").filter("tag1",termFilter("tag","tag1")).filter("tag2",termFilter("tag","tag2")).subAggregation(avg("avg_value"))).execute().actionGet();
    fail("expected execution to fail - an attempt to have a context based numeric sub-aggregation, but there is not value source" + "context which the sub-aggregation can inherit");
  }
 catch (  ElasticsearchException ese) {
  }
}
