{
  AtomicReader reader=context.reader();
  Terms terms=reader.terms(getFieldNames().indexName());
  if (terms == null) {
    return ByteArrayAtomicFieldData.EMPTY;
  }
  final TByteArrayList values=new TByteArrayList();
  values.add((byte)0);
  OrdinalsBuilder builder=new OrdinalsBuilder(terms,reader.maxDoc());
  BytesRefIterator iter=builder.buildFromTerms(builder.wrapNumeric32Bit(terms.iterator(null)),reader.getLiveDocs());
  BytesRef term;
  while ((term=iter.next()) != null) {
    values.add((byte)NumericUtils.prefixCodedToInt(term));
  }
  try {
    Ordinals build=builder.build(fieldDataType.getSettings());
    return build(reader,fieldDataType,builder,build,new BuilderBytes(){
      @Override public byte get(      int index){
        return values.get(index);
      }
      @Override public byte[] toArray(){
        return values.toArray();
      }
    }
);
  }
  finally {
    builder.close();
  }
}
