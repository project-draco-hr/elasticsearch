{
  HttpResponse httpResponse=httpGet(Collections.singleton(host),"/_cat/health",Collections.singletonMap("h","cluster"));
  StatusLine statusLine=httpResponse.getStatusLine();
  if (statusLine.getStatusCode() != 200) {
    throw new RuntimeException("failed to fetch nodes: " + statusLine.getReasonPhrase());
  }
  HttpEntity entity=httpResponse.getEntity();
  try (BufferedReader content=new BufferedReader(new InputStreamReader(entity.getContent(),StandardCharsets.UTF_8))){
    String clusterName=content.readLine().trim();
    if (clusterName.length() == 0) {
      throw new IllegalStateException("clustername must not be empty");
    }
    return clusterName;
  }
 }
