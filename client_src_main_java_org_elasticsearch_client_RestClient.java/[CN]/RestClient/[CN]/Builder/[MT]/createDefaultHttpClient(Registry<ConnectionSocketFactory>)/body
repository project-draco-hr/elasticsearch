{
  PoolingHttpClientConnectionManager connectionManager;
  if (socketFactoryRegistry == null) {
    connectionManager=new PoolingHttpClientConnectionManager();
  }
 else {
    connectionManager=new PoolingHttpClientConnectionManager(socketFactoryRegistry);
  }
  connectionManager.setDefaultMaxPerRoute(10);
  connectionManager.setMaxTotal(30);
  RequestConfig requestConfig=RequestConfig.custom().setConnectTimeout(DEFAULT_CONNECT_TIMEOUT).setSocketTimeout(DEFAULT_SOCKET_TIMEOUT).setConnectionRequestTimeout(DEFAULT_CONNECTION_REQUEST_TIMEOUT).build();
  return HttpClientBuilder.create().setConnectionManager(connectionManager).setDefaultRequestConfig(requestConfig).build();
}
