{
  double longitudeDifference=targetLongitude - sourceLongitude;
  double c=Math.toRadians(90D - targetLatitude);
  double factor=(cosA * Math.cos(c)) + (sinA * Math.sin(c) * Math.cos(Math.toRadians(longitudeDifference)));
  if (factor < -1D) {
    return Math.PI * earthRadius;
  }
 else   if (factor >= 1D) {
    return 0;
  }
 else {
    return Math.acos(factor) * earthRadius;
  }
}
