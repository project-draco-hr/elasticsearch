{
  for (  Tuple<PluginInfo,Plugin> plugin : plugins()) {
    List<OnModuleReference> references=onModuleReferences.get(plugin.v2());
    if (references != null) {
      for (      OnModuleReference reference : references) {
        if (reference.moduleClass.isAssignableFrom(module.getClass())) {
          try {
            reference.onModuleMethod.invoke(plugin.v2(),module);
          }
 catch (          IllegalAccessException|InvocationTargetException e) {
            logger.warn("plugin {}, failed to invoke custom onModule method",e,plugin.v1().getName());
            throw new ElasticsearchException("failed to invoke onModule",e);
          }
catch (          Exception e) {
            logger.warn(new ParameterizedMessage("plugin {}, failed to invoke custom onModule method",plugin.v1().getName()),e);
            throw e;
          }
        }
      }
    }
  }
}
