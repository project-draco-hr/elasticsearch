{
  while (true) {
    if (close) {
      closed=true;
      return;
    }
    try {
      client.client().admin().indices().prepareFlush().execute().actionGet();
      Thread.sleep(indexerThrottle.millis());
    }
 catch (    Exception e) {
      logger.warn("failed to flush / sleep",e);
    }
  }
}
