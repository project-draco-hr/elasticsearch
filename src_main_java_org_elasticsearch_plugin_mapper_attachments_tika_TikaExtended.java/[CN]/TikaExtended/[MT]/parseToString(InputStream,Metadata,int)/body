{
  WriteOutContentHandler writeHandler=new WriteOutContentHandler(maxExtractedStringLength);
  BodyContentHandler contentHandler=new BodyContentHandler(writeHandler);
  Parser parser=getParser();
  ParseContext context=new ParseContext();
  context.set(Parser.class,parser);
  try {
    parser.parse(stream,contentHandler,metadata,context);
  }
 catch (  SAXException e) {
    if (!writeHandler.isWriteLimitReached(e)) {
      throw new TikaException("Unexpected SAX processing failure",e);
    }
  }
 finally {
    stream.close();
  }
  return writeHandler.toString();
}
