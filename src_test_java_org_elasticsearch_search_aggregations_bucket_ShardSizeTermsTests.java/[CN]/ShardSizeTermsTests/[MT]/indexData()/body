{
  List<IndexRequestBuilder> indexOps=new ArrayList<IndexRequestBuilder>();
  indexDoc("1","1",5,indexOps);
  indexDoc("1","2",4,indexOps);
  indexDoc("1","3",3,indexOps);
  indexDoc("1","4",2,indexOps);
  indexDoc("1","5",1,indexOps);
  indexDoc("2","1",3,indexOps);
  indexDoc("2","2",1,indexOps);
  indexDoc("2","3",5,indexOps);
  indexDoc("2","4",2,indexOps);
  indexDoc("2","5",1,indexOps);
  indexRandom(true,indexOps);
  long totalOnOne=client().prepareSearch("idx").setTypes("type").setRouting("1").setQuery(matchAllQuery()).execute().actionGet().getHits().getTotalHits();
  assertThat(totalOnOne,is(15l));
  long totalOnTwo=client().prepareSearch("idx").setTypes("type").setRouting("2").setQuery(matchAllQuery()).execute().actionGet().getHits().getTotalHits();
  assertThat(totalOnTwo,is(12l));
  ensureSearchable();
}
