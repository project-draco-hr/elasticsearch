{
  int numIndices=between(1,100);
  String[] indices=new String[numIndices];
  for (int i=0; i < numIndices; i++) {
    indices[i]=randomSimpleString(random(),1,30);
  }
  UpdateByQueryRequest request=new UpdateByQueryRequest(new SearchRequest(indices));
  List<? extends IndicesRequest> subRequests=request.subRequests();
  assertThat(subRequests,hasSize(numIndices + 1));
  for (int i=0; i < numIndices; i++) {
    assertThat(subRequests.get(i).indices(),arrayWithSize(1));
    assertEquals(indices[i],subRequests.get(i).indices()[0]);
  }
  assertThat(subRequests.get(numIndices),sameInstance(request.getSearchRequest()));
}
