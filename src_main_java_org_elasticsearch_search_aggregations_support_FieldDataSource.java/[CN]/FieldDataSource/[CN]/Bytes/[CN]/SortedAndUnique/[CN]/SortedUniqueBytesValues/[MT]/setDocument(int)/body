{
  final int numValues=super.setDocument(docId);
  if (numValues == 0) {
    sortedIds=null;
    return 0;
  }
  bytes.clear();
  bytes.reinit();
  for (int i=0; i < numValues; ++i) {
    bytes.add(super.nextValue(),super.currentValueHash());
  }
  numUniqueValues=bytes.size();
  sortedIds=bytes.sort(BytesRef.getUTF8SortedAsUnicodeComparator());
  pos=0;
  return numUniqueValues;
}
