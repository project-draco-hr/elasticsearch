{
  List<DiscoveryNode> possibleNodes=Lists.newArrayList(nodes);
  if (possibleNodes.isEmpty()) {
    return null;
  }
  for (Iterator<DiscoveryNode> it=possibleNodes.iterator(); it.hasNext(); ) {
    DiscoveryNode node=it.next();
    if (node.attributes().containsKey("zen.master")) {
      if (node.attributes().get("zen.master").equals("false")) {
        it.remove();
      }
    }
  }
  Collections.sort(possibleNodes,nodeComparator);
  return possibleNodes;
}
