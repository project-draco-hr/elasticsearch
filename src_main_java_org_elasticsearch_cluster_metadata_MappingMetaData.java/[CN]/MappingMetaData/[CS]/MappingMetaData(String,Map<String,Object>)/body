{
  this.type=type;
  this.source=new CompressedString(XContentFactory.jsonBuilder().map(mapping).string());
  Map<String,Object> withoutType=mapping;
  if (mapping.size() == 1 && mapping.containsKey(type)) {
    withoutType=(Map<String,Object>)mapping.get(type);
  }
  initMappers(withoutType);
}
