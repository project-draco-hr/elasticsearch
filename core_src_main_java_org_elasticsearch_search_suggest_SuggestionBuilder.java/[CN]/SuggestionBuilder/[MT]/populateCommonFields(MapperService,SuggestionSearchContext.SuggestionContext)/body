{
  if (analyzer != null) {
    Analyzer luceneAnalyzer=mapperService.analysisService().analyzer(analyzer);
    if (luceneAnalyzer == null) {
      throw new IllegalArgumentException("Analyzer [" + luceneAnalyzer + "] doesn't exists");
    }
    suggestionContext.setAnalyzer(luceneAnalyzer);
  }
  if (fieldname != null) {
    suggestionContext.setField(fieldname);
  }
  if (size != null) {
    suggestionContext.setSize(size);
  }
  if (shardSize != null) {
    suggestionContext.setShardSize(shardSize);
  }
 else {
    suggestionContext.setShardSize(Math.max(suggestionContext.getSize(),5));
  }
  if (text != null) {
    suggestionContext.setText(BytesRefs.toBytesRef(text));
  }
  if (prefix != null) {
    suggestionContext.setPrefix(BytesRefs.toBytesRef(prefix));
  }
  if (regex != null) {
    suggestionContext.setRegex(BytesRefs.toBytesRef(regex));
  }
  if (text != null && prefix == null) {
    suggestionContext.setPrefix(BytesRefs.toBytesRef(text));
  }
 else   if (text == null && prefix != null) {
    suggestionContext.setText(BytesRefs.toBytesRef(prefix));
  }
 else   if (text == null && regex != null) {
    suggestionContext.setText(BytesRefs.toBytesRef(regex));
  }
}
