{
  super(index,indexSettings,name,settings);
  List<String> rules=Analysis.getWordList(env,settings,"synonyms");
  if (rules == null) {
    throw new ElasticSearchIllegalArgumentException("synonym requires either `synonyms` or `synonyms_path` to be configured");
  }
  boolean ignoreCase=settings.getAsBoolean("ignore_case",false);
  boolean expand=settings.getAsBoolean("expand",true);
  String tokenizerName=settings.get("tokenizer","whitespace");
  TokenizerFactoryFactory tokenizerFactoryFactory=tokenizerFactories.get(tokenizerName);
  if (tokenizerFactoryFactory == null) {
    tokenizerFactoryFactory=indicesAnalysisService.tokenizerFactoryFactory(tokenizerName);
  }
  if (tokenizerFactoryFactory == null) {
    throw new ElasticSearchIllegalArgumentException("failed to fine tokenizer [" + tokenizerName + "] for synonym token filter");
  }
  TokenizerFactory tokenizerFactory=tokenizerFactoryFactory.create(tokenizerName,settings);
  synonymMap=new SynonymMap(ignoreCase);
  parseRules(rules,synonymMap,"=>",",",expand,tokenizerFactory);
}
