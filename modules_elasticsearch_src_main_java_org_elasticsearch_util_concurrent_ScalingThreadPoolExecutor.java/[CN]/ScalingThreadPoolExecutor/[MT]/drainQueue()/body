{
  List<Runnable> taskList=new ArrayList<Runnable>();
  workQueue.drainTo(taskList);
  queueSize.getAndAdd(taskList.size() * -1);
  while (!workQueue.isEmpty()) {
    Iterator<Runnable> it=workQueue.iterator();
    try {
      if (it.hasNext()) {
        Runnable r=it.next();
        if (workQueue.remove(r)) {
          taskList.add(r);
          queueSize.decrementAndGet();
        }
      }
    }
 catch (    ConcurrentModificationException ignore) {
    }
  }
  return taskList;
}
