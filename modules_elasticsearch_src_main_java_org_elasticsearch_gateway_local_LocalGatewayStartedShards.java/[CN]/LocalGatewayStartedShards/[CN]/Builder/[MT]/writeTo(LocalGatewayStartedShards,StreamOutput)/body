{
  out.writeLong(state.version());
  out.writeVInt(state.shards.size());
  for (  Map.Entry<ShardId,Long> entry : state.shards.entrySet()) {
    entry.getKey().writeTo(out);
    out.writeLong(entry.getValue());
  }
}
