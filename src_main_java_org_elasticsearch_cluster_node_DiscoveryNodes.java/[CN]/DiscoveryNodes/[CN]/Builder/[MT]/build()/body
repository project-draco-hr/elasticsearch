{
  ImmutableOpenMap.Builder<String,DiscoveryNode> dataNodesBuilder=ImmutableOpenMap.builder();
  ImmutableOpenMap.Builder<String,DiscoveryNode> masterNodesBuilder=ImmutableOpenMap.builder();
  for (  ObjectObjectCursor<String,DiscoveryNode> nodeEntry : nodes) {
    if (nodeEntry.value.dataNode()) {
      dataNodesBuilder.put(nodeEntry.key,nodeEntry.value);
    }
    if (nodeEntry.value.masterNode()) {
      masterNodesBuilder.put(nodeEntry.key,nodeEntry.value);
    }
  }
  return new DiscoveryNodes(nodes.build(),dataNodesBuilder.build(),masterNodesBuilder.build(),masterNodeId,localNodeId);
}
