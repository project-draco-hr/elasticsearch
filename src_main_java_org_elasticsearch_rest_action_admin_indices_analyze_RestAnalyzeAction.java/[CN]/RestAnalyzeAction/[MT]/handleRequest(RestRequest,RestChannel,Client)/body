{
  AnalyzeRequest analyzeRequest=new AnalyzeRequest(request.param("index"));
  analyzeRequest.listenerThreaded(false);
  AnalyzeSourceBuilder sourceBuilder=new AnalyzeSourceBuilder();
  sourceBuilder.setAnalyzer(request.param("analyzer"));
  sourceBuilder.setTokenizer(request.param("tokenizer"));
  sourceBuilder.setText(request.param("text"));
  sourceBuilder.setCharFilters(request.paramAsStringArray("char_filters",null));
  sourceBuilder.setTokenFilters(request.paramAsStringArray("token_filters",request.paramAsStringArray("filters",null)));
  sourceBuilder.setField(request.param("field"));
  sourceBuilder.setPreferLocal(request.paramAsBoolean("prefer_local",analyzeRequest.preferLocalShard()));
  if (request.hasContent()) {
    analyzeRequest.source(RestActions.getRestContent(request),request.contentUnsafe());
  }
 else {
    analyzeRequest.source(sourceBuilder);
  }
  client.admin().indices().analyze(analyzeRequest,new RestToXContentListener<AnalyzeResponse>(channel));
}
