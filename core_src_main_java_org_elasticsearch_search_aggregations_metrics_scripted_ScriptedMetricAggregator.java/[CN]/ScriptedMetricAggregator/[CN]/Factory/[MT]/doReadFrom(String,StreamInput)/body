{
  Factory factory=new Factory(name);
  factory.initScript=in.readOptionalStreamable(Script.SUPPLIER);
  factory.mapScript=in.readOptionalStreamable(Script.SUPPLIER);
  factory.combineScript=in.readOptionalStreamable(Script.SUPPLIER);
  factory.reduceScript=in.readOptionalStreamable(Script.SUPPLIER);
  if (in.readBoolean()) {
    factory.params=in.readMap();
  }
  return factory;
}
