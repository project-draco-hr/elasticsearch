{
  XContentBuilder builder=channel.newBuilder().startObject();
  if (t == null) {
    builder.field("error","Unknown");
  }
 else   if (channel.detailedErrorsEnabled()) {
    builder.field("error",detailedMessage(t));
    if (channel.request().paramAsBoolean("error_trace",false)) {
      buildErrorTrace(t,builder);
    }
  }
 else {
    builder.field("error",simpleMessage(t));
  }
  builder.field("status",status.getStatus());
  builder.endObject();
  return builder;
}
