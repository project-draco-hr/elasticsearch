{
  Settings.Builder settingsBuilder=Settings.builder().put("node.data",false).put("node.master",true).put("path.data",createTempDir().toString());
  internalCluster().startNode(settingsBuilder.build());
  createIndex("test");
  SealIndicesResponse sealIndicesResponse=client().admin().indices().prepareSealIndices("test").get();
  int numShards=client().admin().indices().prepareGetSettings("test").get().getIndexToSettings().get("test").getAsInt(IndexMetaData.SETTING_NUMBER_OF_SHARDS,-1);
  assertThat(sealIndicesResponse.results().size(),equalTo(numShards));
  assertThat(sealIndicesResponse.results().iterator().next().failureReason(),equalTo("no active primary available"));
}
