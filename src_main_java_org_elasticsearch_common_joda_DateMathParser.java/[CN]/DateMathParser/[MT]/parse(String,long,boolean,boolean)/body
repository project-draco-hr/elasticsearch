{
  long time;
  String mathString;
  if (text.startsWith("now")) {
    time=now;
    mathString=text.substring("now".length());
  }
 else {
    int index=text.indexOf("||");
    String parseString;
    if (index == -1) {
      parseString=text;
      mathString="";
    }
 else {
      parseString=text.substring(0,index);
      mathString=text.substring(index + 2);
    }
    if (upperInclusive) {
      time=parseUpperInclusiveStringValue(parseString);
    }
 else {
      time=parseStringValue(parseString);
    }
  }
  if (mathString.isEmpty()) {
    return time;
  }
  return parseMath(mathString,time,roundUp);
}
