{
  if (value.length() > 4 && StringUtils.isNumeric(value)) {
    try {
      long time=Long.parseLong(value);
      return timeUnit.toMillis(time);
    }
 catch (    NumberFormatException e) {
      throw new ElasticsearchParseException("failed to parse date field [" + value + "] as timestamp",e);
    }
  }
  DateTimeFormatter parser=dateTimeFormatter.parser();
  if (timeZone != null) {
    parser=parser.withZone(timeZone);
  }
  try {
    return parser.parseMillis(value);
  }
 catch (  IllegalArgumentException e) {
    throw new ElasticsearchParseException("failed to parse date field [" + value + "] with format ["+ dateTimeFormatter.format()+ "]",e);
  }
}
