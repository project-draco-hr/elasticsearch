{
  ClusterState state=ClusterState.builder(new ClusterName("_name")).metaData(MetaData.builder().build()).build();
  IndexNameExpressionResolver indexNameExpressionResolver=new IndexNameExpressionResolver();
  IndicesOptions options=IndicesOptions.strictExpandOpen();
  IndexNameExpressionResolver.Context context=new IndexNameExpressionResolver.Context(state,options);
  String[] results=indexNameExpressionResolver.concreteIndices(context,Strings.EMPTY_ARRAY);
  assertThat(results,emptyArray());
  try {
    indexNameExpressionResolver.concreteIndices(context,"foo");
    fail();
  }
 catch (  IndexMissingException e) {
    assertThat(e.index().name(),equalTo("foo"));
  }
  results=indexNameExpressionResolver.concreteIndices(context,"foo*");
  assertThat(results,emptyArray());
  try {
    indexNameExpressionResolver.concreteIndices(context,"foo*","bar");
    fail();
  }
 catch (  IndexMissingException e) {
    assertThat(e.index().name(),equalTo("bar"));
  }
  context=new IndexNameExpressionResolver.Context(state,IndicesOptions.lenientExpandOpen());
  results=indexNameExpressionResolver.concreteIndices(context,Strings.EMPTY_ARRAY);
  assertThat(results,emptyArray());
  results=indexNameExpressionResolver.concreteIndices(context,"foo");
  assertThat(results,emptyArray());
  results=indexNameExpressionResolver.concreteIndices(context,"foo*");
  assertThat(results,emptyArray());
  results=indexNameExpressionResolver.concreteIndices(context,"foo*","bar");
  assertThat(results,emptyArray());
  context=new IndexNameExpressionResolver.Context(state,IndicesOptions.fromOptions(true,false,true,false));
  try {
    indexNameExpressionResolver.concreteIndices(context,Strings.EMPTY_ARRAY);
  }
 catch (  IndexMissingException e) {
    assertThat(e.index().name(),equalTo("[_all]"));
  }
}
