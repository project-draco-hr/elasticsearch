{
  if (query instanceof FunctionScoreQuery) {
    query=((FunctionScoreQuery)query).getSubQuery();
    extract(query,query.getBoost(),terms);
  }
 else   if (query instanceof FiltersFunctionScoreQuery) {
    query=((FiltersFunctionScoreQuery)query).getSubQuery();
    extract(query,query.getBoost(),terms);
  }
 else   if (query instanceof FilteredQuery) {
    query=((FilteredQuery)query).getQuery();
    extract(query,1F,terms);
  }
 else {
    extractWeightedTerms(terms,query,query.getBoost());
  }
}
