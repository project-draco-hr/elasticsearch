{
  List<InjectionPoint> sink=Lists.newArrayList();
  Errors errors=new Errors();
  addInjectionPoints(type,Factory.FIELDS,true,sink,errors);
  addInjectionPoints(type,Factory.METHODS,true,sink,errors);
  ImmutableSet<InjectionPoint> result=ImmutableSet.copyOf(sink);
  if (errors.hasErrors()) {
    throw new ConfigurationException(errors.getMessages()).withPartialValue(result);
  }
  return result;
}
