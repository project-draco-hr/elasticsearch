{
  prepareCreate("test-idx").addMapping("doc",XContentFactory.jsonBuilder().startObject().startObject("doc").startObject("properties").startObject("f").field("type",RegisterExternalTypes.EXTERNAL_UPPER).startObject("fields").startObject("f").field("type","string").field("store","yes").startObject("fields").startObject("raw").field("type","string").field("index","not_analyzed").field("store","yes").endObject().endObject().endObject().endObject().endObject().endObject().endObject().endObject()).execute().get();
  ensureYellow("test-idx");
  index("test-idx","doc","1","f","This is my text");
  refresh();
  SearchResponse response=client().prepareSearch("test-idx").setQuery(QueryBuilders.termQuery("f.f.raw","FOO BAR")).execute().actionGet();
  assertThat(response.getHits().totalHits(),equalTo((long)1));
}
