{
  try {
    SearchResponse response=client().prepareSearch("idx").setTypes("type").addAggregation(terms("terms").collectMode(randomFrom(SubAggCollectionMode.values())).script("doc['" + MULTI_VALUED_FIELD_NAME + "']").subAggregation(sum("sum"))).execute().actionGet();
    fail("expected to fail as sub-aggregation sum requires a numeric value source context, but there is none");
  }
 catch (  Exception e) {
  }
}
