{
  try {
    SearchResponse response=client().prepareSearch("idx").setTypes("type").addAggregation(terms("terms").script("doc['values'].values").subAggregation(sum("sum"))).execute().actionGet();
    fail("expected to fail as sub-aggregation sum requires a numeric value source context, but there is none");
  }
 catch (  Exception e) {
  }
}
