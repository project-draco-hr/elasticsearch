{
  SnapshotException ex=serialize(new SnapshotException(new SnapshotId("repo","snap"),"no such snapshot",new NullPointerException()));
  assertEquals(ex.snapshot(),new SnapshotId("repo","snap"));
  assertEquals(ex.getMessage(),"[repo:snap] no such snapshot");
  assertTrue(ex.getCause() instanceof NullPointerException);
  ex=serialize(new SnapshotException(null,"no such snapshot",new NullPointerException()));
  assertEquals(ex.snapshot(),null);
  assertEquals(ex.getMessage(),"[_na] no such snapshot");
  assertTrue(ex.getCause() instanceof NullPointerException);
}
