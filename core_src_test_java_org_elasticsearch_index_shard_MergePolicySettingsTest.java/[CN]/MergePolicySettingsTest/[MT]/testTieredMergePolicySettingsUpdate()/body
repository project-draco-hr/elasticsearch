{
  MergePolicyConfig mp=new MergePolicyConfig(logger,EMPTY_SETTINGS);
  assertThat(mp.getMergePolicy().getNoCFSRatio(),equalTo(0.1));
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getForceMergeDeletesPctAllowed(),MergePolicyConfig.DEFAULT_EXPUNGE_DELETES_ALLOWED,0.0d);
  mp.onRefreshSettings(Settings.builder().put(MergePolicyConfig.INDEX_MERGE_POLICY_EXPUNGE_DELETES_ALLOWED,MergePolicyConfig.DEFAULT_EXPUNGE_DELETES_ALLOWED + 1.0d).build());
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getForceMergeDeletesPctAllowed(),MergePolicyConfig.DEFAULT_EXPUNGE_DELETES_ALLOWED + 1.0d,0.0d);
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getFloorSegmentMB(),MergePolicyConfig.DEFAULT_FLOOR_SEGMENT.mbFrac(),0);
  mp.onRefreshSettings(Settings.builder().put(MergePolicyConfig.INDEX_MERGE_POLICY_FLOOR_SEGMENT,new ByteSizeValue(MergePolicyConfig.DEFAULT_FLOOR_SEGMENT.mb() + 1,ByteSizeUnit.MB)).build());
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getFloorSegmentMB(),new ByteSizeValue(MergePolicyConfig.DEFAULT_FLOOR_SEGMENT.mb() + 1,ByteSizeUnit.MB).mbFrac(),0.001);
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getMaxMergeAtOnce(),MergePolicyConfig.DEFAULT_MAX_MERGE_AT_ONCE);
  mp.onRefreshSettings(Settings.builder().put(MergePolicyConfig.INDEX_MERGE_POLICY_MAX_MERGE_AT_ONCE,MergePolicyConfig.DEFAULT_MAX_MERGE_AT_ONCE - 1).build());
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getMaxMergeAtOnce(),MergePolicyConfig.DEFAULT_MAX_MERGE_AT_ONCE - 1);
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getMaxMergeAtOnceExplicit(),MergePolicyConfig.DEFAULT_MAX_MERGE_AT_ONCE_EXPLICIT);
  mp.onRefreshSettings(Settings.builder().put(MergePolicyConfig.INDEX_MERGE_POLICY_MAX_MERGE_AT_ONCE_EXPLICIT,MergePolicyConfig.DEFAULT_MAX_MERGE_AT_ONCE_EXPLICIT - 1).build());
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getMaxMergeAtOnceExplicit(),MergePolicyConfig.DEFAULT_MAX_MERGE_AT_ONCE_EXPLICIT - 1);
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getMaxMergedSegmentMB(),MergePolicyConfig.DEFAULT_MAX_MERGED_SEGMENT.mbFrac(),0.0001);
  mp.onRefreshSettings(Settings.builder().put(MergePolicyConfig.INDEX_MERGE_POLICY_MAX_MERGED_SEGMENT,new ByteSizeValue(MergePolicyConfig.DEFAULT_MAX_MERGED_SEGMENT.bytes() + 1)).build());
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getMaxMergedSegmentMB(),new ByteSizeValue(MergePolicyConfig.DEFAULT_MAX_MERGED_SEGMENT.bytes() + 1).mbFrac(),0.0001);
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getReclaimDeletesWeight(),MergePolicyConfig.DEFAULT_RECLAIM_DELETES_WEIGHT,0);
  mp.onRefreshSettings(Settings.builder().put(MergePolicyConfig.INDEX_MERGE_POLICY_RECLAIM_DELETES_WEIGHT,MergePolicyConfig.DEFAULT_RECLAIM_DELETES_WEIGHT + 1).build());
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getReclaimDeletesWeight(),MergePolicyConfig.DEFAULT_RECLAIM_DELETES_WEIGHT + 1,0);
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getSegmentsPerTier(),MergePolicyConfig.DEFAULT_SEGMENTS_PER_TIER,0);
  mp.onRefreshSettings(Settings.builder().put(MergePolicyConfig.INDEX_MERGE_POLICY_SEGMENTS_PER_TIER,MergePolicyConfig.DEFAULT_SEGMENTS_PER_TIER + 1).build());
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getSegmentsPerTier(),MergePolicyConfig.DEFAULT_SEGMENTS_PER_TIER + 1,0);
  mp.onRefreshSettings(EMPTY_SETTINGS);
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getForceMergeDeletesPctAllowed(),MergePolicyConfig.DEFAULT_EXPUNGE_DELETES_ALLOWED + 1.0d,0.0d);
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getFloorSegmentMB(),new ByteSizeValue(MergePolicyConfig.DEFAULT_FLOOR_SEGMENT.mb() + 1,ByteSizeUnit.MB).mbFrac(),0.001);
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getMaxMergeAtOnce(),MergePolicyConfig.DEFAULT_MAX_MERGE_AT_ONCE - 1);
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getMaxMergeAtOnceExplicit(),MergePolicyConfig.DEFAULT_MAX_MERGE_AT_ONCE_EXPLICIT - 1);
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getMaxMergedSegmentMB(),new ByteSizeValue(MergePolicyConfig.DEFAULT_MAX_MERGED_SEGMENT.bytes() + 1).mbFrac(),0.0001);
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getReclaimDeletesWeight(),MergePolicyConfig.DEFAULT_RECLAIM_DELETES_WEIGHT + 1,0);
  assertEquals(((TieredMergePolicy)mp.getMergePolicy()).getSegmentsPerTier(),MergePolicyConfig.DEFAULT_SEGMENTS_PER_TIER + 1,0);
}
