{
  builder.startObject(getName());
  if (this.metaData != null) {
    builder.field("meta",this.metaData);
  }
  builder.field(type);
  internalXContent(builder,params);
  if (aggregations != null || aggregatorFactories != null || pipelineAggregatorFactories != null || aggregationsBinary != null) {
    if (aggregations != null || aggregatorFactories != null || pipelineAggregatorFactories != null) {
      builder.startObject("aggregations");
      if (aggregations != null) {
        for (        AbstractAggregationBuilder subAgg : aggregations) {
          subAgg.toXContent(builder,params);
        }
      }
      if (aggregatorFactories != null) {
        for (        AggregatorFactory subAgg : aggregatorFactories) {
          subAgg.toXContent(builder,params);
        }
      }
      if (pipelineAggregatorFactories != null) {
        for (        PipelineAggregatorFactory subAgg : pipelineAggregatorFactories) {
          subAgg.toXContent(builder,params);
        }
      }
      builder.endObject();
    }
    if (aggregationsBinary != null) {
      if (XContentFactory.xContentType(aggregationsBinary) == builder.contentType()) {
        builder.rawField("aggregations",aggregationsBinary);
      }
 else {
        builder.field("aggregations_binary",aggregationsBinary);
      }
    }
  }
  return builder.endObject();
}
