{
switch (method) {
case TDIGEST:
    return new TDigestPercentilesAggregator(name,valuesSource,aggregationContext,parent,percents,compression,keyed,config.formatter(),pipelineAggregators,metaData);
case HDR:
  return new HDRPercentilesAggregator(name,valuesSource,aggregationContext,parent,percents,numberOfSignificantValueDigits,keyed,config.formatter(),pipelineAggregators,metaData);
default :
throw new IllegalStateException("Illegal method [" + method.getName() + "]");
}
}
