{
  if (obj instanceof Map) {
    @SuppressWarnings("unchecked") Map<String,Object> doc=(Map)obj;
    Iterator<Map.Entry<String,Object>> it=doc.entrySet().iterator();
    Map<String,Object> deDottedFields=new HashMap<>();
    while (it.hasNext()) {
      Map.Entry<String,Object> entry=it.next();
      deDot(entry.getValue());
      String fieldName=entry.getKey();
      if (fieldName.contains(".")) {
        String deDottedFieldName=fieldName.replaceAll("\\.",separator);
        deDottedFields.put(deDottedFieldName,entry.getValue());
        it.remove();
      }
    }
    doc.putAll(deDottedFields);
  }
 else   if (obj instanceof List) {
    @SuppressWarnings("unchecked") List<Object> list=(List)obj;
    for (    Object value : list) {
      deDot(value);
    }
  }
}
