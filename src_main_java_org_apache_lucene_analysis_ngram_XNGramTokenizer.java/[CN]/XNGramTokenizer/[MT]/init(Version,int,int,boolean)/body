{
  if (!version.onOrAfter(Version.LUCENE_43)) {
    throw new IllegalArgumentException("This class only works with Lucene 4.4+. To emulate the old (broken) behavior of NGramTokenizer, use Lucene43NGramTokenizer/Lucene43EdgeNGramTokenizer");
  }
  charUtils=version.onOrAfter(Version.LUCENE_43) ? XCharacterUtils.getInstance(version) : XCharacterUtils.getJava4Instance();
  if (minGram < 1) {
    throw new IllegalArgumentException("minGram must be greater than zero");
  }
  if (minGram > maxGram) {
    throw new IllegalArgumentException("minGram must not be greater than maxGram");
  }
  this.minGram=minGram;
  this.maxGram=maxGram;
  this.edgesOnly=edgesOnly;
  charBuffer=XCharacterUtils.newCharacterBuffer(2 * maxGram + 1024);
  buffer=new int[charBuffer.getBuffer().length];
  termAtt.resizeBuffer(2 * maxGram);
}
