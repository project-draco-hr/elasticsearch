{
  ShapeBuilder shape=RandomShapeGenerator.createShapeWithin(getRandom(),null);
  GeoShapeQueryBuilder builder;
  if (randomBoolean()) {
    try {
      builder=new GeoShapeQueryBuilder(GEO_SHAPE_FIELD_NAME,shape);
    }
 catch (    IOException e) {
      throw new RuntimeException(e);
    }
  }
 else {
    indexedShapeToReturn=shape;
    indexedShapeId=randomAsciiOfLengthBetween(3,20);
    indexedShapeType=randomAsciiOfLengthBetween(3,20);
    builder=new GeoShapeQueryBuilder(GEO_SHAPE_FIELD_NAME,indexedShapeId,indexedShapeType);
    if (randomBoolean()) {
      indexedShapeIndex=randomAsciiOfLengthBetween(3,20);
      builder.indexedShapeIndex(indexedShapeIndex);
    }
    if (randomBoolean()) {
      indexedShapePath=randomAsciiOfLengthBetween(3,20);
      builder.indexedShapePath(indexedShapePath);
    }
  }
  SpatialStrategy strategy=randomFrom(SpatialStrategy.values());
  builder.strategy(strategy);
  if (strategy != SpatialStrategy.TERM) {
    builder.relation(randomFrom(ShapeRelation.values()));
  }
  return builder;
}
