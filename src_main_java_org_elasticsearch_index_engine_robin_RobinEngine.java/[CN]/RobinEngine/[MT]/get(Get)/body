{
  rwl.readLock().lock();
  try {
    if (get.realtime()) {
      VersionValue versionValue=versionMap.get(get.uid().text());
      if (versionValue != null) {
        if (versionValue.delete()) {
          return GetResult.NOT_EXISTS;
        }
        if (!get.loadSource()) {
          return new GetResult(true,versionValue.version(),null);
        }
        byte[] data=translog.read(versionValue.translogLocation());
        if (data != null) {
          try {
            Translog.Source source=TranslogStreams.readSource(data);
            return new GetResult(true,versionValue.version(),source);
          }
 catch (          IOException e) {
          }
        }
      }
    }
    Searcher searcher=searcher();
    try {
      List<AtomicReaderContext> readers=searcher.reader().leaves();
      for (int i=0; i < readers.size(); i++) {
        AtomicReaderContext readerContext=readers.get(i);
        UidField.DocIdAndVersion docIdAndVersion=UidField.loadDocIdAndVersion(readerContext,get.uid());
        if (docIdAndVersion != null && docIdAndVersion.docId != Lucene.NO_DOC) {
          return new GetResult(searcher,docIdAndVersion);
        }
      }
    }
 catch (    Exception e) {
      throw new EngineException(shardId(),"failed to load document",e);
    }
 finally {
      searcher.release();
    }
    return GetResult.NOT_EXISTS;
  }
  finally {
    rwl.readLock().unlock();
  }
}
