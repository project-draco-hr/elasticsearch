{
  rwl.readLock().lock();
  try {
    if (get.realtime()) {
      VersionValue versionValue=versionMap.get(get.uid().text());
      if (versionValue != null) {
        if (versionValue.delete()) {
          return GetResult.NOT_EXISTS;
        }
        if (!get.loadSource()) {
          return new GetResult(true,versionValue.version(),null);
        }
        byte[] data=translog.read(versionValue.translogLocation());
        if (data != null) {
          try {
            Translog.Source source=TranslogStreams.readSource(data);
            return new GetResult(true,versionValue.version(),source);
          }
 catch (          IOException e) {
          }
        }
      }
    }
    Searcher searcher=searcher();
    try {
      UnicodeUtil.UTF8Result utf8=Unicode.fromStringAsUtf8(get.uid().text());
      for (int i=0; i < searcher.searcher().subReaders().length; i++) {
        IndexReader subReader=searcher.searcher().subReaders()[i];
        BloomFilter filter=bloomCache.filter(subReader,UidFieldMapper.NAME,asyncLoadBloomFilter);
        if (!filter.isPresent(utf8.result,0,utf8.length)) {
          continue;
        }
        int docStart=searcher.searcher().docStarts()[i];
        UidField.DocIdAndVersion docIdAndVersion=UidField.loadDocIdAndVersion(subReader,docStart,get.uid());
        if (docIdAndVersion != null && docIdAndVersion.docId != Lucene.NO_DOC) {
          return new GetResult(searcher,docIdAndVersion);
        }
      }
    }
 catch (    Exception e) {
      searcher.release();
      throw new EngineException(shardId(),"failed to load document",e);
    }
    searcher.release();
    return GetResult.NOT_EXISTS;
  }
  finally {
    rwl.readLock().unlock();
  }
}
