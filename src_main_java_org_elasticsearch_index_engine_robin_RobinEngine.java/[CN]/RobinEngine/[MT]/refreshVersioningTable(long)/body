{
  refresh(new Refresh().force(true).source("version_table"));
  for (  Map.Entry<HashedBytesRef,VersionValue> entry : versionMap.entrySet()) {
    HashedBytesRef uid=entry.getKey();
synchronized (dirtyLock(uid.bytes)) {
      VersionValue versionValue=versionMap.get(uid);
      if (versionValue == null) {
        continue;
      }
      if (time - versionValue.time() <= 0) {
        continue;
      }
      if (versionValue.delete()) {
        if (enableGcDeletes && (time - versionValue.time()) > gcDeletesInMillis) {
          versionMap.remove(uid);
        }
      }
 else {
        versionMap.remove(uid);
      }
    }
  }
}
