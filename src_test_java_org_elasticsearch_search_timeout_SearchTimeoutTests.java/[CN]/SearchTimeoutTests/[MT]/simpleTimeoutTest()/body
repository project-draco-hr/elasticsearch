{
  createIndex("test");
  for (int i=0; i < 10; i++) {
    client().prepareIndex("test","type",Integer.toString(i)).setSource("field","value").execute().actionGet();
  }
  refresh();
  SearchResponse searchResponse=client().prepareSearch("test").setTimeout("10ms").setQuery(filteredQuery(matchAllQuery(),scriptFilter("Thread.sleep(100); return true;"))).execute().actionGet();
  assertThat(searchResponse.isTimedOut(),equalTo(true));
}
