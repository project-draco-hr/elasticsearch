{
  XMoreLikeThis mlt=new XMoreLikeThis(reader,similarity == null ? new DefaultSimilarity() : similarity);
  mlt.setFieldNames(moreLikeFields);
  mlt.setAnalyzer(analyzer);
  mlt.setMinTermFreq(minTermFrequency);
  mlt.setMinDocFreq(minDocFreq);
  mlt.setMaxDocFreq(maxDocFreq);
  mlt.setMaxQueryTerms(maxQueryTerms);
  mlt.setMinWordLen(minWordLen);
  mlt.setMaxWordLen(maxWordLen);
  mlt.setStopWords(stopWords);
  mlt.setBoost(boostTerms);
  mlt.setBoostFactor(boostTermsFactor);
  BooleanQuery bq=new BooleanQuery();
  if (this.likeFields != null) {
    bq.add((BooleanQuery)mlt.like(this.likeFields),BooleanClause.Occur.SHOULD);
  }
  if (this.likeText != null) {
    Reader[] readers=new Reader[likeText.length];
    for (int i=0; i < readers.length; i++) {
      readers[i]=new FastStringReader(likeText[i]);
    }
    bq.add((BooleanQuery)mlt.like(moreLikeFields[0],readers),BooleanClause.Occur.SHOULD);
  }
  BooleanClause[] clauses=bq.getClauses();
  bq.setMinimumNumberShouldMatch((int)(clauses.length * percentTermsToMatch));
  bq.setBoost(getBoost());
  return bq;
}
