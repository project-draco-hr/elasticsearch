{
  int index=-1;
  PageSet<? extends StorageMetadata> pageSet=blobStoreContext.getBlobStore().list(container,inDirectory(metaDataDirectory).maxResults(1000));
  for (  StorageMetadata storageMetadata : pageSet) {
    if (logger.isTraceEnabled()) {
      logger.trace("[findLatestMetadata]: Processing blob [" + storageMetadata.getName() + "]");
    }
    if (!storageMetadata.getName().contains("metadata-")) {
      continue;
    }
    int fileIndex=Integer.parseInt(storageMetadata.getName().substring(storageMetadata.getName().lastIndexOf('-') + 1));
    if (fileIndex >= index) {
      try {
        readMetaData(storageMetadata.getName());
        index=fileIndex;
      }
 catch (      IOException e) {
        logger.warn("[findLatestMetadata]: Failed to read metadata from [" + storageMetadata.getName() + "], ignoring...",e);
      }
    }
  }
  return index;
}
