{
  super(settings);
  this.clusterName=clusterName;
  this.blobStoreService=blobStoreService;
  String container=componentSettings.get("container");
  if (container == null) {
    throw new ElasticSearchIllegalArgumentException("Cloud gateway requires 'container' setting");
  }
  this.location=componentSettings.get("location");
  this.container=container + "." + clusterName.value();
  blobStoreService.context().getBlobStore().createContainerInLocation(location,container);
  if (blobStoreService.context() == null) {
    throw new ElasticSearchIllegalStateException("No cloud setting is configure");
  }
  this.currentIndex=findLatestIndex();
  logger.debug("Latest metadata found at index [" + currentIndex + "]");
}
