{
  Suggesters suggesters=new Suggesters(Collections.emptyMap());
  QueryParseContext context=new QueryParseContext(null);
  context.parseFieldMatcher(new ParseFieldMatcher(Settings.EMPTY));
  for (int runs=0; runs < NUMBER_OF_RUNS; runs++) {
    SuggestBuilder suggestBuilder=createTestModel();
    XContentBuilder xContentBuilder=XContentFactory.contentBuilder(randomFrom(XContentType.values()));
    if (randomBoolean()) {
      xContentBuilder.prettyPrint();
    }
    suggestBuilder.toXContent(xContentBuilder,ToXContent.EMPTY_PARAMS);
    XContentParser parser=XContentHelper.createParser(xContentBuilder.bytes());
    context.reset(parser);
    SuggestBuilder secondSuggestBuilder=SuggestBuilder.fromXContent(context,suggesters);
    assertNotSame(suggestBuilder,secondSuggestBuilder);
    assertEquals(suggestBuilder,secondSuggestBuilder);
    assertEquals(suggestBuilder.hashCode(),secondSuggestBuilder.hashCode());
  }
}
