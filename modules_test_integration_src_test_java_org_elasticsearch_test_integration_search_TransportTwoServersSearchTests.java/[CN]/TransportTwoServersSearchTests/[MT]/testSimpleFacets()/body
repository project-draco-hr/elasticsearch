{
  SearchSourceBuilder sourceBuilder=searchSource().query(termQuery("multi","test")).from(0).size(20).explain(true).facets(facets().queryFacet("all",termQuery("multi","test"),true).queryFacet("test1",termQuery("name","test1")));
  SearchResponse searchResponse=client.search(searchRequest("test").source(sourceBuilder)).actionGet();
  assertThat("Failures " + Arrays.toString(searchResponse.shardFailures()),searchResponse.shardFailures().length,equalTo(0));
  assertThat(searchResponse.hits().totalHits(),equalTo(100l));
  assertThat(searchResponse.facets().countFacet("test1").count(),equalTo(1l));
  assertThat(searchResponse.facets().countFacet("all").count(),equalTo(100l));
}
