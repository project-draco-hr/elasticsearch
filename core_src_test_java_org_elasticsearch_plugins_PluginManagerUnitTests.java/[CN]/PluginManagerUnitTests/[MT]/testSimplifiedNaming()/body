{
  String pluginName=randomAsciiOfLength(10);
  PluginManager.PluginHandle handle=PluginManager.PluginHandle.parse(pluginName);
  assertThat(handle.urls(),hasSize(Version.CURRENT.snapshot() ? 2 : 1));
  Iterator<URL> iterator=handle.urls().iterator();
  if (Version.CURRENT.snapshot()) {
    String expectedSnapshotUrl=String.format(Locale.ROOT,"http://download.elastic.co/elasticsearch/snapshot/org/elasticsearch/plugin/%s/%s-SNAPSHOT/%s-%s-SNAPSHOT.zip",pluginName,Version.CURRENT.number(),pluginName,Version.CURRENT.number());
    assertThat(iterator.next(),is(new URL(expectedSnapshotUrl)));
  }
  URL expected=new URL("http","download.elastic.co","/elasticsearch/release/org/elasticsearch/plugin/" + pluginName + "/"+ Version.CURRENT.number()+ "/"+ pluginName+ "-"+ Version.CURRENT.number()+ ".zip");
  assertThat(iterator.next(),is(expected));
}
