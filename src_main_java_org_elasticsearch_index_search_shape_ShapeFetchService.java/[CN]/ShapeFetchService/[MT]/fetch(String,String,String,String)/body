{
  GetResponse response=client.get(new GetRequest(index,type,id).preference("_local").operationThreaded(false)).actionGet();
  if (!response.isExists()) {
    throw new IllegalArgumentException("Shape with ID [" + id + "] in type ["+ type+ "] not found");
  }
  String[] pathElements=Strings.splitStringToArray(path,'.');
  int currentPathSlot=0;
  XContentParser parser=null;
  try {
    parser=XContentHelper.createParser(response.getSourceAsBytesRef());
    XContentParser.Token currentToken;
    while ((currentToken=parser.nextToken()) != XContentParser.Token.END_OBJECT) {
      if (currentToken == XContentParser.Token.FIELD_NAME) {
        if (pathElements[currentPathSlot].equals(parser.currentName())) {
          parser.nextToken();
          if (++currentPathSlot == pathElements.length) {
            return ShapeBuilder.parse(parser);
          }
        }
 else {
          parser.nextToken();
          parser.skipChildren();
        }
      }
    }
    throw new IllegalStateException("Shape with name [" + id + "] found but missing "+ path+ " field");
  }
  finally {
    if (parser != null) {
      parser.close();
    }
  }
}
