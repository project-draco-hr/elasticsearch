{
  out.writeByte(order.id());
  if (order instanceof Aggregation) {
    out.writeBoolean(((MultiBucketsAggregation.Bucket.SubAggregationComparator)order.comparator).asc());
    OrderPath path=((Aggregation)order).path();
    if (out.getVersion().onOrAfter(Version.V_1_1_0)) {
      out.writeString(path.toString());
    }
 else {
      OrderPath.Token token=path.lastToken();
      out.writeString(token.name);
      boolean hasValueName=token.key != null;
      out.writeBoolean(hasValueName);
      if (hasValueName) {
        out.writeString(token.key);
      }
    }
  }
}
