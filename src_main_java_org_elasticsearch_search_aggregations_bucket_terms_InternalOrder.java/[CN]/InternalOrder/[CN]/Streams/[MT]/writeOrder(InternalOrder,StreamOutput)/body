{
  out.writeByte(order.id());
  if (order instanceof Aggregation) {
    out.writeBoolean(((Terms.Bucket.Comparator)order.comparator).asc());
    out.writeString(((Terms.Bucket.Comparator)order.comparator).aggName());
    boolean hasValueName=((Terms.Bucket.Comparator)order.comparator).aggName() != null;
    out.writeBoolean(hasValueName);
    if (hasValueName) {
      out.writeString(((Terms.Bucket.Comparator)order.comparator).valueName());
    }
  }
}
