{
  byte id=in.readByte();
switch (id) {
case 1:
    return InternalOrder.COUNT_DESC;
case 2:
  return InternalOrder.COUNT_ASC;
case 3:
return InternalOrder.TERM_DESC;
case 4:
return InternalOrder.TERM_ASC;
case 0:
boolean asc=in.readBoolean();
String key=in.readString();
if (in.getVersion().onOrAfter(Version.V_1_1_0)) {
return new InternalOrder.Aggregation(key,asc);
}
boolean hasValueNmae=in.readBoolean();
if (hasValueNmae) {
return new InternalOrder.Aggregation(key + "." + in.readString(),asc);
}
return new InternalOrder.Aggregation(key,asc);
default :
throw new RuntimeException("unknown terms order");
}
}
