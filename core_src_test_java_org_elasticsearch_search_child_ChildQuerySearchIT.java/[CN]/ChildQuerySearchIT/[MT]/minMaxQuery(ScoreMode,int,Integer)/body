{
  HasChildQueryBuilder hasChildQuery=hasChildQuery("child",QueryBuilders.functionScoreQuery(constantScoreQuery(QueryBuilders.termQuery("foo","two")),new FunctionScoreQueryBuilder.FilterFunctionBuilder[]{new FunctionScoreQueryBuilder.FilterFunctionBuilder(weightFactorFunction(1)),new FunctionScoreQueryBuilder.FilterFunctionBuilder(QueryBuilders.termQuery("foo","three"),weightFactorFunction(1)),new FunctionScoreQueryBuilder.FilterFunctionBuilder(QueryBuilders.termQuery("foo","four"),weightFactorFunction(1))}).boostMode(CombineFunction.REPLACE).scoreMode(FiltersFunctionScoreQuery.ScoreMode.SUM)).scoreMode(scoreMode).minChildren(minChildren);
  if (maxChildren != null) {
    hasChildQuery.maxChildren(maxChildren);
  }
  return client().prepareSearch("test").setQuery(hasChildQuery).addSort("_score",SortOrder.DESC).addSort("id",SortOrder.ASC).get();
}
