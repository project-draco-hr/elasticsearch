{
  Settings settings=nodeEnvSettings(tmpPaths());
  NodeEnvironment env=new NodeEnvironment(settings,new Environment(settings));
  final int numIndices=randomIntBetween(1,10);
  for (int i=0; i < numIndices; i++) {
    for (    Path path : env.indexPaths(new Index("foo" + i))) {
      Files.createDirectories(path);
    }
  }
  Set<String> indices=env.findAllIndices();
  assertEquals(indices.size(),numIndices);
  for (int i=0; i < numIndices; i++) {
    assertTrue(indices.contains("foo" + i));
  }
  assertTrue("LockedShards: " + env.lockedShards(),env.lockedShards().isEmpty());
}
