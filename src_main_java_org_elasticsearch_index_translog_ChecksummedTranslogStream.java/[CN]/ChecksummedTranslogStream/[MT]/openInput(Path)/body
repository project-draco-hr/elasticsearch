{
  final InputStream fileInputStream=Files.newInputStream(translogFile);
  boolean success=false;
  try {
    final InputStreamStreamInput in=new InputStreamStreamInput(fileInputStream);
    CodecUtil.checkHeader(new InputStreamDataInput(in),TranslogStreams.TRANSLOG_CODEC,VERSION,VERSION);
    success=true;
    return in;
  }
 catch (  EOFException e) {
    throw new TruncatedTranslogException("translog header truncated",e);
  }
catch (  IOException e) {
    throw new TranslogCorruptedException("translog header corrupted",e);
  }
 finally {
    if (success == false) {
      IOUtils.closeWhileHandlingException(fileInputStream);
    }
  }
}
