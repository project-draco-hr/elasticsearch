{
  ShardId shardId=new ShardId(new Index("index"),1);
  Settings settings=EMPTY_SETTINGS;
  Store store=new MemoryStore(shardId,settings);
  store.deleteContent();
  ThreadPool threadPool=new DynamicThreadPool();
  SnapshotDeletionPolicy deletionPolicy=new SnapshotDeletionPolicy(new KeepOnlyLastDeletionPolicy(shardId,settings));
  Engine engine=new RobinEngine(shardId,settings,store,deletionPolicy,new MemoryTranslog(shardId,settings),new LogByteSizeMergePolicyProvider(store),new ConcurrentMergeSchedulerProvider(shardId,settings),new AnalysisService(shardId.index()),new SimilarityService(shardId.index()));
  engine.start();
  SimpleEngineBenchmark benchmark=new SimpleEngineBenchmark(store,engine).numberOfContentItems(1000).searcherThreads(50).searcherIterations(10000).writerThreads(10).writerIterations(10000).refreshSchedule(new TimeValue(1,TimeUnit.SECONDS)).flushSchedule(new TimeValue(1,TimeUnit.MINUTES)).build();
  benchmark.run();
  engine.close();
  store.close();
  threadPool.shutdown();
}
