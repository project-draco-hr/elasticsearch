{
  for (int i=0; i < searcherThreads.length; i++) {
    searcherThreads[i]=new Thread(new SearcherThread(),"Searcher[" + i + "]");
  }
  for (int i=0; i < writerThreads.length; i++) {
    writerThreads[i]=new Thread(new WriterThread(),"Writer[" + i + "]");
  }
  latch=new CountDownLatch(searcherThreads.length + writerThreads.length);
  barrier1=new CyclicBarrier(searcherThreads.length + writerThreads.length + 1);
  barrier2=new CyclicBarrier(searcherThreads.length + writerThreads.length + 1);
  StopWatch stopWatch=new StopWatch();
  stopWatch.start();
  for (  String contentItem : contentItems) {
    int id=idGenerator.incrementAndGet();
    String sId=Integer.toString(id);
    Document doc=doc().add(field("_id",sId)).add(field("content",contentItem)).build();
    ParsedDocument pDoc=new ParsedDocument(sId,sId,"type",null,doc,Lucene.STANDARD_ANALYZER,TRANSLOG_PAYLOAD,false);
    if (create) {
      engine.create(new Engine.Create(null,new Term("_id",sId),pDoc));
    }
 else {
      engine.index(new Engine.Index(null,new Term("_id",sId),pDoc));
    }
  }
  engine.refresh(new Engine.Refresh(true));
  stopWatch.stop();
  System.out.println("Warmup of [" + contentItems.length + "] content items, took "+ stopWatch.totalTime());
  return this;
}
