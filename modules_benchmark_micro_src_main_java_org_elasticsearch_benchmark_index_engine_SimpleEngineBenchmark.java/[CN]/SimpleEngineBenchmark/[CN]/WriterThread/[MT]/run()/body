{
  try {
    barrier1.await();
    barrier2.await();
    for (int i=0; i < writerIterations; i++) {
      int id=idGenerator.incrementAndGet();
      String sId=Integer.toString(id);
      Document doc=doc().add(field("_id",sId)).add(field("content",content(id))).build();
      ParsedDocument pDoc=new ParsedDocument(sId,sId,"type",doc,TRANSLOG_PAYLOAD,false);
      if (create) {
        engine.create(new Engine.Create(pDoc,Lucene.STANDARD_ANALYZER));
      }
 else {
        engine.index(new Engine.Index(new Term("_id",sId),pDoc,Lucene.STANDARD_ANALYZER));
      }
    }
  }
 catch (  Exception e) {
    System.out.println("Writer thread failed");
    e.printStackTrace();
  }
 finally {
    latch.countDown();
  }
}
