{
  MetaData metaData=new MetaData();
  metaData.uniqueness=Uniqueness.UNIQUE;
  for (  AtomicReaderContext readerContext : context.searcher().getTopReaderContext().leaves()) {
    AtomicFieldData fieldData=indexFieldData.load(readerContext);
    if (fieldData instanceof AtomicFieldData.WithOrdinals<?>) {
      AtomicFieldData.WithOrdinals<?> fd=(AtomicFieldData.WithOrdinals<?>)fieldData;
      BytesValues.WithOrdinals values=fd.getBytesValues();
      metaData.multiValued|=values.isMultiValued();
      metaData.maxAtomicUniqueValuesCount=Math.max(metaData.maxAtomicUniqueValuesCount,values.getMaxOrd());
    }
 else     if (fieldData instanceof AtomicNumericFieldData) {
      AtomicNumericFieldData fd=(AtomicNumericFieldData)fieldData;
      DoubleValues values=fd.getDoubleValues();
      metaData.multiValued|=values.isMultiValued();
      metaData.maxAtomicUniqueValuesCount=Long.MAX_VALUE;
    }
 else     if (fieldData instanceof AtomicGeoPointFieldData<?>) {
      AtomicGeoPointFieldData<?> fd=(AtomicGeoPointFieldData<?>)fieldData;
      GeoPointValues values=fd.getGeoPointValues();
      metaData.multiValued|=values.isMultiValued();
      metaData.maxAtomicUniqueValuesCount=Long.MAX_VALUE;
    }
 else {
      metaData.multiValued=true;
      metaData.maxAtomicUniqueValuesCount=Long.MAX_VALUE;
    }
  }
  return metaData;
}
