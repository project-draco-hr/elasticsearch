{
  MetaData metaData=new MetaData();
  metaData.uniqueness=Uniqueness.UNIQUE;
  for (  LeafReaderContext readerContext : context.searcher().getTopReaderContext().leaves()) {
    AtomicFieldData fieldData=indexFieldData.load(readerContext);
    if (fieldData instanceof AtomicOrdinalsFieldData) {
      AtomicOrdinalsFieldData fd=(AtomicOrdinalsFieldData)fieldData;
      RandomAccessOrds values=fd.getOrdinalsValues();
      metaData.multiValued|=FieldData.isMultiValued(values);
      metaData.maxAtomicUniqueValuesCount=Math.max(metaData.maxAtomicUniqueValuesCount,values.getValueCount());
    }
 else     if (fieldData instanceof AtomicNumericFieldData) {
      AtomicNumericFieldData fd=(AtomicNumericFieldData)fieldData;
      SortedNumericDoubleValues values=fd.getDoubleValues();
      metaData.multiValued|=FieldData.isMultiValued(values);
      metaData.maxAtomicUniqueValuesCount=Long.MAX_VALUE;
    }
 else     if (fieldData instanceof AtomicGeoPointFieldData) {
      AtomicGeoPointFieldData fd=(AtomicGeoPointFieldData)fieldData;
      MultiGeoPointValues values=fd.getGeoPointValues();
      metaData.multiValued|=FieldData.isMultiValued(values);
      metaData.maxAtomicUniqueValuesCount=Long.MAX_VALUE;
    }
 else {
      metaData.multiValued=true;
      metaData.maxAtomicUniqueValuesCount=Long.MAX_VALUE;
    }
  }
  return metaData;
}
