{
  final int numValues=delegate.setDocument(docId);
  numUniqueValues=0;
  pos=0;
  if (numValues > 0) {
    bytes.clear();
    indices=ArrayUtil.grow(this.indices,numValues);
    for (int i=0; i < numValues; ++i) {
      final BytesRef next=delegate.nextValue();
      indices[i]=i;
      bytes.append(next);
    }
    numUniqueValues=CollectionUtils.sortAndDedup(bytes,indices);
  }
  return numUniqueValues;
}
