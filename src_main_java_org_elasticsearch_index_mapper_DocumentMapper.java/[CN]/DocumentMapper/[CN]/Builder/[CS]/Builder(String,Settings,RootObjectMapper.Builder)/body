{
  this.index=index;
  this.indexSettings=indexSettings;
  this.builderContext=new Mapper.BuilderContext(indexSettings,new ContentPath(1));
  this.rootObjectMapper=builder.build(builderContext);
  IdFieldMapper idFieldMapper=new IdFieldMapper();
  if (indexSettings != null) {
    String idIndexed=indexSettings.get("index.mapping._id.indexed");
    if (idIndexed != null && Booleans.parseBoolean(idIndexed,false)) {
      FieldType fieldType=new FieldType(IdFieldMapper.Defaults.FIELD_TYPE);
      fieldType.setTokenized(false);
      idFieldMapper=new IdFieldMapper(fieldType);
    }
  }
  this.rootMappers.put(UidFieldMapper.class,new UidFieldMapper());
  this.rootMappers.put(IdFieldMapper.class,idFieldMapper);
  this.rootMappers.put(RoutingFieldMapper.class,new RoutingFieldMapper());
  this.rootMappers.put(SizeFieldMapper.class,new SizeFieldMapper(indexSettings));
  this.rootMappers.put(IndexFieldMapper.class,new IndexFieldMapper());
  this.rootMappers.put(SourceFieldMapper.class,new SourceFieldMapper(indexSettings));
  this.rootMappers.put(TypeFieldMapper.class,new TypeFieldMapper());
  this.rootMappers.put(AnalyzerMapper.class,new AnalyzerMapper());
  this.rootMappers.put(AllFieldMapper.class,new AllFieldMapper());
  this.rootMappers.put(BoostFieldMapper.class,new BoostFieldMapper(indexSettings));
  this.rootMappers.put(TimestampFieldMapper.class,new TimestampFieldMapper(indexSettings));
  this.rootMappers.put(TTLFieldMapper.class,new TTLFieldMapper(indexSettings));
  this.rootMappers.put(VersionFieldMapper.class,new VersionFieldMapper());
  this.rootMappers.put(ParentFieldMapper.class,new ParentFieldMapper(indexSettings));
  this.rootMappers.put(FieldNamesFieldMapper.class,new FieldNamesFieldMapper(indexSettings));
}
