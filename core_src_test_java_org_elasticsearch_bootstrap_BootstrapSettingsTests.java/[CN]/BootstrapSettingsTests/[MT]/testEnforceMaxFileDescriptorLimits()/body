{
  Bootstrap.enforceOrLogLimits(Settings.EMPTY);
  Settings build=Settings.builder().put(randomFrom(Bootstrap.ENFORCE_SETTINGS.toArray(new Setting[0])).getKey(),"127.0.0.1").build();
  long maxFileDescriptorCount=ProcessProbe.getInstance().getMaxFileDescriptorCount();
  try {
    Bootstrap.enforceOrLogLimits(build);
    if (maxFileDescriptorCount != -1 || maxFileDescriptorCount < (1 << 16)) {
      fail("must have enforced limits: " + maxFileDescriptorCount);
    }
  }
 catch (  IllegalStateException ex) {
    assertTrue(ex.getMessage(),ex.getMessage().startsWith("max file descriptors"));
  }
}
