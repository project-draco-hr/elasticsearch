{
  QueryParseContext context=new QueryParseContext(indicesQueriesRegistry);
  context.parseFieldMatcher(new ParseFieldMatcher(Settings.EMPTY));
  String highlightElement="{\n" + "    \"tags_schema\" : \"styled\"\n" + "}\n";
  XContentParser parser=XContentFactory.xContent(highlightElement).createParser(highlightElement);
  context.reset(parser);
  HighlightBuilder highlightBuilder=HighlightBuilder.fromXContent(context);
  assertArrayEquals("setting tags_schema 'styled' should alter pre_tags",HighlightBuilder.STYLED_PRE_TAG,highlightBuilder.preTags());
  assertArrayEquals("setting tags_schema 'styled' should alter post_tags",HighlightBuilder.STYLED_POST_TAGS,highlightBuilder.postTags());
  highlightElement="{\n" + "    \"tags_schema\" : \"default\"\n" + "}\n";
  parser=XContentFactory.xContent(highlightElement).createParser(highlightElement);
  context.reset(parser);
  highlightBuilder=HighlightBuilder.fromXContent(context);
  assertArrayEquals("setting tags_schema 'default' should alter pre_tags",HighlightBuilder.DEFAULT_PRE_TAGS,highlightBuilder.preTags());
  assertArrayEquals("setting tags_schema 'default' should alter post_tags",HighlightBuilder.DEFAULT_POST_TAGS,highlightBuilder.postTags());
  highlightElement="{\n" + "    \"tags_schema\" : \"somthing_else\"\n" + "}\n";
  parser=XContentFactory.xContent(highlightElement).createParser(highlightElement);
  context.reset(parser);
  try {
    highlightBuilder=HighlightBuilder.fromXContent(context);
    fail("setting unknown tag schema should throw exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("Unknown tag schema [somthing_else]",e.getMessage());
  }
}
