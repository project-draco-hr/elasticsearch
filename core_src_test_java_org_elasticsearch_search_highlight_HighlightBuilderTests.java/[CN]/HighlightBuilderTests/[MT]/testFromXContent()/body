{
  QueryParseContext context=new QueryParseContext(indicesQueriesRegistry);
  context.parseFieldMatcher(new ParseFieldMatcher(Settings.EMPTY));
  for (int runs=0; runs < NUMBER_OF_TESTBUILDERS; runs++) {
    HighlightBuilder highlightBuilder=randomHighlighterBuilder();
    XContentBuilder builder=XContentFactory.contentBuilder(randomFrom(XContentType.values()));
    if (randomBoolean()) {
      builder.prettyPrint();
    }
    builder.startObject();
    highlightBuilder.innerXContent(builder);
    builder.endObject();
    XContentParser parser=XContentHelper.createParser(builder.bytes());
    context.reset(parser);
    HighlightBuilder secondHighlightBuilder=HighlightBuilder.fromXContent(context);
    assertNotSame(highlightBuilder,secondHighlightBuilder);
    assertEquals(highlightBuilder,secondHighlightBuilder);
    assertEquals(highlightBuilder.hashCode(),secondHighlightBuilder.hashCode());
  }
}
