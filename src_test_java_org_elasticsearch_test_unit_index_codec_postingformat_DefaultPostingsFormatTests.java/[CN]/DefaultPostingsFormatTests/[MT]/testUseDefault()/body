{
  Codec codec=new TestCodec();
  Directory d=new RAMDirectory();
  IndexWriterConfig config=new IndexWriterConfig(Lucene.VERSION,new WhitespaceAnalyzer(Lucene.VERSION));
  config.setCodec(codec);
  IndexWriter writer=new IndexWriter(d,config);
  writer.addDocument(Arrays.asList(new TextField("foo","bar",Store.YES),new TextField(UidFieldMapper.NAME,"1234",Store.YES)));
  writer.commit();
  DirectoryReader reader=DirectoryReader.open(writer,false);
  List<AtomicReaderContext> leaves=reader.leaves();
  assertThat(leaves.size(),equalTo(1));
  AtomicReader ar=leaves.get(0).reader();
  Terms terms=ar.terms("foo");
  Terms uidTerms=ar.terms(UidFieldMapper.NAME);
  assertThat(terms.size(),equalTo(1l));
  assertThat(terms,not(instanceOf(BloomFilterPostingsFormat.BloomFilteredTerms.class)));
  assertThat(uidTerms,instanceOf(BloomFilterPostingsFormat.BloomFilteredTerms.class));
  reader.close();
  writer.close();
  d.close();
}
