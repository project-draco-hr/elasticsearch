{
  CompletableFuture<U> d, fr;
  U u;
  Throwable ex;
  if ((d=this.dst) != null && d.result == null) {
    try {
      fr=fn.apply(arg);
      ex=(fr == null) ? new NullPointerException() : null;
    }
 catch (    Throwable rex) {
      ex=rex;
      fr=null;
    }
    if (ex != null)     u=null;
 else {
      Object r=fr.result;
      if (r == null)       r=fr.waitingGet(false);
      if (r instanceof AltResult) {
        ex=((AltResult)r).ex;
        u=null;
      }
 else {
        @SuppressWarnings("unchecked") U ur=(U)r;
        u=ur;
      }
    }
    d.internalComplete(u,ex);
  }
  return true;
}
