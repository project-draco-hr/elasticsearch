{
  try (ReleasableLock lock=writeLock.acquire()){
    ensureOpen();
    if (this.buffer.length != bufferSize) {
      flush();
      this.buffer=new byte[bufferSize];
    }
  }
 catch (  IOException e) {
    throw new TranslogException(shardId,"failed to flush",e);
  }
}
