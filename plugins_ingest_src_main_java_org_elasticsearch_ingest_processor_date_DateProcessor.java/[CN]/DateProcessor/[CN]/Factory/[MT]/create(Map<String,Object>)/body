{
  String timezoneString=(String)config.get("timezone");
  DateTimeZone timezone=(timezoneString == null) ? DateTimeZone.UTC : DateTimeZone.forID(timezoneString);
  String localeString=(String)config.get("locale");
  Locale locale=localeString == null ? Locale.ENGLISH : Locale.forLanguageTag(localeString);
  String matchField=(String)config.get("match_field");
  List<String> matchFormats=(List<String>)config.get("match_formats");
  String targetField=(String)config.get("target_field");
  if (targetField == null) {
    targetField=DEFAULT_TARGET_FIELD;
  }
  return new DateProcessor(timezone,locale,matchField,matchFormats,targetField);
}
