{
  threadPool=new ThreadPool();
  serviceA=build(ImmutableSettings.builder().put("name","A").build(),version0);
  nodeA=new DiscoveryNode("A","A",serviceA.boundAddress().publishAddress(),ImmutableMap.<String,String>of(),version0);
  serviceB=build(ImmutableSettings.builder().put("name","B").build(),version1);
  nodeB=new DiscoveryNode("B","B",serviceB.boundAddress().publishAddress(),ImmutableMap.<String,String>of(),version1);
  serviceA.connectToNode(nodeB);
  serviceA.connectToNode(nodeA);
  serviceB.connectToNode(nodeA);
  serviceB.connectToNode(nodeB);
}
