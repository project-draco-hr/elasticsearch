{
  serviceA.registerHandler("sayHello",new BaseTransportRequestHandler<TransportRequest.Empty>(){
    @Override public TransportRequest.Empty newInstance(){
      return TransportRequest.Empty.INSTANCE;
    }
    @Override public String executor(){
      return ThreadPool.Names.GENERIC;
    }
    @Override public void messageReceived(    TransportRequest.Empty request,    TransportChannel channel){
      try {
        channel.sendResponse(TransportResponse.Empty.INSTANCE,TransportResponseOptions.options().withCompress(true));
      }
 catch (      IOException e) {
        e.printStackTrace();
        assertThat(e.getMessage(),false,equalTo(true));
      }
    }
  }
);
  TransportFuture<TransportResponse.Empty> res=serviceB.submitRequest(serviceANode,"sayHello",TransportRequest.Empty.INSTANCE,TransportRequestOptions.options().withCompress(true),new BaseTransportResponseHandler<TransportResponse.Empty>(){
    @Override public TransportResponse.Empty newInstance(){
      return TransportResponse.Empty.INSTANCE;
    }
    @Override public String executor(){
      return ThreadPool.Names.GENERIC;
    }
    @Override public void handleResponse(    TransportResponse.Empty response){
    }
    @Override public void handleException(    TransportException exp){
      exp.printStackTrace();
      assertThat("got exception instead of a response: " + exp.getMessage(),false,equalTo(true));
    }
  }
);
  try {
    TransportResponse.Empty message=res.get();
    assertThat(message,notNullValue());
  }
 catch (  Exception e) {
    assertThat(e.getMessage(),false,equalTo(true));
  }
  serviceA.removeHandler("sayHello");
}
