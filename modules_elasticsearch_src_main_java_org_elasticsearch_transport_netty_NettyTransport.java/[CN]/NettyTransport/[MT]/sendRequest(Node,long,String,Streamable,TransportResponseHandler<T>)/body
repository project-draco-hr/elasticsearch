{
  Channel targetChannel=nodeChannel(node);
  BytesStreamOutput stream=BytesStreamOutput.Cached.cached();
  stream.writeBytes(LENGTH_PLACEHOLDER);
  stream.writeLong(requestId);
  byte status=0;
  status=setRequest(status);
  stream.writeByte(status);
  stream.writeUTF(action);
  streamable.writeTo(stream);
  ChannelBuffer buffer=ChannelBuffers.wrappedBuffer(stream.copiedByteArray());
  int size=buffer.writerIndex() - 4;
  if (size == 0) {
    handler.handleException(new RemoteTransportException("",new FailedCommunicationException("Trying to send a stream with 0 size")));
  }
  buffer.setInt(0,size);
  ChannelFuture channelFuture=targetChannel.write(buffer);
}
