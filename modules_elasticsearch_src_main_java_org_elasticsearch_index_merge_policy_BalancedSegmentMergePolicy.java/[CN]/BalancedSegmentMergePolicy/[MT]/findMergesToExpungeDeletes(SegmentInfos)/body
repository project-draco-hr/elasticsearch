{
  final int numSegs=infos.size();
  final int numLargeSegs=(numSegs < _numLargeSegments ? numSegs : _numLargeSegments);
  MergeSpecification spec=null;
  if (numLargeSegs < numSegs) {
    SegmentInfos smallSegments=infos.range(numLargeSegs,numSegs);
    spec=super.findMergesToExpungeDeletes(smallSegments);
  }
  if (spec == null)   spec=new MergeSpecification();
  for (int i=0; i < numLargeSegs; i++) {
    SegmentInfo info=infos.info(i);
    if (info.hasDeletions()) {
      spec.add(new OneMerge(infos.range(i,i + 1),getUseCompoundFile()));
    }
  }
  return spec;
}
