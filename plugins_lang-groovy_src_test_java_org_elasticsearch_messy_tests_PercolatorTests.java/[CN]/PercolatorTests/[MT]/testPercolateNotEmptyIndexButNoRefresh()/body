{
  client().admin().indices().prepareCreate("my-index").setSettings(settingsBuilder().put("index.refresh_interval",-1)).execute().actionGet();
  ensureGreen();
  client().prepareIndex("my-index",PercolatorService.TYPE_NAME,"1").setSource(jsonBuilder().startObject().field("query",matchAllQuery()).field("level",1).endObject()).execute().actionGet();
  PercolateResponse response=client().preparePercolate().setIndices("my-index").setDocumentType("my-type").setSortByScore(true).setSize(2).setPercolateDoc(docBuilder().setDoc("field","value")).setPercolateQuery(QueryBuilders.functionScoreQuery(matchAllQuery(),scriptFunction(new Script("doc['level'].value")))).execute().actionGet();
  assertMatchCount(response,0l);
}
