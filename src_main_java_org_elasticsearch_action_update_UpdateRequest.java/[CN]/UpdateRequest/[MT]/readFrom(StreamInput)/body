{
  super.readFrom(in);
  replicationType=ReplicationType.fromId(in.readByte());
  consistencyLevel=WriteConsistencyLevel.fromId(in.readByte());
  type=in.readSharedString();
  id=in.readString();
  routing=in.readOptionalString();
  script=in.readOptionalString();
  if (Strings.hasLength(script)) {
    if (in.getVersion().onOrAfter(Version.V_1_3_0)) {
      scriptType=ScriptService.ScriptType.readFrom(in);
    }
 else {
      scriptType=null;
    }
  }
  scriptLang=in.readOptionalString();
  scriptParams=in.readMap();
  retryOnConflict=in.readVInt();
  refresh=in.readBoolean();
  if (in.readBoolean()) {
    doc=new IndexRequest();
    doc.readFrom(in);
  }
  int size=in.readInt();
  if (size >= 0) {
    fields=new String[size];
    for (int i=0; i < size; i++) {
      fields[i]=in.readString();
    }
  }
  if (in.readBoolean()) {
    upsertRequest=new IndexRequest();
    upsertRequest.readFrom(in);
  }
  docAsUpsert=in.readBoolean();
  version=Versions.readVersion(in);
  versionType=VersionType.fromValue(in.readByte());
  if (in.getVersion().onOrAfter(Version.V_1_4_0_Beta1)) {
    detectNoop=in.readBoolean();
    scriptedUpsert=in.readBoolean();
  }
}
