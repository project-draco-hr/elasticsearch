{
  Path dir=createTempDir();
  String previousJavaVersion=System.getProperty("java.specification.version");
  System.setProperty("java.specification.version","1.7");
  Manifest manifest=new Manifest();
  Attributes attributes=manifest.getMainAttributes();
  attributes.put(Attributes.Name.MANIFEST_VERSION,"1.0.0");
  attributes.put(new Attributes.Name("X-Compile-Target-JDK"),"1.8");
  URL[] jars={makeJar(dir,"foo.jar",manifest,"Foo.class")};
  try {
    JarHell.checkJarHell(jars);
    fail("did not get expected exception");
  }
 catch (  IllegalStateException e) {
    assertTrue(e.getMessage().contains("requires Java 1.8"));
    assertTrue(e.getMessage().contains("your system: 1.7"));
  }
 finally {
    System.setProperty("java.specification.version",previousJavaVersion);
  }
}
