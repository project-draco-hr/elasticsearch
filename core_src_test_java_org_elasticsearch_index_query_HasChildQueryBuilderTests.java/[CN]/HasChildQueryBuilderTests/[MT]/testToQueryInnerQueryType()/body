{
  String[] searchTypes=new String[]{PARENT_TYPE};
  QueryShardContext.setTypes(searchTypes);
  HasChildQueryBuilder hasChildQueryBuilder=new HasChildQueryBuilder(CHILD_TYPE,new IdsQueryBuilder().addIds("id"));
  Query query=hasChildQueryBuilder.toQuery(createShardContext());
  assertThat(QueryShardContext.getTypes(),equalTo(searchTypes));
  assertLateParsingQuery(query,CHILD_TYPE,"id");
}
