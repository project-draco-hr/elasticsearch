{
  String[] searchTypes=new String[]{PARENT_TYPE};
  QueryShardContext shardContext=createShardContext();
  shardContext.setTypes(searchTypes);
  HasChildQueryBuilder hasChildQueryBuilder=new HasChildQueryBuilder(CHILD_TYPE,new IdsQueryBuilder().addIds("id"));
  Query query=hasChildQueryBuilder.toQuery(shardContext);
  assertThat(shardContext.getTypes(),equalTo(searchTypes));
  assertLateParsingQuery(query,CHILD_TYPE,"id");
}
