{
  threadPool.shutdown();
  threadPool=new ThreadPool(getTestName()){
    @Override public Executor generic(){
      return new Executor(){
        @Override public void execute(        Runnable command){
          ((AbstractRunnable)command).onRejection(new EsRejectedExecutionException("test"));
        }
      }
;
    }
  }
;
  new DummyAbstractAsyncBulkByScrollAction().onScrollResponse(new SearchResponse(null,scrollId(),5,4,randomLong(),null));
  try {
    listener.get();
    fail("Expected a failure");
  }
 catch (  ExecutionException e) {
    assertThat(e.getMessage(),equalTo("EsRejectedExecutionException[test]"));
  }
}
