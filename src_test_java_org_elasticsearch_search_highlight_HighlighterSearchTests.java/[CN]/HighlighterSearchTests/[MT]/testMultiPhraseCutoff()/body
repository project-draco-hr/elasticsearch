{
  assertAcked(prepareCreate("test").addMapping("test","body","type=string,analyzer=custom_analyzer,search_analyzer=custom_analyzer,term_vector=with_positions_offsets").setSettings(settingsBuilder().put(indexSettings()).put("analysis.filter.wordDelimiter.type","word_delimiter").put("analysis.filter.wordDelimiter.type.split_on_numerics",false).put("analysis.filter.wordDelimiter.generate_word_parts",true).put("analysis.filter.wordDelimiter.generate_number_parts",true).put("analysis.filter.wordDelimiter.catenate_words",true).put("analysis.filter.wordDelimiter.catenate_numbers",true).put("analysis.filter.wordDelimiter.catenate_all",false).put("analysis.analyzer.custom_analyzer.tokenizer","whitespace").putArray("analysis.analyzer.custom_analyzer.filter","lowercase","wordDelimiter")));
  ensureGreen();
  client().prepareIndex("test","test","1").setSource("body","Test: http://www.facebook.com http://elasticsearch.org http://xing.com http://cnn.com http://quora.com http://twitter.com this is a test for highlighting feature Test: http://www.facebook.com http://elasticsearch.org http://xing.com http://cnn.com http://quora.com http://twitter.com this is a test for highlighting feature").get();
  refresh();
  SearchResponse search=client().prepareSearch().setQuery(matchQuery("body","Test: http://www.facebook.com ").type(Type.PHRASE)).addHighlightedField("body").execute().actionGet();
  assertHighlight(search,0,"body",0,startsWith("<em>Test: http://www.facebook.com</em>"));
  search=client().prepareSearch().setQuery(matchQuery("body","Test: http://www.facebook.com http://elasticsearch.org http://xing.com http://cnn.com http://quora.com http://twitter.com this is a test for highlighting feature Test: http://www.facebook.com http://elasticsearch.org http://xing.com http://cnn.com http://quora.com http://twitter.com this is a test for highlighting feature").type(Type.PHRASE)).addHighlightedField("body").execute().actionGet();
  assertHighlight(search,0,"body",0,equalTo("<em>Test</em>: <em>http://www.facebook.com</em> <em>http://elasticsearch.org</em> <em>http://xing.com</em> <em>http://cnn.com</em> http://quora.com"));
}
