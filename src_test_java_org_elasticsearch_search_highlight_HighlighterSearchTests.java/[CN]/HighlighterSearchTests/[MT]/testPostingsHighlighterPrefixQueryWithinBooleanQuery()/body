{
  assertAcked(prepareCreate("test").addMapping("type1",type1PostingsffsetsMapping()));
  ensureGreen();
  client().prepareIndex("test","type1").setSource("field1","The photography word will get highlighted").get();
  refresh();
  logger.info("--> highlighting and searching on field1");
  for (  String rewriteMethod : REWRITE_METHODS) {
    SearchSourceBuilder source=searchSource().query(boolQuery().must(prefixQuery("field1","photo").rewrite(rewriteMethod)).should(matchQuery("field1","test").minimumShouldMatch("0"))).highlight(highlight().field("field1"));
    SearchResponse searchResponse=client().search(searchRequest("test").source(source).searchType(randomBoolean() ? SearchType.DFS_QUERY_THEN_FETCH : SearchType.QUERY_THEN_FETCH)).get();
    assertHighlight(searchResponse,0,"field1",0,1,equalTo("The <em>photography</em> word will get highlighted"));
  }
}
