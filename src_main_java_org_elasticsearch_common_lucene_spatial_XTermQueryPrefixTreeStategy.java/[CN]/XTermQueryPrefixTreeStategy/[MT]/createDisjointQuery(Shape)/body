{
  int detailLevel=getGrid().getLevelForDistance(resolveDistErr(shape,ctx,getDistErrPct()));
  List<Node> nodes=getGrid().getNodes(shape,detailLevel,false);
  BooleanQuery query=new BooleanQuery();
  query.add(new MatchAllDocsQuery(),BooleanClause.Occur.SHOULD);
  for (  Node node : nodes) {
    query.add(new TermQuery(fieldName.createIndexNameTerm(node.getTokenString())),BooleanClause.Occur.MUST_NOT);
  }
  return new ConstantScoreQuery(query);
}
