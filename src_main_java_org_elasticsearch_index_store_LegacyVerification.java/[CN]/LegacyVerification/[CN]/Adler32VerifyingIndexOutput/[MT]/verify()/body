{
  if (written != length) {
    throw new CorruptIndexException("expected length=" + length + " != actual length: "+ written+ " : file truncated?",out.toString());
  }
  final String actualChecksum=Store.digestToString(checksum.getValue());
  if (!adler32.equals(actualChecksum)) {
    throw new CorruptIndexException("checksum failed (hardware problem?) : expected=" + adler32 + " actual="+ actualChecksum,out.toString());
  }
}
