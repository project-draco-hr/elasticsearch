{
  for (  PartialFieldsContext.PartialField field : context.partialFields().fields()) {
    Object value=context.lookup().source().filter(field.includes(),field.excludes());
    if (hitContext.hit().fieldsOrNull() == null) {
      hitContext.hit().fields(new HashMap<String,SearchHitField>(2));
    }
    SearchHitField hitField=hitContext.hit().fields().get(field.name());
    if (hitField == null) {
      hitField=new InternalSearchHitField(field.name(),new ArrayList<Object>(2));
      hitContext.hit().fields().put(field.name(),hitField);
    }
    hitField.values().add(value);
  }
}
