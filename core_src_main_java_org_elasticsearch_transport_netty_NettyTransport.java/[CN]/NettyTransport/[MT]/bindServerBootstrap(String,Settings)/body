{
  InetAddress hostAddressX;
  String bindHost=settings.get("bind_host");
  try {
    hostAddressX=networkService.resolveBindHostAddress(bindHost);
  }
 catch (  IOException e) {
    throw new BindTransportException("Failed to resolve host [" + bindHost + "]",e);
  }
  final InetAddress hostAddress=hostAddressX;
  String port=settings.get("port");
  PortsRange portsRange=new PortsRange(port);
  final AtomicReference<Exception> lastException=new AtomicReference<>();
  boolean success=portsRange.iterate(new PortsRange.PortCallback(){
    @Override public boolean onPortNumber(    int portNumber){
      try {
        serverChannels.put(name,serverBootstraps.get(name).bind(new InetSocketAddress(hostAddress,portNumber)));
      }
 catch (      Exception e) {
        lastException.set(e);
        return false;
      }
      return true;
    }
  }
);
  if (!success) {
    throw new BindTransportException("Failed to bind to [" + port + "]",lastException.get());
  }
  if (!DEFAULT_PROFILE.equals(name)) {
    InetSocketAddress boundAddress=(InetSocketAddress)serverChannels.get(name).getLocalAddress();
    int publishPort=settings.getAsInt("publish_port",boundAddress.getPort());
    String publishHost=settings.get("publish_host",boundAddress.getHostString());
    InetSocketAddress publishAddress=createPublishAddress(publishHost,publishPort);
    profileBoundAddresses.put(name,new BoundTransportAddress(new InetSocketTransportAddress(boundAddress),new InetSocketTransportAddress(publishAddress)));
  }
  logger.debug("Bound profile [{}] to address [{}]",name,serverChannels.get(name).getLocalAddress());
}
