{
  ensureGreen();
  ContentEncodingHeaderExtractor headerExtractor=new ContentEncodingHeaderExtractor();
  try (RestClient client=restClient(HttpClients.custom().addInterceptorFirst(headerExtractor).build())){
    ElasticsearchResponse response=client.performRequest("GET","/",Collections.emptyMap(),null,new BasicHeader(HttpHeaders.ACCEPT_ENCODING,GZIP_ENCODING));
    assertEquals(200,response.getStatusLine().getStatusCode());
    assertTrue(headerExtractor.hasContentEncodingHeader());
    assertEquals(GZIP_ENCODING,headerExtractor.getContentEncodingHeader().getValue());
  }
 }
