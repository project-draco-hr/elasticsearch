{
  if (fieldNames.size() == 1) {
    Map.Entry<String,Float> fieldBoost=fieldNames.entrySet().iterator().next();
    Float boostValue=fieldBoost.getValue();
    return parseAndApply(type,fieldBoost.getKey(),value,minimumShouldMatch,boostValue);
  }
  if (useDisMax) {
    DisjunctionMaxQuery disMaxQuery=new DisjunctionMaxQuery(tieBreaker);
    boolean clauseAdded=false;
    for (    String fieldName : fieldNames.keySet()) {
      Float boostValue=fieldNames.get(fieldName);
      Query query=parseAndApply(type,fieldName,value,minimumShouldMatch,boostValue);
      if (query != null) {
        clauseAdded=true;
        disMaxQuery.add(query);
      }
    }
    return clauseAdded ? disMaxQuery : null;
  }
 else {
    BooleanQuery booleanQuery=new BooleanQuery();
    for (    String fieldName : fieldNames.keySet()) {
      Float boostValue=fieldNames.get(fieldName);
      Query query=parseAndApply(type,fieldName,value,minimumShouldMatch,boostValue);
      if (query != null) {
        booleanQuery.add(query,BooleanClause.Occur.SHOULD);
      }
    }
    return !booleanQuery.clauses().isEmpty() ? booleanQuery : null;
  }
}
