{
  if (fieldNames.size() == 1) {
    return parse(type,fieldNames.get(0),text);
  }
  if (useDisMax) {
    DisjunctionMaxQuery disMaxQuery=new DisjunctionMaxQuery(tieBreaker);
    boolean clauseAdded=false;
    for (    String fieldName : fieldNames) {
      Query query=parse(type,fieldName,text);
      if (query != null) {
        clauseAdded=true;
        disMaxQuery.add(query);
      }
    }
    return clauseAdded ? disMaxQuery : null;
  }
 else {
    BooleanQuery booleanQuery=new BooleanQuery();
    for (    String fieldName : fieldNames) {
      Query query=parse(type,fieldName,text);
      if (query != null) {
        booleanQuery.add(query,BooleanClause.Occur.SHOULD);
      }
    }
    return !booleanQuery.clauses().isEmpty() ? booleanQuery : null;
  }
}
