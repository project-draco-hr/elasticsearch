{
  double sumOfSqrs=0;
  for (  InternalAggregation aggregation : reduceContext.aggregations()) {
    InternalExtendedStats stats=(InternalExtendedStats)aggregation;
    sumOfSqrs+=stats.getSumOfSquares();
  }
  final InternalStats stats=super.doReduce(reduceContext);
  return new InternalExtendedStats(name,stats.getCount(),stats.getSum(),stats.getMin(),stats.getMax(),sumOfSqrs,sigma,valueFormatter,getMetaData());
}
