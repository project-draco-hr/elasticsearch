{
  List<DiscoveryNode> removed=new ArrayList<>();
  List<DiscoveryNode> added=new ArrayList<>();
  for (  DiscoveryNode node : other) {
    if (!this.nodeExists(node.getId())) {
      removed.add(node);
    }
  }
  for (  DiscoveryNode node : this) {
    if (!other.nodeExists(node.getId())) {
      added.add(node);
    }
  }
  DiscoveryNode previousMasterNode=null;
  DiscoveryNode newMasterNode=null;
  if (masterNodeId != null) {
    if (other.masterNodeId == null || !other.masterNodeId.equals(masterNodeId)) {
      previousMasterNode=other.masterNode();
      newMasterNode=masterNode();
    }
  }
  return new Delta(previousMasterNode,newMasterNode,localNodeId,Collections.unmodifiableList(removed),Collections.unmodifiableList(added));
}
