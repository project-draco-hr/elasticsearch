{
  QueryRescoreContext rescore=((QueryRescoreContext)context.rescore());
  ContextIndexSearcher searcher=context.searcher();
  Explanation primaryExplain=searcher.explain(context.query(),topLevelDocId);
  if (primaryExplain == null) {
    return new ComplexExplanation(false,0.0f,"nothing matched");
  }
  Explanation rescoreExplain=searcher.explain(rescore.query(),topLevelDocId);
  float primaryWeight=rescore.queryWeight();
  ComplexExplanation prim=new ComplexExplanation(primaryExplain.isMatch(),primaryExplain.getValue() * primaryWeight,"product of:");
  prim.addDetail(primaryExplain);
  prim.addDetail(new Explanation(primaryWeight,"primaryWeight"));
  if (rescoreExplain != null) {
    ComplexExplanation sumExpl=new ComplexExplanation();
    sumExpl.setDescription("sum of:");
    sumExpl.addDetail(prim);
    sumExpl.setMatch(prim.isMatch());
    float secondaryWeight=rescore.rescoreQueryWeight();
    ComplexExplanation sec=new ComplexExplanation(rescoreExplain.isMatch(),rescoreExplain.getValue() * secondaryWeight,"product of:");
    sec.addDetail(rescoreExplain);
    sec.addDetail(new Explanation(secondaryWeight,"secondaryWeight"));
    sumExpl.addDetail(sec);
    sumExpl.setValue(prim.getValue() + sec.getValue());
    return sumExpl;
  }
 else {
    return prim;
  }
}
