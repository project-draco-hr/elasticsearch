{
  Settings nodeSettings=settingsBuilder().put("path.home",createTempDir()).build();
  IndexSettings settings=IndexSettingsModule.newIndexSettings(new Index("_na"),nodeSettings,Collections.emptyList());
  SimilarityService similarityService=new SimilarityService(settings,Collections.EMPTY_MAP);
  AnalysisService analysisService=new AnalysisRegistry(null,new Environment(nodeSettings)).build(settings);
  MapperService service=new MapperService(settings,analysisService,similarityService);
  return new CodecService(service,ESLoggerFactory.getLogger("test"));
}
