{
  try {
    UidAndRoutingFieldsVisitor fieldsVisitor=new UidAndRoutingFieldsVisitor();
    context.reader().document(doc,fieldsVisitor);
    Uid uid=fieldsVisitor.uid();
    final long version=Versions.loadVersion(context.reader(),new Term(UidFieldMapper.NAME,uid.toBytesRef()));
    docsToPurge.add(new DocToPurge(uid.type(),uid.id(),version,fieldsVisitor.routing()));
  }
 catch (  Exception e) {
    logger.trace("failed to collect doc",e);
  }
}
