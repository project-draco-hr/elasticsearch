{
  try {
    UidAndRoutingFieldVisitor fieldVisitor=new UidAndRoutingFieldVisitor();
    context.reader().document(doc,new UidAndRoutingFieldVisitor());
    String uid=fieldVisitor.uid();
    long version=UidField.loadVersion(context,new Term(UidFieldMapper.NAME,uid));
    docsToPurge.add(new DocToPurge(Uid.typeFromUid(uid),Uid.idFromUid(uid),version,fieldVisitor.routing()));
  }
 catch (  Exception e) {
    logger.trace("failed to collect doc",e);
  }
}
