{
  metaDataMappingService.putMapping(new MetaDataMappingService.PutRequest(request.indices(),request.type(),request.source()).ignoreConflicts(request.ignoreConflicts()).timeout(request.timeout()).masterTimeout(request.masterNodeTimeout()),new MetaDataMappingService.Listener(){
    @Override public void onResponse(    MetaDataMappingService.Response response){
      listener.onResponse(new PutMappingResponse(response.acknowledged()));
    }
    @Override public void onFailure(    Throwable t){
      logger.debug("failed to put mappings on indices [{}], type [{}]",t,request.indices(),request.type());
      listener.onFailure(t);
    }
  }
);
}
