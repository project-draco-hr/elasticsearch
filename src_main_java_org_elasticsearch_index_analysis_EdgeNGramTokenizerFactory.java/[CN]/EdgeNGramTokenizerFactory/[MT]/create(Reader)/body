{
  if (version.onOrAfter(Version.LUCENE_43)) {
    if (side == EdgeNGramTokenizer.Side.BACK) {
      throw new ElasticSearchIllegalArgumentException("side=BACK is not supported anymore. Please fix your analysis chain or use" + " an older compatibility version (<=4.2) but beware that it might cause highlighting bugs.");
    }
    if (matcher == null) {
      return new XEdgeNGramTokenizer(version,reader,minGram,maxGram);
    }
 else {
      return new XEdgeNGramTokenizer(version,reader,minGram,maxGram){
        @Override protected boolean isTokenChar(        int chr){
          return matcher.isTokenChar(chr);
        }
      }
;
    }
  }
 else {
    return new EdgeNGramTokenizer(reader,side,minGram,maxGram);
  }
}
