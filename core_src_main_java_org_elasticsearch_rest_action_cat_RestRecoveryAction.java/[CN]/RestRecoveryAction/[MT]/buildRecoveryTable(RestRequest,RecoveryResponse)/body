{
  Table t=getTableWithHeader(request);
  for (  String index : response.shardRecoveryStates().keySet()) {
    List<RecoveryState> shardRecoveryStates=response.shardRecoveryStates().get(index);
    if (shardRecoveryStates.size() == 0) {
      continue;
    }
    CollectionUtil.introSort(shardRecoveryStates,new Comparator<RecoveryState>(){
      @Override public int compare(      RecoveryState o1,      RecoveryState o2){
        int id1=o1.getShardId().id();
        int id2=o2.getShardId().id();
        if (id1 < id2) {
          return -1;
        }
 else         if (id1 > id2) {
          return 1;
        }
 else {
          return 0;
        }
      }
    }
);
    for (    RecoveryState state : shardRecoveryStates) {
      t.startRow();
      t.addCell(index);
      t.addCell(state.getShardId().id());
      t.addCell(state.getTimer().time());
      t.addCell(state.getType().toString().toLowerCase(Locale.ROOT));
      t.addCell(state.getStage().toString().toLowerCase(Locale.ROOT));
      t.addCell(state.getSourceNode() == null ? "n/a" : state.getSourceNode().getHostName());
      t.addCell(state.getTargetNode().getHostName());
      t.addCell(state.getRestoreSource() == null ? "n/a" : state.getRestoreSource().snapshotId().getRepository());
      t.addCell(state.getRestoreSource() == null ? "n/a" : state.getRestoreSource().snapshotId().getSnapshot());
      t.addCell(state.getIndex().totalRecoverFiles());
      t.addCell(String.format(Locale.ROOT,"%1.1f%%",state.getIndex().recoveredFilesPercent()));
      t.addCell(state.getIndex().totalRecoverBytes());
      t.addCell(String.format(Locale.ROOT,"%1.1f%%",state.getIndex().recoveredBytesPercent()));
      t.addCell(state.getIndex().totalFileCount());
      t.addCell(state.getIndex().totalBytes());
      t.addCell(state.getTranslog().recoveredOperations());
      t.addCell(String.format(Locale.ROOT,"%1.1f%%",state.getTranslog().recoveredPercent()));
      t.addCell(state.getTranslog().totalOperations());
      t.endRow();
    }
  }
  return t;
}
