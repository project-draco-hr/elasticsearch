{
  this.index=index;
  this.shuffler=new RotationShardShuffler(ThreadLocalRandom.current().nextInt());
  this.shards=shards;
  List<ShardRouting> allActiveShards=new ArrayList<>();
  for (  IntObjectCursor<IndexShardRoutingTable> cursor : shards) {
    for (    ShardRouting shardRouting : cursor.value) {
      shardRouting.freeze();
      if (shardRouting.active()) {
        allActiveShards.add(shardRouting);
      }
    }
  }
  this.allActiveShards=Collections.unmodifiableList(allActiveShards);
}
