{
  if (length == 0) {
    return;
  }
  BytesRef ref=new BytesRef();
  int written=0;
  if (offset != 0) {
    int fragmentSize=Math.min(length,PAGE_SIZE - (offset % PAGE_SIZE));
    bytearray.get(offset,fragmentSize,ref);
    os.write(ref.bytes,ref.offset,fragmentSize);
    written+=fragmentSize;
  }
  while (written < length) {
    int remaining=length - written;
    int bulkSize=(remaining > PAGE_SIZE) ? PAGE_SIZE : remaining;
    bytearray.get(offset + written,bulkSize,ref);
    os.write(ref.bytes,ref.offset,bulkSize);
    written+=bulkSize;
  }
}
