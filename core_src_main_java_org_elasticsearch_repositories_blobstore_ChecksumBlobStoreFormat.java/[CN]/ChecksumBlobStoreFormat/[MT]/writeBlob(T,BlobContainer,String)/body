{
  BytesReference bytes=write(obj);
  try (OutputStream outputStream=blobContainer.createOutput(blobName)){
    final String resourceDesc="ChecksumBlobStoreFormat.writeBlob(blob=\"" + blobName + "\")";
    try (OutputStreamIndexOutput indexOutput=new OutputStreamIndexOutput(resourceDesc,outputStream,BUFFER_SIZE)){
      CodecUtil.writeHeader(indexOutput,codec,VERSION);
      try (OutputStream indexOutputOutputStream=new IndexOutputOutputStream(indexOutput){
        @Override public void close() throws IOException {
        }
      }
){
        bytes.writeTo(indexOutputOutputStream);
      }
       CodecUtil.writeFooter(indexOutput);
    }
   }
 }
