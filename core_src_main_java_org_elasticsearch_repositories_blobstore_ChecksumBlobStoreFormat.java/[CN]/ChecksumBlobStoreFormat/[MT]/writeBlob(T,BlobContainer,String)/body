{
  BytesReference bytes=write(obj);
  try (ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream()){
    final String resourceDesc="ChecksumBlobStoreFormat.writeBlob(blob=\"" + blobName + "\")";
    try (OutputStreamIndexOutput indexOutput=new OutputStreamIndexOutput(resourceDesc,byteArrayOutputStream,BUFFER_SIZE)){
      CodecUtil.writeHeader(indexOutput,codec,VERSION);
      try (OutputStream indexOutputOutputStream=new IndexOutputOutputStream(indexOutput){
        @Override public void close() throws IOException {
        }
      }
){
        bytes.writeTo(indexOutputOutputStream);
      }
       CodecUtil.writeFooter(indexOutput);
    }
     blobContainer.writeBlob(blobName,new BytesArray(byteArrayOutputStream.toByteArray()));
  }
 }
