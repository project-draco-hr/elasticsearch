{
  Path[] locations=indexStore.shardIndexLocations(shardId);
  Directory[] dirs=new Directory[locations.length];
  for (int i=0; i < dirs.length; i++) {
    Files.createDirectories(locations[i]);
    Directory wrapped=newFSDirectory(locations[i],buildLockFactory());
    dirs[i]=new RateLimitedFSDirectory(wrapped,this,this);
  }
  return dirs;
}
