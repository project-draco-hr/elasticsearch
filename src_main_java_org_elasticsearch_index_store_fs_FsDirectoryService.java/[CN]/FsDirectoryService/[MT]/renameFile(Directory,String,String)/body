{
  File directory=((RateLimitedFSDirectory)dir).wrappedDirectory().getDirectory();
  File old=new File(directory,from);
  File nu=new File(directory,to);
  if (nu.exists())   if (!nu.delete())   throw new IOException("Cannot delete " + nu);
  if (!old.exists()) {
    throw new FileNotFoundException("Can't rename from [" + from + "] to ["+ to+ "], from does not exists");
  }
  boolean renamed=false;
  for (int i=0; i < 3; i++) {
    if (old.renameTo(nu)) {
      renamed=true;
      break;
    }
    try {
      Thread.sleep(100);
    }
 catch (    InterruptedException e) {
      throw new InterruptedIOException(e.getMessage());
    }
  }
  if (!renamed) {
    throw new IOException("Failed to rename, from [" + from + "], to ["+ to+ "]");
  }
}
