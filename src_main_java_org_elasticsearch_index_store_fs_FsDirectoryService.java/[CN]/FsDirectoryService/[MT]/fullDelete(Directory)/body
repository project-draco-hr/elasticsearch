{
  final FSDirectory fsDirectory=DirectoryUtils.getLeaf(dir,FSDirectory.class);
  if (fsDirectory == null) {
    throw new ElasticSearchIllegalArgumentException("Can not fully delete on non-filesystem based directory");
  }
  FileSystemUtils.deleteRecursively(fsDirectory.getDirectory());
  String[] list=fsDirectory.getDirectory().getParentFile().list();
  if (list == null || list.length == 0) {
    FileSystemUtils.deleteRecursively(fsDirectory.getDirectory().getParentFile());
  }
}
