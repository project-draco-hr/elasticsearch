{
  String mapping=copyToStringFromClasspath("/org/elasticsearch/index/mapper/all/multifield-mapping.json");
  DocumentMapper docMapper=MapperTestUtils.newParser().parse(mapping);
  XContentBuilder builder=XContentFactory.jsonBuilder();
  builder.startObject().field("_id","1").field("foo").startObject().field("bar","Elasticsearch rules!").endObject().endObject();
  Document doc=docMapper.parse(builder.bytes()).rootDoc();
  AllField field=(AllField)doc.getField("_all");
  AllEntries allEntries=((AllTokenStream)field.tokenStream(docMapper.mappers().indexAnalyzer())).allEntries();
  assertThat(allEntries.fields(),empty());
}
