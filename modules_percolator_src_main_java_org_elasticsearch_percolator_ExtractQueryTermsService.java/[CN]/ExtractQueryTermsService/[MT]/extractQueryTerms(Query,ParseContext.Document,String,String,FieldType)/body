{
  Result result;
  try {
    result=extractQueryTerms(query);
  }
 catch (  UnsupportedQueryException e) {
    document.add(new Field(extractionResultField,EXTRACTION_FAILED,fieldType));
    return;
  }
  for (  Term term : result.terms) {
    BytesRefBuilder builder=new BytesRefBuilder();
    builder.append(new BytesRef(term.field()));
    builder.append(FIELD_VALUE_SEPARATOR);
    builder.append(term.bytes());
    document.add(new Field(queryTermsFieldField,builder.toBytesRef(),fieldType));
  }
  if (result.verified) {
    document.add(new Field(extractionResultField,EXTRACTION_COMPLETE,fieldType));
  }
 else {
    document.add(new Field(extractionResultField,EXTRACTION_PARTIAL,fieldType));
  }
}
