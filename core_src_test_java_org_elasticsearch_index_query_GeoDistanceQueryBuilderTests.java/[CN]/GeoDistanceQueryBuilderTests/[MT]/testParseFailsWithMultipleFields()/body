{
  String json="{\n" + "  \"geo_distance\" : {\n" + "    \"point1\" : {\n"+ "      \"lat\" : 30, \"lon\" : 12\n"+ "    },\n"+ "    \"point2\" : {\n"+ "      \"lat\" : 30, \"lon\" : 12\n"+ "    }\n"+ "  }\n"+ "}";
  try {
    parseQuery(json);
    fail("parseQuery should have failed");
  }
 catch (  ParsingException e) {
    assertEquals("[geo_distance] query doesn't support multiple fields, found [point1] and [point2]",e.getMessage());
  }
}
