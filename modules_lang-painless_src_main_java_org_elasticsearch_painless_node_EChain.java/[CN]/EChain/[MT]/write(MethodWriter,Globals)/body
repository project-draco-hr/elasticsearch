{
  writer.writeDebugInfo(location);
  int catElementStackSize=0;
  if (cat) {
    catElementStackSize=writer.writeNewStrings();
  }
  ALink last=links.get(links.size() - 1);
  for (  ALink link : links) {
    link.write(writer,globals);
    if (link == last && link.store) {
      if (cat) {
        writer.writeDup(link.size,catElementStackSize);
        link.load(writer,globals);
        writer.writeAppendStrings(link.after);
        expression.write(writer,globals);
        if (!(expression instanceof EBinary) || ((EBinary)expression).operation != Operation.ADD || expression.actual.sort != Sort.STRING) {
          writer.writeAppendStrings(expression.actual);
        }
        writer.writeToStrings();
        writer.writeCast(back);
        if (link.load) {
          writer.writeDup(link.after.sort.size,link.size);
        }
        link.store(writer,globals);
      }
 else       if (operation != null) {
        writer.writeDup(link.size,0);
        link.load(writer,globals);
        if (link.load && post) {
          writer.writeDup(link.after.sort.size,link.size);
        }
        writer.writeCast(there);
        expression.write(writer,globals);
        if (promote.sort == Sort.DEF) {
          writer.writeDynamicBinaryInstruction(location,promote,Definition.DEF_TYPE,Definition.DEF_TYPE,operation,DefBootstrap.OPERATOR_COMPOUND_ASSIGNMENT);
        }
 else {
          writer.writeBinaryInstruction(location,promote,operation);
        }
        writer.writeCast(back);
        if (link.load && !post) {
          writer.writeDup(link.after.sort.size,link.size);
        }
        link.store(writer,globals);
      }
 else {
        expression.write(writer,globals);
        if (link.load) {
          writer.writeDup(link.after.sort.size,link.size);
        }
        link.store(writer,globals);
      }
    }
 else {
      link.load(writer,globals);
    }
  }
  writer.writeBranch(tru,fals);
}
