{
  try {
    shard.refresh(new Engine.Refresh("percolator_load_queries").force(true));
    Engine.Searcher searcher=shard.acquireSearcher("percolator_load_queries");
    try {
      Query query=new XConstantScoreQuery(indexCache.filter().cache(new TermFilter(new Term(TypeFieldMapper.NAME,PercolatorService.Constants.TYPE_NAME))));
      QueriesLoaderCollector queries=new QueriesLoaderCollector(PercolatorQueriesRegistry.this,logger,indexFieldDataService);
      searcher.searcher().search(query,queries);
      percolateQueries.putAll(queries.queries());
    }
  finally {
      searcher.release();
    }
  }
 catch (  Exception e) {
    throw new PercolatorException(shardId.index(),"failed to load queries from percolator index",e);
  }
}
