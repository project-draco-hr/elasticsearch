{
  if (SCORE_FIELD_NAME.equals(fieldName)) {
    if (reverse) {
      sortFields.add(SORT_SCORE_REVERSE);
    }
 else {
      sortFields.add(SORT_SCORE);
    }
  }
 else   if (DOC_FIELD_NAME.equals(fieldName)) {
    if (reverse) {
      sortFields.add(SORT_DOC_REVERSE);
    }
 else {
      sortFields.add(SORT_DOC);
    }
  }
 else {
    FieldMapper fieldMapper=context.mapperService().smartNameFieldMapper(fieldName);
    if (fieldMapper == null) {
      throw new SearchParseException(context,"No mapping found for [" + fieldName + "]");
    }
    sortFields.add(new SortField(fieldMapper.names().indexName(),fieldMapper.fieldDataType().newFieldComparatorSource(context.fieldDataCache(),missing),reverse));
  }
}
