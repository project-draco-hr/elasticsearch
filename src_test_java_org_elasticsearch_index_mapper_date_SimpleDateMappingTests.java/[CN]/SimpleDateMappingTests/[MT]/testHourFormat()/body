{
  String mapping=XContentFactory.jsonBuilder().startObject().startObject("type").field("date_detection",false).startObject("properties").startObject("date_field").field("type","date").field("format","HH:mm:ss").endObject().endObject().endObject().endObject().string();
  DocumentMapper defaultMapper=mapper(mapping);
  ParsedDocument doc=defaultMapper.parse("type","1",XContentFactory.jsonBuilder().startObject().field("date_field","10:00:00").endObject().bytes());
  assertThat(((LongFieldMapper.CustomLongNumericField)doc.rootDoc().getField("date_field")).numericAsString(),equalTo(Long.toString(new DateTime(TimeValue.timeValueHours(10).millis(),DateTimeZone.UTC).getMillis())));
  Filter filter;
  try {
    SearchContext.setCurrent(new TestSearchContext());
    filter=defaultMapper.mappers().smartNameFieldMapper("date_field").rangeFilter("10:00:00","11:00:00",true,true,null);
  }
  finally {
    SearchContext.removeCurrent();
  }
  assertThat(filter,instanceOf(NumericRangeFilter.class));
  NumericRangeFilter<Long> rangeFilter=(NumericRangeFilter<Long>)filter;
  assertThat(rangeFilter.getMax(),equalTo(new DateTime(TimeValue.timeValueHours(11).millis() + 999).getMillis()));
  assertThat(rangeFilter.getMin(),equalTo(new DateTime(TimeValue.timeValueHours(10).millis()).getMillis()));
}
