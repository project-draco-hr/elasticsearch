{
  assertThat(doc.rootDoc().getField(fieldA).tokenStream(defaultMapper.indexAnalyzer(),null),notNullValue());
  assertThat(doc.rootDoc().getField(fieldB).tokenStream(defaultMapper.indexAnalyzer(),null),notNullValue());
  TokenStream tokenStream=doc.rootDoc().getField(fieldA).tokenStream(defaultMapper.indexAnalyzer(),null);
  tokenStream.reset();
  NumericTermAttribute nta=tokenStream.addAttribute(NumericTermAttribute.class);
  List<Long> values=new ArrayList<>();
  while (tokenStream.incrementToken()) {
    values.add(nta.getRawValue());
  }
  tokenStream=doc.rootDoc().getField(fieldB).tokenStream(defaultMapper.indexAnalyzer(),null);
  tokenStream.reset();
  nta=tokenStream.addAttribute(NumericTermAttribute.class);
  int pos=0;
  while (tokenStream.incrementToken()) {
    assertThat(values.get(pos++),equalTo(nta.getRawValue()));
  }
  assertThat(pos,equalTo(values.size()));
}
