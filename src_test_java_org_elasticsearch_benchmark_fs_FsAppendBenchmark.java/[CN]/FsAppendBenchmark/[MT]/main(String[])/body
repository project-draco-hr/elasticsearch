{
  IOUtils.deleteFilesIgnoringExceptions(Paths.get("work/test.log"));
  RandomAccessFile raf=new RandomAccessFile("work/test.log","rw");
  raf.setLength(0);
  boolean CHANNEL=true;
  int CHUNK=(int)ByteSizeValue.parseBytesSizeValue("1k").bytes();
  long DATA=ByteSizeValue.parseBytesSizeValue("10gb").bytes();
  byte[] data=new byte[CHUNK];
  new Random().nextBytes(data);
  StopWatch watch=new StopWatch().start("write");
  if (CHANNEL) {
    FileChannel channel=raf.getChannel();
    long position=0;
    while (position < DATA) {
      channel.write(ByteBuffer.wrap(data),position);
      position+=data.length;
    }
    watch.stop().start("flush");
    channel.force(true);
  }
 else {
    long position=0;
    while (position < DATA) {
      raf.write(data);
      position+=data.length;
    }
    watch.stop().start("flush");
    raf.getFD().sync();
  }
  raf.close();
  watch.stop();
  System.out.println("Wrote [" + (new ByteSizeValue(DATA)) + "], chunk ["+ (new ByteSizeValue(CHUNK))+ "], in "+ watch);
}
