{
  valueFormatter=ValueFormatterStreams.readOptional(in);
  if (in.getVersion().before(Version.V_1_2_0)) {
    final byte id=in.readByte();
    if (id != 0) {
      throw new ElasticsearchIllegalArgumentException("Unexpected percentiles aggregator id [" + id + "]");
    }
  }
  keys=new double[in.readInt()];
  for (int i=0; i < keys.length; ++i) {
    keys[i]=in.readDouble();
  }
  state=TDigestState.read(in);
  keyed=in.readBoolean();
}
