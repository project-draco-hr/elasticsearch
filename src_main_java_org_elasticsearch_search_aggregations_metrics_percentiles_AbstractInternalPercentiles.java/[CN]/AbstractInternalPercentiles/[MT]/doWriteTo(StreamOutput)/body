{
  ValueFormatterStreams.writeOptional(valueFormatter,out);
  if (out.getVersion().before(Version.V_1_2_0)) {
    out.writeByte((byte)0);
  }
  out.writeInt(keys.length);
  for (int i=0; i < keys.length; ++i) {
    out.writeDouble(keys[i]);
  }
  TDigestState.write(state,out);
  out.writeBoolean(keyed);
}
