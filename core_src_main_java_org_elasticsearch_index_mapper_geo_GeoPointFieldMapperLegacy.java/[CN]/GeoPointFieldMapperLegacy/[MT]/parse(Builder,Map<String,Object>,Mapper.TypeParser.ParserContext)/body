{
  final boolean indexCreatedBeforeV2_0=parserContext.indexVersionCreated().before(Version.V_2_0_0);
  for (Iterator<Map.Entry<String,Object>> iterator=node.entrySet().iterator(); iterator.hasNext(); ) {
    Map.Entry<String,Object> entry=iterator.next();
    String propName=Strings.toUnderscoreCase(entry.getKey());
    Object propNode=entry.getValue();
    if (indexCreatedBeforeV2_0 && propName.equals("validate")) {
      builder.ignoreMalformed=!XContentMapValues.nodeBooleanValue(propNode);
      iterator.remove();
    }
 else     if (indexCreatedBeforeV2_0 && propName.equals("validate_lon")) {
      builder.ignoreMalformed=!XContentMapValues.nodeBooleanValue(propNode);
      iterator.remove();
    }
 else     if (indexCreatedBeforeV2_0 && propName.equals("validate_lat")) {
      builder.ignoreMalformed=!XContentMapValues.nodeBooleanValue(propNode);
      iterator.remove();
    }
 else     if (propName.equals(Names.COERCE)) {
      builder.coerce=XContentMapValues.nodeBooleanValue(propNode);
      iterator.remove();
    }
 else     if (indexCreatedBeforeV2_0 && propName.equals("normalize")) {
      builder.coerce=XContentMapValues.nodeBooleanValue(propNode);
      iterator.remove();
    }
 else     if (indexCreatedBeforeV2_0 && propName.equals("normalize_lat")) {
      builder.coerce=XContentMapValues.nodeBooleanValue(propNode);
      iterator.remove();
    }
 else     if (indexCreatedBeforeV2_0 && propName.equals("normalize_lon")) {
      builder.coerce=XContentMapValues.nodeBooleanValue(propNode);
      iterator.remove();
    }
  }
  return builder;
}
