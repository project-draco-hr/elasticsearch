{
  String[] updateShardActions=new String[]{UpdateAction.NAME + "[s]",IndexAction.NAME + "[r]"};
  interceptTransportActions(updateShardActions);
  String indexOrAlias=randomIndexOrAlias();
  UpdateRequest updateRequest=new UpdateRequest(indexOrAlias,"type","id").upsert("field","value").doc("field1","value1");
  UpdateResponse updateResponse=internalCluster().coordOnlyNodeClient().update(updateRequest).actionGet();
  assertThat(updateResponse.isCreated(),equalTo(true));
  clearInterceptedActions();
  assertSameIndices(updateRequest,updateShardActions);
}
