{
  logger.info("-->  deleting a snapshot is blocked when the cluster is read only");
  try {
    setClusterReadOnly(true);
    assertBlocked(client().admin().cluster().prepareDeleteSnapshot(REPOSITORY_NAME,SNAPSHOT_NAME),MetaData.CLUSTER_READ_ONLY_BLOCK);
  }
  finally {
    setClusterReadOnly(false);
  }
  logger.info("-->  deleting a snapshot is allowed when the cluster is not read only");
  DeleteSnapshotResponse response=client().admin().cluster().prepareDeleteSnapshot(REPOSITORY_NAME,SNAPSHOT_NAME).execute().actionGet();
  assertThat(response.isAcknowledged(),equalTo(true));
}
