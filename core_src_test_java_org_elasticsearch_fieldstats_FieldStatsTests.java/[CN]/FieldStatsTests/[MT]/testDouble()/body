{
  String fieldName="field";
  createIndex("test",Settings.EMPTY,fieldName,"value","type=double");
  for (double value=-1; value <= 9; value++) {
    client().prepareIndex("test","test").setSource(fieldName,value).get();
  }
  client().admin().indices().prepareRefresh().get();
  FieldStatsResponse result=client().prepareFieldStats().setFields(fieldName).get();
  assertThat(result.getAllFieldStats().get(fieldName).getMaxDoc(),equalTo(11l));
  assertThat(result.getAllFieldStats().get(fieldName).getDocCount(),equalTo(11l));
  assertThat(result.getAllFieldStats().get(fieldName).getDensity(),equalTo(100));
  assertThat(result.getAllFieldStats().get(fieldName).getMinValue(),equalTo(Double.toString(-1)));
  assertThat(result.getAllFieldStats().get(fieldName).getMaxValue(),equalTo(Double.toString(9)));
}
