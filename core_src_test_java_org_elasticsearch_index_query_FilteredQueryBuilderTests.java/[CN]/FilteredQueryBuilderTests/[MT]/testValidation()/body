{
  QueryBuilder valid=RandomQueryBuilder.createQuery(random());
  QueryBuilder invalid=RandomQueryBuilder.createInvalidQuery(random());
  FilteredQueryBuilder qb=new FilteredQueryBuilder(invalid);
  QueryValidationException result=qb.validate();
  assertNotNull(result);
  assertEquals(1,result.validationErrors().size());
  qb=new FilteredQueryBuilder(valid,invalid);
  result=qb.validate();
  assertNotNull(result);
  assertEquals(1,result.validationErrors().size());
  qb=new FilteredQueryBuilder(invalid,valid);
  result=qb.validate();
  assertNotNull(result);
  assertEquals(1,result.validationErrors().size());
  qb=new FilteredQueryBuilder(invalid,invalid);
  result=qb.validate();
  assertNotNull(result);
  assertEquals(2,result.validationErrors().size());
  qb=new FilteredQueryBuilder(valid);
  assertNull(qb.validate());
  qb=new FilteredQueryBuilder(null);
  assertNull(qb.validate());
  qb=new FilteredQueryBuilder(null,valid);
  assertNull(qb.validate());
  qb=new FilteredQueryBuilder(valid,null);
  assertNull(qb.validate());
  qb=new FilteredQueryBuilder(valid,valid);
  assertNull(qb.validate());
}
