{
  registry.getPercolateQueries().put(new BytesRef(id),query);
  ParseContext.Document document=new ParseContext.Document();
  FieldType extractedQueryTermsFieldType=new FieldType();
  extractedQueryTermsFieldType.setTokenized(false);
  extractedQueryTermsFieldType.setIndexOptions(IndexOptions.DOCS);
  extractedQueryTermsFieldType.freeze();
  ExtractQueryTermsService.extractQueryTerms(query,document,PercolatorFieldMapper.EXTRACTED_TERMS_FULL_FIELD_NAME,PercolatorFieldMapper.UNKNOWN_QUERY_FULL_FIELD_NAME,extractedQueryTermsFieldType);
  document.add(new StoredField(UidFieldMapper.NAME,Uid.createUid(PercolatorService.TYPE_NAME,id)));
  writer.addDocument(document);
}
