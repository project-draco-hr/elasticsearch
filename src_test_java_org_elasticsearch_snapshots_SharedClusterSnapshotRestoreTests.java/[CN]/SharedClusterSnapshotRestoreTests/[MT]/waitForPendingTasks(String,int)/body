{
  return awaitBusy(new Predicate<Object>(){
    @Override public boolean apply(    Object o){
      PendingClusterTasksResponse tasks=client().admin().cluster().preparePendingClusterTasks().get();
      int count=0;
      for (      PendingClusterTask task : tasks) {
        if (task.getSource().toString().startsWith(taskPrefix)) {
          count++;
        }
      }
      return expectedCount == count;
    }
  }
);
}
