{
  String field;
  MappedFieldType fieldType=parseContext.fieldMapper(fieldName);
  if (fieldType != null) {
    field=fieldType.names().indexName();
  }
 else {
    field=fieldName;
  }
  Analyzer analyzerObj;
  if (analyzer == null) {
    if (fieldType != null) {
      analyzerObj=parseContext.getSearchAnalyzer(fieldType);
    }
 else {
      analyzerObj=parseContext.mapperService().searchAnalyzer();
    }
  }
 else {
    analyzerObj=parseContext.mapperService().analysisService().analyzer(analyzer);
    if (analyzerObj == null) {
      throw new IllegalArgumentException("no analyzer found for [" + analyzer + "]");
    }
  }
  Occur highFreqOccur=highFreqOperator.toBooleanClauseOccur();
  Occur lowFreqOccur=lowFreqOperator.toBooleanClauseOccur();
  ExtendedCommonTermsQuery commonsQuery=new ExtendedCommonTermsQuery(highFreqOccur,lowFreqOccur,cutoffFrequency,disableCoord,fieldType);
  commonsQuery.setBoost(boost);
  Query query=parseQueryString(commonsQuery,text,field,analyzerObj,lowFreqMinimumShouldMatch,highFreqMinimumShouldMatch);
  if (queryName != null) {
    parseContext.addNamedQuery(queryName,query);
  }
  return query;
}
