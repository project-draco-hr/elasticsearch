{
  assertThat(query,instanceOf(SpanTermQuery.class));
  SpanTermQuery spanTermQuery=(SpanTermQuery)query;
  assertThat(spanTermQuery.getTerm().field(),equalTo(queryBuilder.fieldName()));
  MappedFieldType mapper=context.fieldMapper(queryBuilder.fieldName());
  if (mapper != null) {
    BytesRef bytesRef=mapper.indexedValueForSearch(queryBuilder.value());
    assertThat(spanTermQuery.getTerm().bytes(),equalTo(bytesRef));
  }
 else {
    assertThat(spanTermQuery.getTerm().bytes(),equalTo(BytesRefs.toBytesRef(queryBuilder.value())));
  }
}
