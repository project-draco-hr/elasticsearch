{
  if (!fieldData.hasValue(doc)) {
    return false;
  }
  if (fieldData.multiValued()) {
    double[] lats=fieldData.latValues(doc);
    double[] lons=fieldData.lonValues(doc);
    for (int i=0; i < lats.length; i++) {
      if (topLeft.lon <= lons[i] && bottomRight.lon >= lons[i] && topLeft.lat >= lats[i] && bottomRight.lat <= lats[i]) {
        return true;
      }
    }
  }
 else {
    double lat=fieldData.latValue(doc);
    double lon=fieldData.lonValue(doc);
    if (topLeft.lon <= lon && bottomRight.lon >= lon && topLeft.lat >= lat && bottomRight.lat <= lat) {
      return true;
    }
  }
  return false;
}
