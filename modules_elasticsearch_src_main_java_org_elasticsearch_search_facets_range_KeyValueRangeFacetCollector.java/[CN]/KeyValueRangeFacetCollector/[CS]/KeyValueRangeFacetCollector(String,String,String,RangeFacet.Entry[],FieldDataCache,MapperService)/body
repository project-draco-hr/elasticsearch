{
  super(facetName);
  this.keyFieldName=keyFieldName;
  this.valueFieldName=valueFieldName;
  this.entries=entries;
  this.fieldDataCache=fieldDataCache;
  FieldMapper mapper=mapperService.smartNameFieldMapper(keyFieldName);
  if (mapper == null) {
    throw new FacetPhaseExecutionException(facetName,"No mapping found for key_field [" + keyFieldName + "]");
  }
  keyIndexFieldName=mapper.names().indexName();
  keyFieldDataType=mapper.fieldDataType();
  mapper=mapperService.smartNameFieldMapper(valueFieldName);
  if (mapper == null) {
    throw new FacetPhaseExecutionException(facetName,"No mapping found for value_field [" + valueFieldName + "]");
  }
  valueIndexFieldName=mapper.names().indexName();
  valueFieldDataType=mapper.fieldDataType();
}
