{
  Index index=new Index("test");
  Settings settings=generateSettings(generateWordList());
  Injector injector=new ModulesBuilder().add(new IndexSettingsModule(settings),new IndexNameModule(index),new AnalysisModule(settings)).createInjector();
  AnalysisService analysisService=injector.getInstance(AnalysisService.class);
  Analyzer analyzer=analysisService.analyzer("myAnalyzer2").analyzer();
  AllEntries allEntries=new AllEntries();
  allEntries.addText("field1","donaudampfschiff",1.0f);
  allEntries.addText("field2","spargelcremesuppe",1.0f);
  allEntries.reset();
  TokenStream stream=AllTokenStream.allTokenStream("_all",allEntries,analyzer);
  TermAttribute termAtt=stream.addAttribute(TermAttribute.class);
  List<String> terms=new ArrayList<String>();
  while (stream.incrementToken()) {
    String tokText=termAtt.term();
    terms.add(tokText);
  }
  MatcherAssert.assertThat(terms.size(),equalTo(8));
  MatcherAssert.assertThat(terms,hasItems("donau","dampf","schiff","donaudampfschiff","spargel","creme","suppe","spargelcremesuppe"));
}
