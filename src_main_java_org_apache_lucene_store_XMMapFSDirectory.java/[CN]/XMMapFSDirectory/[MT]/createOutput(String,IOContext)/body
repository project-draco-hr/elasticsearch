{
  StoreRateLimiting rateLimiting=rateLimitingProvider.rateLimiting();
  StoreRateLimiting.Type type=rateLimiting.getType();
  RateLimiter limiter=rateLimiting.getRateLimiter();
  if (type == StoreRateLimiting.Type.NONE || limiter == null) {
    return super.createOutput(name,context);
  }
  if (TrackingMergeScheduler.getCurrentMerge() != null) {
    ensureOpen();
    ensureCanWrite(name);
    return new XFSIndexOutput(this,name,limiter,rateListener);
  }
  if (type == StoreRateLimiting.Type.ALL) {
    ensureOpen();
    ensureCanWrite(name);
    return new XFSIndexOutput(this,name,limiter,rateListener);
  }
  return super.createOutput(name,context);
}
