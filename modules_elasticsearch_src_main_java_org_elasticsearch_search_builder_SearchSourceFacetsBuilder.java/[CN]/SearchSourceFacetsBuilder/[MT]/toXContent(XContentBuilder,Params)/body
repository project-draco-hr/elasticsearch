{
  if (queryFacets == null && termFacets == null) {
    return;
  }
  builder.field("facets");
  builder.startObject();
  if (queryFacets != null) {
    for (    QueryFacet queryFacet : queryFacets) {
      builder.startObject(queryFacet.name());
      builder.field(QueryFacetCollectorParser.NAME);
      queryFacet.queryBuilder().toXContent(builder,params);
      if (queryFacet.global() != null) {
        builder.field("global",queryFacet.global());
      }
      builder.endObject();
    }
  }
  if (termFacets != null) {
    for (    TermFacet termFacet : termFacets) {
      builder.startObject(termFacet.name());
      builder.startObject(TermFacetCollectorParser.NAME);
      builder.field("field",termFacet.fieldName());
      builder.field("size",termFacet.size());
      builder.endObject();
      if (termFacet.global() != null) {
        builder.field("global",termFacet.global());
      }
      builder.endObject();
    }
  }
  builder.endObject();
}
