{
  MultiSearchRequest multiSearchRequest=new MultiSearchRequest();
  if (request.hasParam("max_concurrent_searches")) {
    multiSearchRequest.maxConcurrentSearchRequests(request.paramAsInt("max_concurrent_searches",0));
  }
  String[] indices=Strings.splitStringByCommaToArray(request.param("index"));
  String[] types=Strings.splitStringByCommaToArray(request.param("type"));
  String path=request.path();
  boolean isTemplateRequest=isTemplateRequest(path);
  IndicesOptions indicesOptions=IndicesOptions.fromRequest(request,multiSearchRequest.indicesOptions());
  parseRequest(multiSearchRequest,RestActions.getRestContent(request),isTemplateRequest,indices,types,request.param("search_type"),request.param("routing"),indicesOptions,allowExplicitIndex,indicesQueriesRegistry,parseFieldMatcher,aggParsers,suggesters);
  client.multiSearch(multiSearchRequest,new RestToXContentListener<>(channel));
}
