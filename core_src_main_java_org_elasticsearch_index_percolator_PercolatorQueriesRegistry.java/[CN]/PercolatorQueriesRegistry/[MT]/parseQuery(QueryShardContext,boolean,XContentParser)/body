{
  QueryShardContext context=new QueryShardContext(queryShardContext);
  try {
    context.reset(parser);
    context.setAllowUnmappedFields(false);
    context.setMapUnmappedFieldAsString(mapUnmappedFieldsAsString);
    return context.parseInnerQuery();
  }
 catch (  IOException e) {
    throw new ParsingException(parser.getTokenLocation(),"Failed to parse",e);
  }
 finally {
    context.reset(null);
  }
}
