{
  int expectedOps=0;
  this.nodes=clusterState.nodes();
  List<String> scrollIds=parseSource(request);
  if (scrollIds.size() == 1 && "_all".equals(scrollIds.get(0))) {
    expectedOps=nodes.size();
  }
 else {
    for (    String parsedScrollId : scrollIds) {
      Tuple<String,Long>[] context=parseScrollId(parsedScrollId).getContext();
      expectedOps+=context.length;
      this.contexts.add(context);
    }
  }
  this.request=request;
  this.listener=listener;
  this.expHolder=new AtomicReference<>();
  this.expectedOps=new CountDown(expectedOps);
}
