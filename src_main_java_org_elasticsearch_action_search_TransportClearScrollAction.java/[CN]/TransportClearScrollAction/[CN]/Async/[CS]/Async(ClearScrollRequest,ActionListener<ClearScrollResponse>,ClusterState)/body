{
  int expectedOps=0;
  this.nodes=clusterState.nodes();
  if (request.getScrollIds() == null || request.getScrollIds().isEmpty()) {
    expectedOps=nodes.size();
  }
 else {
    for (    String parsedScrollId : request.getScrollIds()) {
      Tuple<String,Long>[] context=parseScrollId(parsedScrollId).getContext();
      expectedOps+=context.length;
      this.contexts.add(context);
    }
  }
  this.request=request;
  this.listener=listener;
  this.expHolder=new AtomicReference<Throwable>();
  this.expectedOps=new AtomicInteger(expectedOps);
}
