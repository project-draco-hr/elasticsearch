{
  if (states.isEmpty()) {
    return current=NO_MORE_DOCS;
  }
  if (current == -1) {
    for (    State state : states) {
      state.initialize();
    }
  }
  int lowestIndex=0;
  int lowestDocId=states.get(0).current;
  for (int i=1; i < states.size(); i++) {
    State state=states.get(i);
    if (lowestDocId > state.current) {
      lowestDocId=state.current;
      lowestIndex=i;
    }
  }
  if (states.get(lowestIndex).next() == DocsEnum.NO_MORE_DOCS) {
    states.remove(lowestIndex);
  }
  return current=lowestDocId;
}
