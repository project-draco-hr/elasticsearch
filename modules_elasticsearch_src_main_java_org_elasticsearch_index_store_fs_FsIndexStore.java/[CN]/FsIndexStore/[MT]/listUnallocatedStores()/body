{
  File[] shardLocations=location.listFiles();
  if (shardLocations == null || shardLocations.length == 0) {
    return new StoreFilesMetaData[0];
  }
  List<StoreFilesMetaData> shards=Lists.newArrayList();
  for (  File shardLocation : shardLocations) {
    int shardId=Integer.parseInt(shardLocation.getName());
    if (!indexService.hasShard(shardId)) {
      shards.add(listUnallocatedStoreMetaData(new ShardId(index,shardId)));
    }
  }
  return shards.toArray(new StoreFilesMetaData[shards.size()]);
}
