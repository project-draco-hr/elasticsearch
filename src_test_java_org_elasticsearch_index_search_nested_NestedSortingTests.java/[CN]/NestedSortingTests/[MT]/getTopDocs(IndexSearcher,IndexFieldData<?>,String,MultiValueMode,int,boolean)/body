{
  Filter parentFilter=new TermFilter(new Term("__type","parent"));
  Filter childFilter=new TermFilter(new Term("__type","child"));
  XFieldComparatorSource nestedComparatorSource=indexFieldData.comparatorSource(missingValue,sortMode,new Nested(parentFilter,childFilter));
  Query query=new ConstantScoreQuery(parentFilter);
  Sort sort=new Sort(new SortField("f",nestedComparatorSource,reverse));
  return searcher.search(query,n,sort);
}
