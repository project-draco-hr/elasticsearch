{
  try {
    barrier1.await();
    barrier2.await();
    for (; counter < max; counter++) {
      Client client=client(counter);
      long id=idGenerator.incrementAndGet();
      client.index(Requests.indexRequest().index("test").type("type1").id(Long.toString(id)).source(XContentFactory.jsonBuilder().startObject().field("num",id % fieldNumLimit).endObject())).actionGet();
    }
    System.out.println("Indexer [" + id + "]: Done");
  }
 catch (  Exception e) {
    System.err.println("Failed to index:");
    e.printStackTrace();
  }
 finally {
    latch.countDown();
  }
}
