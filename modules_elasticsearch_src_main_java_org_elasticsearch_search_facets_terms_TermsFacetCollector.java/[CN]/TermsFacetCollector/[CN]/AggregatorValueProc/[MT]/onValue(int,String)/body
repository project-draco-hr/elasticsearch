{
  if (excluded != null && excluded.contains(value)) {
    return;
  }
  if (matcher != null && !matcher.reset(value).matches()) {
    return;
  }
  if (scriptFunction != null) {
    params.put("term",value);
    Object scriptValue=scriptFunction.execute(docId,params);
    if (scriptValue instanceof Boolean) {
      if (!((Boolean)scriptValue)) {
        return;
      }
    }
 else {
      value=scriptValue.toString();
    }
  }
  super.onValue(docId,value);
}
