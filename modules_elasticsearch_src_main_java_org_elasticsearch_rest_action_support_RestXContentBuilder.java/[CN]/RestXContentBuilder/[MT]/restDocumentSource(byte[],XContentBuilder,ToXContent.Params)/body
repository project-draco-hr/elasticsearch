{
  if (LZFDecoder.isCompressed(source)) {
    BytesStreamInput siBytes=new BytesStreamInput(source);
    LZFStreamInput siLzf=CachedStreamInput.cachedLzf(siBytes);
    XContentType contentType=XContentFactory.xContentType(siLzf);
    siLzf.resetToBufferStart();
    if (contentType == builder.contentType()) {
      builder.rawField("_source",siLzf);
    }
 else {
      builder.field("_source",XContentFactory.xContent(builder.contentType()).createParser(siLzf).map());
    }
  }
 else {
    if (XContentFactory.xContentType(source) == builder.contentType()) {
      builder.rawField("_source",source);
    }
 else {
      builder.field("_source",XContentFactory.xContent(builder.contentType()).createParser(source).map());
    }
  }
}
