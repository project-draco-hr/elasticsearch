{
  if (length < 1) {
    return 0;
  }
  if (!readyBuffer()) {
    return -1;
  }
  int chunkLength=Math.min(valid - position,length);
  System.arraycopy(uncompressed,position,buffer,offset,chunkLength);
  position+=chunkLength;
  if (chunkLength == length || !fullRead) {
    return chunkLength;
  }
  int totalRead=chunkLength;
  do {
    offset+=chunkLength;
    if (!readyBuffer()) {
      break;
    }
    chunkLength=Math.min(valid - position,(length - totalRead));
    System.arraycopy(uncompressed,position,buffer,offset,chunkLength);
    position+=chunkLength;
    totalRead+=chunkLength;
  }
 while (totalRead < length);
  return totalRead;
}
