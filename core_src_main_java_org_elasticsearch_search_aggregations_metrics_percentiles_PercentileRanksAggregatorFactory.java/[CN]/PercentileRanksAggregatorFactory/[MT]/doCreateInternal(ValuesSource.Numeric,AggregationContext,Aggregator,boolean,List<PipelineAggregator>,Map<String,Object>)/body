{
switch (method) {
case TDIGEST:
    return new TDigestPercentileRanksAggregator(name,valuesSource,aggregationContext,parent,values,compression,keyed,config.formatter(),pipelineAggregators,metaData);
case HDR:
  return new HDRPercentileRanksAggregator(name,valuesSource,aggregationContext,parent,values,numberOfSignificantValueDigits,keyed,config.formatter(),pipelineAggregators,metaData);
default :
throw new IllegalStateException("Illegal method [" + method.getName() + "]");
}
}
