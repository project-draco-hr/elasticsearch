{
  long totalRefreshTime=0;
  int numExecutedRefreshed=0;
  while (run) {
    long docIdLimit=COUNT;
    for (long docId=1; run && docId < docIdLimit; ) {
      try {
        for (int j=0; j < 8; j++) {
          GetResponse getResponse=client.prepareGet(indexName,"type1",String.valueOf(++docId)).get();
          client.prepareIndex(indexName,"type1",getResponse.getId()).setSource(getResponse.getSource()).get();
        }
        long startTime=System.currentTimeMillis();
        client.admin().indices().prepareRefresh(indexName).execute().actionGet();
        totalRefreshTime+=System.currentTimeMillis() - startTime;
        numExecutedRefreshed++;
        Thread.sleep(500);
      }
 catch (      Throwable e) {
        e.printStackTrace();
      }
    }
  }
  avgRefreshTime=totalRefreshTime / numExecutedRefreshed;
  stopped=true;
}
