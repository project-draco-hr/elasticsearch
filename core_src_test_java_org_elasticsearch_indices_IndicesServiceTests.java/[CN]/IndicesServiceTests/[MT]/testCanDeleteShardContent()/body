{
  IndicesService indicesService=getIndicesService();
  IndexMetaData meta=IndexMetaData.builder("test").settings(settings(Version.CURRENT)).numberOfShards(1).numberOfReplicas(1).build();
  IndexSettings indexSettings=IndexSettingsModule.newIndexSettings("test",meta.getSettings());
  assertFalse("no shard location",indicesService.canDeleteShardContent(new ShardId("test","_na_",0),indexSettings));
  IndexService test=createIndex("test");
  assertTrue(test.hasShard(0));
  assertFalse("shard is allocated",indicesService.canDeleteShardContent(new ShardId("test","_na_",0),indexSettings));
  test.removeShard(0,"boom");
  assertTrue("shard is removed",indicesService.canDeleteShardContent(new ShardId("test","_na_",0),indexSettings));
}
