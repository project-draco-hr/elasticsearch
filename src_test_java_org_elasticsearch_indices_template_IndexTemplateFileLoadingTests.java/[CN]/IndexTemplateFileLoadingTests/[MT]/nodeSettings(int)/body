{
  ImmutableSettings.Builder settingsBuilder=ImmutableSettings.settingsBuilder();
  settingsBuilder.put(super.nodeSettings(nodeOrdinal));
  try {
    File directory=temporaryFolder.newFolder();
    settingsBuilder.put("path.conf",directory.getPath());
    File templatesDir=new File(directory + File.separator + "templates");
    templatesDir.mkdir();
    File dst=new File(templatesDir,"template.json");
    String templatePath="/org/elasticsearch/indices/template/template" + randomInt(5) + ".json";
    logger.info("Picking template path [{}]",templatePath);
    String template=Streams.copyToStringFromClasspath(templatePath);
    Files.write(template,dst,Charsets.UTF_8);
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  return settingsBuilder.build();
}
