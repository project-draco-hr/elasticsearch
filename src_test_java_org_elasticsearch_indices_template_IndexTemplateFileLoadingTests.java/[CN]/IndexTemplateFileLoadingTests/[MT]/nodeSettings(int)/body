{
  ImmutableSettings.Builder settingsBuilder=ImmutableSettings.settingsBuilder();
  settingsBuilder.put(super.nodeSettings(nodeOrdinal));
  try {
    Path directory=newTempDirPath();
    settingsBuilder.put("path.conf",directory.toAbsolutePath());
    Path templatesDir=directory.resolve("templates");
    Files.createDirectory(templatesDir);
    Path dst=templatesDir.resolve("template.json");
    String templatePath="/org/elasticsearch/indices/template/template" + randomInt(5) + ".json";
    logger.info("Picking template path [{}]",templatePath);
    String template=Streams.copyToStringFromClasspath(templatePath);
    Files.write(dst,template.getBytes(StandardCharsets.UTF_8));
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  return settingsBuilder.build();
}
