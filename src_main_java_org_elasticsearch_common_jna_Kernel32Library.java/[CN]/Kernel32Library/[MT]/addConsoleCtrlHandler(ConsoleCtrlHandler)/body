{
  if (internal == null) {
    throw new UnsupportedOperationException("windows/Kernel32 library not loaded, console ctrl handler cannot be set");
  }
  boolean result=false;
  if (handler != null) {
    NativeHandlerCallback callback=new NativeHandlerCallback(handler);
    result=internal.SetConsoleCtrlHandler(callback,true);
    if (result) {
      callbacks.add(callback);
    }
  }
  return result;
}
