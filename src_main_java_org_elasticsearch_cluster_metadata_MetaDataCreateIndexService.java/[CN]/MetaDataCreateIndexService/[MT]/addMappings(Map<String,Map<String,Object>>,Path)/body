{
  try (DirectoryStream<Path> stream=Files.newDirectoryStream(mappingsDir)){
    for (    Path mappingFile : stream) {
      final String fileName=mappingFile.getFileName().toString();
      if (Files.isHidden(mappingFile)) {
        continue;
      }
      int lastDotIndex=fileName.lastIndexOf('.');
      String mappingType=lastDotIndex != -1 ? mappingFile.getFileName().toString().substring(0,lastDotIndex) : mappingFile.getFileName().toString();
      try (BufferedReader reader=Files.newBufferedReader(mappingFile,Charsets.UTF_8)){
        String mappingSource=Streams.copyToString(reader);
        if (mappings.containsKey(mappingType)) {
          XContentHelper.mergeDefaults(mappings.get(mappingType),parseMapping(mappingSource));
        }
 else {
          mappings.put(mappingType,parseMapping(mappingSource));
        }
      }
 catch (      Exception e) {
        logger.warn("failed to read / parse mapping [" + mappingType + "] from location ["+ mappingFile+ "], ignoring...",e);
      }
    }
  }
 }
