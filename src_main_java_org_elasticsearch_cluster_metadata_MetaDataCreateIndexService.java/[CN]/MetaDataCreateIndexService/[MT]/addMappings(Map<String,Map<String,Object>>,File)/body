{
  File[] mappingsFiles=mappingsDir.listFiles();
  for (  File mappingFile : mappingsFiles) {
    if (mappingFile.isHidden()) {
      continue;
    }
    int lastDotIndex=mappingFile.getName().lastIndexOf('.');
    String mappingType=lastDotIndex != -1 ? mappingFile.getName().substring(0,lastDotIndex) : mappingFile.getName();
    try {
      String mappingSource=Streams.copyToString(new FileReader(mappingFile));
      if (mappings.containsKey(mappingType)) {
        XContentHelper.mergeDefaults(mappings.get(mappingType),parseMapping(mappingSource));
      }
 else {
        mappings.put(mappingType,parseMapping(mappingSource));
      }
    }
 catch (    Exception e) {
      logger.warn("failed to read / parse mapping [" + mappingType + "] from location ["+ mappingFile+ "], ignoring...",e);
    }
  }
}
