{
  ImmutableList<DiscoveryNode> nodes=this.nodes;
  if (nodes.isEmpty()) {
    throw new NoNodeAvailableException();
  }
  int index=randomNodeGenerator.incrementAndGet();
  if (index < 0) {
    index=0;
    randomNodeGenerator.set(0);
  }
  for (int i=0; i < nodes.size(); i++) {
    DiscoveryNode node=nodes.get((index + i) % nodes.size());
    try {
      return callback.doWithNode(node);
    }
 catch (    ConnectTransportException e) {
    }
  }
  throw new NoNodeAvailableException();
}
