{
  SearchSourceBuilder sourceBuilder=searchSource().query(termQuery("multi","test")).from(0).size(20).explain(true).facet(FacetBuilders.queryFacet("all",termQuery("multi","test")).global(true)).facet(FacetBuilders.queryFacet("test1",termQuery("name","test1")));
  SearchResponse searchResponse=client().search(searchRequest("test").source(sourceBuilder)).actionGet();
  assertThat("Failures " + Arrays.toString(searchResponse.getShardFailures()),searchResponse.getShardFailures().length,equalTo(0));
  assertThat(searchResponse.getHits().totalHits(),equalTo(100l));
  assertThat(searchResponse.getFacets().facet(QueryFacet.class,"test1").getCount(),equalTo(1l));
  assertThat(searchResponse.getFacets().facet(QueryFacet.class,"all").getCount(),equalTo(100l));
}
