{
  final Path configDir=getDataPath("config");
  final String level=randomFrom(Level.values()).toString();
  final Settings settings=Settings.builder().put(Environment.PATH_CONF_SETTING.getKey(),configDir.toAbsolutePath()).put(Environment.PATH_HOME_SETTING.getKey(),createTempDir().toString()).put("logger.level",level).build();
  final Environment environment=new Environment(settings);
  LogConfigurator.configure(environment);
  final String loggerName;
  if (LogManager.getContext(false).hasLogger("org.elasticsearch.test",new PrefixMessageFactory())) {
    loggerName="org.elasticsearch.test";
  }
 else {
    assertTrue(LogManager.getContext(false).hasLogger("test",new PrefixMessageFactory()));
    loggerName="test";
  }
  final Logger logger=ESLoggerFactory.getLogger(loggerName);
  assertThat(logger.getLevel().toString(),equalTo(level));
}
