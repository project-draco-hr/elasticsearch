{
  StringBuilder sb=new StringBuilder();
  XContentBuilder json=XContentFactory.jsonBuilder().startObject().field("field","value" + ThreadLocalRandom.current().nextInt());
  int fields=Math.abs(ThreadLocalRandom.current().nextInt()) % numberOfFields;
  for (int i=0; i < fields; i++) {
    json.field("num_" + i,ThreadLocalRandom.current().nextDouble());
    int tokens=ThreadLocalRandom.current().nextInt() % textTokens;
    sb.setLength(0);
    for (int j=0; j < tokens; j++) {
      sb.append(Strings.randomBase64UUID(random)).append(' ');
    }
    json.field("text_" + i,sb.toString());
  }
  json.endObject();
  String id=Long.toString(idCounter.incrementAndGet());
  client.client().prepareIndex("test","type1",id).setCreate(true).setSource(json).execute().actionGet();
  indexCounter.incrementAndGet();
}
