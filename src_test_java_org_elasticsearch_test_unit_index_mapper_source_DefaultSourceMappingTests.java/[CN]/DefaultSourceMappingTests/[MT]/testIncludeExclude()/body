{
  String mapping=XContentFactory.jsonBuilder().startObject().startObject("type").startObject("_source").field("includes",new String[]{"path1*"}).endObject().endObject().endObject().string();
  DocumentMapper documentMapper=MapperTests.newParser().parse(mapping);
  ParsedDocument doc=documentMapper.parse("type","1",XContentFactory.jsonBuilder().startObject().startObject("path1").field("field1","value1").endObject().startObject("path2").field("field2","value2").endObject().endObject().bytes());
  Fieldable sourceField=doc.rootDoc().getFieldable("_source");
  Map<String,Object> sourceAsMap=XContentFactory.xContent(XContentType.JSON).createParser(sourceField.getBinaryValue(),sourceField.getBinaryOffset(),sourceField.getBinaryLength()).mapAndClose();
  assertThat(sourceAsMap.containsKey("path1"),equalTo(true));
  assertThat(sourceAsMap.containsKey("path2"),equalTo(false));
}
