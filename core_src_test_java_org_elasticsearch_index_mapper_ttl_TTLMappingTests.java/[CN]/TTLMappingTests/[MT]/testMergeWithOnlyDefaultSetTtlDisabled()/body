{
  XContentBuilder mappingWithTtlEnabled=getMappingWithTtlDisabled("7d");
  IndexService indexService=createIndex("testindex",Settings.builder().build(),"type",mappingWithTtlEnabled);
  CompressedXContent mappingAfterCreation=indexService.mapperService().documentMapper("type").mappingSource();
  assertThat(mappingAfterCreation,equalTo(new CompressedXContent("{\"type\":{\"_ttl\":{\"enabled\":false},\"properties\":{\"field\":{\"type\":\"text\"}}}}")));
  XContentBuilder mappingWithOnlyDefaultSet=getMappingWithOnlyTtlDefaultSet("6m");
  indexService.mapperService().merge("type",new CompressedXContent(mappingWithOnlyDefaultSet.string()),MapperService.MergeReason.MAPPING_UPDATE,false);
  CompressedXContent mappingAfterMerge=indexService.mapperService().documentMapper("type").mappingSource();
  assertThat(mappingAfterMerge,equalTo(new CompressedXContent("{\"type\":{\"_ttl\":{\"enabled\":false},\"properties\":{\"field\":{\"type\":\"text\"}}}}")));
}
