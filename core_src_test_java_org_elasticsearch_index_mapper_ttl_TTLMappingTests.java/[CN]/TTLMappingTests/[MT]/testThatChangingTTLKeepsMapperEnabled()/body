{
  String mappingWithTtl=XContentFactory.jsonBuilder().startObject().startObject("type").startObject("_ttl").field("enabled","yes").endObject().startObject("properties").field("field").startObject().field("type","string").endObject().endObject().endObject().endObject().string();
  String updatedMapping=XContentFactory.jsonBuilder().startObject().startObject("type").startObject("_ttl").field("default","1w").endObject().startObject("properties").field("field").startObject().field("type","string").endObject().endObject().endObject().endObject().string();
  DocumentMapperParser parser=createIndex("test").mapperService().documentMapperParser();
  DocumentMapper initialMapper=parser.parse("type",new CompressedXContent(mappingWithTtl));
  DocumentMapper updatedMapper=parser.parse("type",new CompressedXContent(updatedMapping));
  initialMapper.merge(updatedMapper.mapping(),true,false);
  assertThat(initialMapper.TTLFieldMapper().enabled(),equalTo(true));
}
