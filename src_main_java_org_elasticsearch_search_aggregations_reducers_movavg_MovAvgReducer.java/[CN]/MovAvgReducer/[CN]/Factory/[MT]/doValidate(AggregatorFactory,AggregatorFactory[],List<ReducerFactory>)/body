{
  if (bucketsPaths.length != 1) {
    throw new IllegalStateException(Reducer.Parser.BUCKETS_PATH.getPreferredName() + " must contain a single entry for reducer [" + name+ "]");
  }
  if (!(parent instanceof HistogramAggregator.Factory)) {
    throw new IllegalStateException("derivative reducer [" + name + "] must have a histogram or date_histogram as parent");
  }
 else {
    HistogramAggregator.Factory histoParent=(HistogramAggregator.Factory)parent;
    if (histoParent.minDocCount() != 0) {
      throw new IllegalStateException("parent histogram of derivative reducer [" + name + "] must have min_doc_count of 0");
    }
  }
}
