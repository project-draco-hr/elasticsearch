{
  int numOps=0;
  try {
    for (    Translog.Operation operation : operations) {
      performRecoveryOperation(engine,operation,false);
      numOps++;
    }
    engine.getTranslog().sync();
  }
 catch (  Throwable t) {
    throw new BatchOperationException(shardId,"failed to apply batch translog operation",numOps,t);
  }
  return numOps;
}
