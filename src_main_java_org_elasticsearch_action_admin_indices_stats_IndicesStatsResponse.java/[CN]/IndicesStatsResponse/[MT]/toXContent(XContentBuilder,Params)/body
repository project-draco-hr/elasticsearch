{
  builder.startObject("_all");
  builder.startObject("primaries");
  getPrimaries().toXContent(builder,params);
  builder.endObject();
  builder.startObject("total");
  getTotal().toXContent(builder,params);
  builder.endObject();
  builder.endObject();
  builder.startObject(Fields.INDICES);
  for (  IndexStats indexStats : getIndices().values()) {
    builder.startObject(indexStats.getIndex(),XContentBuilder.FieldCaseConversion.NONE);
    builder.startObject("primaries");
    indexStats.getPrimaries().toXContent(builder,params);
    builder.endObject();
    builder.startObject("total");
    indexStats.getTotal().toXContent(builder,params);
    builder.endObject();
    if ("shards".equalsIgnoreCase(params.param("level",null))) {
      builder.startObject(Fields.SHARDS);
      for (      IndexShardStats indexShardStats : indexStats) {
        builder.startArray(Integer.toString(indexShardStats.getShardId().id()));
        for (        ShardStats shardStats : indexShardStats) {
          builder.startObject();
          builder.startObject(Fields.ROUTING).field(Fields.STATE,shardStats.getShardRouting().state()).field(Fields.PRIMARY,shardStats.getShardRouting().primary()).field(Fields.NODE,shardStats.getShardRouting().currentNodeId()).field(Fields.RELOCATING_NODE,shardStats.getShardRouting().relocatingNodeId()).endObject();
          shardStats.getStats().toXContent(builder,params);
          builder.endObject();
        }
        builder.endArray();
      }
      builder.endObject();
    }
    builder.endObject();
  }
  builder.endObject();
  return builder;
}
