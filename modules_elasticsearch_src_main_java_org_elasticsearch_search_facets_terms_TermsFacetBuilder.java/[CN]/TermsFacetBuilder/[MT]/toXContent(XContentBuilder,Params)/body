{
  if (fieldName == null) {
    throw new SearchSourceBuilderException("field must be set on terms facet for facet [" + name + "]");
  }
  builder.startObject(name);
  builder.startObject(TermsFacetCollectorParser.NAME);
  builder.field("field",fieldName);
  builder.field("size",size);
  if (exclude != null) {
    builder.startArray("exclude");
    for (    String ex : exclude) {
      builder.value(ex);
    }
    builder.endArray();
  }
  builder.endObject();
  if (filter != null) {
    builder.field("filter");
    filter.toXContent(builder,params);
  }
  if (global != null) {
    builder.field("global",global);
  }
  builder.endObject();
}
