{
  out.writeString(index);
  out.writeOptionalString(type);
  out.writeString(id);
  out.writeOptionalString(routing);
  if (out.getVersion().before(Version.V_0_90_1)) {
    if (fields == null) {
      out.writeVInt(0);
    }
 else {
      out.writeVInt(fields.length);
      for (      String field : fields) {
        out.writeString(field);
      }
    }
  }
 else {
    if (fields == null) {
      out.writeInt(-1);
    }
 else {
      out.writeInt(fields.length);
      for (      String field : fields) {
        out.writeString(field);
      }
    }
  }
}
