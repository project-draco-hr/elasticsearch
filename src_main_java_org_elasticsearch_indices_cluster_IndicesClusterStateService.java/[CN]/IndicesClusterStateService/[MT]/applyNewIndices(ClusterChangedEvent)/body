{
  RoutingNodes.RoutingNodeIterator routingNode=event.state().readOnlyRoutingNodes().routingNodeIter(event.state().nodes().localNodeId());
  if (routingNode == null) {
    return;
  }
  for (  MutableShardRouting shard : routingNode) {
    if (!indicesService.hasIndex(shard.index())) {
      final IndexMetaData indexMetaData=event.state().metaData().index(shard.index());
      if (logger.isDebugEnabled()) {
        logger.debug("[{}] creating index",indexMetaData.index());
      }
      try {
        indicesService.createIndex(indexMetaData.index(),indexMetaData.settings(),event.state().nodes().localNode().id());
      }
 catch (      Exception e) {
        logger.warn("failed to create index [{}]",e,indexMetaData.index());
      }
    }
  }
}
