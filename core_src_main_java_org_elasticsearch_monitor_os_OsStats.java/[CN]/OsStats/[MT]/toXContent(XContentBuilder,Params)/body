{
  builder.startObject(Fields.OS);
  builder.field(Fields.TIMESTAMP,getTimestamp());
  if (cpu != null) {
    builder.startObject(Fields.CPU);
    builder.field(Fields.PERCENT,cpu.getPercent());
    builder.field(Fields.LOAD_AVERAGE,cpu.getLoadAverage());
    builder.endObject();
  }
  if (mem != null) {
    builder.startObject(Fields.MEM);
    builder.byteSizeField(Fields.TOTAL_IN_BYTES,Fields.TOTAL,mem.getTotal());
    builder.byteSizeField(Fields.FREE_IN_BYTES,Fields.FREE,mem.getFree());
    builder.byteSizeField(Fields.USED_IN_BYTES,Fields.USED,mem.getUsed());
    builder.field(Fields.FREE_PERCENT,mem.getFreePercent());
    builder.field(Fields.USED_PERCENT,mem.getUsedPercent());
    builder.endObject();
  }
  if (swap != null) {
    builder.startObject(Fields.SWAP);
    builder.byteSizeField(Fields.TOTAL_IN_BYTES,Fields.TOTAL,swap.getTotal());
    builder.byteSizeField(Fields.FREE_IN_BYTES,Fields.FREE,swap.getFree());
    builder.byteSizeField(Fields.USED_IN_BYTES,Fields.USED,swap.getUsed());
    builder.endObject();
  }
  builder.endObject();
  return builder;
}
