{
  createIndex("test");
  ensureGreen("test");
  final XContentBuilder mapping=jsonBuilder().startObject().startObject("type").startObject("properties").startObject("foo").field("type","string").field("analyzer","kuromoji").endObject().endObject().endObject().endObject();
  client().admin().indices().preparePutMapping("test").setType("type").setSource(mapping).get();
  index("test","type","1","foo","JR??????????????????????????????????????????????????????");
  refresh();
  SearchResponse response=client().prepareSearch("test").setQuery(QueryBuilders.matchQuery("foo","jr")).execute().actionGet();
  assertThat(response.getHits().getTotalHits(),is(1L));
}
