{
  HashMap<String,ScriptMode> scriptModesMap=new HashMap<>();
  addGlobalScriptTypeModes(scriptEngines.keySet(),scriptContextRegistry,ScriptType.FILE,ScriptMode.ON,scriptModesMap);
  addGlobalScriptTypeModes(scriptEngines.keySet(),scriptContextRegistry,ScriptType.INDEXED,ScriptMode.SANDBOX,scriptModesMap);
  addGlobalScriptTypeModes(scriptEngines.keySet(),scriptContextRegistry,ScriptType.INLINE,ScriptMode.SANDBOX,scriptModesMap);
  processSourceBasedGlobalSettings(settings,scriptEngines,scriptContextRegistry,scriptModesMap);
  processOperationBasedGlobalSettings(settings,scriptEngines,scriptContextRegistry,scriptModesMap);
  processEngineSpecificSettings(settings,scriptEngines,scriptContextRegistry,scriptModesMap);
  return unmodifiableMap(scriptModesMap);
}
