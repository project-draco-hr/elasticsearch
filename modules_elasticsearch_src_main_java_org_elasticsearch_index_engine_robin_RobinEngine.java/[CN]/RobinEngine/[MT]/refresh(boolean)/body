{
  if (refreshMutex.compareAndSet(false,true)) {
    if (dirty) {
      dirty=false;
      try {
        AcquirableResource<ReaderSearcherHolder> current=nrtResource;
        IndexReader newReader=current.resource().reader().reopen(true);
        if (newReader != current.resource().reader()) {
          nrtResource=newAcquirableResource(new ReaderSearcherHolder(newReader));
          current.markForClose();
        }
      }
 catch (      IOException e) {
        throw new RefreshFailedEngineException(shardId,e);
      }
    }
    refreshMutex.set(false);
  }
}
