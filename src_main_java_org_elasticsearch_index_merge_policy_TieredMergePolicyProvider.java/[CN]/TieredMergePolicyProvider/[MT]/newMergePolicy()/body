{
  CustomTieredMergePolicyProvider mergePolicy;
  if (asyncMerge) {
    mergePolicy=new EnableMergeTieredMergePolicyProvider(this);
  }
 else {
    mergePolicy=new CustomTieredMergePolicyProvider(this);
  }
  mergePolicy.setUseCompoundFile(compoundFormat);
  mergePolicy.setForceMergeDeletesPctAllowed(forceMergeDeletesPctAllowed);
  mergePolicy.setFloorSegmentMB(floorSegment.mbFrac());
  mergePolicy.setMaxMergeAtOnce(maxMergeAtOnce);
  mergePolicy.setMaxMergeAtOnceExplicit(maxMergeAtOnceExplicit);
  mergePolicy.setMaxMergedSegmentMB(maxMergedSegment.mbFrac());
  mergePolicy.setSegmentsPerTier(segmentsPerTier);
  mergePolicy.setReclaimDeletesWeight(reclaimDeletesWeight);
  return mergePolicy;
}
