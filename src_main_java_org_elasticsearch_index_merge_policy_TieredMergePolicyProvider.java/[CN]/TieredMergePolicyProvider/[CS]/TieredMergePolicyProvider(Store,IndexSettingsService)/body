{
  super(store);
  this.indexSettingsService=indexSettingsService;
  double forceMergeDeletesPctAllowed=componentSettings.getAsDouble("expunge_deletes_allowed",DEFAULT_EXPUNGE_DELETES_ALLOWED);
  ByteSizeValue floorSegment=componentSettings.getAsBytesSize("floor_segment",DEFAULT_FLOOR_SEGMENT);
  int maxMergeAtOnce=componentSettings.getAsInt("max_merge_at_once",DEFAULT_MAX_MERGE_AT_ONCE);
  int maxMergeAtOnceExplicit=componentSettings.getAsInt("max_merge_at_once_explicit",DEFAULT_MAX_MERGE_AT_ONCE_EXPLICIT);
  ByteSizeValue maxMergedSegment=componentSettings.getAsBytesSize("max_merged_segment",DEFAULT_MAX_MERGED_SEGMENT);
  double segmentsPerTier=componentSettings.getAsDouble("segments_per_tier",DEFAULT_SEGMENTS_PER_TIER);
  double reclaimDeletesWeight=componentSettings.getAsDouble("reclaim_deletes_weight",DEFAULT_RECLAIM_DELETES_WEIGHT);
  maxMergeAtOnce=adjustMaxMergeAtOnceIfNeeded(maxMergeAtOnce,segmentsPerTier);
  mergePolicy.setNoCFSRatio(noCFSRatio);
  mergePolicy.setForceMergeDeletesPctAllowed(forceMergeDeletesPctAllowed);
  mergePolicy.setFloorSegmentMB(floorSegment.mbFrac());
  mergePolicy.setMaxMergeAtOnce(maxMergeAtOnce);
  mergePolicy.setMaxMergeAtOnceExplicit(maxMergeAtOnceExplicit);
  mergePolicy.setMaxMergedSegmentMB(maxMergedSegment.mbFrac());
  mergePolicy.setSegmentsPerTier(segmentsPerTier);
  mergePolicy.setReclaimDeletesWeight(reclaimDeletesWeight);
  logger.debug("using [tiered] merge mergePolicy with expunge_deletes_allowed[{}], floor_segment[{}], max_merge_at_once[{}], max_merge_at_once_explicit[{}], max_merged_segment[{}], segments_per_tier[{}], reclaim_deletes_weight[{}]",forceMergeDeletesPctAllowed,floorSegment,maxMergeAtOnce,maxMergeAtOnceExplicit,maxMergedSegment,segmentsPerTier,reclaimDeletesWeight);
  indexSettingsService.addListener(applySettings);
}
