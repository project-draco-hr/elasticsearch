{
  String mapping=XContentFactory.jsonBuilder().startObject().startObject("type").startObject("properties").startObject("field1").field("type","integer").field("doc_values_format","disk").endObject().startObject("field2").field("type","double").field("doc_values_format","my_format1").endObject().endObject().endObject().endObject().string();
  Settings indexSettings=ImmutableSettings.settingsBuilder().put("index.codec.doc_values_format.my_format1.type","disk").build();
  CodecService codecService=createCodecService(indexSettings);
  DocumentMapper documentMapper=codecService.mapperService().documentMapperParser().parse(mapping);
  assertThat(documentMapper.mappers().name("field1").mapper().docValuesFormatProvider(),instanceOf(PreBuiltDocValuesFormatProvider.class));
  assertThat(documentMapper.mappers().name("field1").mapper().docValuesFormatProvider().get(),instanceOf(Lucene49DocValuesFormat.class));
  assertThat(documentMapper.mappers().name("field2").mapper().docValuesFormatProvider(),instanceOf(DiskDocValuesFormatProvider.class));
}
