{
  if (dir instanceof FSDirectory) {
    File destinationFile=new File(((FSDirectory)dir).getFile(),fileName);
    if (!destinationFile.exists()) {
      destinationFile.createNewFile();
    }
    copyFile(copyFrom,destinationFile);
  }
 else {
    FileInputStream is=null;
    IndexOutput output=null;
    try {
      is=new FileInputStream(copyFrom);
      output=dir.createOutput(fileName);
      copyToDirectory(is,output);
    }
  finally {
      if (is != null) {
        try {
          is.close();
        }
 catch (        IOException e) {
        }
      }
      if (output != null) {
        try {
          output.close();
        }
 catch (        IOException e) {
        }
      }
    }
  }
  sync(dir,fileName);
}
