{
  if (dir instanceof FSDirectory) {
    File destinationFile=new File(((FSDirectory)dir).getFile(),fileName);
    if (!destinationFile.exists()) {
      destinationFile.createNewFile();
    }
    copyFile(copyFrom,destinationFile);
  }
 else {
    copyToDirectory(new FileInputStream(copyFrom),dir.createOutput(fileName));
  }
  if (dir instanceof ForceSyncDirectory) {
    ((ForceSyncDirectory)dir).forceSync(fileName);
  }
 else {
    dir.sync(fileName);
  }
}
