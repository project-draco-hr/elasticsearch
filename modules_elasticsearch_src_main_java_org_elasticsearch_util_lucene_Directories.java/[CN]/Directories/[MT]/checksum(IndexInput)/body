{
  final int BUFFER_SIZE=16384;
  byte[] buf=new byte[BUFFER_SIZE];
  ChecksumIndexInput cii=new ChecksumIndexInput(indexInput);
  long len=cii.length();
  long readCount=0;
  while (readCount < len) {
    int toRead=readCount + BUFFER_SIZE > len ? (int)(len - readCount) : BUFFER_SIZE;
    cii.readBytes(buf,0,toRead);
    readCount+=toRead;
  }
  cii.close();
  return cii.getChecksum();
}
