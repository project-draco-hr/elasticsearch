{
  InetAddress address=null;
  Enumeration intfs=NetworkInterface.getNetworkInterfaces();
  while (intfs.hasMoreElements()) {
    NetworkInterface intf=(NetworkInterface)intfs.nextElement();
    if (!intf.isUp() || intf.isLoopback())     continue;
    address=getFirstNonLoopbackAddress(intf,ip_version);
    if (address != null) {
      return address;
    }
  }
  return null;
}
