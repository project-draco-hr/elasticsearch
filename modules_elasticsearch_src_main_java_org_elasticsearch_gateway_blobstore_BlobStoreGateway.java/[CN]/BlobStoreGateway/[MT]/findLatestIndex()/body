{
  ImmutableMap<String,BlobMetaData> blobs=metaDataBlobContainer.listBlobsByPrefix("metadata-");
  int index=-1;
  for (  BlobMetaData md : blobs.values()) {
    if (logger.isTraceEnabled()) {
      logger.trace("[findLatestMetadata]: Processing [" + md.name() + "]");
    }
    String name=md.name();
    int fileIndex=Integer.parseInt(name.substring(name.indexOf('-') + 1));
    if (fileIndex >= index) {
      byte[] data=null;
      try {
        data=metaDataBlobContainer.readBlobFully(name);
        readMetaData(data);
        index=fileIndex;
      }
 catch (      IOException e) {
        logger.warn("[findLatestMetadata]: failed to read metadata from [{}], data_length [{}] ignoring...",e,name,data == null ? "na" : data.length);
      }
    }
  }
  return index;
}
