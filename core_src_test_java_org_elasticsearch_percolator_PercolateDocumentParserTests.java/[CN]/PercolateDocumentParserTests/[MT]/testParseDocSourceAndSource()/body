{
  XContentBuilder source=jsonBuilder().startObject().startObject("doc").field("field1","value1").endObject().startObject("query").startObject("term").field("field1","value1").endObject().endObject().field("track_scores",true).field("size",123).startObject("sort").startObject("_score").endObject().endObject().endObject();
  XContentBuilder docSource=jsonBuilder().startObject().field("field1","value1").endObject();
  Mockito.when(request.source()).thenReturn(source.bytes());
  Mockito.when(request.docSource()).thenReturn(docSource.bytes());
  PercolateContext context=new PercolateContext(request,new SearchShardTarget("_node",new Index("_index","_na_"),0),mapperService);
  try {
    parser.parse(request,context,mapperService,queryShardContext);
  }
 catch (  IllegalArgumentException e) {
    assertThat(e.getMessage(),equalTo("Can't specify the document to percolate in the source of the request and as document id"));
  }
}
