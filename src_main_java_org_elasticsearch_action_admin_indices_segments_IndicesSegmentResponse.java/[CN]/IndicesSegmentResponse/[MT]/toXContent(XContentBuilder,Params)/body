{
  builder.startObject(Fields.INDICES);
  for (  IndexSegments indexSegments : getIndices().values()) {
    builder.startObject(indexSegments.getIndex(),XContentBuilder.FieldCaseConversion.NONE);
    builder.startObject(Fields.SHARDS);
    for (    IndexShardSegments indexSegment : indexSegments) {
      builder.startArray(Integer.toString(indexSegment.getShardId().id()));
      for (      ShardSegments shardSegments : indexSegment) {
        builder.startObject();
        builder.startObject(Fields.ROUTING);
        builder.field(Fields.STATE,shardSegments.getShardRouting().state());
        builder.field(Fields.PRIMARY,shardSegments.getShardRouting().primary());
        builder.field(Fields.NODE,shardSegments.getShardRouting().currentNodeId());
        if (shardSegments.getShardRouting().relocatingNodeId() != null) {
          builder.field(Fields.RELOCATING_NODE,shardSegments.getShardRouting().relocatingNodeId());
        }
        builder.endObject();
        builder.field(Fields.NUM_COMMITTED_SEGMENTS,shardSegments.getNumberOfCommitted());
        builder.field(Fields.NUM_SEARCH_SEGMENTS,shardSegments.getNumberOfSearch());
        builder.startObject(Fields.SEGMENTS);
        for (        Segment segment : shardSegments) {
          builder.startObject(segment.name());
          builder.field(Fields.GENERATION,segment.generation());
          builder.field(Fields.NUM_DOCS,segment.numDocs());
          builder.field(Fields.DELETED_DOCS,segment.deletedDocs());
          builder.field(Fields.SIZE,segment.size().toString());
          builder.field(Fields.SIZE_IN_BYTES,segment.sizeInBytes());
          builder.field(Fields.COMMITTED,segment.committed());
          builder.field(Fields.SEARCH,segment.search());
          builder.endObject();
        }
        builder.endObject();
        builder.endObject();
      }
      builder.endArray();
    }
    builder.endObject();
    builder.endObject();
  }
  builder.endObject();
  return builder;
}
