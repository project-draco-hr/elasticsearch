{
  builder.startObject(Fields.INDICES);
  for (  IndexSegments indexSegments : indices().values()) {
    builder.startObject(indexSegments.index(),XContentBuilder.FieldCaseConversion.NONE);
    builder.startObject(Fields.SHARDS);
    for (    IndexShardSegments indexSegment : indexSegments) {
      builder.startArray(Integer.toString(indexSegment.shardId().id()));
      for (      ShardSegments shardSegments : indexSegment) {
        builder.startObject();
        builder.startObject(Fields.ROUTING);
        builder.field(Fields.STATE,shardSegments.shardRouting().state());
        builder.field(Fields.PRIMARY,shardSegments.shardRouting().primary());
        builder.field(Fields.NODE,shardSegments.shardRouting().currentNodeId());
        if (shardSegments.shardRouting().relocatingNodeId() != null) {
          builder.field(Fields.RELOCATING_NODE,shardSegments.shardRouting().relocatingNodeId());
        }
        builder.endObject();
        builder.field(Fields.NUM_COMMITTED_SEGMENTS,shardSegments.numberOfCommitted());
        builder.field(Fields.NUM_SEARCH_SEGMENTS,shardSegments.numberOfSearch());
        builder.startObject(Fields.SEGMENTS);
        for (        Segment segment : shardSegments) {
          builder.startObject(segment.name());
          builder.field(Fields.GENERATION,segment.generation());
          builder.field(Fields.NUM_DOCS,segment.numDocs());
          builder.field(Fields.DELETED_DOCS,segment.deletedDocs());
          builder.field(Fields.SIZE,segment.size().toString());
          builder.field(Fields.SIZE_IN_BYTES,segment.sizeInBytes());
          builder.field(Fields.COMMITTED,segment.committed());
          builder.field(Fields.SEARCH,segment.search());
          builder.endObject();
        }
        builder.endObject();
        builder.endObject();
      }
      builder.endArray();
    }
    builder.endObject();
    builder.endObject();
  }
  builder.endObject();
  return builder;
}
