{
  if (out.getVersion().onOrAfter(org.elasticsearch.Version.V_1_4_0_Beta1)) {
    if (explanation instanceof ComplexExplanation) {
      out.writeBoolean(true);
      out.writeOptionalBoolean(((ComplexExplanation)explanation).getMatch());
    }
 else {
      out.writeBoolean(false);
    }
  }
  out.writeFloat(explanation.getValue());
  out.writeString(explanation.getDescription());
  Explanation[] subExplanations=explanation.getDetails();
  if (subExplanations == null) {
    out.writeBoolean(false);
  }
 else {
    out.writeBoolean(true);
    out.writeVInt(subExplanations.length);
    for (    Explanation subExp : subExplanations) {
      writeExplanation(out,subExp);
    }
  }
}
