{
  if (topDocs.scoreDocs.length - from < 0) {
    out.writeBoolean(false);
    return;
  }
  out.writeBoolean(true);
  if (topDocs instanceof TopFieldDocs) {
    out.writeBoolean(true);
    TopFieldDocs topFieldDocs=(TopFieldDocs)topDocs;
    out.writeVInt(topDocs.totalHits);
    out.writeFloat(topDocs.getMaxScore());
    out.writeVInt(topFieldDocs.fields.length);
    for (    SortField sortField : topFieldDocs.fields) {
      if (sortField.getField() == null) {
        out.writeBoolean(false);
      }
 else {
        out.writeBoolean(true);
        out.writeString(sortField.getField());
      }
      if (sortField.getComparatorSource() != null) {
        writeSortType(out,((FieldDataType.ExtendedFieldComparatorSource)sortField.getComparatorSource()).reducedType());
      }
 else {
        writeSortType(out,sortField.getType());
      }
      out.writeBoolean(sortField.getReverse());
    }
    out.writeVInt(topDocs.scoreDocs.length - from);
    int index=0;
    for (    ScoreDoc doc : topFieldDocs.scoreDocs) {
      if (index++ < from) {
        continue;
      }
      FieldDoc fieldDoc=(FieldDoc)doc;
      out.writeVInt(fieldDoc.fields.length);
      for (      Object field : fieldDoc.fields) {
        if (field == null) {
          out.writeByte((byte)0);
        }
 else {
          Class type=field.getClass();
          if (type == String.class) {
            out.writeByte((byte)1);
            out.writeString((String)field);
          }
 else           if (type == Integer.class) {
            out.writeByte((byte)2);
            out.writeInt((Integer)field);
          }
 else           if (type == Long.class) {
            out.writeByte((byte)3);
            out.writeLong((Long)field);
          }
 else           if (type == Float.class) {
            out.writeByte((byte)4);
            out.writeFloat((Float)field);
          }
 else           if (type == Double.class) {
            out.writeByte((byte)5);
            out.writeDouble((Double)field);
          }
 else           if (type == Byte.class) {
            out.writeByte((byte)6);
            out.writeByte((Byte)field);
          }
 else           if (type == Short.class) {
            out.writeByte((byte)7);
            out.writeShort((Short)field);
          }
 else           if (type == Boolean.class) {
            out.writeByte((byte)8);
            out.writeBoolean((Boolean)field);
          }
 else           if (type == BytesRef.class) {
            out.writeByte((byte)9);
            out.writeBytesRef((BytesRef)field);
          }
 else {
            throw new IOException("Can't handle sort field value of type [" + type + "]");
          }
        }
      }
      out.writeVInt(doc.doc);
      out.writeFloat(doc.score);
    }
  }
 else {
    out.writeBoolean(false);
    out.writeVInt(topDocs.totalHits);
    out.writeFloat(topDocs.getMaxScore());
    out.writeVInt(topDocs.scoreDocs.length - from);
    int index=0;
    for (    ScoreDoc doc : topDocs.scoreDocs) {
      if (index++ < from) {
        continue;
      }
      out.writeVInt(doc.doc);
      out.writeFloat(doc.score);
    }
  }
}
