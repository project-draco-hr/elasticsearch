{
  TotalHitCountCollector countCollector=new TotalHitCountCollector();
  if (!(query instanceof ConstantScoreQuery)) {
    query=new XLuceneConstantScoreQuery(query);
  }
  searcher.search(query,countCollector);
  return countCollector.getTotalHits();
}
