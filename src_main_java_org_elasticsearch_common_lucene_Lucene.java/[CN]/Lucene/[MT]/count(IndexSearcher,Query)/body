{
  TotalHitCountCollector countCollector=new TotalHitCountCollector();
  query=wrapCountQuery(query);
  searcher.search(query,countCollector);
  return countCollector.getTotalHits();
}
