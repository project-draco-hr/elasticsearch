{
  IndexQueryParserService queryParser=queryParser();
  Query parsedQuery=queryParser.parse(filteredQuery(termQuery("name.first","shay"),boolQuery().must(termQuery("name.first","shay1")).must(termQuery("name.first","shay4")).mustNot(termQuery("name.first","shay2")).should(termQuery("name.first","shay3")))).query();
  BooleanQuery.Builder filter=new BooleanQuery.Builder();
  filter.add(new TermQuery(new Term("name.first","shay1")),Occur.MUST);
  filter.add(new TermQuery(new Term("name.first","shay4")),Occur.MUST);
  filter.add(new TermQuery(new Term("name.first","shay2")),Occur.MUST_NOT);
  filter.add(new TermQuery(new Term("name.first","shay3")),Occur.SHOULD);
  filter.setMinimumNumberShouldMatch(1);
  Query expected=Queries.filtered(new TermQuery(new Term("name.first","shay")),filter.build());
  assertEquals(expected,parsedQuery);
}
