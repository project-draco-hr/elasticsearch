{
  Settings settings=Settings.settingsBuilder().put("index.cache.filter.type","none").put("name","SimpleIndexQueryParserTests").build();
  IndexService indexService=createIndex("test",settings);
  MapperService mapperService=indexService.mapperService();
  String mapping=copyToStringFromClasspath("/org/elasticsearch/index/query/mapping.json");
  mapperService.merge("person",new CompressedXContent(mapping),true,false);
  ParsedDocument doc=mapperService.documentMapper("person").parse("person","1",new BytesArray(copyToBytesFromClasspath("/org/elasticsearch/index/query/data.json")));
  assertNotNull(doc.dynamicMappingsUpdate());
  client().admin().indices().preparePutMapping("test").setType("person").setSource(doc.dynamicMappingsUpdate().toString()).get();
  queryParser=indexService.queryParserService();
}
