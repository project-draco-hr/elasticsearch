{
  IndexQueryParserService queryParser=queryParser();
  Query parsedQuery=queryParser.parse(multiMatchQuery("banon","name.first^2","name.last^3","foobar").type(MultiMatchQueryBuilder.Type.CROSS_FIELDS)).query();
  try (Engine.Searcher searcher=indexService.shardSafe(0).acquireSearcher("test")){
    Query rewrittenQuery=searcher.searcher().rewrite(parsedQuery);
    BooleanQuery expected=new BooleanQuery();
    expected.add(new TermQuery(new Term("foobar","banon")),Occur.SHOULD);
    TermQuery tq1=new TermQuery(new Term("name.first","banon"));
    tq1.setBoost(2);
    TermQuery tq2=new TermQuery(new Term("name.last","banon"));
    tq2.setBoost(3);
    expected.add(new DisjunctionMaxQuery(Arrays.<Query>asList(tq1,tq2),0f),Occur.SHOULD);
    assertEquals(expected,rewrittenQuery);
  }
 }
