{
  T t=null;
  try {
    t=supplier.get();
    final Properties props=new NoDuplicatesProperties();
    properties.accept(t,props);
    final Map<String,String> result=new HashMap<>();
    for (    Map.Entry entry : props.entrySet()) {
      result.put((String)entry.getKey(),(String)entry.getValue());
    }
    return result;
  }
  finally {
    IOUtils.closeWhileHandlingException(t);
  }
}
