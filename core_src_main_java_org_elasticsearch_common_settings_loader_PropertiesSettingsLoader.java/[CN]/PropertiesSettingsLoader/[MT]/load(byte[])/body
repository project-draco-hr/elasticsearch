{
  Properties props=new NoDuplicatesProperties();
  StreamInput stream=StreamInput.wrap(source);
  try {
    props.load(stream);
    Map<String,String> result=new HashMap<>();
    for (    Map.Entry entry : props.entrySet()) {
      result.put((String)entry.getKey(),(String)entry.getValue());
    }
    return result;
  }
  finally {
    IOUtils.closeWhileHandlingException(stream);
  }
}
