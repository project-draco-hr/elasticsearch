{
  Settings settings=settingsBuilder().put("cluster.name",internalCluster().getClusterName()).put(TransportModule.TRANSPORT_TYPE_KEY,NettyTransport.class.getName()).put("path.home",createTempDir().toString()).build();
  try (TransportClient transportClient=new TransportClient(settings,false)){
    transportClient.addTransportAddress(new InetSocketTransportAddress("127.0.0.1",randomPort));
    ClusterHealthResponse response=transportClient.admin().cluster().prepareHealth().get();
    assertThat(response.getStatus(),is(ClusterHealthStatus.GREEN));
  }
 }
