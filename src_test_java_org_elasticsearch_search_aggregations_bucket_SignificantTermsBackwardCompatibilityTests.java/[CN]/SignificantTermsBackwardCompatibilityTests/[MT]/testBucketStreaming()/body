{
  logger.debug("testBucketStreaming: indexing documents");
  String type=randomBoolean() ? "string" : "long";
  String settings="{\"index.number_of_shards\": 5, \"index.number_of_replicas\": 0}";
  index01Docs(type,settings);
  logClusterState();
  boolean upgraded;
  int upgradedNodesCounter=1;
  do {
    logger.debug("testBucketStreaming: upgrading {}st node",upgradedNodesCounter++);
    upgraded=backwardsCluster().upgradeOneNode();
    ensureGreen();
    logClusterState();
    checkSignificantTermsAggregationCorrect();
  }
 while (upgraded);
  logger.debug("testBucketStreaming: done testing significant terms while upgrading");
}
