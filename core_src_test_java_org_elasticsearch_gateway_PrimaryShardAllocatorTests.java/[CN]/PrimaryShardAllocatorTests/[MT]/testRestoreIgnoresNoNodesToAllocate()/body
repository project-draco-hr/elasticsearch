{
  MetaData metaData=MetaData.builder().put(IndexMetaData.builder(shardId.getIndex()).settings(settings(Version.CURRENT)).numberOfShards(1).numberOfReplicas(0)).build();
  RoutingTable routingTable=RoutingTable.builder().addAsRestore(metaData.index(shardId.getIndex()),new RestoreSource(new SnapshotId("test","test"),Version.CURRENT,shardId.getIndex())).build();
  ClusterState state=ClusterState.builder(org.elasticsearch.cluster.ClusterName.DEFAULT).metaData(metaData).routingTable(routingTable).nodes(DiscoveryNodes.builder().put(node1).put(node2).put(node3)).build();
  RoutingAllocation allocation=new RoutingAllocation(yesAllocationDeciders(),state.routingNodes(),state.nodes(),null);
  testAllocator.addData(node1,-1).addData(node2,-1);
  boolean changed=testAllocator.allocateUnassigned(allocation);
  assertThat(changed,equalTo(false));
  assertThat(allocation.routingNodes().ignoredUnassigned().isEmpty(),equalTo(true));
}
