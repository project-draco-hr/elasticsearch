{
  MetaData metaData=MetaData.builder().put(IndexMetaData.builder(shardId.getIndex()).settings(settings(version)).numberOfShards(1).numberOfReplicas(0).putActiveAllocationIds(0,new HashSet<>(Arrays.asList(activeAllocationIds)))).build();
  RoutingTable.Builder routingTableBuilder=RoutingTable.builder();
  if (asNew) {
    routingTableBuilder.addAsNew(metaData.index(shardId.getIndex()));
  }
 else {
    routingTableBuilder.addAsRecovery(metaData.index(shardId.getIndex()));
  }
  ClusterState state=ClusterState.builder(org.elasticsearch.cluster.ClusterName.DEFAULT).metaData(metaData).routingTable(routingTableBuilder.build()).nodes(DiscoveryNodes.builder().put(node1).put(node2).put(node3)).build();
  return new RoutingAllocation(deciders,new RoutingNodes(state,false),state.nodes(),null,System.nanoTime());
}
