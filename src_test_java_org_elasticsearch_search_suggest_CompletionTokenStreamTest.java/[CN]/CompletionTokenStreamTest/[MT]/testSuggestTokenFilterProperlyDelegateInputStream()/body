{
  TokenStream tokenStream=new MockTokenizer(new StringReader("mykeyword"),MockTokenizer.WHITESPACE,true);
  BytesRef payload=new BytesRef("Surface keyword|friggin payload|10");
  TokenStream suggestTokenStream=new ByteTermAttrToCharTermAttrFilter(new CompletionTokenStream(tokenStream,payload,new CompletionTokenStream.ToFiniteStrings(){
    @Override public Set<IntsRef> toFiniteStrings(    TokenStream stream) throws IOException {
      return suggester.toFiniteStrings(suggester.getTokenStreamToAutomaton(),stream);
    }
  }
));
  TermToBytesRefAttribute termAtt=suggestTokenStream.getAttribute(TermToBytesRefAttribute.class);
  BytesRef ref=termAtt.getBytesRef();
  assertNotNull(ref);
  suggestTokenStream.reset();
  while (suggestTokenStream.incrementToken()) {
    termAtt.fillBytesRef();
    assertThat(ref.utf8ToString(),equalTo("mykeyword"));
  }
  suggestTokenStream.end();
  suggestTokenStream.close();
}
