{
  if (!closed) {
    flushBuffer();
    long metaDataPointerValue=out.getFilePointer();
    out.writeVLong(uncompressedPosition);
    out.writeVInt(offsets.size());
    for (TLongIterator it=offsets.iterator(); it.hasNext(); ) {
      out.writeVLong(it.next());
    }
    out.seek(metaDataPointer);
    out.writeLong(metaDataPointerValue);
    closed=true;
    doClose();
    out.close();
  }
}
