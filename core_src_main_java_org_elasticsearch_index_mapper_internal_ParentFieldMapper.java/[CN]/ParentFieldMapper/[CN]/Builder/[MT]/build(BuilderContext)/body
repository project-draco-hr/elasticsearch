{
  if (parentType == null) {
    throw new MapperParsingException("[_parent] field mapping must contain the [type] option");
  }
  parentJoinFieldType.setNames(new MappedFieldType.Names(joinField(documentType)));
  parentJoinFieldType.setFieldDataType(null);
  childJoinFieldType.setNames(new MappedFieldType.Names(joinField(parentType)));
  if (context.indexCreatedVersion().before(Version.V_2_0_0_beta1)) {
    childJoinFieldType.setHasDocValues(false);
    childJoinFieldType.setDocValuesType(DocValuesType.NONE);
    parentJoinFieldType.setHasDocValues(false);
    parentJoinFieldType.setDocValuesType(DocValuesType.NONE);
  }
  return new ParentFieldMapper(fieldType,parentJoinFieldType,childJoinFieldType,parentType,context.indexSettings());
}
