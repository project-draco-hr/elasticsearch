{
  if (parentType == null) {
    throw new MapperParsingException("[_parent] field mapping must contain the [type] option");
  }
  parentJoinFieldType.setName(joinField(documentType));
  parentJoinFieldType.setFieldDataType(null);
  childJoinFieldType.setName(joinField(parentType));
  return new ParentFieldMapper(fieldType,parentJoinFieldType,childJoinFieldType,parentType,context.indexSettings());
}
