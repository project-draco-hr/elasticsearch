{
  if (parentType == null) {
    throw new MapperParsingException("[_parent] field mapping must contain the [type] option");
  }
  parentJoinFieldType.setNames(new MappedFieldType.Names(joinField(documentType)));
  parentJoinFieldType.setFieldDataType(null);
  childJoinFieldType.setNames(new MappedFieldType.Names(joinField(parentType)));
  return new ParentFieldMapper(fieldType,parentJoinFieldType,childJoinFieldType,parentType,context.indexSettings());
}
