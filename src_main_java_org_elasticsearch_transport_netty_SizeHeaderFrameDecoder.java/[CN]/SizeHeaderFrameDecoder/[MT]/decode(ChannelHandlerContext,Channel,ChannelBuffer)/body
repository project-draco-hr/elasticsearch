{
  if (buffer.readableBytes() < 6) {
    return null;
  }
  int readerIndex=buffer.readerIndex();
  if (buffer.getByte(readerIndex) != 'E' || buffer.getByte(readerIndex + 1) != 'S') {
    throw new StreamCorruptedException("invalid internal transport message format");
  }
  int dataLen=buffer.getInt(buffer.readerIndex() + 2);
  if (dataLen <= 0) {
    throw new StreamCorruptedException("invalid data length: " + dataLen);
  }
  if (dataLen > NINETY_PER_HEAP_SIZE) {
    throw new TooLongFrameException("transport content length received [" + new ByteSizeValue(dataLen) + "] exceeded ["+ new ByteSizeValue(NINETY_PER_HEAP_SIZE)+ "]");
  }
  if (buffer.readableBytes() < dataLen + 6) {
    return null;
  }
  buffer.skipBytes(6);
  return buffer;
}
