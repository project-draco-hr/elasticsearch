{
  keyScript.setNextDocId(doc);
  valueScript.setNextDocId(doc);
  long bucket;
  if (interval == 0) {
    bucket=keyScript.runAsLong();
  }
 else {
    bucket=bucket(keyScript.runAsDouble(),interval);
  }
  double value=valueScript.runAsDouble();
  InternalFullHistogramFacet.FullEntry entry=entries.get(bucket);
  if (entry == null) {
    entry=new InternalFullHistogramFacet.FullEntry(bucket,1,value,value,1,value);
    entries.put(bucket,entry);
  }
 else {
    entry.count++;
    entry.totalCount++;
    entry.total+=value;
    if (value < entry.min) {
      entry.min=value;
    }
    if (value > entry.max) {
      entry.max=value;
    }
  }
}
