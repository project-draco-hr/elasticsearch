{
  assertThat(query,notNullValue());
  if (queryBuilder.fields().size() > 1) {
    assertThat(query,instanceOf(BooleanQuery.class));
    BooleanQuery booleanQuery=(BooleanQuery)query;
    assertThat(booleanQuery.clauses().size(),equalTo(queryBuilder.fields().size()));
    Iterator<String> fields=queryBuilder.fields().keySet().iterator();
    for (    BooleanClause booleanClause : booleanQuery) {
      assertThat(booleanClause.getQuery(),instanceOf(TermQuery.class));
      TermQuery termQuery=(TermQuery)booleanClause.getQuery();
      assertThat(termQuery.getTerm(),equalTo(new Term(fields.next(),queryBuilder.value().toLowerCase(Locale.ROOT))));
    }
  }
 else {
    assertThat(query,instanceOf(TermQuery.class));
    String field;
    if (queryBuilder.fields().size() == 0) {
      field=MetaData.ALL;
    }
 else {
      field=queryBuilder.fields().keySet().iterator().next();
    }
    TermQuery termQuery=(TermQuery)query;
    assertThat(termQuery.getTerm(),equalTo(new Term(field,queryBuilder.value().toLowerCase(Locale.ROOT))));
  }
}
