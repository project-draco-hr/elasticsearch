{
  if (!(aSource.getProtocol().equals(aDest.getProtocol()) || ("http".equals(aSource.getProtocol()) && "https".equals(aDest.getProtocol())))) {
    String message="Redirection detected from " + aSource.getProtocol() + " to "+ aDest.getProtocol()+ ". Protocol switch unsafe, not allowed.";
    throw new IOException(message);
  }
  redirections++;
  if (redirections > 5) {
    String message="More than " + 5 + " times redirected, giving up";
    throw new IOException(message);
  }
  return true;
}
