{
  final StatementMetadata trapsmd=metadata.getStatementMetadata(ctx);
  final Branch branch=utility.getBranch(ctx);
  final Label jump=new Label();
  final BlockContext blockctx=ctx.block();
  final EmptyscopeContext emptyctx=ctx.emptyscope();
  execute.mark(jump);
  execute.visitVarInsn(trapsmd.exception.type.getOpcode(Opcodes.ISTORE),trapsmd.slot);
  if (blockctx != null) {
    writer.visit(ctx.block());
  }
 else   if (emptyctx == null) {
    throw new IllegalStateException(WriterUtility.error(ctx) + "Unexpected state.");
  }
  execute.visitTryCatchBlock(branch.begin,branch.end,jump,trapsmd.exception.type.getInternalName());
  if (branch.tru != null && !trapsmd.allLast) {
    execute.goTo(branch.tru);
  }
}
