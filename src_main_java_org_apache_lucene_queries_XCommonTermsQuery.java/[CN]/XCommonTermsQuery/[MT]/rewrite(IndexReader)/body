{
  if (this.terms.isEmpty()) {
    return new BooleanQuery();
  }
 else   if (this.terms.size() == 1) {
    final TermQuery tq=new TermQuery(this.terms.get(0));
    tq.setBoost(getBoost());
    return tq;
  }
  final List<AtomicReaderContext> leaves=reader.leaves();
  final int maxDoc=reader.maxDoc();
  final TermContext[] contextArray=new TermContext[terms.size()];
  final Term[] queryTerms=this.terms.toArray(new Term[0]);
  collectTermContext(reader,leaves,contextArray,queryTerms);
  return buildQuery(maxDoc,contextArray,queryTerms);
}
