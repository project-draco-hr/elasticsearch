{
  String matchField=ConfigurationUtils.readStringProperty(TYPE,processorTag,config,"field");
  String matchPattern=ConfigurationUtils.readStringProperty(TYPE,processorTag,config,"pattern");
  Map<String,String> customPatternBank=ConfigurationUtils.readOptionalMap(TYPE,processorTag,config,"pattern_definitions");
  Map<String,String> patternBank=new HashMap<>(builtinPatterns);
  if (customPatternBank != null) {
    patternBank.putAll(customPatternBank);
  }
  Grok grok;
  try {
    grok=new Grok(patternBank,matchPattern);
  }
 catch (  Exception e) {
    throw newConfigurationException(TYPE,processorTag,"pattern","Invalid regex pattern. " + e.getMessage());
  }
  return new GrokProcessor(processorTag,grok,matchField);
}
