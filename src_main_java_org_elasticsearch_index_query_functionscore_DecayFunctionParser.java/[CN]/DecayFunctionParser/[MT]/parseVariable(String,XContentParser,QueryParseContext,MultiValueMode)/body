{
  MapperService.SmartNameFieldMappers smartMappers=parseContext.smartFieldMappers(fieldName);
  if (smartMappers == null || !smartMappers.hasMapper()) {
    throw new QueryParsingException(parseContext,"Unknown field [" + fieldName + "]");
  }
  FieldMapper<?> mapper=smartMappers.fieldMappers().mapper();
  parser.nextToken();
  if (mapper instanceof DateFieldMapper) {
    return parseDateVariable(fieldName,parser,parseContext,(DateFieldMapper)mapper,mode);
  }
 else   if (mapper instanceof GeoPointFieldMapper) {
    return parseGeoVariable(fieldName,parser,parseContext,(GeoPointFieldMapper)mapper,mode);
  }
 else   if (mapper instanceof NumberFieldMapper<?>) {
    return parseNumberVariable(fieldName,parser,parseContext,(NumberFieldMapper<?>)mapper,mode);
  }
 else {
    throw new QueryParsingException(parseContext,"Field " + fieldName + " is of type "+ mapper.fieldType()+ ", but only numeric types are supported.");
  }
}
