{
  MapperService.SmartNameFieldMappers smartMappers=parseContext.smartFieldMappers(fieldName);
  if (smartMappers == null || !smartMappers.hasMapper()) {
    throw new QueryParsingException(parseContext.index(),"Unknown field [" + fieldName + "]");
  }
  FieldMapper<?> mapper=smartMappers.fieldMappers().mapper();
  if (mapper instanceof DateFieldMapper) {
    return parseDateVariable(fieldName,parser,parseContext,(DateFieldMapper)mapper);
  }
 else   if (mapper instanceof GeoStringFieldMapper) {
    return parseGeoVariable(fieldName,parser,parseContext,(GeoStringFieldMapper)mapper);
  }
 else   if (mapper instanceof NumberFieldMapper<?>) {
    return parseNumberVariable(fieldName,parser,parseContext,(NumberFieldMapper<?>)mapper);
  }
 else {
    throw new QueryParsingException(parseContext.index(),"Field " + fieldName + " is of type "+ mapper.fieldType()+ ", but only numeric types are supported.");
  }
}
