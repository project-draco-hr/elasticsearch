{
  MapperService.SmartNameFieldMappers smartMappers=parseContext.smartFieldMappers(fieldName);
  if (smartMappers == null || !smartMappers.hasMapper()) {
    throw new QueryParsingException(parseContext.index(),"Unknown field [" + fieldName + "]");
  }
  FieldMappers mappers=smartMappers.fieldMappers();
  List<FieldMapper> allMappers=mappers.mappers();
  if (allMappers.size() != 1) {
    throw new QueryParsingException(parseContext.index(),"The field name [" + fieldName + "] is ambiguous! Please set the full name of the field");
  }
  FieldMapper<?> mapper=allMappers.get(0);
  if (mapper instanceof DateFieldMapper) {
    return parseDateVariable(fieldName,parser,parseContext,(DateFieldMapper)mapper);
  }
 else   if (mapper instanceof GeoStringFieldMapper) {
    return parseGeoVariable(fieldName,parser,parseContext,(GeoStringFieldMapper)mapper);
  }
 else   if (mapper instanceof NumberFieldMapper<?>) {
    return parseNumberVariable(fieldName,parser,parseContext,(NumberFieldMapper<?>)mapper);
  }
 else {
    throw new QueryParsingException(parseContext.index(),"Field " + fieldName + " is of type "+ mapper.fieldType()+ ", but only numeric types are supported.");
  }
}
