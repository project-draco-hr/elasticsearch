{
  Processor.Factory factory=processorRegistry.get(type);
  if (factory != null) {
    List<Processor> onFailureProcessors=readProcessors("on_failure",processorRegistry,config);
    Processor processor=factory.create(config);
    if (config.isEmpty() == false) {
      throw new IllegalArgumentException("processor [" + type + "] doesn't support one or more provided configuration parameters "+ Arrays.toString(config.keySet().toArray()));
    }
    if (onFailureProcessors.isEmpty()) {
      return processor;
    }
 else {
      return new CompoundProcessor(Arrays.asList(processor),onFailureProcessors);
    }
  }
 else {
    throw new IllegalArgumentException("No processor type exist with name [" + type + "]");
  }
}
