{
  Map<String,Object> root;
  try {
    root=XContentFactory.xContent(source).createParser(source).mapOrderedAndClose();
  }
 catch (  Exception e) {
    throw new MapperParsingException("failed to parse mapping definition",e);
  }
  int size=root.size();
switch (size) {
case 0:
    throw new MapperParsingException("malformed mapping no root object found");
case 1:
  break;
default :
throw new MapperParsingException("mapping must have the `type` as the root object");
}
String rootName=root.keySet().iterator().next();
if (type == null) {
type=rootName;
}
return new Tuple<String,Map<String,Object>>(type,(Map<String,Object>)root.get(rootName));
}
