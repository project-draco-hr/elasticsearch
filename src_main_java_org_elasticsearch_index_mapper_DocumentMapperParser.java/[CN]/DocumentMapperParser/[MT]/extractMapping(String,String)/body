{
  Map<String,Object> root;
  try {
    root=XContentFactory.xContent(source).createParser(source).mapOrderedAndClose();
  }
 catch (  Exception e) {
    throw new MapperParsingException("failed to parse mapping definition",e);
  }
  if (root.keySet().size() != 1) {
    throw new MapperParsingException("mapping must have the `type` as the root object");
  }
  String rootName=root.keySet().iterator().next();
  if (type == null) {
    type=rootName;
  }
  return new Tuple<String,Map<String,Object>>(type,(Map<String,Object>)root.get(rootName));
}
