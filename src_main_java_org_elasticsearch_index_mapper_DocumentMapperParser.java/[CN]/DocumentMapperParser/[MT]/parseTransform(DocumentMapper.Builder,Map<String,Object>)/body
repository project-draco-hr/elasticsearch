{
  String script=(String)transformConfig.remove("script_file");
  ScriptType scriptType=ScriptType.FILE;
  if (script == null) {
    script=(String)transformConfig.remove("script_id");
    scriptType=ScriptType.INDEXED;
  }
  if (script == null) {
    script=(String)transformConfig.remove("script");
    scriptType=ScriptType.INLINE;
  }
  if (script != null) {
    String scriptLang=(String)transformConfig.remove("lang");
    Map<String,Object> params=(Map<String,Object>)transformConfig.remove("params");
    docBuilder.transform(scriptService,script,scriptType,scriptLang,params);
  }
  if (!transformConfig.isEmpty()) {
    throw new MapperParsingException("Unrecognized parameter in transform config:  " + getRemainingFields(transformConfig));
  }
}
