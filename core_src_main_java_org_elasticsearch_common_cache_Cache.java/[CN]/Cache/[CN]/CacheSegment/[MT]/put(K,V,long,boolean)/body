{
  Entry<K,V> entry=new Entry<>(key,value,now);
  lock.writeLock().lock();
  Entry<K,V> existing=null;
  if (!onlyIfAbsent || (onlyIfAbsent && map.get(key) == null)) {
    existing=map.put(key,entry);
  }
  lock.writeLock().unlock();
  return Tuple.tuple(entry,existing);
}
