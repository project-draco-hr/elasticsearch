{
  if (!context.parsingStillNeeded()) {
    return;
  }
  XContentParser.Token token=parser.currentToken();
  if (token == null) {
    token=parser.nextToken();
  }
  if (token == XContentParser.Token.START_OBJECT) {
    token=parser.nextToken();
  }
  String idPart=context.idParsingStillNeeded() ? id().pathElements()[context.locationId] : null;
  String routingPart=context.routingParsingStillNeeded() ? routing().pathElements()[context.locationRouting] : null;
  String timestampPart=context.timestampParsingStillNeeded() ? timestamp().pathElements()[context.locationTimestamp] : null;
  for (; token == XContentParser.Token.FIELD_NAME; token=parser.nextToken()) {
    String fieldName=parser.currentName();
    token=parser.nextToken();
    boolean incLocationId=false;
    boolean incLocationRouting=false;
    boolean incLocationTimestamp=false;
    if (context.idParsingStillNeeded() && fieldName.equals(idPart)) {
      if (context.locationId + 1 == id.pathElements().length) {
        if (!token.isValue()) {
          throw new MapperParsingException("id field must be a value but was either an object or an array");
        }
        context.id=parser.textOrNull();
        context.idResolved=true;
      }
 else {
        incLocationId=true;
      }
    }
    if (context.routingParsingStillNeeded() && fieldName.equals(routingPart)) {
      if (context.locationRouting + 1 == routing.pathElements().length) {
        context.routing=parser.textOrNull();
        context.routingResolved=true;
      }
 else {
        incLocationRouting=true;
      }
    }
    if (context.timestampParsingStillNeeded() && fieldName.equals(timestampPart)) {
      if (context.locationTimestamp + 1 == timestamp.pathElements().length) {
        context.timestamp=parser.textOrNull();
        context.timestampResolved=true;
      }
 else {
        incLocationTimestamp=true;
      }
    }
    if (incLocationId || incLocationRouting || incLocationTimestamp) {
      if (token == XContentParser.Token.START_OBJECT) {
        context.locationId+=incLocationId ? 1 : 0;
        context.locationRouting+=incLocationRouting ? 1 : 0;
        context.locationTimestamp+=incLocationTimestamp ? 1 : 0;
        innerParse(parser,context);
        context.locationId-=incLocationId ? 1 : 0;
        context.locationRouting-=incLocationRouting ? 1 : 0;
        context.locationTimestamp-=incLocationTimestamp ? 1 : 0;
      }
    }
 else {
      parser.skipChildren();
    }
    if (!context.parsingStillNeeded()) {
      return;
    }
  }
}
