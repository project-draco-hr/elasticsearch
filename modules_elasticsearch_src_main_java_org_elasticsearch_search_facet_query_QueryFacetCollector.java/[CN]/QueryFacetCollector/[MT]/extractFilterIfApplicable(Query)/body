{
  if (query instanceof FilteredQuery) {
    FilteredQuery fQuery=(FilteredQuery)query;
    if (Queries.isMatchAllQuery(fQuery.getQuery())) {
      return fQuery.getFilter();
    }
  }
 else   if (query instanceof DeletionAwareConstantScoreQuery) {
    return ((DeletionAwareConstantScoreQuery)query).getFilter();
  }
 else   if (query instanceof ConstantScoreQuery) {
    return ((ConstantScoreQuery)query).getFilter();
  }
  return null;
}
