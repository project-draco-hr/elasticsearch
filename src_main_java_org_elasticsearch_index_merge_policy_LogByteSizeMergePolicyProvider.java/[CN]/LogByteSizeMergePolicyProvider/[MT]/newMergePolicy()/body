{
  CustomLogByteSizeMergePolicy mergePolicy;
  if (asyncMerge) {
    mergePolicy=new EnableMergeLogByteSizeMergePolicy(this);
  }
 else {
    mergePolicy=new CustomLogByteSizeMergePolicy(this);
  }
  mergePolicy.setMinMergeMB(minMergeSize.mbFrac());
  mergePolicy.setMaxMergeMB(maxMergeSize.mbFrac());
  mergePolicy.setMergeFactor(mergeFactor);
  mergePolicy.setMaxMergeDocs(maxMergeDocs);
  mergePolicy.setCalibrateSizeByDeletes(calibrateSizeByDeletes);
  mergePolicy.setUseCompoundFile(compoundFormat);
  mergePolicy.setNoCFSRatio(noCFSRatio);
  policies.add(mergePolicy);
  return mergePolicy;
}
