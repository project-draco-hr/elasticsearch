{
  CreateIndexRequestBuilder builder=prepareCreate("test").setSettings(settingsBuilder().put(SETTING_NUMBER_OF_SHARDS,1).put(SETTING_NUMBER_OF_REPLICAS,0).put("index.analysis.analyzer.reverse.tokenizer","standard").putArray("index.analysis.analyzer.reverse.filter","lowercase","reverse").put("index.analysis.analyzer.body.tokenizer","standard").putArray("index.analysis.analyzer.body.filter","lowercase").put("index.analysis.analyzer.bigram.tokenizer","standard").putArray("index.analysis.analyzer.bigram.filter","my_shingle","lowercase").put("index.analysis.filter.my_shingle.type","shingle").put("index.analysis.filter.my_shingle.output_unigrams",false).put("index.analysis.filter.my_shingle.min_shingle_size",2).put("index.analysis.filter.my_shingle.max_shingle_size",2));
  addMapping(builder,"type1",new Object[]{"_all","store","yes","termVector","with_positions_offsets"},new Object[]{"body","type","string","analyzer","body"},new Object[]{"body_reverse","type","string","analyzer","reverse"},new Object[]{"bigram","type","string","analyzer","bigram"});
  builder.get();
  ensureGreen();
  index("test","type1","1","body","hello world");
  index("test","type1","2","body","hello world");
  index("test","type1","3","body","hello words");
  refresh();
  Suggest searchSuggest=searchSuggest(client(),"hello word",phraseSuggestion("simple_phrase").field("body").addCandidateGenerator(PhraseSuggestionBuilder.candidateGenerator("body").prefixLength(4).minWordLength(1).suggestMode("always")).size(1).confidence(1.0f));
  assertSuggestion(searchSuggest,0,"simple_phrase","hello words");
  searchSuggest=searchSuggest(client(),"hello word",phraseSuggestion("simple_phrase").field("body").addCandidateGenerator(PhraseSuggestionBuilder.candidateGenerator("body").prefixLength(2).minWordLength(1).suggestMode("always")).size(1).confidence(1.0f));
  assertSuggestion(searchSuggest,0,"simple_phrase","hello world");
}
