{
  client.admin().indices().prepareDelete().execute().actionGet();
  client.admin().indices().prepareCreate("test").setSettings(settingsBuilder().put(SETTING_NUMBER_OF_SHARDS,5).put(SETTING_NUMBER_OF_REPLICAS,0)).execute().actionGet();
  client.admin().cluster().prepareHealth("test").setWaitForGreenStatus().execute().actionGet();
  client.prepareIndex("test","type1","1").setSource(XContentFactory.jsonBuilder().startObject().field("field1","foobar1").endObject()).setRouting("1").execute().actionGet();
  client.prepareIndex("test","type1","2").setSource(XContentFactory.jsonBuilder().startObject().field("field1","foobar2").endObject()).setRouting("2").execute().actionGet();
  client.prepareIndex("test","type1","3").setSource(XContentFactory.jsonBuilder().startObject().field("field1","foobar3").endObject()).setRouting("1").execute().actionGet();
  client.admin().indices().prepareRefresh().execute().actionGet();
  Suggest suggest=searchSuggest(client,"foobar",termSuggestion("simple").size(10).minDocFreq(0).field("field1").suggestMode("always"));
  assertThat(suggest,notNullValue());
  assertThat(suggest.size(),equalTo(1));
  assertThat(suggest.getSuggestion("simple").getName(),equalTo("simple"));
  assertThat(suggest.getSuggestion("simple").getEntries().size(),equalTo(1));
  assertThat(suggest.getSuggestion("simple").getEntries().get(0).getOptions().size(),equalTo(3));
}
