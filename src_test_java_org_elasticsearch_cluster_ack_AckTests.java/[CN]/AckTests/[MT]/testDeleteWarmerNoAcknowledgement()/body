{
  createIndex("test");
  index("test","type","1","f",1);
  assertAcked(client().admin().indices().preparePutWarmer("custom_warmer").setSearchRequest(client().prepareSearch("test").setTypes("test").setQuery(QueryBuilders.matchAllQuery())));
  DeleteWarmerResponse deleteWarmerResponse=client().admin().indices().prepareDeleteWarmer().setIndices("test").setNames("custom_warmer").setTimeout("0s").get();
  assertFalse(deleteWarmerResponse.isAcknowledged());
  assertTrue(awaitBusy(new Predicate<Object>(){
    @Override public boolean apply(    Object input){
      for (      Client client : clients()) {
        GetWarmersResponse getWarmersResponse=client.admin().indices().prepareGetWarmers().setLocal(true).get();
        if (getWarmersResponse.warmers().size() > 0) {
          return false;
        }
      }
      return true;
    }
  }
));
}
