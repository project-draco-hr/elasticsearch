{
  logger.info("--> creating test index: {}",name);
  assertAcked(prepareCreate(name,nodeCount,settingsBuilder().put("number_of_shards",shardCount).put("number_of_replicas",replicaCount)));
  ensureGreen();
  logger.info("--> indexing sample data");
  for (int i=0; i < DOC_COUNT; i++) {
    index(INDEX_NAME,"x",Integer.toString(i),"foo-" + i,"bar-" + i);
  }
  refresh();
  assertThat(client().prepareCount(INDEX_NAME).get().getCount(),equalTo((long)DOC_COUNT));
  return client().admin().indices().prepareStats(INDEX_NAME).execute().actionGet();
}
