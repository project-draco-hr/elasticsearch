{
  Map<String,String> params=new HashMap<>();
  String uri="something?";
  RestUtils.decodeQueryString(uri,uri.indexOf('?') + 1,params);
  assertThat(params.size(),equalTo(0));
  params.clear();
  uri=String.format(Locale.ROOT,"something?%c",randomDelimiter());
  RestUtils.decodeQueryString(uri,uri.indexOf('?') + 1,params);
  assertThat(params.size(),equalTo(0));
  params.clear();
  uri=String.format(Locale.ROOT,"something?p=v%c%cp1=v1",randomDelimiter(),randomDelimiter());
  RestUtils.decodeQueryString(uri,uri.indexOf('?') + 1,params);
  assertThat(params.size(),equalTo(2));
  assertThat(params.get("p"),equalTo("v"));
  assertThat(params.get("p1"),equalTo("v1"));
  params.clear();
  uri="something?=";
  RestUtils.decodeQueryString(uri,uri.indexOf('?') + 1,params);
  assertThat(params.size(),equalTo(0));
  params.clear();
  uri=String.format(Locale.ROOT,"something?%c=",randomDelimiter());
  RestUtils.decodeQueryString(uri,uri.indexOf('?') + 1,params);
  assertThat(params.size(),equalTo(0));
  params.clear();
  uri="something?a";
  RestUtils.decodeQueryString(uri,uri.indexOf('?') + 1,params);
  assertThat(params.size(),equalTo(1));
  assertThat(params.get("a"),equalTo(""));
  params.clear();
  uri=String.format(Locale.ROOT,"something?p=v%ca",randomDelimiter());
  RestUtils.decodeQueryString(uri,uri.indexOf('?') + 1,params);
  assertThat(params.size(),equalTo(2));
  assertThat(params.get("a"),equalTo(""));
  assertThat(params.get("p"),equalTo("v"));
  params.clear();
  uri=String.format(Locale.ROOT,"something?p=v%ca%cp1=v1",randomDelimiter(),randomDelimiter());
  RestUtils.decodeQueryString(uri,uri.indexOf('?') + 1,params);
  assertThat(params.size(),equalTo(3));
  assertThat(params.get("a"),equalTo(""));
  assertThat(params.get("p"),equalTo("v"));
  assertThat(params.get("p1"),equalTo("v1"));
  params.clear();
  uri=String.format(Locale.ROOT,"something?p=v%ca%cb%cp1=v1",randomDelimiter(),randomDelimiter(),randomDelimiter());
  RestUtils.decodeQueryString(uri,uri.indexOf('?') + 1,params);
  assertThat(params.size(),equalTo(4));
  assertThat(params.get("a"),equalTo(""));
  assertThat(params.get("b"),equalTo(""));
  assertThat(params.get("p"),equalTo("v"));
  assertThat(params.get("p1"),equalTo("v1"));
}
