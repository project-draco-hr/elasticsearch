{
  String percolateShardAction=PercolateAction.NAME + "[s]";
  interceptTransportActions(percolateShardAction);
  client().prepareIndex("test-get","type","1").setSource("field","value").get();
  PercolateRequest percolateRequest=new PercolateRequest().indices(randomIndicesOrAliases()).documentType("type");
  if (randomBoolean()) {
    percolateRequest.getRequest(new GetRequest("test-get","type","1"));
  }
 else {
    percolateRequest.source("\"field\":\"value\"");
  }
  internalCluster().clientNodeClient().percolate(percolateRequest).actionGet();
  clearInterceptedActions();
  assertSameIndices(percolateRequest,percolateShardAction);
}
