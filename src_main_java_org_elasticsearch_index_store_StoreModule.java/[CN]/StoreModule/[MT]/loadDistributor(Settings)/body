{
  final Class<? extends Distributor> distributor;
  final String type=settings.get(DISTIBUTOR_KEY);
  if ("least_used".equals(type)) {
    distributor=LeastUsedDistributor.class;
  }
 else   if ("random".equals(type)) {
    distributor=RandomWeightedDistributor.class;
  }
 else {
    distributor=settings.getAsClass(DISTIBUTOR_KEY,LeastUsedDistributor.class,"org.elasticsearch.index.store.distributor.","Distributor");
  }
  return distributor;
}
