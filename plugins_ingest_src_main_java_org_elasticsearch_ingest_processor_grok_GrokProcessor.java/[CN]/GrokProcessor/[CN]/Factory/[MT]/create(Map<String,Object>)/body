{
  String matchField=(String)config.get("field");
  String matchPattern=(String)config.get("pattern");
  Map<String,String> patternBank=new HashMap<>();
  Path patternsDirectory=grokConfigDirectory.resolve("patterns");
  try (DirectoryStream<Path> stream=Files.newDirectoryStream(patternsDirectory)){
    for (    Path patternFilePath : stream) {
      try (InputStream is=Files.newInputStream(patternFilePath,StandardOpenOption.READ)){
        PatternUtils.loadBankFromStream(patternBank,is);
      }
     }
  }
   Grok grok=new Grok(patternBank,matchPattern);
  return new GrokProcessor(grok,matchField);
}
