{
  final FSDirectory leaf=DirectoryUtils.getLeaf(directory,FSDirectory.class);
  if (leaf != null) {
    return Files.getFileStore(leaf.getDirectory()).getUsableSpace();
  }
 else {
    return 0;
  }
}
