{
  if (directory instanceof RateLimitedFSDirectory) {
    return ((RateLimitedFSDirectory)directory).wrappedDirectory().getDirectory().getUsableSpace();
  }
 else   if (directory instanceof FSDirectory) {
    return ((FSDirectory)directory).getDirectory().getUsableSpace();
  }
 else {
    return 0;
  }
}
