{
  logger.info("Creating index [test1]");
  client("server1").admin().indices().create(createIndexRequest("test1")).actionGet();
  logger.info("Creating index [test2]");
  client("server1").admin().indices().create(createIndexRequest("test2")).actionGet();
  logger.info("Running Cluster Health");
  ClusterHealthResponse clusterHealth=client("server1").admin().cluster().health(clusterHealthRequest().waitForGreenStatus()).actionGet();
  logger.info("Done Cluster Health, status " + clusterHealth.status());
  assertThat(clusterHealth.timedOut(),equalTo(false));
  assertThat(clusterHealth.status(),equalTo(ClusterHealthStatus.GREEN));
  logger.info("Pinging single person with id 1");
  SinglePingResponse singleResponse=client("server1").admin().cluster().ping(pingSingleRequest("test1").type("person").id("1")).actionGet();
  logger.info("Broadcast pinging test1 and test2");
  BroadcastPingResponse broadcastResponse=client("server1").admin().cluster().ping(pingBroadcastRequest("test1","test2")).actionGet();
  assertThat(broadcastResponse.successfulShards(),equalTo(10));
  assertThat(broadcastResponse.failedShards(),equalTo(0));
  logger.info("Broadcast pinging test1");
  broadcastResponse=client("server1").admin().cluster().ping(pingBroadcastRequest("test1")).actionGet();
  assertThat(broadcastResponse.successfulShards(),equalTo(5));
  assertThat(broadcastResponse.failedShards(),equalTo(0));
  logger.info("Replication pinging test1 and test2");
  ReplicationPingResponse replicationResponse=client("server1").admin().cluster().ping(pingReplicationRequest("test1","test2")).actionGet();
  assertThat(replicationResponse.indices().size(),equalTo(2));
  assertThat(replicationResponse.index("test1").successfulShards(),equalTo(5));
  assertThat(replicationResponse.index("test1").failedShards(),equalTo(0));
}
