{
  this.deferred=BucketCollector.wrap(deferredCollectors);
  try {
    tdc=createTopDocsCollector(shardSize);
  }
 catch (  IOException e) {
    throw new ElasticsearchException("IO error creating collector",e);
  }
}
