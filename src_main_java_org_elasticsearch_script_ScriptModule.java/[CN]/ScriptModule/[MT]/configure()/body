{
  MapBinder<String,NativeScriptFactory> scriptsBinder=MapBinder.newMapBinder(binder(),String.class,NativeScriptFactory.class);
  for (  Map.Entry<String,Class<? extends NativeScriptFactory>> entry : scripts.entrySet()) {
    scriptsBinder.addBinding(entry.getKey()).to(entry.getValue());
  }
  Map<String,Settings> nativeSettings=settings.getGroups("script.native");
  for (  Map.Entry<String,Settings> entry : nativeSettings.entrySet()) {
    String name=entry.getKey();
    Class<? extends NativeScriptFactory> type=entry.getValue().getAsClass("type",NativeScriptFactory.class);
    if (type == NativeScriptFactory.class) {
      throw new ElasticsearchIllegalArgumentException("type is missing for native script [" + name + "]");
    }
    scriptsBinder.addBinding(name).to(type);
  }
  Multibinder<ScriptEngineService> multibinder=Multibinder.newSetBinder(binder(),ScriptEngineService.class);
  multibinder.addBinding().to(NativeScriptEngineService.class);
  try {
    multibinder.addBinding().to(GroovyScriptEngineService.class);
  }
 catch (  Throwable t) {
    Loggers.getLogger(GroovyScriptEngineService.class).debug("failed to load groovy",t);
  }
  try {
    multibinder.addBinding().to(MvelScriptEngineService.class);
  }
 catch (  Throwable t) {
    Loggers.getLogger(MvelScriptEngineService.class).debug("failed to load mvel",t);
  }
  try {
    multibinder.addBinding().to(MustacheScriptEngineService.class);
  }
 catch (  Throwable t) {
    Loggers.getLogger(MustacheScriptEngineService.class).debug("failed to load mustache",t);
  }
  for (  Class<? extends ScriptEngineService> scriptEngine : scriptEngines) {
    multibinder.addBinding().to(scriptEngine);
  }
  bind(ScriptService.class).asEagerSingleton();
}
