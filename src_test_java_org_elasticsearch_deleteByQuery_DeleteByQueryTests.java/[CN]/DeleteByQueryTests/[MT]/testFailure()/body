{
  wipeIndices();
  client().admin().indices().prepareCreate("twitter").execute().actionGet();
  DeleteByQueryResponse response=client().prepareDeleteByQuery("twitter").setQuery(QueryBuilders.hasChildQuery("type",QueryBuilders.matchAllQuery())).execute().actionGet();
  assertThat(response.status(),equalTo(RestStatus.BAD_REQUEST));
  assertThat(response.getIndex("twitter").getSuccessfulShards(),equalTo(0));
  assertThat(response.getIndex("twitter").getFailedShards(),equalTo(5));
}
