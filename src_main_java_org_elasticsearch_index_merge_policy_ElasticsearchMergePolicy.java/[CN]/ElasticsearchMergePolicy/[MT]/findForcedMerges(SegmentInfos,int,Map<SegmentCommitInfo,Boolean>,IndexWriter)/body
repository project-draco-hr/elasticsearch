{
  MergeSpecification spec=delegate.findForcedMerges(segmentInfos,maxSegmentCount,segmentsToMerge,writer);
  if (spec == null && force) {
    List<SegmentCommitInfo> segments=Lists.newArrayList();
    for (    SegmentCommitInfo info : segmentInfos) {
      if (segmentsToMerge.containsKey(info)) {
        segments.add(info);
      }
    }
    if (!segments.isEmpty()) {
      spec=new IndexUpgraderMergeSpecification();
      spec.add(new OneMerge(segments));
      return spec;
    }
  }
  return upgradedMergeSpecification(spec);
}
