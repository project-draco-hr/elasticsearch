{
  boolean cancelled=false;
  for (  RecoveryStatus status : onGoingRecoveries.values()) {
    if (status.shardId().equals(shardId)) {
      boolean cancel=false;
      if (status.tryIncRef()) {
        try {
          cancel=shouldCancel.apply(status);
        }
  finally {
          status.decRef();
        }
      }
      if (cancel && cancelRecovery(status.recoveryId(),reason)) {
        cancelled=true;
      }
    }
  }
  return cancelled;
}
