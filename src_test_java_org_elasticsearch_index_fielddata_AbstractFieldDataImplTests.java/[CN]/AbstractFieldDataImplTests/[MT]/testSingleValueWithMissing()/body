{
  fillSingleValueWithMissing();
  IndexFieldData indexFieldData=getForField("value");
  AtomicFieldData fieldData=indexFieldData.load(refreshReader());
  assertThat(fieldData.getMemorySizeInBytes(),greaterThan(0l));
  BytesValues bytesValues=fieldData.getBytesValues();
  assertThat(bytesValues.isMultiValued(),equalTo(false));
  assertValues(bytesValues,0,two());
  assertValues(bytesValues,1,Strings.EMPTY_ARRAY);
  assertValues(bytesValues,2,three());
  BytesValues hashedBytesValues=fieldData.getBytesValues();
  assertThat(convert(hashedBytesValues,0),equalTo(new HashedBytesRef(two())));
  assertThat(convert(hashedBytesValues,1),equalTo(new HashedBytesRef(new BytesRef())));
  assertThat(convert(hashedBytesValues,2),equalTo(new HashedBytesRef(three())));
  assertHashedValues(hashedBytesValues,0,two());
  assertHashedValues(hashedBytesValues,1,Strings.EMPTY_ARRAY);
  assertHashedValues(hashedBytesValues,2,three());
}
