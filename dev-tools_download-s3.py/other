import os
import sys
import argparse
try:
    import boto.s3
except:
    raise RuntimeError("\n  S3 download requires boto to be installed\n    Use one of:\n      'pip install -U boto'\n      'apt-get install python-boto'\n      'easy_install boto'\n  ")
import boto.s3
if (__name__ == '__main__'):
    parser = argparse.ArgumentParser(description='Downloads a bucket from Amazon S3')
    parser.add_argument('--file', '-f', metavar='path to file', help='path to store the bucket to', required=True)
    parser.add_argument('--bucket', '-b', default='downloads.elasticsearch.org', help='The S3 Bucket to download from')
    parser.add_argument('--path', '-p', default='', help='The key path to use')
    parser.add_argument('--key', '-k', default=None, help='The key - uses the file name as default key')
    args = parser.parse_args()
    if args.key:
        key = args.key
    else:
        key = os.path.basename(args.file)
    connection = boto.connect_s3()
    download_s3(connection, args.path, key, args.file, args.bucket)
