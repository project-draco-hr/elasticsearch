{
  final IndexFieldDataService ifdService=new IndexFieldDataService(new Index("test"));
  for (  boolean docValues : Arrays.asList(true,false)) {
    final BuilderContext ctx=new BuilderContext(null,new ContentPath(1));
    final StringFieldMapper stringMapper=new StringFieldMapper.Builder("string").tokenized(false).fieldDataSettings(docValues ? DOC_VALUES_SETTINGS : ImmutableSettings.EMPTY).build(ctx);
    ifdService.clear();
    IndexFieldData<?> fd=ifdService.getForField(stringMapper);
    if (docValues) {
      assertTrue(fd instanceof SortedSetDVBytesIndexFieldData);
    }
 else {
      assertTrue(fd instanceof PagedBytesIndexFieldData);
    }
    for (    FieldMapper<?> mapper : Arrays.asList(new ByteFieldMapper.Builder("int").fieldDataSettings(docValues ? DOC_VALUES_SETTINGS : ImmutableSettings.EMPTY).build(ctx),new ShortFieldMapper.Builder("int").fieldDataSettings(docValues ? DOC_VALUES_SETTINGS : ImmutableSettings.EMPTY).build(ctx),new IntegerFieldMapper.Builder("int").fieldDataSettings(docValues ? DOC_VALUES_SETTINGS : ImmutableSettings.EMPTY).build(ctx),new LongFieldMapper.Builder("long").fieldDataSettings(docValues ? DOC_VALUES_SETTINGS : ImmutableSettings.EMPTY).build(ctx))) {
      ifdService.clear();
      fd=ifdService.getForField(mapper);
      if (docValues) {
        assertTrue(fd instanceof SortedSetDVNumericIndexFieldData);
      }
 else {
        assertTrue(fd instanceof PackedArrayIndexFieldData);
      }
    }
    final FloatFieldMapper floatMapper=new FloatFieldMapper.Builder("float").fieldDataSettings(docValues ? DOC_VALUES_SETTINGS : ImmutableSettings.EMPTY).build(ctx);
    ifdService.clear();
    fd=ifdService.getForField(floatMapper);
    if (docValues) {
      assertTrue(fd instanceof SortedSetDVNumericIndexFieldData);
    }
 else {
      assertTrue(fd instanceof FloatArrayIndexFieldData);
    }
    final DoubleFieldMapper doubleMapper=new DoubleFieldMapper.Builder("double").fieldDataSettings(docValues ? DOC_VALUES_SETTINGS : ImmutableSettings.EMPTY).build(ctx);
    ifdService.clear();
    fd=ifdService.getForField(doubleMapper);
    if (docValues) {
      assertTrue(fd instanceof SortedSetDVNumericIndexFieldData);
    }
 else {
      assertTrue(fd instanceof DoubleArrayIndexFieldData);
    }
  }
}
