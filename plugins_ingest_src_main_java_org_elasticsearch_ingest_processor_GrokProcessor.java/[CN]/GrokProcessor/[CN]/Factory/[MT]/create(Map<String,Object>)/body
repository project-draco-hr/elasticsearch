{
  String matchField=ConfigurationUtils.readStringProperty(config,"field");
  String matchPattern=ConfigurationUtils.readStringProperty(config,"pattern");
  Map<String,String> customPatternBank=ConfigurationUtils.readOptionalMap(config,"pattern_definitions");
  Map<String,String> patternBank=new HashMap<>();
  Path patternsDirectory=grokConfigDirectory.resolve("patterns");
  try (DirectoryStream<Path> stream=Files.newDirectoryStream(patternsDirectory)){
    for (    Path patternFilePath : stream) {
      if (Files.isRegularFile(patternFilePath)) {
        try (InputStream is=Files.newInputStream(patternFilePath,StandardOpenOption.READ)){
          loadBankFromStream(patternBank,is);
        }
       }
    }
  }
   if (customPatternBank != null) {
    patternBank.putAll(customPatternBank);
  }
  Grok grok=new Grok(patternBank,matchPattern);
  return new GrokProcessor(grok,matchField);
}
