{
  add(localNodeMasterListeners);
  this.clusterState=ClusterState.builder(clusterState).blocks(initialBlocks).build();
  this.updateTasksExecutor=EsExecutors.newSinglePrioritizing(daemonThreadFactory(settings,UPDATE_THREAD_NAME));
  this.reconnectToNodes=threadPool.schedule(reconnectInterval,ThreadPool.Names.GENERIC,new ReconnectToNodes());
  Map<String,String> nodeAttributes=discoveryNodeService.buildAttributes();
  final String nodeId=DiscoveryService.generateNodeId(settings);
  DiscoveryNode localNode=new DiscoveryNode(settings.get("name"),nodeId,transportService.boundAddress().publishAddress(),nodeAttributes,version);
  DiscoveryNodes.Builder nodeBuilder=DiscoveryNodes.builder().put(localNode).localNodeId(localNode.id());
  this.clusterState=ClusterState.builder(clusterState).nodes(nodeBuilder).blocks(initialBlocks).build();
}
