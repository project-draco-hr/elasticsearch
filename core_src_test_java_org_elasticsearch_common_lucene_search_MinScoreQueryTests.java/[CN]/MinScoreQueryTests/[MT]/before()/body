{
  dir=newDirectory();
  terms=new String[TestUtil.nextInt(random(),2,15)];
  for (int i=0; i < terms.length; ++i) {
    terms[i]=TestUtil.randomSimpleString(random());
  }
  final int numDocs=TestUtil.nextInt(random(),1,200);
  Analyzer analyzer=new MockAnalyzer(random(),MockTokenizer.WHITESPACE,false);
  RandomIndexWriter w=new RandomIndexWriter(random(),dir,newIndexWriterConfig(analyzer));
  for (int i=0; i < numDocs; ++i) {
    StringBuilder value=new StringBuilder();
    final int numTerms=random().nextInt(10);
    for (int j=0; j < numTerms; ++j) {
      if (j > 0) {
        value.append(' ');
      }
      String term=terms[TestUtil.nextInt(random(),0,TestUtil.nextInt(random(),0,terms.length - 1))];
      value.append(term);
    }
    Document doc=new Document();
    doc.add(new TextField("field",value.toString(),Store.NO));
    w.addDocument(doc);
  }
  r=w.getReader();
  s=newSearcher(r);
  w.close();
}
