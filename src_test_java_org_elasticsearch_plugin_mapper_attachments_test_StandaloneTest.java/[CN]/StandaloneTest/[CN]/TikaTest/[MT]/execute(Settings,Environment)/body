{
  XContentBuilder builder=jsonBuilder().startObject().field("_id",1).field("file").startObject();
  if (base64text != null) {
    builder.field("_content",base64text);
  }
 else {
    File file=new File(new URL(url).getFile());
    boolean exists=file.exists();
    if (!exists) {
      return ExitStatus.IO_ERROR;
    }
    byte[] bytes=copyToByteArray(file);
    builder.field("_content",bytes);
  }
  if (size >= 0) {
    builder.field("_indexed_chars",10);
  }
  BytesReference json=builder.endObject().endObject().bytes();
  ParseContext.Document doc=docMapper.parse(json).rootDoc();
  terminal.println("## Extracted text");
  terminal.println("--------------------- BEGIN -----------------------");
  terminal.println(doc.get(docMapper.mappers().smartName("file").mapper().names().indexName()));
  terminal.println("---------------------- END ------------------------");
  terminal.println("## Metadata");
  printMetadataContent(doc,AttachmentMapper.FieldNames.AUTHOR);
  printMetadataContent(doc,AttachmentMapper.FieldNames.CONTENT_LENGTH);
  printMetadataContent(doc,AttachmentMapper.FieldNames.CONTENT_TYPE);
  printMetadataContent(doc,AttachmentMapper.FieldNames.DATE);
  printMetadataContent(doc,AttachmentMapper.FieldNames.KEYWORDS);
  printMetadataContent(doc,AttachmentMapper.FieldNames.LANGUAGE);
  printMetadataContent(doc,AttachmentMapper.FieldNames.NAME);
  printMetadataContent(doc,AttachmentMapper.FieldNames.TITLE);
  return ExitStatus.OK;
}
