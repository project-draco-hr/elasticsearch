{
  AtomicNumericFieldData leftData=random.nextBoolean() ? left.load(context) : left.loadDirect(context);
  AtomicNumericFieldData rightData=random.nextBoolean() ? right.load(context) : right.loadDirect(context);
  assertThat(leftData.getNumDocs(),equalTo(rightData.getNumDocs()));
  int numDocs=leftData.getNumDocs();
  LongValues leftLongValues=leftData.getLongValues();
  LongValues rightLongValues=rightData.getLongValues();
  for (int i=0; i < numDocs; i++) {
    assertThat(leftLongValues.hasValue(i),equalTo(rightLongValues.hasValue(i)));
    if (leftLongValues.hasValue(i)) {
      assertThat(leftLongValues.getValue(i),equalTo(rightLongValues.getValue(i)));
    }
 else {
      assertThat(leftLongValues.getValue(i),equalTo(0l));
      assertThat(rightLongValues.getValue(i),equalTo(0l));
    }
    int numValues=0;
    assertThat((numValues=leftLongValues.setDocument(i)),equalTo(rightLongValues.setDocument(i)));
    for (int j=0; j < numValues; j++) {
      assertThat(leftLongValues.nextValue(),equalTo(rightLongValues.nextValue()));
    }
  }
}
