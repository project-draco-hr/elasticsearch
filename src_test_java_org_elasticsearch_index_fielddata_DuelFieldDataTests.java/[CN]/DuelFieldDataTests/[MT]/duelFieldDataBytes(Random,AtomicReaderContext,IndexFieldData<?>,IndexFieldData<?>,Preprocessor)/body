{
  AtomicFieldData<?> leftData=random.nextBoolean() ? left.load(context) : left.loadDirect(context);
  AtomicFieldData<?> rightData=random.nextBoolean() ? right.load(context) : right.loadDirect(context);
  assertThat(leftData.getNumDocs(),equalTo(rightData.getNumDocs()));
  int numDocs=leftData.getNumDocs();
  BytesValues leftBytesValues=leftData.getBytesValues(random.nextBoolean());
  BytesValues rightBytesValues=rightData.getBytesValues(random.nextBoolean());
  BytesRef leftSpare=new BytesRef();
  BytesRef rightSpare=new BytesRef();
  for (int i=0; i < numDocs; i++) {
    assertThat(leftBytesValues.hasValue(i),equalTo(rightBytesValues.hasValue(i)));
    if (leftBytesValues.hasValue(i)) {
      assertThat(pre.toString(leftBytesValues.getValue(i)),equalTo(pre.toString(rightBytesValues.getValue(i))));
    }
 else {
      assertThat(leftBytesValues.getValue(i),equalTo(new BytesRef()));
      assertThat(rightBytesValues.getValue(i),equalTo(new BytesRef()));
    }
    int numValues=0;
    if (leftBytesValues.hasValue(i)) {
      assertThat(rightBytesValues.hasValue(i),equalTo(true));
      assertThat(leftBytesValues.setDocument(i),Matchers.greaterThanOrEqualTo(1));
      assertThat(rightBytesValues.setDocument(i),Matchers.greaterThanOrEqualTo(1));
    }
 else {
      assertThat(rightBytesValues.hasValue(i),equalTo(false));
      assertThat(leftBytesValues.setDocument(i),equalTo(0));
      assertThat(rightBytesValues.setDocument(i),equalTo(0));
    }
    assertThat((numValues=leftBytesValues.setDocument(i)),equalTo(rightBytesValues.setDocument(i)));
    for (int j=0; j < numValues; j++) {
      rightSpare.copyBytes(rightBytesValues.nextValue());
      leftSpare.copyBytes(leftBytesValues.nextValue());
      assertThat(rightSpare.hashCode(),equalTo(rightBytesValues.currentValueHash()));
      assertThat(leftSpare.hashCode(),equalTo(leftBytesValues.currentValueHash()));
      pre.toString(rightSpare);
      pre.toString(leftSpare);
      assertThat(pre.toString(leftSpare),equalTo(pre.toString(rightSpare)));
      if (leftSpare.equals(rightSpare)) {
        assertThat(leftBytesValues.currentValueHash(),equalTo(rightBytesValues.currentValueHash()));
      }
    }
  }
}
