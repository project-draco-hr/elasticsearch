{
  AtomicFieldData leftData=random.nextBoolean() ? left.load(context) : left.loadDirect(context);
  AtomicFieldData rightData=random.nextBoolean() ? right.load(context) : right.loadDirect(context);
  int numDocs=context.reader().maxDoc();
  SortedBinaryDocValues leftBytesValues=leftData.getBytesValues();
  SortedBinaryDocValues rightBytesValues=rightData.getBytesValues();
  BytesRefBuilder leftSpare=new BytesRefBuilder();
  BytesRefBuilder rightSpare=new BytesRefBuilder();
  for (int i=0; i < numDocs; i++) {
    leftBytesValues.setDocument(i);
    rightBytesValues.setDocument(i);
    int numValues=leftBytesValues.count();
    assertThat(numValues,equalTo(rightBytesValues.count()));
    BytesRef previous=null;
    for (int j=0; j < numValues; j++) {
      rightSpare.copyBytes(rightBytesValues.valueAt(j));
      leftSpare.copyBytes(leftBytesValues.valueAt(j));
      if (previous != null) {
        assertThat(pre.compare(previous,rightSpare.get()),lessThan(0));
      }
      previous=BytesRef.deepCopyOf(rightSpare.get());
      pre.toString(rightSpare.get());
      pre.toString(leftSpare.get());
      assertThat(pre.toString(leftSpare.get()),equalTo(pre.toString(rightSpare.get())));
    }
  }
}
