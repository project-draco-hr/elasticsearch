{
  XContentDocumentMapper builderDocMapper=doc(object("person").add(multiField("name").add(stringField("name").store(Field.Store.YES)).add(stringField("indexed").index(Field.Index.ANALYZED)).add(stringField("not_indexed").index(Field.Index.NO).store(Field.Store.YES)))).build();
  String builtMapping=builderDocMapper.buildSource();
  XContentDocumentMapper docMapper=XContentMapperTests.newParser().parse(builtMapping);
  byte[] json=copyToBytesFromClasspath("/org/elasticsearch/index/mapper/xcontent/multifield/test-data.json");
  Document doc=docMapper.parse(json).doc();
  Field f=doc.getField("name");
  assertThat(f.name(),equalTo("name"));
  assertThat(f.stringValue(),equalTo("some name"));
  assertThat(f.isStored(),equalTo(true));
  assertThat(f.isIndexed(),equalTo(true));
  f=doc.getField("name.indexed");
  assertThat(f.name(),equalTo("name.indexed"));
  assertThat(f.stringValue(),equalTo("some name"));
  assertThat(f.isStored(),equalTo(false));
  assertThat(f.isIndexed(),equalTo(true));
  f=doc.getField("name.not_indexed");
  assertThat(f.name(),equalTo("name.not_indexed"));
  assertThat(f.stringValue(),equalTo("some name"));
  assertThat(f.isStored(),equalTo(true));
  assertThat(f.isIndexed(),equalTo(false));
}
