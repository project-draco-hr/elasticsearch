{
  Builder builder=ImmutableSettings.settingsBuilder().put("index.analysis.filter.my_stop.type","stop");
  if (random().nextBoolean()) {
    builder.put("index.analysis.filter.my_stop.enable_position_increments",true);
  }
  int thingToDo=random().nextInt(3);
  if (thingToDo == 0) {
    builder.put("index.analysis.filter.my_stop.version",Version.LATEST);
  }
 else   if (thingToDo == 1) {
    builder.put("index.analysis.filter.my_stop.version",Version.LUCENE_30);
  }
 else {
  }
  AnalysisService analysisService=AnalysisTestsHelper.createAnalysisServiceFromSettings(builder.build());
  TokenFilterFactory tokenFilter=analysisService.tokenFilter("my_stop");
  assertThat(tokenFilter,instanceOf(StopTokenFilterFactory.class));
  TokenStream create=tokenFilter.create(new WhitespaceTokenizer(TEST_VERSION_CURRENT,new StringReader("foo bar")));
  assertThat(create,instanceOf(StopFilter.class));
  assertThat(((StopFilter)create).getEnablePositionIncrements(),equalTo(true));
}
