{
  Node build=NodeBuilder.nodeBuilder().local(true).data(true).settings(Settings.builder().put(ClusterName.SETTING,InternalTestCluster.clusterName("single-node-cluster",randomLong())).put("path.home",createTempDir()).put("path.shared_data",createTempDir().getParent()).put("node.name",nodeName()).put(NodeEnvironment.SETTING_CUSTOM_DATA_PATH_ENABLED,true).put(IndexMetaData.SETTING_NUMBER_OF_SHARDS,1).put(IndexMetaData.SETTING_NUMBER_OF_REPLICAS,0).put("script.inline","on").put("script.indexed","on").put(EsExecutors.PROCESSORS,1).put("http.enabled",false).put(InternalSettingsPreparer.IGNORE_SYSTEM_PROPERTIES_SETTING,true)).build();
  build.start();
  assertThat(DiscoveryNode.localNode(build.settings()),is(true));
  return build;
}
