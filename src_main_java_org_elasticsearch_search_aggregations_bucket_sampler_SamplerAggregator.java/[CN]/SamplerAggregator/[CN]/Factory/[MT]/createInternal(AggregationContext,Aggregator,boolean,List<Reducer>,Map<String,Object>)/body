{
  if (collectsFromSingleBucket == false) {
    return asMultiBucketAggregator(this,context,parent);
  }
  return new SamplerAggregator(name,shardSize,factories,context,parent,reducers,metaData);
}
