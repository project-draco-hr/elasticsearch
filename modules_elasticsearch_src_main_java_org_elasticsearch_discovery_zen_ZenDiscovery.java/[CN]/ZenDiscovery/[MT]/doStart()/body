{
  Map<String,String> nodeAttributes=buildCommonNodesAttributes(settings);
  Boolean zenMaster=componentSettings.getAsBoolean("master",null);
  if (zenMaster != null) {
    if (zenMaster.equals(Boolean.FALSE)) {
      nodeAttributes.put("zen.master","false");
    }
  }
 else   if (nodeAttributes.containsKey("client")) {
    if (nodeAttributes.get("client").equals("true")) {
      nodeAttributes.put("zen.master","false");
    }
  }
  String nodeId=UUID.randomUUID().toString();
  localNode=new DiscoveryNode(settings.get("name"),nodeId,transportService.boundAddress().publishAddress(),nodeAttributes);
  latestDiscoNodes=new DiscoveryNodes.Builder().put(localNode).localNodeId(localNode.id()).build();
  nodesFD.updateNodes(latestDiscoNodes);
  pingService.start();
  threadPool.execute(new Runnable(){
    @Override public void run(){
      joinCluster();
    }
  }
);
}
