{
  if (master) {
    clusterService.submitStateUpdateTask("zen-disco-node_failed(" + node + ")",new ClusterStateUpdateTask(){
      @Override public ClusterState execute(      ClusterState currentState){
        DiscoveryNodes.Builder builder=new DiscoveryNodes.Builder().putAll(currentState.nodes()).remove(node.id());
        latestDiscoNodes=builder.build();
        return newClusterStateBuilder().state(currentState).nodes(latestDiscoNodes).build();
      }
    }
);
  }
 else {
    handleMasterGone(node,"shut_down");
  }
}
