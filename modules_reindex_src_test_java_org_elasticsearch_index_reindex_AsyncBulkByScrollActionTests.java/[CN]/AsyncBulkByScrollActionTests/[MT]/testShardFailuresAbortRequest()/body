{
  ShardSearchFailure shardFailure=new ShardSearchFailure(new RuntimeException("test"));
  InternalSearchResponse internalResponse=new InternalSearchResponse(null,null,null,null,false,null);
  new DummyAbstractAsyncBulkByScrollAction().onScrollResponse(timeValueNanos(System.nanoTime()),0,new SearchResponse(internalResponse,scrollId(),5,4,randomLong(),new ShardSearchFailure[]{shardFailure}));
  BulkIndexByScrollResponse response=listener.get();
  assertThat(response.getIndexingFailures(),emptyCollectionOf(Failure.class));
  assertThat(response.getSearchFailures(),contains(shardFailure));
  assertFalse(response.isTimedOut());
  assertNull(response.getReasonCancelled());
  assertThat(client.scrollsCleared,contains(scrollId));
}
