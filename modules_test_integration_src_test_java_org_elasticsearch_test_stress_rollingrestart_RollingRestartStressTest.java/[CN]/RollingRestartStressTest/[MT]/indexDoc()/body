{
  StringBuffer sb=new StringBuffer();
  XContentBuilder json=XContentFactory.jsonBuilder().startObject().field("field","value" + ThreadLocalRandom.current().nextInt());
  int fields=Math.abs(ThreadLocalRandom.current().nextInt()) % numberOfFields;
  for (int i=0; i < fields; i++) {
    json.field("num_" + i,ThreadLocalRandom.current().nextDouble());
    int tokens=ThreadLocalRandom.current().nextInt() % textTokens;
    sb.setLength(0);
    for (int j=0; j < tokens; j++) {
      sb.append(UUID.randomBase64UUID()).append(' ');
    }
    json.field("text_" + i,sb.toString());
  }
  json.endObject();
  client.client().prepareIndex("test","type1",Long.toString(idCounter.incrementAndGet())).setCreate(true).setSource(json).execute().actionGet();
  indexCounter.incrementAndGet();
}
