{
  String name=null;
  Version version=Version.CURRENT;
  SnapshotState state=SnapshotState.IN_PROGRESS;
  String reason=null;
  ImmutableList<String> indices=ImmutableList.of();
  long startTime=0;
  long endTime=0;
  int totalShard=0;
  int successfulShards=0;
  List<SnapshotShardFailure> shardFailures=NO_FAILURES;
  if (parser.currentToken() == null) {
    parser.nextToken();
  }
  if (parser.currentToken() == XContentParser.Token.START_OBJECT) {
    parser.nextToken();
  }
  XContentParser.Token token;
  if ((token=parser.nextToken()) == XContentParser.Token.START_OBJECT) {
    String currentFieldName=parser.currentName();
    if ("snapshot".equals(currentFieldName)) {
      while ((token=parser.nextToken()) != XContentParser.Token.END_OBJECT) {
        if (token == XContentParser.Token.FIELD_NAME) {
          currentFieldName=parser.currentName();
          token=parser.nextToken();
          if (token.isValue()) {
            if ("name".equals(currentFieldName)) {
              name=parser.text();
            }
 else             if ("state".equals(currentFieldName)) {
              state=SnapshotState.valueOf(parser.text());
            }
 else             if ("reason".equals(currentFieldName)) {
              reason=parser.text();
            }
 else             if ("start_time".equals(currentFieldName)) {
              startTime=parser.longValue();
            }
 else             if ("end_time".equals(currentFieldName)) {
              endTime=parser.longValue();
            }
 else             if ("total_shards".equals(currentFieldName)) {
              totalShard=parser.intValue();
            }
 else             if ("successful_shards".equals(currentFieldName)) {
              successfulShards=parser.intValue();
            }
 else             if ("version_id".equals(currentFieldName)) {
              version=Version.fromId(parser.intValue());
            }
          }
 else           if (token == XContentParser.Token.START_ARRAY) {
            if ("indices".equals(currentFieldName)) {
              ArrayList<String> indicesArray=new ArrayList<>();
              while (parser.nextToken() != XContentParser.Token.END_ARRAY) {
                indicesArray.add(parser.text());
              }
              indices=ImmutableList.copyOf(indicesArray);
            }
 else             if ("failures".equals(currentFieldName)) {
              ArrayList<SnapshotShardFailure> shardFailureArrayList=new ArrayList<>();
              while (parser.nextToken() != XContentParser.Token.END_ARRAY) {
                shardFailureArrayList.add(SnapshotShardFailure.fromXContent(parser));
              }
              shardFailures=ImmutableList.copyOf(shardFailureArrayList);
            }
 else {
              parser.skipChildren();
            }
          }
 else           if (token == XContentParser.Token.START_OBJECT) {
            parser.skipChildren();
          }
        }
      }
    }
  }
 else {
    throw new ElasticsearchParseException("unexpected token  [" + token + "]");
  }
  return new Snapshot(name,indices,state,reason,version,startTime,endTime,totalShard,successfulShards,shardFailures);
}
