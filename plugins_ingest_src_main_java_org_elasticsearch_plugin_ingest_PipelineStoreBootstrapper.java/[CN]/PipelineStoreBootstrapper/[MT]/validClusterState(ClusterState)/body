{
  if (state.blocks().hasGlobalBlock(DiscoverySettings.NO_MASTER_BLOCK_WRITES) || state.blocks().hasGlobalBlock(DiscoverySettings.NO_MASTER_BLOCK_ALL)) {
    return false;
  }
  if (state.getMetaData().hasConcreteIndex(PipelineStore.INDEX)) {
    IndexRoutingTable routingTable=state.getRoutingTable().index(PipelineStore.INDEX);
    return routingTable.allPrimaryShardsActive();
  }
 else {
    return true;
  }
}
