{
  if (source.length() > MAXIMUM_SOURCE_LENGTH) {
    throw new IllegalArgumentException("Scripts may be no longer than " + MAXIMUM_SOURCE_LENGTH + " characters.  The passed in script is "+ source.length()+ " characters.  Consider using a"+ " plugin if a script longer than this length is a requirement.");
  }
  final Definition definition=custom != null ? new Definition(custom) : DEFAULT_DEFINITION;
  final ParserRuleContext root=createParseTree(source);
  final Metadata metadata=new Metadata(definition,source,root,settings);
  Analyzer.analyze(metadata);
  final byte[] bytes=Writer.write(metadata);
  final Executable executable=createExecutable(loader,definition,name,source,bytes);
  return executable;
}
