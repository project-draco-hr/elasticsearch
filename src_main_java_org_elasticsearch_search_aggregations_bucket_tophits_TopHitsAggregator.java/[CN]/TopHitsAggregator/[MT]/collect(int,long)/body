{
  TopDocsCollector topDocsCollector=topDocsCollectors.get(bucketOrdinal);
  if (topDocsCollector == null) {
    Sort sort=topHitsContext.sort();
    int size=topHitsContext.size();
    topDocsCollectors.put(bucketOrdinal,topDocsCollector=sort != null ? TopFieldCollector.create(sort,size,true,topHitsContext.trackScores(),true,false) : TopScoreDocCollector.create(size,false));
    topDocsCollector.setNextReader(currentContext);
    topDocsCollector.setScorer(currentScorer);
  }
  topDocsCollector.collect(docId);
}
