{
  if (!Strings.hasLength(filter)) {
    this.filter=null;
    return this;
  }
  try {
    XContentParser parser=XContentFactory.xContent(filter).createParser(filter);
    try {
      filter(parser.mapOrdered());
    }
  finally {
      parser.close();
    }
    return this;
  }
 catch (  IOException e) {
    throw new ElasticSearchGenerationException("Failed to generate [" + filter + "]",e);
  }
}
