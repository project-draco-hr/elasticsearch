def start_node(version, release_dir, data_dir, tcp_port, http_port):
    logging.info(('Starting node from %s on port %s/%s' % (release_dir, tcp_port, http_port)))
    cmd = [os.path.join(release_dir, 'bin/elasticsearch'), ('-Des.path.data=%s' % data_dir), '-Des.path.logs=logs', ('-Des.cluster.name=bwc_index_' + version), '-Des.network.host=localhost', '-Des.discovery.zen.ping.multicast.enabled=false', ('-Des.transport.tcp.port=%s' % tcp_port), ('-Des.http.port=%s' % http_port)]
    if (version.startswith('0.') or version.startswith('1.0.0.Beta')):
        cmd.append('-f')
    return subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
