def main():
    logging.basicConfig(format='[%(levelname)s] [%(asctime)s] %(message)s', level=logging.INFO, datefmt='%Y-%m-%d %I:%M:%S %p')
    logging.getLogger('elasticsearch').setLevel(logging.ERROR)
    logging.getLogger('urllib3').setLevel(logging.WARN)
    cfg = parse_config()
    try:
        node = start_node(cfg.version, cfg.release_dir, cfg.data_dir, cfg.tcp_port, cfg.http_port)
        client = create_client(cfg.http_port)
        generate_index(client)
    finally:
        if ('node' in vars()):
            logging.info('Shutting down node with pid %d', node.pid)
            node.terminate()
    compress_index(cfg.version, cfg.tmp_dir, cfg.output_dir)
