{
  boolean useScroll=!useSlowScroll && request.scroll() != null;
  sortedShardList=searchPhaseController.sortDocs(useScroll,firstResults);
  final InternalSearchResponse internalResponse=searchPhaseController.merge(sortedShardList,firstResults,firstResults);
  String scrollId=null;
  if (request.scroll() != null) {
    scrollId=buildScrollId(request.searchType(),firstResults,null);
  }
  listener.onResponse(new SearchResponse(internalResponse,scrollId,expectedSuccessfulOps,successfulOps.get(),buildTookInMillis(),buildShardFailures()));
}
