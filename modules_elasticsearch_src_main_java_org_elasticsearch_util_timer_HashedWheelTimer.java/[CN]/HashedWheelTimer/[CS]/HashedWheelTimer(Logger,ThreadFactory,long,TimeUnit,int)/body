{
  this.logger=logger;
  if (threadFactory == null) {
    throw new NullPointerException("threadFactory");
  }
  if (unit == null) {
    throw new NullPointerException("unit");
  }
  if (tickDuration <= 0) {
    throw new IllegalArgumentException("tickDuration must be greater than 0: " + tickDuration);
  }
  if (ticksPerWheel <= 0) {
    throw new IllegalArgumentException("ticksPerWheel must be greater than 0: " + ticksPerWheel);
  }
  wheel=createWheel(ticksPerWheel);
  iterators=createIterators(wheel);
  mask=wheel.length - 1;
  this.tickDuration=tickDuration=unit.toMillis(tickDuration);
  if (tickDuration == Long.MAX_VALUE || tickDuration >= Long.MAX_VALUE / wheel.length) {
    throw new IllegalArgumentException("tickDuration is too long: " + tickDuration + ' '+ unit);
  }
  roundDuration=tickDuration * wheel.length;
  workerThread=threadFactory.newThread(new ThreadRenamingRunnable(worker,"Hashed wheel timer #" + id.incrementAndGet()));
  int activeInstances=HashedWheelTimer.activeInstances.incrementAndGet();
  if (activeInstances >= MISUSE_WARNING_THRESHOLD && loggedMisuseWarning.compareAndSet(false,true)) {
    logger.debug("There are too many active " + HashedWheelTimer.class.getSimpleName() + " instances ("+ activeInstances+ ") - you should share the small number "+ "of instances to avoid excessive resource consumption.");
  }
}
