{
  IndexReader reader=IndexReader.open(writer,true);
  for (int i=0; i < reader.maxDoc(); i++) {
    if (reader.isDeleted(i)) {
      continue;
    }
    Document document=reader.document(i);
    checkDoc(document);
    document=reader.document(i,new MapFieldSelector("id","field","count"));
    checkDoc(document);
  }
  for (int i=0; i < 100; i++) {
    int doc=ThreadLocalRandom.current().nextInt(reader.maxDoc());
    if (reader.isDeleted(i)) {
      continue;
    }
    Document document=reader.document(doc);
    checkDoc(document);
    document=reader.document(doc,new MapFieldSelector("id","field","count"));
    checkDoc(document);
  }
}
