{
  Directory dir=new RAMDirectory();
  IndexOutput out=compressor.indexOutput(dir.createOutput("test",IOContext.DEFAULT));
  long pos1=out.getFilePointer();
  out.writeInt(1);
  long pos2=out.getFilePointer();
  out.writeString("test1");
  long pos3=out.getFilePointer();
  String largeString=RandomStringGenerator.random(0xFFFF + 5);
  out.writeString(largeString);
  long pos4=out.getFilePointer();
  out.writeInt(2);
  long pos5=out.getFilePointer();
  out.writeString("test2");
  out.close();
  IndexInput in=compressor.indexInput(dir.openInput("test",IOContext.DEFAULT));
  assertThat(in.readInt(),equalTo(1));
  assertThat(in.readString(),equalTo("test1"));
  assertThat(in.readString(),equalTo(largeString));
  assertThat(in.readInt(),equalTo(2));
  assertThat(in.readString(),equalTo("test2"));
  in.seek(pos3);
  assertThat(in.readString(),equalTo(largeString));
  in.seek(pos2);
  assertThat(in.readString(),equalTo("test1"));
  in.seek(pos5);
  assertThat(in.readString(),equalTo("test2"));
  in.seek(pos1);
  assertThat(in.readInt(),equalTo(1));
  in.seek(0);
  byte[] full=new byte[(int)in.length()];
  in.readBytes(full,0,full.length);
  in.close();
}
