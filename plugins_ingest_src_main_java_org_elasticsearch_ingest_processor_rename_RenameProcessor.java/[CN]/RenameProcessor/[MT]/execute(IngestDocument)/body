{
  for (  Map.Entry<String,String> entry : fields.entrySet()) {
    if (document.hasPropertyValue(entry.getKey())) {
      if (document.hasPropertyValue(entry.getKey()) == false) {
        throw new IllegalArgumentException("field [" + entry.getKey() + "] doesn't exist");
      }
      Object oldValue=document.getPropertyValue(entry.getKey(),Object.class);
      document.removeProperty(entry.getKey());
      document.setPropertyValue(entry.getValue(),oldValue);
    }
  }
}
