{
  for (  Map.Entry<String,String> entry : fields.entrySet()) {
    if (document.hasField(entry.getKey())) {
      if (document.hasField(entry.getKey()) == false) {
        throw new IllegalArgumentException("field [" + entry.getKey() + "] doesn't exist");
      }
      Object oldValue=document.getFieldValue(entry.getKey(),Object.class);
      document.removeField(entry.getKey());
      document.setFieldValue(entry.getValue(),oldValue);
    }
  }
}
