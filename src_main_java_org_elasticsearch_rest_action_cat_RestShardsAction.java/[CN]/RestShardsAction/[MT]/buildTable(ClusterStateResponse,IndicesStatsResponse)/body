{
  Table table=new Table();
  table.startHeaders().addCell("index","default:true;").addCell("shard","default:true;").addCell("p/r","default:true;").addCell("state","default:true;").addCell("docs","default:true;").addCell("store","default:true;").addCell("ip","default:true;").addCell("node","default:true;").endHeaders();
  for (  ShardRouting shard : state.getState().routingTable().allShards()) {
    CommonStats shardStats=stats.asMap().get(shard);
    table.startRow();
    table.addCell(shard.index());
    table.addCell(shard.id());
    table.addCell(shard.primary() ? "p" : "r");
    table.addCell(shard.state());
    table.addCell(shardStats == null ? null : shardStats.getDocs().getCount());
    table.addCell(shardStats == null ? null : shardStats.getStore().getSize());
    if (shard.assignedToNode()) {
      table.addCell(((InetSocketTransportAddress)state.getState().nodes().get(shard.currentNodeId()).address()).address().getAddress().getHostAddress());
      table.addCell(state.getState().nodes().get(shard.currentNodeId()).name());
    }
 else {
      table.addCell(null);
      table.addCell(null);
    }
    table.endRow();
  }
  return table;
}
