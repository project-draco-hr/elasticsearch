{
  Table tab=new Table();
  if (headers) {
    tab.addRow(new Row().addCell("index").addCell("shard").addCell("replica").addCell("state").addCell("docs").addCell("size").addCell("bytes").addCell("host").addCell("node"),true);
  }
  for (  ShardRouting shard : state.getState().routingTable().allShards()) {
    Row row=new Row();
    String pri="r";
    StringBuilder host=new StringBuilder();
    String docs="";
    String size="";
    String bytes="";
    String nodeName="";
    if (shard.assignedToNode()) {
      host.append(((InetSocketTransportAddress)state.getState().nodes().get(shard.currentNodeId()).address()).address().getHostString());
      nodeName=state.getState().nodes().get(shard.currentNodeId()).name();
    }
    if (shard.relocating()) {
      host.append(" -> ");
      host.append(((InetSocketTransportAddress)state.getState().nodes().get(shard.relocatingNodeId()).address()).address().getHostString());
      host.append(state.getState().nodes().get(shard.relocatingNodeId()).name());
    }
    if (null != stats.asMap().get(shard.globalId())) {
      size=stats.asMap().get(shard.globalId()).getStore().size().toString();
      bytes=new Long(stats.asMap().get(shard.globalId()).getStore().getSizeInBytes()).toString();
      docs=new Long(stats.asMap().get(shard.globalId()).getDocs().getCount()).toString();
    }
    if (shard.primary()) {
      pri="p";
    }
    row.addCell(shard.index()).addCell(new Integer(shard.shardId().id()).toString()).addCell(pri).addCell(shard.state().toString()).addCell(docs).addCell(size).addCell(bytes).addCell(host.toString()).addCell(nodeName);
    tab.addRow(row);
  }
  return tab.render(headers);
}
