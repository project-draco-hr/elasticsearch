{
  if (collectedUids == null) {
    throw new ElasticSearchIllegalStateException("has_child filter hasn't executed properly");
  }
  if (remaining == 0) {
    return null;
  }
  if (shortCircuitFilter != null) {
    return shortCircuitFilter.getDocIdSet(context,acceptDocs);
  }
  DocIdSet parentDocIdSet=this.parentFilter.getDocIdSet(context,null);
  if (DocIdSets.isEmpty(parentDocIdSet)) {
    return null;
  }
  Bits parentsBits=DocIdSets.toSafeBits(context.reader(),parentDocIdSet);
  IdReaderTypeCache idReaderTypeCache=searchContext.idCache().reader(context.reader()).type(parentType);
  if (idReaderTypeCache != null) {
    return new ParentDocSet(context.reader(),parentsBits,collectedUids.v(),idReaderTypeCache);
  }
 else {
    return null;
  }
}
