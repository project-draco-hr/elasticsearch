{
  Map<String,Object> root;
  XContentParser xContentParser=null;
  try {
    xContentParser=XContentFactory.xContent(source).createParser(source);
    root=xContentParser.map();
  }
 catch (  IOException e) {
    throw new MapperParsingException("Failed to parse mapping definition",e);
  }
 finally {
    if (xContentParser != null) {
      xContentParser.close();
    }
  }
  if (root.keySet().size() != 1) {
    throw new MapperParsingException("Mapping must have the `type` as the root object");
  }
  String rootName=root.keySet().iterator().next();
  if (type == null) {
    type=rootName;
  }
  return new Tuple<String,Map<String,Object>>(type,(Map<String,Object>)root.get(rootName));
}
