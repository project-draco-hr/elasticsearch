{
  long[] fromTo;
  try {
    fromTo=Cidrs.cidrMaskToMinMax(mask);
  }
 catch (  IllegalArgumentException e) {
    throw new SearchSourceBuilderException("invalid CIDR mask [" + mask + "] in ip_range aggregation ["+ getName()+ "]",e);
  }
  ranges.add(new Range(key,fromTo[0] == 0 ? null : fromTo[0],fromTo[1] == InternalIPv4Range.MAX_IP ? null : fromTo[1]));
  return this;
}
