{
  String match=null;
  String pathMatch=null;
  String unmatch=null;
  String pathUnmatch=null;
  Map<String,Object> mapping=null;
  String matchMappingType=null;
  String matchPattern="simple";
  for (  Map.Entry<String,Object> entry : conf.entrySet()) {
    String propName=Strings.toUnderscoreCase(entry.getKey());
    if ("match".equals(propName)) {
      match=entry.getValue().toString();
    }
 else     if ("path_match".equals(propName)) {
      pathMatch=entry.getValue().toString();
    }
 else     if ("unmatch".equals(propName)) {
      unmatch=entry.getValue().toString();
    }
 else     if ("path_unmatch".equals(propName)) {
      pathUnmatch=entry.getValue().toString();
    }
 else     if ("match_mapping_type".equals(propName)) {
      matchMappingType=entry.getValue().toString();
    }
 else     if ("match_pattern".equals(propName)) {
      matchPattern=entry.getValue().toString();
    }
 else     if ("mapping".equals(propName)) {
      mapping=(Map<String,Object>)entry.getValue();
    }
  }
  if (match == null && pathMatch == null && matchMappingType == null) {
    throw new MapperParsingException("template must have match, path_match or match_mapping_type set");
  }
  if (mapping == null) {
    throw new MapperParsingException("template must have mapping set");
  }
  return new DynamicTemplate(name,conf,pathMatch,pathUnmatch,match,unmatch,matchMappingType,MatchType.fromString(matchPattern),mapping);
}
