{
  while (true) {
    MergePolicy.OneMerge merge=writer.getNextMerge();
    if (merge == null)     break;
    long time=System.currentTimeMillis();
    currentMerges.incrementAndGet();
    try {
      writer.merge(merge);
    }
  finally {
      currentMerges.decrementAndGet();
      totalMerges.incrementAndGet();
      totalMergeTime.addAndGet(System.currentTimeMillis() - time);
    }
  }
}
