{
  indexSingleDocumentWithStringFieldsGeneratedFromText(true,randomBoolean());
  String[] fieldsList={"_all","_field_names"};
  assertGetFieldsNull("testidx","doc","1",fieldsList);
  assertGetFieldsException("testidx","doc","1",fieldsList);
  refresh();
  assertGetFieldsAlwaysWorks("testidx","doc","1",fieldsList);
  flush();
  assertGetFieldsAlwaysWorks("testidx","doc","1",fieldsList);
}
