{
  indexSingleDocumentWithStringFieldsGeneratedFromText(true,randomBoolean());
  String[] fieldsList={"_all","_field_names"};
  assertGetFieldsNull(indexOrAlias(),"doc","1",fieldsList);
  assertGetFieldsException(indexOrAlias(),"doc","1",fieldsList);
  refresh();
  assertGetFieldsAlwaysWorks(indexOrAlias(),"doc","1",fieldsList);
  flush();
  assertGetFieldsAlwaysWorks(indexOrAlias(),"doc","1",fieldsList);
}
