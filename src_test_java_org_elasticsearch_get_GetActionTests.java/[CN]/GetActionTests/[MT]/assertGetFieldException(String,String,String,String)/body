{
  try {
    client().prepareGet().setIndex(index).setType(type).setId(docId).setFields(field).setIgnoreErrorsOnGeneratedFields(false).get();
    fail();
  }
 catch (  ElasticsearchException e) {
    assertTrue(e.getMessage().contains("You can only get this field after refresh() has been called."));
  }
  MultiGetResponse multiGetResponse=client().prepareMultiGet().add(new MultiGetRequest.Item(index,type,docId).fields(field)).setIgnoreErrorsOnGeneratedFields(false).get();
  assertNull(multiGetResponse.getResponses()[0].getResponse());
  assertTrue(multiGetResponse.getResponses()[0].getFailure().getMessage().contains("You can only get this field after refresh() has been called."));
}
