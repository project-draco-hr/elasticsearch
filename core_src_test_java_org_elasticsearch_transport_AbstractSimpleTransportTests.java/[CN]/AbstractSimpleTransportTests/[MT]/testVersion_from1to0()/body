{
  serviceA.registerRequestHandler("/version",Version0Request.class,ThreadPool.Names.SAME,new TransportRequestHandler<Version0Request>(){
    @Override public void messageReceived(    Version0Request request,    TransportChannel channel) throws Exception {
      assertThat(request.value1,equalTo(1));
      Version0Response response=new Version0Response();
      response.value1=1;
      channel.sendResponse(response);
    }
  }
);
  Version1Request version1Request=new Version1Request();
  version1Request.value1=1;
  version1Request.value2=2;
  Version1Response version1Response=serviceB.submitRequest(nodeA,"/version",version1Request,new BaseTransportResponseHandler<Version1Response>(){
    @Override public Version1Response newInstance(){
      return new Version1Response();
    }
    @Override public void handleResponse(    Version1Response response){
      assertThat(response.value1,equalTo(1));
      assertThat(response.value2,equalTo(0));
    }
    @Override public void handleException(    TransportException exp){
      exp.printStackTrace();
      fail();
    }
    @Override public String executor(){
      return ThreadPool.Names.SAME;
    }
  }
).txGet();
  assertThat(version1Response.value1,equalTo(1));
  assertThat(version1Response.value2,equalTo(0));
}
