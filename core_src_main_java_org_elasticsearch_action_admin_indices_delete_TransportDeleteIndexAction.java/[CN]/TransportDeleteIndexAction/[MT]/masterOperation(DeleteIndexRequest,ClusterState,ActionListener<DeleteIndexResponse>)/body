{
  final Set<Index> concreteIndices=new HashSet<>(Arrays.asList(indexNameExpressionResolver.concreteIndices(state,request)));
  if (concreteIndices.isEmpty()) {
    listener.onResponse(new DeleteIndexResponse(true));
    return;
  }
  DeleteIndexClusterStateUpdateRequest deleteRequest=new DeleteIndexClusterStateUpdateRequest().ackTimeout(request.timeout()).masterNodeTimeout(request.masterNodeTimeout()).indices(concreteIndices.toArray(new Index[concreteIndices.size()]));
  deleteIndexService.deleteIndices(deleteRequest,new ActionListener<ClusterStateUpdateResponse>(){
    @Override public void onResponse(    ClusterStateUpdateResponse response){
      listener.onResponse(new DeleteIndexResponse(response.isAcknowledged()));
    }
    @Override public void onFailure(    Exception t){
      logger.debug("failed to delete indices [{}]",t,concreteIndices);
      listener.onFailure(t);
    }
  }
);
}
