{
  long date=2015062301000l;
  XContentBuilder mapping=jsonBuilder().startObject().startObject("properties").startObject("date_field").field("type","date").field("format","yyyyMMddHHSSS").endObject().endObject().endObject();
  index=createIndex(Version.CURRENT,mapping);
  XContentBuilder document=XContentFactory.jsonBuilder().startObject().field("date_field",String.valueOf(date)).endObject();
  index(document);
  document=XContentFactory.jsonBuilder().startObject().field("date_field",date).endObject();
  index(document);
  QueryBuilder query=QueryBuilders.rangeQuery("date_field").from("2015-06-23").to("2015-06-24").format("dateOptionalTime");
  SearchResponse response=client().prepareSearch(index).setQuery(query).get();
  assertHitCount(response,2);
}
