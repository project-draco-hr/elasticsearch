{
  Holder holder=cache.get();
  holder.writer.reset();
  t.printStackTrace(holder.printWriter);
  JsonBuilder builder=jsonBuilder().prettyPrint().startObject().field("error",detailedMessage(t));
  if (request.paramAsBoolean("errorTrace",false)) {
    builder.startObject("errorTrace");
    boolean first=true;
    while (t != null) {
      if (!first) {
        builder.startObject("cause");
      }
      buildThrowable(t,builder);
      if (!first) {
        builder.endObject();
      }
      t=t.getCause();
      first=false;
    }
    builder.endObject();
  }
  builder.endObject();
  return builder;
}
