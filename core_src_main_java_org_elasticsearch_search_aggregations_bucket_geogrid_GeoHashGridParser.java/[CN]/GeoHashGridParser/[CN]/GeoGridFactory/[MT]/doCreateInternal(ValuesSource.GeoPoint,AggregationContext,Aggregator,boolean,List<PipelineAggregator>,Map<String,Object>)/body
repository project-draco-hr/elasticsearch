{
  if (collectsFromSingleBucket == false) {
    return asMultiBucketAggregator(this,aggregationContext,parent);
  }
  CellIdSource cellIdSource=new CellIdSource(valuesSource,precision);
  return new GeoHashGridAggregator(name,factories,cellIdSource,requiredSize,shardSize,aggregationContext,parent,pipelineAggregators,metaData);
}
