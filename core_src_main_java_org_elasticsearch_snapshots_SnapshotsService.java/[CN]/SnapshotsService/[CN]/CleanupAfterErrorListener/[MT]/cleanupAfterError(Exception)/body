{
  if (snapshotCreated) {
    try {
      repositoriesService.repository(snapshot.snapshot().getRepository()).finalizeSnapshot(snapshot.snapshot().getSnapshotId(),snapshot.indices(),snapshot.startTime(),ExceptionsHelper.detailedMessage(exception),0,Collections.emptyList());
    }
 catch (    Exception inner) {
      inner.addSuppressed(exception);
      logger.warn(new ParameterizedMessage("[{}] failed to close snapshot in repository",snapshot.snapshot()),inner);
    }
  }
  userCreateSnapshotListener.onFailure(e);
}
