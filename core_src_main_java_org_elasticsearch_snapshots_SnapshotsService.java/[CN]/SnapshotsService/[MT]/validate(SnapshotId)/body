{
  String name=snapshotId.getSnapshot();
  if (!Strings.hasLength(name)) {
    throw new InvalidSnapshotNameException(snapshotId,"cannot be empty");
  }
  if (name.contains(" ")) {
    throw new InvalidSnapshotNameException(snapshotId,"must not contain whitespace");
  }
  if (name.contains(",")) {
    throw new InvalidSnapshotNameException(snapshotId,"must not contain ','");
  }
  if (name.contains("#")) {
    throw new InvalidSnapshotNameException(snapshotId,"must not contain '#'");
  }
  if (name.charAt(0) == '_') {
    throw new InvalidSnapshotNameException(snapshotId,"must not start with '_'");
  }
  if (!name.toLowerCase(Locale.ROOT).equals(name)) {
    throw new InvalidSnapshotNameException(snapshotId,"must be lowercase");
  }
  if (!Strings.validFileName(name)) {
    throw new InvalidSnapshotNameException(snapshotId,"must not contain the following characters " + Strings.INVALID_FILENAME_CHARS);
  }
}
