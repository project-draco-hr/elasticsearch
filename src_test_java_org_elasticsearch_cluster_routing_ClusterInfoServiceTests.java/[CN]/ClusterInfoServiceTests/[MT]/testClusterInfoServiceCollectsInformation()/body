{
  createIndex("test");
  ensureGreen("test");
  Thread.sleep(2000);
  InternalTestCluster internalTestCluster=internalCluster();
  ClusterInfoService infoService=internalTestCluster.getInstance(ClusterInfoService.class,internalTestCluster.getMasterName());
  ClusterInfo info=infoService.getClusterInfo();
  Map<String,DiskUsage> usages=info.getNodeDiskUsages();
  Map<String,Long> shardSizes=info.getShardSizes();
  assertNotNull(usages);
  assertNotNull(shardSizes);
  assertThat("some usages are populated",usages.values().size(),greaterThan(0));
  assertThat("some shard sizes are populated",shardSizes.values().size(),greaterThan(0));
  for (  DiskUsage usage : usages.values()) {
    logger.info("--> usage: {}",usage);
    assertThat("usage has be retrieved",usage.getFreeBytes(),greaterThan(0L));
  }
  for (  Long size : shardSizes.values()) {
    logger.info("--> shard size: {}",size);
    assertThat("shard size is greater than 0",size,greaterThan(0L));
  }
}
