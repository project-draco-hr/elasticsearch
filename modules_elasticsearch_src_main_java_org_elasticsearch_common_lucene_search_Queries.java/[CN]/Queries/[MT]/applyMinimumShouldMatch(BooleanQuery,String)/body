{
  if (minimumShouldMatch == null) {
    return;
  }
  int optionalClauses=0;
  for (  BooleanClause c : query.clauses()) {
    if (c.getOccur() == BooleanClause.Occur.SHOULD) {
      optionalClauses++;
    }
  }
  int msm=calculateMinShouldMatch(optionalClauses,minimumShouldMatch);
  if (0 < msm) {
    query.setMinimumNumberShouldMatch(msm);
  }
}
