{
  if (context == null) {
    return super.termsFilter(values,context);
  }
  if (values.size() == 1) {
    return termFilter(values.get(0),context);
  }
  List<String> types=new ArrayList<String>(context.mapperService().types().size());
  for (  DocumentMapper documentMapper : context.mapperService()) {
    if (documentMapper.parentFieldMapper() == null) {
      types.add(documentMapper.type());
    }
  }
  List<BytesRef> bValues=new ArrayList<BytesRef>(values.size());
  for (  Object value : values) {
    BytesRef bValue=BytesRefs.toBytesRef(value);
    if (Uid.hasDelimiter(bValue)) {
      bValues.add(bValue);
    }
 else {
      for (      String type : types) {
        bValues.add(Uid.createUidAsBytes(type,bValue));
      }
    }
  }
  return new TermsFilter(names.indexName(),bValues);
}
