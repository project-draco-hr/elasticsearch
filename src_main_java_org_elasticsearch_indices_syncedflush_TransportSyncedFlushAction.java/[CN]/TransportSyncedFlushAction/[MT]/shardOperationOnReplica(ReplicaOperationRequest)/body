{
  byte[] commitId=shardRequest.request.commitIds().get(clusterService.localNode().getId());
  IndexService indexService=indicesService.indexServiceSafe(shardRequest.shardId.getIndex());
  IndexShard indexShard=indexService.shardSafe(shardRequest.shardId.id());
  SyncedFlushReplicaResponse syncedFlushReplicaResponse=new SyncedFlushReplicaResponse();
  boolean success=indexShard.syncFlushIfNoPendingChanges(shardRequest.request.syncId(),commitId);
  String message=success ? "synced flush succeeded" : "synced flush failed";
  syncedFlushReplicaResponse.setResult(success,shardRequest.request.index(),shardRequest.shardId.id(),shardRequest.getNodeId(),message);
  return syncedFlushReplicaResponse;
}
