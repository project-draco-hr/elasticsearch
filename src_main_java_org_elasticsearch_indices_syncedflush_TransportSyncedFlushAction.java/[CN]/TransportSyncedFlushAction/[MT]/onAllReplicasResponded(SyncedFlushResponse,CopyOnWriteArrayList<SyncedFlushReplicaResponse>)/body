{
  List<ActionWriteResponse.ShardInfo.Failure> additionalFailures=new ArrayList<>();
  for (  SyncedFlushReplicaResponse replicaResponse : replicaResponses) {
    if (replicaResponse.succeeded == false) {
      additionalFailures.add(new ActionWriteResponse.ShardInfo.Failure(replicaResponse.getIndex(),replicaResponse.getShardId(),replicaResponse.getNodeId(),replicaResponse.getReason(),RestStatus.CONFLICT,false));
    }
  }
  additionalFailures.addAll(Arrays.asList(finalResponse.getShardInfo().getFailures()));
  finalResponse.setShardInfo(new ActionWriteResponse.ShardInfo(finalResponse.getShardInfo().getTotal(),finalResponse.getShardInfo().getTotal() - additionalFailures.size(),additionalFailures.toArray(new ActionWriteResponse.ShardInfo.Failure[additionalFailures.size()])));
  return finalResponse;
}
