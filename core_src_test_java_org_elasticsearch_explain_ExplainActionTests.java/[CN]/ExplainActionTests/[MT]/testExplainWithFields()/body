{
  assertAcked(prepareCreate("test").addAlias(new Alias("alias")));
  ensureGreen("test");
  client().prepareIndex("test","test","1").setSource(jsonBuilder().startObject().startObject("obj1").field("field1","value1").field("field2","value2").endObject().endObject()).get();
  refresh();
  ExplainResponse response=client().prepareExplain(indexOrAlias(),"test","1").setQuery(QueryBuilders.matchAllQuery()).setFields("obj1.field1").get();
  assertNotNull(response);
  assertTrue(response.isMatch());
  assertNotNull(response.getExplanation());
  assertTrue(response.getExplanation().isMatch());
  assertThat(response.getExplanation().getValue(),equalTo(1.0f));
  assertThat(response.getGetResult().isExists(),equalTo(true));
  assertThat(response.getGetResult().getId(),equalTo("1"));
  Set<String> fields=new HashSet<>(response.getGetResult().getFields().keySet());
  fields.remove(TimestampFieldMapper.NAME);
  assertThat(fields,equalTo((Set<String>)ImmutableSet.of("obj1.field1")));
  assertThat(response.getGetResult().getFields().get("obj1.field1").getValue().toString(),equalTo("value1"));
  assertThat(response.getGetResult().isSourceEmpty(),equalTo(true));
  refresh();
  response=client().prepareExplain(indexOrAlias(),"test","1").setQuery(QueryBuilders.matchAllQuery()).setFields("obj1.field1").setFetchSource(true).get();
  assertNotNull(response);
  assertTrue(response.isMatch());
  assertNotNull(response.getExplanation());
  assertTrue(response.getExplanation().isMatch());
  assertThat(response.getExplanation().getValue(),equalTo(1.0f));
  assertThat(response.getGetResult().isExists(),equalTo(true));
  assertThat(response.getGetResult().getId(),equalTo("1"));
  fields=new HashSet<>(response.getGetResult().getFields().keySet());
  fields.remove(TimestampFieldMapper.NAME);
  assertThat(fields,equalTo((Set<String>)ImmutableSet.of("obj1.field1")));
  assertThat(response.getGetResult().getFields().get("obj1.field1").getValue().toString(),equalTo("value1"));
  assertThat(response.getGetResult().isSourceEmpty(),equalTo(false));
  response=client().prepareExplain(indexOrAlias(),"test","1").setQuery(QueryBuilders.matchAllQuery()).setFields("obj1.field1","obj1.field2").get();
  assertNotNull(response);
  assertTrue(response.isMatch());
  String v1=(String)response.getGetResult().field("obj1.field1").getValue();
  String v2=(String)response.getGetResult().field("obj1.field2").getValue();
  assertThat(v1,equalTo("value1"));
  assertThat(v2,equalTo("value2"));
}
