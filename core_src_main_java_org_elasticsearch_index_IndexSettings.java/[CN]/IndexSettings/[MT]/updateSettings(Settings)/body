{
  if (Version.indexCreated(settings) != version) {
    throw new IllegalStateException("version mismatch on settings update");
  }
  if (this.settings.getByPrefix(IndexMetaData.INDEX_SETTING_PREFIX).getAsMap().equals(settings.getByPrefix(IndexMetaData.INDEX_SETTING_PREFIX).getAsMap())) {
    return false;
  }
  this.settings=Settings.builder().put(this.settings).put(settings).build();
  for (  final Consumer<Settings> consumer : updateListeners) {
    try {
      consumer.accept(settings);
    }
 catch (    Exception e) {
      logger.warn("failed to refresh index settings for [{}]",e,settings);
    }
  }
  return true;
}
