{
  if (Version.indexCreated(settings) != version) {
    throw new IllegalArgumentException("version mismatch on settings update expected: " + version + " but was: "+ Version.indexCreated(settings));
  }
  final String newUUID=settings.get(IndexMetaData.SETTING_INDEX_UUID,IndexMetaData.INDEX_UUID_NA_VALUE);
  if (newUUID.equals(getUUID()) == false) {
    throw new IllegalArgumentException("uuid mismatch on settings update expected: " + uuid + " but was: "+ newUUID);
  }
  if (this.settings.getByPrefix(IndexMetaData.INDEX_SETTING_PREFIX).getAsMap().equals(settings.getByPrefix(IndexMetaData.INDEX_SETTING_PREFIX).getAsMap())) {
    return false;
  }
  this.settings=Settings.builder().put(this.settings).put(settings).build();
  for (  final Consumer<Settings> consumer : updateListeners) {
    try {
      consumer.accept(settings);
    }
 catch (    Exception e) {
      logger.warn("failed to refresh index settings for [{}]",e,settings);
    }
  }
  return true;
}
