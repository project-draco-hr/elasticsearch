{
  System.setProperty("es.logger.prefix","");
  int numberOfShards=1;
  int numberOfReplicas=1;
  int numberOfIndices=1000;
  int numberOfDocs=1;
  Client client;
  Node node=null;
  if (true) {
    client=new TransportClient().addTransportAddress(new InetSocketTransportAddress("localhost",9300));
  }
 else {
    node=NodeBuilder.nodeBuilder().client(true).node();
    client=node.client();
  }
  for (int i=0; i < numberOfIndices; i++) {
    logger.info("START index [{}] ...",i);
    client.admin().indices().prepareCreate("index_" + i).setSettings(ImmutableSettings.settingsBuilder().put("index.number_of_shards",numberOfShards).put("index.number_of_replicas",numberOfReplicas)).execute().actionGet();
    for (int j=0; j < numberOfDocs; j++) {
      client.prepareIndex("index_" + i,"type").setSource("field1","test","field2",2,"field3",new Date()).execute().actionGet();
    }
    logger.info("DONE  index [{}]",i);
  }
  logger.info("closing node...");
  if (node != null) {
    node.close();
  }
  logger.info("node closed");
}
