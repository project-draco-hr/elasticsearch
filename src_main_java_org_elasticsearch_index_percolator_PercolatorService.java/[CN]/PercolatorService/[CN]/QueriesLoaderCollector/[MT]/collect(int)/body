{
  Document document=reader.document(doc,new UidAndSourceFieldSelector());
  String id=Uid.createUid(document.get(UidFieldMapper.NAME)).id();
  try {
    Fieldable sourceField=document.getFieldable(SourceFieldMapper.NAME);
    queries.put(id,percolator.parseQuery(id,sourceField.getBinaryValue(),sourceField.getBinaryOffset(),sourceField.getBinaryLength()));
  }
 catch (  Exception e) {
    logger.warn("failed to add query [{}]",e,id);
  }
}
