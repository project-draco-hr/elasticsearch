{
  UidAndSourceFieldVisitor fieldVisitor=new UidAndSourceFieldVisitor();
  reader.document(doc,fieldVisitor);
  Document document=fieldVisitor.createDocument();
  String id=Uid.createUid(document.get(UidFieldMapper.NAME)).id();
  try {
    BytesRef sourceVal=document.getBinaryValue(SourceFieldMapper.NAME);
    queries.put(id,percolator.parseQuery(id,new BytesArray(sourceVal.bytes,sourceVal.offset,sourceVal.length)));
  }
 catch (  Exception e) {
    logger.warn("failed to add query [{}]",e,id);
  }
}
