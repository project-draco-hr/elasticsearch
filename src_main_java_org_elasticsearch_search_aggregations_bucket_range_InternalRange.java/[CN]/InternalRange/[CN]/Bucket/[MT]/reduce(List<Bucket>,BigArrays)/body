{
  long docCount=0;
  List<InternalAggregations> aggregationsList=Lists.newArrayListWithCapacity(ranges.size());
  for (  Bucket range : ranges) {
    docCount+=range.docCount;
    aggregationsList.add(range.aggregations);
  }
  final InternalAggregations aggs=InternalAggregations.reduce(aggregationsList,bigArrays);
  return getFactory().createBucket(key,from,to,docCount,aggs,formatter);
}
