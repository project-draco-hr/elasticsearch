{
  FieldMappersLookup lookup=new FieldMappersLookup();
  FakeFieldMapper f=new FakeFieldMapper("foo","bar");
  FakeFieldMapper other=new FakeFieldMapper("blah","blah");
  lookup=lookup.copyAndAddAll(Lists.newArrayList(f,other));
  FakeFieldMapper f2=new FakeFieldMapper("foo","bar");
  FieldMappersLookup lookup2=lookup.copyAndAddAll(Lists.newArrayList(f2));
  FieldMappers mappers=lookup2.fullName("foo");
  assertNotNull(mappers);
  assertEquals(2,mappers.mappers().size());
  mappers=lookup2.indexName("bar");
  assertNotNull(mappers);
  assertEquals(2,mappers.mappers().size());
  assertEquals(3,Iterators.size(lookup2.iterator()));
}
