{
  assertAcked(prepareCreate("test").setSettings(Settings.builder().put(IndexStore.INDEX_STORE_THROTTLE_TYPE,"merge").put(IndexMetaData.SETTING_NUMBER_OF_SHARDS,"1").put(IndexMetaData.SETTING_NUMBER_OF_REPLICAS,"0").put(MergePolicyConfig.INDEX_MERGE_POLICY_MAX_MERGE_AT_ONCE,"2").put(MergePolicyConfig.INDEX_MERGE_POLICY_SEGMENTS_PER_TIER,"2").put(ConcurrentMergeSchedulerProvider.MAX_THREAD_COUNT,"1").put(ConcurrentMergeSchedulerProvider.MAX_MERGE_COUNT,"10000")));
  ensureGreen();
  long termUpto=0;
  IndicesStatsResponse stats;
  for (int i=0; i < 100; i++) {
    StringBuilder sb=new StringBuilder();
    for (int j=0; j < 100; j++) {
      sb.append(' ');
      sb.append(termUpto++);
      sb.append(" some random text that keeps repeating over and over again hambone");
    }
    client().prepareIndex("test","type","" + termUpto).setSource("field" + (i % 10),sb.toString()).get();
  }
  refresh();
  stats=client().admin().indices().prepareStats().execute().actionGet();
  stats=client().admin().indices().prepareStats().execute().actionGet();
  assertThat(stats.getPrimaries().getIndexing().getTotal().getThrottleTimeInMillis(),equalTo(0l));
}
