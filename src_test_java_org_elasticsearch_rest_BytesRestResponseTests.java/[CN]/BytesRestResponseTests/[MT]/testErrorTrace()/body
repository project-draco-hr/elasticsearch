{
  RestRequest request=new FakeRestRequest();
  request.params().put("error_trace","true");
  RestChannel channel=new DetailedExceptionRestChannel(request);
  Throwable t=new Throwable("an error occurred reading data",new FileNotFoundException("/foo/bar"));
  BytesRestResponse response=new BytesRestResponse(channel,t);
  String text=response.content().toUtf8();
  assertThat(text,containsString("\"error\":\"Throwable[an error occurred reading data]"));
  assertThat(text,containsString("FileNotFoundException[/foo/bar]"));
  assertThat(text,containsString("\"error_trace\":{\"message\":\"an error occurred reading data\""));
}
