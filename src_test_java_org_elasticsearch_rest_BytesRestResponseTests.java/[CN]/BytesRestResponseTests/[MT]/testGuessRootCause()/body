{
  RestRequest request=new FakeRestRequest();
  RestChannel channel=new DetailedExceptionRestChannel(request);
  Throwable t=new ElasticsearchException("an error occurred reading data",new FileNotFoundException("/foo/bar"));
  BytesRestResponse response=new BytesRestResponse(channel,t);
  String text=response.content().toUtf8();
  assertThat(text,containsString("{\"root_cause\":[{\"type\":\"exception\",\"reason\":\"an error occurred reading data\"}]"));
}
