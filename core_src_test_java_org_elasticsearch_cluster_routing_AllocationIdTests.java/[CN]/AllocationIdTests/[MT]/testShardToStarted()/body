{
  logger.info("-- create unassigned shard");
  ShardRouting shard=ShardRouting.newUnassigned("test",0,null,true,new UnassignedInfo(UnassignedInfo.Reason.INDEX_CREATED,null));
  assertThat(shard.allocationId(),nullValue());
  logger.info("-- initialize the shard");
  shard.initialize("node1",-1);
  AllocationId allocationId=shard.allocationId();
  assertThat(allocationId,notNullValue());
  assertThat(allocationId.getId(),notNullValue());
  assertThat(allocationId.getRelocationId(),nullValue());
  logger.info("-- start the shard");
  shard.moveToStarted();
  assertThat(shard.allocationId().getId(),equalTo(allocationId.getId()));
  allocationId=shard.allocationId();
  assertThat(allocationId.getId(),notNullValue());
  assertThat(allocationId.getRelocationId(),nullValue());
}
