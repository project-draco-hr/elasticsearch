{
  if (random().nextBoolean() && dir instanceof MockDirectoryWrapper) {
    return ((MockDirectoryWrapper)dir).getOpenDeletedFiles();
  }
  DistributorDirectory d=DirectoryUtils.getLeaf(dir,DistributorDirectory.class,null);
  Distributor distributor=d.getDistributor();
  Set<String> set=new HashSet<>();
  for (  Directory subDir : distributor.all()) {
    Set<String> openDeletedFiles=((MockDirectoryWrapper)subDir).getOpenDeletedFiles();
    set.addAll(openDeletedFiles);
  }
  return set;
}
