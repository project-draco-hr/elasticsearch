{
  ShardId shardId=new ShardId("test",0);
  Map<String,byte[]> commitIds=new HashMap<>();
  final String nodeId="node_id";
  commitIds.put(nodeId,generateRandomId(randomInt(100)));
  SyncedFlushRequest syncedFlushRequest=new SyncedFlushRequest(shardId,randomAsciiOfLength(5),commitIds);
  BytesStreamOutput out=new BytesStreamOutput();
  syncedFlushRequest.writeTo(out);
  out.close();
  StreamInput in=new BytesStreamInput(out.bytes());
  SyncedFlushRequest request=new SyncedFlushRequest();
  request.readFrom(in);
  assertArrayEquals(request.commitIds().get(nodeId),syncedFlushRequest.commitIds().get(nodeId));
}
