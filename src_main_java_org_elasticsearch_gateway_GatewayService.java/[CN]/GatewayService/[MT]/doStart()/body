{
  clusterService.addLast(this);
  if (discoveryService.initialStateReceived()) {
    ClusterState clusterState=clusterService.state();
    if (clusterState.nodes().localNodeMaster() && clusterState.blocks().hasGlobalBlock(STATE_NOT_RECOVERED_BLOCK)) {
      checkStateMeetsSettingsAndMaybeRecover(clusterState,false);
    }
  }
 else {
    logger.debug("can't wait on start for (possibly) reading state from gateway, will do it asynchronously");
  }
}
