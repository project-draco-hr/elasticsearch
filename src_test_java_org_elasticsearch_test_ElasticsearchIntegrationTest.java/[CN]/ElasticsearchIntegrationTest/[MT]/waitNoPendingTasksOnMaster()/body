{
  assertNoTimeout(client().admin().cluster().prepareHealth().setWaitForEvents(Priority.LANGUID).get());
  assertBusy(new Runnable(){
    @Override public void run(){
      PendingClusterTasksResponse pendingTasks=client().admin().cluster().preparePendingClusterTasks().setLocal(true).get();
      assertThat("master still has pending tasks " + pendingTasks.prettyPrint(),pendingTasks,Matchers.emptyIterable());
    }
  }
);
  assertNoTimeout(client().admin().cluster().prepareHealth().setWaitForEvents(Priority.LANGUID).get());
}
