{
  if (rarely()) {
    if (rarely()) {
      client().admin().indices().prepareRefresh(indices).setIndicesOptions(IndicesOptions.lenient()).execute(new LatchedActionListener<RefreshResponse>(newLatch(inFlightAsyncOperations)));
    }
 else     if (rarely()) {
      client().admin().indices().prepareFlush(indices).setIndicesOptions(IndicesOptions.lenient()).execute(new LatchedActionListener<FlushResponse>(newLatch(inFlightAsyncOperations)));
    }
 else     if (rarely()) {
      client().admin().indices().prepareOptimize(indices).setIndicesOptions(IndicesOptions.lenient()).setMaxNumSegments(between(1,10)).setFlush(randomBoolean()).execute(new LatchedActionListener<OptimizeResponse>(newLatch(inFlightAsyncOperations)));
    }
  }
  while (inFlightAsyncOperations.size() > MAX_IN_FLIGHT_ASYNC_INDEXES) {
    int waitFor=between(0,inFlightAsyncOperations.size() - 1);
    inFlightAsyncOperations.remove(waitFor).await();
  }
}
