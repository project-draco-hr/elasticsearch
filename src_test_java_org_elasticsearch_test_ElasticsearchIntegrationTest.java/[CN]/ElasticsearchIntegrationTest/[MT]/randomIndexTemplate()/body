{
  if (immutableCluster().size() > 0) {
    ImmutableSettings.Builder randomSettingsBuilder=setRandomSettings(getRandom(),ImmutableSettings.builder()).put(SETTING_INDEX_SEED,getRandom().nextLong());
    if (randomizeNumberOfShardsAndReplicas()) {
      randomSettingsBuilder.put(SETTING_NUMBER_OF_SHARDS,between(DEFAULT_MIN_NUM_SHARDS,DEFAULT_MAX_NUM_SHARDS)).put(SETTING_NUMBER_OF_REPLICAS,between(0,getRandom().nextInt(10) > 0 ? 1 : immutableCluster().dataNodes() - 1));
    }
    client().admin().indices().preparePutTemplate("random_index_template").setTemplate("*").setOrder(0).setSettings(randomSettingsBuilder).execute().actionGet();
  }
}
