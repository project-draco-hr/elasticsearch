{
  ImmutableSettings.Builder builder=ImmutableSettings.builder();
  int numberOfShards=numberOfShards();
  if (numberOfShards > 0) {
    builder.put(SETTING_NUMBER_OF_SHARDS,numberOfShards).build();
  }
  int numberOfReplicas=numberOfReplicas();
  if (numberOfReplicas >= 0) {
    builder.put(SETTING_NUMBER_OF_REPLICAS,numberOfReplicas).build();
  }
  if ((randomInt(9) < 3) && useCustomDataPath()) {
    String dataPath="data/custom-" + CHILD_JVM_ID + "/"+ UUID.randomUUID().toString();
    logger.info("using custom data_path for index: [{}]",dataPath);
    builder.put(IndexMetaData.SETTING_DATA_PATH,dataPath);
  }
  return builder.build();
}
