{
  ImmutableSettings.Builder builder=ImmutableSettings.builder();
  if (randomizeNumberOfShardsAndReplicas()) {
    int numberOfShards=numberOfShards();
    if (numberOfShards > 0) {
      builder.put(SETTING_NUMBER_OF_SHARDS,numberOfShards).build();
    }
    int numberOfReplicas=numberOfReplicas();
    if (numberOfReplicas >= 0) {
      builder.put(SETTING_NUMBER_OF_REPLICAS,numberOfReplicas).build();
    }
  }
  return builder.build();
}
