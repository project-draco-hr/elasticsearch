{
  Pipeline.Factory factory=new Pipeline.Factory();
  Map<String,Processor.Factory> processorRegistry=new HashMap<>();
  processorRegistry.put("simple",new SimpleProcessor.Factory());
  Map<String,Object> processorConfig=new HashMap<>();
  processorConfig.put("path","_path");
  processorConfig.put("expected_value","_expected_value");
  processorConfig.put("add_field","_add_field");
  processorConfig.put("add_field_value","_add_field_value");
  Map<String,Object> pipelineConfig=new HashMap<>();
  pipelineConfig.put("description","_description");
  pipelineConfig.put("processors",Collections.singletonList(Collections.singletonMap("simple",processorConfig)));
  Pipeline pipeline=factory.create("_id",pipelineConfig,processorRegistry);
  assertThat(pipeline.getId(),equalTo("_id"));
  assertThat(pipeline.getDescription(),equalTo("_description"));
  assertThat(pipeline.getProcessors().size(),equalTo(1));
  assertThat(pipeline.getProcessors().get(0),instanceOf(SimpleProcessor.class));
}
