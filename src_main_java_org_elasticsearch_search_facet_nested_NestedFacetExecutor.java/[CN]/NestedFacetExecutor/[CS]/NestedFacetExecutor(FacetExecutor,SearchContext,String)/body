{
  this.facetExecutor=facetExecutor;
  MapperService.SmartNameObjectMapper mapper=context.smartNameObjectMapper(nestedPath);
  if (mapper == null) {
    throw new SearchParseException(context,"facet nested path [" + nestedPath + "] not found");
  }
  ObjectMapper objectMapper=mapper.mapper();
  if (objectMapper == null) {
    throw new SearchParseException(context,"facet nested path [" + nestedPath + "] not found");
  }
  if (!objectMapper.nested().isNested()) {
    throw new SearchParseException(context,"facet nested path [" + nestedPath + "] is not nested");
  }
  parentFilter=context.filterCache().cache(NonNestedDocsFilter.INSTANCE);
  childFilter=context.filterCache().cache(objectMapper.nestedTypeFilter());
}
