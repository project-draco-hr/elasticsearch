{
  initNestedIndexAndPercolation();
  client().prepareIndex("nestedindex","company","notmatching").setSource(getNotMatchingNestedDoc()).get();
  client().prepareIndex("nestedindex","company","matching").setSource(getMatchingNestedDoc()).get();
  refresh();
  PercolateResponse response=client().preparePercolate().setGetRequest(Requests.getRequest("nestedindex").type("company").id("notmatching")).setDocumentType("company").setIndices("nestedindex").get();
  assertEquals(response.getMatches().length,0);
  response=client().preparePercolate().setGetRequest(Requests.getRequest("nestedindex").type("company").id("matching")).setDocumentType("company").setIndices("nestedindex").get();
  assertEquals(response.getMatches().length,1);
  assertEquals(response.getMatches()[0].getId().string(),"Q");
}
