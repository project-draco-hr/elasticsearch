{
  Map<String,Object> source=XContentHelper.convertToMap(request.source(),false).v2();
  SimulatePipelineRequestPayload payload;
  SimulatePipelineRequestPayload.Factory factory=new SimulatePipelineRequestPayload.Factory();
  try {
    payload=factory.create(request.id(),source,pipelineStore);
  }
 catch (  IOException e) {
    listener.onFailure(e);
    return;
  }
  threadPool.executor(ThreadPool.Names.MANAGEMENT).execute(new Runnable(){
    @Override public void run(){
      listener.onResponse(payload.execute());
    }
  }
);
}
