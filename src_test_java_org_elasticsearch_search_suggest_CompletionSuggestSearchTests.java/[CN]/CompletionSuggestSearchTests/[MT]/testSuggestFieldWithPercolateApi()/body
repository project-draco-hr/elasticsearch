{
  createIndexAndMapping();
  String[][] input={{"Foo Fighters"},{"Foo Fighters"},{"Foo Fighters"},{"Foo Fighters"},{"Generator","Foo Fighters Generator"},{"Learn to Fly","Foo Fighters Learn to Fly"},{"The Prodigy"},{"The Prodigy"},{"The Prodigy"},{"Firestarter","The Prodigy Firestarter"},{"Turbonegro"},{"Turbonegro"},{"Get it on","Turbonegro Get it on"}};
  for (int i=0; i < input.length; i++) {
    client().prepareIndex(INDEX,TYPE,"" + i).setSource(jsonBuilder().startObject().startObject(FIELD).startArray("input").value(input[i]).endArray().endObject().endObject()).execute().actionGet();
  }
  client().prepareIndex(INDEX,PercolatorService.TYPE_NAME,"4").setSource(jsonBuilder().startObject().field("query",matchAllQuery()).endObject()).execute().actionGet();
  refresh();
  PercolateResponse response=client().preparePercolate().setIndices(INDEX).setDocumentType(TYPE).setGetRequest(Requests.getRequest(INDEX).type(TYPE).id("1")).execute().actionGet();
  assertThat(response.getCount(),equalTo(1l));
}
