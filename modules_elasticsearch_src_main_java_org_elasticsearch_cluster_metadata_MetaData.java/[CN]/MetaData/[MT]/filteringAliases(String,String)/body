{
  if (indices == null || indices.length == 0) {
    return null;
  }
  if (indices.length == 1) {
    String alias=indices[0];
    if (alias.equals("_all")) {
      return null;
    }
    ImmutableMap<String,Boolean> aliasToFilteringRequiredMap=indexToAliasFilteringRequiredMap.get(index);
    if (aliasToFilteringRequiredMap == null) {
      throw new IndexMissingException(new Index(index));
    }
    Boolean filteringRequired=aliasToFilteringRequiredMap.get(alias);
    if (filteringRequired == null || !filteringRequired) {
      return null;
    }
    return new String[]{alias};
  }
  List<String> filteringAliases=null;
  for (  String alias : indices) {
    ImmutableMap<String,Boolean> aliasToFilteringRequiredMap=indexToAliasFilteringRequiredMap.get(index);
    if (aliasToFilteringRequiredMap == null) {
      throw new IndexMissingException(new Index(index));
    }
    Boolean filteringRequired=aliasToFilteringRequiredMap.get(alias);
    if (filteringRequired != null) {
      if (filteringRequired) {
        if (filteringAliases == null) {
          filteringAliases=newArrayList();
        }
        filteringAliases.add(alias);
      }
 else {
        return null;
      }
    }
  }
  if (filteringAliases == null) {
    return null;
  }
  return filteringAliases.toArray(new String[filteringAliases.size()]);
}
