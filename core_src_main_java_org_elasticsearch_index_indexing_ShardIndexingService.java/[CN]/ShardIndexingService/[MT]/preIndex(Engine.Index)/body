{
  totalStats.indexCurrent.inc();
  typeStats(index.type()).indexCurrent.inc();
  for (  IndexingOperationListener listener : listeners) {
    try {
      listener.preIndex(index);
    }
 catch (    Exception e) {
      logger.warn("preIndex listener [{}] failed",e,listener);
    }
  }
  return index;
}
