{
  SearchRequestBuilder builder=client().prepareSearch().setSearchType(SearchType.COUNT);
  if (suggestText != null) {
    builder.setSuggestText(suggestText);
  }
  for (  SuggestionBuilder<?> suggestion : suggestions) {
    builder.addSuggestion(suggestion);
  }
  SearchResponse actionGet=builder.execute().actionGet();
  assertThat(Arrays.toString(actionGet.getShardFailures()),actionGet.getFailedShards(),equalTo(expectShardsFailed));
  return actionGet.getSuggest();
}
