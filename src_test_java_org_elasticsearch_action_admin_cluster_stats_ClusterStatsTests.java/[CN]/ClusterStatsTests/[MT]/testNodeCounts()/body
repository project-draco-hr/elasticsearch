{
  cluster().startNode();
  ClusterStatsResponse response=client().admin().cluster().prepareClusterStats().get();
  assertCounts(response.getNodesStats().getCounts(),1,0,0,1,0);
  cluster().startNode(ImmutableSettings.builder().put("node.data",false));
  response=client().admin().cluster().prepareClusterStats().get();
  assertCounts(response.getNodesStats().getCounts(),2,1,0,1,0);
  cluster().startNode(ImmutableSettings.builder().put("node.master",false));
  response=client().admin().cluster().prepareClusterStats().get();
  assertCounts(response.getNodesStats().getCounts(),3,1,1,1,0);
  cluster().startNode(ImmutableSettings.builder().put("node.client",true));
  response=client().admin().cluster().prepareClusterStats().get();
  assertCounts(response.getNodesStats().getCounts(),4,1,1,1,1);
}
