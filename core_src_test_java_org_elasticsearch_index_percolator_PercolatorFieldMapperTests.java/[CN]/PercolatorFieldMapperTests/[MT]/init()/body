{
  IndexService indexService=createIndex("test",Settings.EMPTY);
  mapperService=indexService.mapperService();
  String mapper=XContentFactory.jsonBuilder().startObject().startObject("type").startObject("properties").startObject("field").field("type","text").endObject().endObject().endObject().endObject().string();
  mapperService.merge("type",new CompressedXContent(mapper),MapperService.MergeReason.MAPPING_UPDATE,true);
  String percolatorMapper=XContentFactory.jsonBuilder().startObject().startObject(PercolatorFieldMapper.TYPE_NAME).startObject("properties").startObject("query").field("type","percolator").endObject().endObject().endObject().endObject().string();
  mapperService.merge(PercolatorFieldMapper.TYPE_NAME,new CompressedXContent(percolatorMapper),MapperService.MergeReason.MAPPING_UPDATE,true);
}
