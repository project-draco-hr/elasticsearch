{
  indexService=createIndex("test",Settings.EMPTY);
  mapperService=indexService.mapperService();
  String mapper=XContentFactory.jsonBuilder().startObject().startObject("type").startObject("properties").startObject("field").field("type","text").endObject().startObject("number_field").field("type","long").endObject().startObject("date_field").field("type","date").endObject().endObject().endObject().endObject().string();
  mapperService.merge("type",new CompressedXContent(mapper),MapperService.MergeReason.MAPPING_UPDATE,true);
}
