{
  ParsedDocument doc=mapperService.documentMapper(PercolatorFieldMapper.TYPE_NAME).parse("test",PercolatorFieldMapper.TYPE_NAME,"1",XContentFactory.jsonBuilder().startObject().field("query",termQuery("field","value")).endObject().bytes());
  assertThat(doc.rootDoc().getFields(PercolatorFieldMapper.EXTRACTED_TERMS_FULL_FIELD_NAME).length,equalTo(1));
  assertThat(doc.rootDoc().getFields(PercolatorFieldMapper.EXTRACTED_TERMS_FULL_FIELD_NAME)[0].binaryValue().utf8ToString(),equalTo("field\0value"));
  assertThat(doc.rootDoc().getFields(PercolatorFieldMapper.QUERY_BUILDER_FULL_FIELD_NAME).length,equalTo(1));
}
