{
  IndexService indexService=createIndex("test1",Settings.EMPTY);
  MapperService mapperService=indexService.mapperService();
  String percolatorMapper=XContentFactory.jsonBuilder().startObject().startObject(PercolatorFieldMapper.TYPE_NAME).startObject("properties").startObject("query").field("type","percolator").field("index","no").endObject().endObject().endObject().endObject().string();
  try {
    mapperService.merge(PercolatorFieldMapper.TYPE_NAME,new CompressedXContent(percolatorMapper),MapperService.MergeReason.MAPPING_UPDATE,true);
    fail("MapperParsingException expected");
  }
 catch (  MapperParsingException e) {
    assertThat(e.getMessage(),equalTo("Mapping definition for [query] has unsupported parameters:  [index : no]"));
  }
}
