{
  ImmutableOpenMap.Builder<String,WithOrdinals> globalIfdPerType=ImmutableOpenMap.builder();
  long memorySizeInBytes=0;
  for (  BytesRef parentType : parentTypes) {
    PerType perType=new PerType(parentType.utf8ToString());
    GlobalOrdinalsIndexFieldData globalIfd=(GlobalOrdinalsIndexFieldData)globalOrdinalsBuilder.build(indexReader,perType,indexSettings,breakerService);
    globalIfdPerType.put(perType.type,globalIfd);
    memorySizeInBytes+=globalIfd.getMemorySizeInBytes();
  }
  return new ParentChildGlobalOrdinalsIndexFieldData(globalIfdPerType.build(),memorySizeInBytes);
}
