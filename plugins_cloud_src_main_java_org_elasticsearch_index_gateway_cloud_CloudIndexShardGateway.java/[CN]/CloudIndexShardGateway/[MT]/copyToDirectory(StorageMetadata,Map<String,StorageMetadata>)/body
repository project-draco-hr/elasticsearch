{
  Blob blob=blobStoreContext.getBlobStore().getBlob(shardIndexContainer,metadata.getName());
  byte[] buffer=new byte[16384];
  IndexOutput indexOutput=store.directory().createOutput(metadata.getName());
  copy(blob.getContent(),indexOutput,buffer);
  blob.getContent().close();
  int part=1;
  while (true) {
    String partName=metadata.getName() + ".part" + part;
    if (!allMetadatas.containsKey(partName)) {
      break;
    }
    blob=blobStoreContext.getBlobStore().getBlob(shardIndexContainer,partName);
    copy(blob.getContent(),indexOutput,buffer);
    blob.getContent().close();
    part++;
  }
  indexOutput.close();
  Directories.sync(store.directory(),metadata.getName());
}
