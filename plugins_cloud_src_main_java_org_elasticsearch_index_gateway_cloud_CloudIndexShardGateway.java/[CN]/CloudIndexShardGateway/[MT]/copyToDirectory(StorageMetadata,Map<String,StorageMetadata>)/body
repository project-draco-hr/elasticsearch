{
  String fileName=metadata.getName().substring(shardIndexDirectory.length() + 1);
  Blob blob=blobStoreContext.getBlobStore().getBlob(container,metadata.getName());
  byte[] buffer=new byte[16384];
  IndexOutput indexOutput=store.directory().createOutput(fileName);
  copy(blob.getContent(),indexOutput,buffer);
  blob.getContent().close();
  int part=1;
  while (true) {
    String partName=metadata.getName() + ".part" + part;
    if (!allMetadatas.containsKey(partName)) {
      break;
    }
    blob=blobStoreContext.getBlobStore().getBlob(container,partName);
    copy(blob.getContent(),indexOutput,buffer);
    blob.getContent().close();
    part++;
  }
  indexOutput.close();
  Directories.sync(store.directory(),fileName);
}
