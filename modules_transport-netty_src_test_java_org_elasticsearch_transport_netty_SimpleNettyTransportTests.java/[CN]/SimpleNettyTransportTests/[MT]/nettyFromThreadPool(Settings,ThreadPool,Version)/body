{
  NamedWriteableRegistry namedWriteableRegistry=new NamedWriteableRegistry();
  Transport transport=new NettyTransport(settings,threadPool,new NetworkService(settings),BigArrays.NON_RECYCLING_INSTANCE,namedWriteableRegistry,new NoneCircuitBreakerService()){
    @Override protected Version getCurrentVersion(){
      return version;
    }
  }
;
  return new MockTransportService(Settings.EMPTY,transport,threadPool);
}
