{
  return new NumericRangeFieldDataFilter<Long>(indexFieldData,lowerVal,upperVal,includeLower,includeUpper){
    @Override public DocIdSet getDocIdSet(    AtomicReaderContext ctx,    Bits acceptedDocs) throws IOException {
      final long inclusiveLowerPoint, inclusiveUpperPoint;
      if (lowerVal != null) {
        long i=lowerVal.longValue();
        if (!includeLower && i == Long.MAX_VALUE)         return null;
        inclusiveLowerPoint=includeLower ? i : (i + 1l);
      }
 else {
        inclusiveLowerPoint=Long.MIN_VALUE;
      }
      if (upperVal != null) {
        long i=upperVal.longValue();
        if (!includeUpper && i == Long.MIN_VALUE)         return null;
        inclusiveUpperPoint=includeUpper ? i : (i - 1l);
      }
 else {
        inclusiveUpperPoint=Long.MAX_VALUE;
      }
      if (inclusiveLowerPoint > inclusiveUpperPoint)       return null;
      final LongValues values=indexFieldData.load(ctx).getLongValues();
      return new MatchDocIdSet(ctx.reader().maxDoc(),acceptedDocs){
        @Override public boolean isCacheable(){
          return true;
        }
        @Override protected boolean matchDoc(        int doc){
          LongValues.Iter iter=values.getIter(doc);
          while (iter.hasNext()) {
            long value=iter.next();
            if (value >= inclusiveLowerPoint && value <= inclusiveUpperPoint) {
              return true;
            }
          }
          return false;
        }
      }
;
    }
  }
;
}
