{
  super(index,indexSettings,name,settings);
  String tokenizerName=settings.get("tokenizer");
  if (tokenizerName == null) {
    throw new IllegalArgumentException("Custom Analyzer [" + name + "] must be configured with a tokenizer");
  }
  TokenizerFactoryFactory tokenizerFactoryFactory=tokenizerFactories.get(tokenizerName);
  if (tokenizerFactoryFactory == null) {
    tokenizerFactoryFactory=tokenizerFactories.get(Strings.toCamelCase(tokenizerName));
    if (tokenizerFactoryFactory == null) {
      tokenizerFactoryFactory=tokenizerFactories.get(Strings.toUnderscoreCase(tokenizerName));
      if (tokenizerFactoryFactory == null) {
        throw new IllegalArgumentException("Custom Analyzer [" + name + "] failed to find tokenizer under name ["+ tokenizerName+ "]");
      }
    }
  }
  Settings tokenizerSettings=indexSettings.getGroups("index.analysis.tokenizer").get(tokenizerName);
  if (tokenizerSettings == null) {
    tokenizerSettings=ImmutableSettings.Builder.EMPTY_SETTINGS;
  }
  TokenizerFactory tokenizerFactory=tokenizerFactoryFactory.create(tokenizerName,tokenizerSettings);
  List<CharFilterFactory> charFilters=newArrayList();
  String[] charFilterNames=settings.getAsArray("char_filter");
  for (  String charFilterName : charFilterNames) {
    CharFilterFactoryFactory charFilterFactoryFactory=charFilterFactories.get(charFilterName);
    if (charFilterFactoryFactory == null) {
      charFilterFactoryFactory=charFilterFactories.get(Strings.toCamelCase(charFilterName));
      if (charFilterFactoryFactory == null) {
        charFilterFactoryFactory=charFilterFactories.get(Strings.toUnderscoreCase(charFilterName));
        if (charFilterFactoryFactory == null) {
          throw new IllegalArgumentException("Custom Analyzer [" + name + "] failed to find char filter under name ["+ charFilterName+ "]");
        }
      }
    }
    Settings charFilterSettings=indexSettings.getGroups("index.analysis.char_filter").get(charFilterName);
    if (charFilterSettings == null) {
      charFilterSettings=ImmutableSettings.Builder.EMPTY_SETTINGS;
    }
    charFilters.add(charFilterFactoryFactory.create(charFilterName,charFilterSettings));
  }
  CharFilterFactory[] charFilterFactories1=charFilters.toArray(new CharFilterFactory[charFilters.size()]);
  List<TokenFilterFactory> tokenFilters=newArrayList();
  String[] tokenFilterNames=settings.getAsArray("filter");
  for (  String tokenFilterName : tokenFilterNames) {
    TokenFilterFactoryFactory tokenFilterFactoryFactory=tokenFilterFactories.get(tokenFilterName);
    if (tokenFilterFactoryFactory == null) {
      tokenFilterFactoryFactory=tokenFilterFactories.get(Strings.toCamelCase(tokenFilterName));
      if (tokenFilterFactoryFactory == null) {
        tokenFilterFactoryFactory=tokenFilterFactories.get(Strings.toUnderscoreCase(tokenFilterName));
        if (tokenFilterFactoryFactory == null) {
          throw new IllegalArgumentException("Custom Analyzer [" + name + "] failed to find token filter under name ["+ tokenFilterName+ "]");
        }
      }
    }
    Settings tokenFilterSettings=indexSettings.getGroups("index.analysis.filter").get(tokenFilterName);
    if (tokenFilterSettings == null) {
      tokenFilterSettings=ImmutableSettings.Builder.EMPTY_SETTINGS;
    }
    tokenFilters.add(tokenFilterFactoryFactory.create(tokenFilterName,tokenFilterSettings));
  }
  TokenFilterFactory[] tokenFilterFactories1=tokenFilters.toArray(new TokenFilterFactory[tokenFilters.size()]);
  this.customAnalyzer=new CustomAnalyzer(tokenizerFactory,charFilterFactories1,tokenFilterFactories1);
}
