{
  if (!enabled) {
    return null;
  }
  if (store == Field.Store.NO) {
    return null;
  }
  if (context.flyweight()) {
    return null;
  }
  byte[] data=context.source();
  if (compress != null && compress && !LZF.isCompressed(data)) {
    if (compressThreshold == -1 || data.length > compressThreshold) {
      data=LZFEncoder.encode(data,data.length);
      context.source(data);
    }
  }
  ArrayDeque<Field> cache=fieldCache.get();
  Field field=cache.poll();
  if (field == null) {
    field=new Field(names().indexName(),Bytes.EMPTY_ARRAY);
  }
  field.setValue(data);
  return field;
}
