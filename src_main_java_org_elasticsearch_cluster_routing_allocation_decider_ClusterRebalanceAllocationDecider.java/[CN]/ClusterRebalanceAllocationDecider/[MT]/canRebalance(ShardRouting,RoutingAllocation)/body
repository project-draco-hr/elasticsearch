{
  if (type == ClusterRebalanceType.INDICES_PRIMARIES_ACTIVE) {
    if (allocation.routingNodes().hasUnassignedPrimaries()) {
      return allocation.decision(Decision.NO,"cluster has unassigned primary shards");
    }
    if (allocation.routingNodes().hasInactivePrimaries()) {
      return allocation.decision(Decision.NO,"cluster has inactive primary shards");
    }
    return allocation.decision(Decision.YES,"all primary shards are active");
  }
  if (type == ClusterRebalanceType.INDICES_ALL_ACTIVE) {
    if (allocation.routingNodes().hasUnassignedShards()) {
      return allocation.decision(Decision.NO,"cluster has unassigned shards");
    }
    if (allocation.routingNodes().hasInactiveShards()) {
      return allocation.decision(Decision.NO,"cluster has inactive shards");
    }
  }
  return allocation.decision(Decision.YES,"all shards are active");
}
