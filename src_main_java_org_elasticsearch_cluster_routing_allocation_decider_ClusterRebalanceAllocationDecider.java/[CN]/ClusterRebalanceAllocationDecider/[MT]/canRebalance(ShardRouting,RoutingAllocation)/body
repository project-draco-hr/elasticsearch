{
  if (type == ClusterRebalanceType.INDICES_PRIMARIES_ACTIVE) {
    if (allocation.routingNodes().hasUnassignedPrimaries()) {
      return Decision.NO;
    }
    if (allocation.routingNodes().hasInactivePrimaries()) {
      return Decision.NO;
    }
    return Decision.YES;
  }
  if (type == ClusterRebalanceType.INDICES_ALL_ACTIVE) {
    if (allocation.routingNodes().hasUnassignedShards()) {
      return Decision.NO;
    }
    if (allocation.routingNodes().hasInactiveShards()) {
      return Decision.NO;
    }
  }
  return Decision.YES;
}
