{
  UpdateIndexShardSnapshotStatusRequest request=new UpdateIndexShardSnapshotStatusRequest(snapshotId,shardId,status);
  try {
    if (clusterService.state().nodes().localNodeMaster()) {
      innerUpdateSnapshotState(request);
    }
 else {
      transportService.sendRequest(clusterService.state().nodes().masterNode(),UPDATE_SNAPSHOT_ACTION_NAME,request,EmptyTransportResponseHandler.INSTANCE_SAME);
    }
  }
 catch (  Throwable t) {
    logger.warn("[{}] [{}] failed to update snapshot state",t,request.snapshotId(),request.status());
  }
}
