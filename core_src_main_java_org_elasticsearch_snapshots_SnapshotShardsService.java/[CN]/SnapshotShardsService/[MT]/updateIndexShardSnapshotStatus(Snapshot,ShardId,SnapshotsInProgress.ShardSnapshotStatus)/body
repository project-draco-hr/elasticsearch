{
  UpdateIndexShardSnapshotStatusRequest request=new UpdateIndexShardSnapshotStatusRequest(snapshot,shardId,status);
  try {
    if (clusterService.state().nodes().isLocalNodeElectedMaster()) {
      innerUpdateSnapshotState(request);
    }
 else {
      transportService.sendRequest(clusterService.state().nodes().getMasterNode(),UPDATE_SNAPSHOT_ACTION_NAME,request,EmptyTransportResponseHandler.INSTANCE_SAME);
    }
  }
 catch (  Exception e) {
    logger.warn(new ParameterizedMessage("[{}] [{}] failed to update snapshot state",request.snapshot(),request.status()),e);
  }
}
