{
  UpdateIndexShardSnapshotStatusRequest request=new UpdateIndexShardSnapshotStatusRequest(snapshot,shardId,status);
  try {
    if (clusterService.state().nodes().isLocalNodeElectedMaster()) {
      innerUpdateSnapshotState(request);
    }
 else {
      transportService.sendRequest(clusterService.state().nodes().getMasterNode(),UPDATE_SNAPSHOT_ACTION_NAME,request,EmptyTransportResponseHandler.INSTANCE_SAME);
    }
  }
 catch (  Exception e) {
    logger.warn("[{}] [{}] failed to update snapshot state",e,request.snapshot(),request.status());
  }
}
