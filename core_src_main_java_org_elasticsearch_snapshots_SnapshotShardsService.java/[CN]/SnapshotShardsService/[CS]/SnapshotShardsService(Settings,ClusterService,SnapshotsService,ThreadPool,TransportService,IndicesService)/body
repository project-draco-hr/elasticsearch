{
  super(settings);
  this.indicesService=indicesService;
  this.snapshotsService=snapshotsService;
  this.transportService=transportService;
  this.clusterService=clusterService;
  this.threadPool=threadPool;
  if (DiscoveryNode.dataNode(settings)) {
    clusterService.addLast(this);
  }
  if (DiscoveryNode.masterNode(settings)) {
    transportService.registerRequestHandler(UPDATE_SNAPSHOT_ACTION_NAME,UpdateIndexShardSnapshotStatusRequest.class,ThreadPool.Names.SAME,new UpdateSnapshotStateRequestHandler());
  }
}
