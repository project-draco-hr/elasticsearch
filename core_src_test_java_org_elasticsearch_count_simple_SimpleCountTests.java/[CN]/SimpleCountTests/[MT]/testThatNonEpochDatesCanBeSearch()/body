{
  assertAcked(prepareCreate("test").addMapping("type1",jsonBuilder().startObject().startObject("type1").startObject("properties").startObject("date_field").field("type","date").field("format","yyyyMMddHH").endObject().endObject().endObject().endObject()));
  ensureGreen("test");
  XContentBuilder document=jsonBuilder().startObject().field("date_field","2015060210").endObject();
  assertThat(client().prepareIndex("test","type1").setSource(document).get().isCreated(),is(true));
  document=jsonBuilder().startObject().field("date_field","2014060210").endObject();
  assertThat(client().prepareIndex("test","type1").setSource(document).get().isCreated(),is(true));
  document=jsonBuilder().startObject().field("date_field","1433236702").endObject();
  assertThat(client().prepareIndex("test","type1").setSource(document).get().isCreated(),is(true));
  refresh();
  assertHitCount(client().prepareCount("test").get(),3);
  CountResponse countResponse=client().prepareCount("test").setQuery(QueryBuilders.rangeQuery("date_field").from("2015010100").to("2015123123")).get();
  assertHitCount(countResponse,1);
  countResponse=client().prepareCount("test").setQuery(QueryBuilders.rangeQuery("date_field").from(2015010100).to(2015123123)).get();
  assertHitCount(countResponse,1);
  countResponse=client().prepareCount("test").setQuery(QueryBuilders.rangeQuery("date_field").from(2015010100).to(2015123123).timeZone("UTC")).get();
  assertHitCount(countResponse,1);
}
