{
  if (!text.hasBytes()) {
    final String string=text.string();
    UnicodeUtil.UTF16toUTF8(string,0,string.length(),spare);
    writeInt(spare.length);
    write(spare.bytes,spare.offset,spare.length);
  }
 else {
    BytesReference bytes=text.bytes();
    writeInt(bytes.length());
    bytes.writeTo(this);
  }
}
