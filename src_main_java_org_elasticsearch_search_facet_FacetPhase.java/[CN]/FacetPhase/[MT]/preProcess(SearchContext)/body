{
  if (context.nestedQueries() != null) {
    for (    Map.Entry<String,BlockJoinQuery> entry : context.nestedQueries().entrySet()) {
      List<Collector> collectors=context.searcher().removeCollectors(entry.getKey());
      if (collectors != null && !collectors.isEmpty()) {
        if (collectors.size() == 1) {
          entry.getValue().setCollector(collectors.get(0));
        }
 else {
          entry.getValue().setCollector(MultiCollector.wrap(collectors.toArray(new Collector[collectors.size()])));
        }
      }
    }
  }
}
