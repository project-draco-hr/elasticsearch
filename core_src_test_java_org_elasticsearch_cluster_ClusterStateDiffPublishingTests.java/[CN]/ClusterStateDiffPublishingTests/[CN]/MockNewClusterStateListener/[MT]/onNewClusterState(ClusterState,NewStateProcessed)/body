{
  final NewClusterStateExpectation expectation;
  try {
    expectation=expectations.remove(0);
  }
 catch (  ArrayIndexOutOfBoundsException ex) {
    fail("Unexpected cluster state update " + clusterState.prettyPrint());
    return;
  }
  expectation.check(clusterState,newStateProcessed);
  newStateProcessed.onNewClusterStateProcessed();
}
