{
  refreshOrUpdateQueue.add(new UpdateTask(index,type,mappingSource,listener));
  clusterService.submitStateUpdateTask("update-mapping [" + index + "]["+ type+ "]",Priority.HIGH,new ClusterStateUpdateTask(){
    @Override public void onFailure(    String source,    Throwable t){
      listener.onFailure(t);
    }
    @Override public ClusterState execute(    final ClusterState currentState) throws Exception {
      return executeRefreshOrUpdate(currentState);
    }
  }
);
}
