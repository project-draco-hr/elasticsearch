{
  Query query=qb.query().toQuery(context);
  Query filter=qb.filter().toQuery(context);
  if (query == null) {
    return null;
  }
  Query result;
  if (filter == null || Queries.isConstantMatchAllQuery(filter)) {
    result=qb.query().toQuery(context);
  }
 else   if (Queries.isConstantMatchAllQuery(query)) {
    result=new ConstantScoreQuery(filter);
  }
 else {
    result=Queries.filtered(qb.query().toQuery(context),filter);
  }
  result.setBoost(qb.boost());
  return result;
}
