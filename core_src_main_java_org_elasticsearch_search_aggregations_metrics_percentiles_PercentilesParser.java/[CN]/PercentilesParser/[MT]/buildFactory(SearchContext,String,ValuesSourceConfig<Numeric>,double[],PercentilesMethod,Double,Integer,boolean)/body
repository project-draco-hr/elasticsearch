{
  if (keys == null) {
    keys=DEFAULT_PERCENTS;
  }
  if (method == PercentilesMethod.TDIGEST) {
    return new TDigestPercentilesAggregator.Factory(aggregationName,valuesSourceConfig,keys,compression,keyed);
  }
 else   if (method == PercentilesMethod.HDR) {
    return new HDRPercentilesAggregator.Factory(aggregationName,valuesSourceConfig,keys,numberOfSignificantValueDigits,keyed);
  }
 else {
    throw new AssertionError();
  }
}
