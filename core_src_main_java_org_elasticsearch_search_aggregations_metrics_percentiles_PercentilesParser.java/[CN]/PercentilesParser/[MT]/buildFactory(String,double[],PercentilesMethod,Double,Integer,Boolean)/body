{
  if (method == PercentilesMethod.TDIGEST) {
    TDigestPercentilesAggregator.Factory factory=new TDigestPercentilesAggregator.Factory(aggregationName);
    if (keys != null) {
      factory.percents(keys);
    }
    if (compression != null) {
      factory.compression(compression);
    }
    if (keyed != null) {
      factory.keyed(keyed);
    }
    return factory;
  }
 else   if (method == PercentilesMethod.HDR) {
    HDRPercentilesAggregator.Factory factory=new HDRPercentilesAggregator.Factory(aggregationName);
    if (keys != null) {
      factory.percents(keys);
    }
    if (numberOfSignificantValueDigits != null) {
      factory.numberOfSignificantValueDigits(numberOfSignificantValueDigits);
    }
    if (keyed != null) {
      factory.keyed(keyed);
    }
    return factory;
  }
 else {
    throw new AssertionError();
  }
}
