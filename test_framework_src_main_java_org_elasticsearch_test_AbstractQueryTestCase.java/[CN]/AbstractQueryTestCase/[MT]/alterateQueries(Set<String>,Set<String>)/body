{
  List<Tuple<String,Boolean>> results=new ArrayList<>();
  boolean hasArbitraryContent=(arbitraryMarkers != null && arbitraryMarkers.isEmpty() == false);
  for (  String query : queries) {
    int mutation=0;
    while (true) {
      Deque<String> hierarchy=new LinkedList<>();
      BytesStreamOutput out=new BytesStreamOutput();
      try (XContentGenerator generator=XContentType.JSON.xContent().createGenerator(out);XContentParser parser=XContentHelper.createParser(new BytesArray(query))){
        int objectIndex=-1;
        XContentParser.Token token;
        while ((token=parser.nextToken()) != null) {
          if (token == XContentParser.Token.START_OBJECT) {
            objectIndex++;
            if (objectIndex <= mutation) {
              hierarchy.push(parser.currentName());
            }
            if (objectIndex == mutation) {
              generator.writeStartObject();
              generator.writeFieldName("newField");
              XContentHelper.copyCurrentStructure(generator,parser);
              generator.writeEndObject();
              continue;
            }
          }
          XContentHelper.copyCurrentEvent(generator,parser);
        }
        assertThat(token,nullValue());
        if (objectIndex < mutation) {
          break;
        }
 else {
          mutation++;
        }
      }
       boolean expectException=true;
      if (hasArbitraryContent) {
        for (        String marker : arbitraryMarkers) {
          if (hierarchy.contains(marker)) {
            expectException=false;
            break;
          }
        }
      }
      results.add(new Tuple<>(out.bytes().utf8ToString(),expectException));
    }
  }
  return results;
}
