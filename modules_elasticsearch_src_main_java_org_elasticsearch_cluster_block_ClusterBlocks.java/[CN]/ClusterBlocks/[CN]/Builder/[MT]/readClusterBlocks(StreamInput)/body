{
  ImmutableLevelHolder[] holders=new ImmutableLevelHolder[3];
  for (  ClusterBlockLevel level : ClusterBlockLevel.values()) {
    ImmutableSet<ClusterBlock> global=readBlockSet(in);
    ImmutableMap.Builder<String,ImmutableSet<ClusterBlock>> indicesBuilder=ImmutableMap.builder();
    int size=in.readVInt();
    for (int j=0; j < size; j++) {
      indicesBuilder.put(in.readUTF().intern(),readBlockSet(in));
    }
    holders[level.id()]=new ImmutableLevelHolder(global,indicesBuilder.build());
  }
  return new ClusterBlocks(holders);
}
