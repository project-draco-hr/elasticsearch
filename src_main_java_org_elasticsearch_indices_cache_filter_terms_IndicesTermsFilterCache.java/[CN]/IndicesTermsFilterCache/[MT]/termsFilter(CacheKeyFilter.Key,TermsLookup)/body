{
  try {
    return cache.get(cacheKey,new Callable<TermsFilterValue>(){
      @Override public TermsFilterValue call() throws Exception {
        GetResponse getResponse=client.get(new GetRequest(lookup.getIndex(),lookup.getType(),lookup.getId()).preference("_local")).actionGet();
        if (!getResponse.isExists()) {
          return NO_TERMS;
        }
        List<Object> values=XContentMapValues.extractRawValues(lookup.getPath(),getResponse.getSourceAsMap());
        if (values.isEmpty()) {
          return NO_TERMS;
        }
        Filter filter=lookup.getFieldMapper().termsFilter(values,null);
        return new TermsFilterValue(estimateSizeInBytes(values),filter);
      }
    }
).filter;
  }
 catch (  ExecutionException e) {
    if (e.getCause() instanceof RuntimeException) {
      throw (RuntimeException)e.getCause();
    }
    throw new ElasticSearchException(e.getMessage(),e.getCause());
  }
}
