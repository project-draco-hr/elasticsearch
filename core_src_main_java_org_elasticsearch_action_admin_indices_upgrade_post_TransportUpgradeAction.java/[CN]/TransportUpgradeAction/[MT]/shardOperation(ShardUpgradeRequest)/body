{
  IndexShard indexShard=indicesService.indexServiceSafe(request.shardId().getIndex()).shardSafe(request.shardId().id());
  org.apache.lucene.util.Version oldestLuceneSegment=indexShard.upgrade(request.upgradeRequest());
  return new ShardUpgradeResponse(request.shardId(),indexShard.routingEntry().primary(),Version.CURRENT,oldestLuceneSegment);
}
