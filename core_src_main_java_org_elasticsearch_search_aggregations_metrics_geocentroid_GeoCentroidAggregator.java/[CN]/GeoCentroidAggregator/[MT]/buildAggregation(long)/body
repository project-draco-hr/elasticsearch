{
  if (valuesSource == null || bucket >= centroids.size()) {
    return buildEmptyAggregation();
  }
  final long bucketCount=counts.get(bucket);
  final GeoPoint bucketCentroid=(bucketCount > 0) ? GeoPoint.fromIndexLong(centroids.get(bucket)) : new GeoPoint(Double.NaN,Double.NaN);
  return new InternalGeoCentroid(name,bucketCentroid,bucketCount,pipelineAggregators(),metaData());
}
