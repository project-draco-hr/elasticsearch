{
  BloomFilter filter=bloomCache.filter(reader,UidFieldMapper.NAME,true);
  FixedBitSet set=null;
  TermDocs td=null;
  UnicodeUtil.UTF8Result utf8=new UnicodeUtil.UTF8Result();
  try {
    for (    Term uid : uids) {
      Unicode.fromStringAsUtf8(uid.text(),utf8);
      if (!filter.isPresent(utf8.result,0,utf8.length)) {
        continue;
      }
      if (td == null) {
        td=reader.termDocs();
      }
      td.seek(uid);
      while (td.next()) {
        if (set == null) {
          set=new FixedBitSet(reader.maxDoc());
        }
        set.set(td.doc());
      }
    }
  }
  finally {
    if (td != null) {
      td.close();
    }
  }
  return set;
}
