{
  client().prepareIndex("my-index","my-type1","1").setSource(jsonBuilder().startObject().startObject("field1").field("field2","value1").endObject().endObject()).setRefresh(true).get();
  SearchResponse searchResponse=client().prepareSearch("my-index").setTypes("my-type1").addField("field1").get();
  assertThat(searchResponse.getShardFailures().length,equalTo(1));
  assertThat(searchResponse.getShardFailures()[0].status(),equalTo(RestStatus.BAD_REQUEST));
  assertThat(searchResponse.getShardFailures()[0].reason(),containsString("field [field1] isn't a leaf field"));
}
