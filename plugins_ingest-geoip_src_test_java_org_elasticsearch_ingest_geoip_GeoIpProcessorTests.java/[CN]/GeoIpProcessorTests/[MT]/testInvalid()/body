{
  InputStream database=GeoIpProcessor.class.getResourceAsStream("/GeoLite2-City.mmdb");
  GeoIpProcessor processor=new GeoIpProcessor("source_field",new DatabaseReader.Builder(database).build(),"target_field",EnumSet.allOf(GeoIpProcessor.Field.class));
  Map<String,Object> document=new HashMap<>();
  document.put("source_field","www.google.com");
  IngestDocument ingestDocument=RandomDocumentPicks.randomIngestDocument(random(),document);
  try {
    processor.execute(ingestDocument);
    fail("did not get expected exception");
  }
 catch (  IllegalArgumentException expected) {
    assertNotNull(expected.getMessage());
    assertThat(expected.getMessage(),containsString("not an IP string literal"));
  }
}
