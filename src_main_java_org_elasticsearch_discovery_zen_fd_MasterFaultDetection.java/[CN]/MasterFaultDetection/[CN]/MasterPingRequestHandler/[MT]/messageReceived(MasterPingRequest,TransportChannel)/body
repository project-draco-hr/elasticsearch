{
  DiscoveryNodes nodes=nodesProvider.nodes();
  if (!request.masterNodeId.equals(nodes.localNodeId())) {
    throw new NotMasterException();
  }
  if (!nodes.localNodeMaster()) {
    throw new NoLongerMasterException();
  }
  if (!nodes.nodeExists(request.nodeId)) {
    throw new NodeDoesNotExistOnMasterException();
  }
  channel.sendResponse(new MasterPingResponseResponse(nodes.nodeExists(request.nodeId)));
}
