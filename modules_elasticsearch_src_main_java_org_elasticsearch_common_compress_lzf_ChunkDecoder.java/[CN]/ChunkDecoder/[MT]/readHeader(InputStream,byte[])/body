{
  int needed=HEADER_BYTES;
  int count=is.read(inputBuffer,0,needed);
  if (count == needed) {
    return count;
  }
  if (count <= 0) {
    return 0;
  }
  int offset=count;
  needed-=count;
  do {
    count=is.read(inputBuffer,offset,needed);
    if (count <= 0) {
      break;
    }
    offset+=count;
    needed-=count;
  }
 while (needed > 0);
  return offset;
}
