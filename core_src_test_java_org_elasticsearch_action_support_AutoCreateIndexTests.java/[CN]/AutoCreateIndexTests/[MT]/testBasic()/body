{
{
    AutoCreateIndex autoCreateIndex=new AutoCreateIndex(Settings.EMPTY,new IndexNameExpressionResolver(Settings.EMPTY));
    ClusterState cs=buildClusterState("foo");
    assertFalse("already exists",autoCreateIndex.shouldAutoCreate("foo",cs));
    assertTrue(autoCreateIndex.shouldAutoCreate("foobar",cs));
  }
{
    AutoCreateIndex autoCreateIndex=new AutoCreateIndex(Settings.builder().put("action.auto_create_index","-foo,+b*").build(),new IndexNameExpressionResolver(Settings.EMPTY));
    ClusterState cs=buildClusterState("foobar","baz");
    assertFalse(autoCreateIndex.shouldAutoCreate("foo",cs));
    assertTrue(autoCreateIndex.shouldAutoCreate("bar",cs));
    assertFalse("already exists",autoCreateIndex.shouldAutoCreate("baz",cs));
  }
{
    AutoCreateIndex autoCreateIndex=new AutoCreateIndex(Settings.builder().put("action.auto_create_index","-foo,+b*").put("index.mapper.dynamic",false).build(),new IndexNameExpressionResolver(Settings.EMPTY));
    ClusterState cs=buildClusterState("foobar","baz");
    assertFalse(autoCreateIndex.shouldAutoCreate("foo",cs));
    assertFalse(autoCreateIndex.shouldAutoCreate("bar",cs));
    assertFalse("already exists",autoCreateIndex.shouldAutoCreate("baz",cs));
  }
{
    AutoCreateIndex autoCreateIndex=new AutoCreateIndex(Settings.builder().put("action.auto_create_index",false).put("index.mapper.dynamic",false).build(),new IndexNameExpressionResolver(Settings.EMPTY));
    ClusterState cs=buildClusterState("foobar","baz");
    assertFalse(autoCreateIndex.shouldAutoCreate("foo",cs));
    assertFalse(autoCreateIndex.shouldAutoCreate("bar",cs));
    assertFalse("already exists",autoCreateIndex.shouldAutoCreate("baz",cs));
  }
}
