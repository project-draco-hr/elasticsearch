{
  searchContext.idCache().refresh(searchContext.searcher().getTopReaderContext().leaves());
  uidToScore=searchContext.cacheRecycler().popObjectFloatMap();
  ParentUidCollector collector=new ParentUidCollector(uidToScore,searchContext,parentType);
  Query parentQuery;
  if (rewrittenParentQuery == null) {
    parentQuery=rewrittenParentQuery=searchContext.searcher().rewrite(originalParentQuery);
  }
 else {
    parentQuery=rewrittenParentQuery;
  }
  searchContext.searcher().search(parentQuery,collector);
}
