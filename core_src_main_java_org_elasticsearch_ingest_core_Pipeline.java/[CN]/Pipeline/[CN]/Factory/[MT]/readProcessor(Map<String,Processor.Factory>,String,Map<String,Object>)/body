{
  Processor.Factory factory=processorRegistry.get(type);
  if (factory != null) {
    List<Processor> onFailureProcessors=readProcessors(ON_FAILURE_KEY,processorRegistry,config);
    Processor processor=factory.create(config);
    if (config.isEmpty() == false) {
      throw new IllegalArgumentException("processor [" + type + "] doesn't support one or more provided configuration parameters "+ Arrays.toString(config.keySet().toArray()));
    }
    if (onFailureProcessors.isEmpty()) {
      return processor;
    }
    return new CompoundProcessor(Collections.singletonList(processor),onFailureProcessors);
  }
  throw new IllegalArgumentException("No processor type exists with name [" + type + "]");
}
