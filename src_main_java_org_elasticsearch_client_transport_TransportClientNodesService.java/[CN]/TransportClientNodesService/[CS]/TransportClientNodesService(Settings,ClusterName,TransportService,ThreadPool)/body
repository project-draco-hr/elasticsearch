{
  super(settings);
  this.clusterName=clusterName;
  this.transportService=transportService;
  this.threadPool=threadPool;
  this.nodesSamplerInterval=componentSettings.getAsTime("nodes_sampler_interval",timeValueSeconds(5));
  this.pingTimeout=componentSettings.getAsTime("ping_timeout",timeValueSeconds(5)).millis();
  this.ignoreClusterName=componentSettings.getAsBoolean("ignore_cluster_name",false);
  if (logger.isDebugEnabled()) {
    logger.debug("node_sampler_interval[" + nodesSamplerInterval + "]");
  }
  if (componentSettings.getAsBoolean("sniff",false)) {
    this.nodesSampler=new SniffNodesSampler();
  }
 else {
    this.nodesSampler=new SimpleNodeSampler();
  }
  this.nodesSamplerFuture=threadPool.schedule(nodesSamplerInterval,ThreadPool.Names.GENERIC,new ScheduledNodeSampler());
  transportService.throwConnectException(true);
}
