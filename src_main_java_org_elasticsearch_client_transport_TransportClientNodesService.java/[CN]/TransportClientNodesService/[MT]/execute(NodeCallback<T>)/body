{
  ImmutableList<DiscoveryNode> nodes=this.nodes;
  ensureNodesAreAvailable(nodes);
  int index=getNodeNumber();
  for (int i=0; i < nodes.size(); i++) {
    DiscoveryNode node=nodes.get((index + i) % nodes.size());
    try {
      return callback.doWithNode(node);
    }
 catch (    ElasticsearchException e) {
      if (e.unwrapCause() instanceof ConnectTransportException) {
        logConnectTransportException((ConnectTransportException)e.unwrapCause());
      }
 else {
        throw e;
      }
    }
  }
  throw new NoNodeAvailableException("None of the configured nodes were available: " + nodes);
}
