{
  FixedBitSet res=null;
  if (mustFilters == null && notFilters == null && shouldFilters != null && shouldFilters.size() == 1) {
    return shouldFilters.get(0).getDocIdSet(context,null);
  }
  if (shouldFilters == null && notFilters == null && mustFilters != null && mustFilters.size() == 1) {
    return mustFilters.get(0).getDocIdSet(context,null);
  }
  if (shouldFilters != null) {
    for (int i=0; i < shouldFilters.size(); i++) {
      final DocIdSet disi=getDISI(shouldFilters,i,context,null);
      if (disi == null)       continue;
      if (res == null) {
        res=new FixedBitSet(context.reader().maxDoc());
      }
      DocSets.or(res,disi);
    }
    if (res == null && !shouldFilters.isEmpty()) {
      return null;
    }
  }
  if (notFilters != null) {
    for (int i=0; i < notFilters.size(); i++) {
      if (res == null) {
        res=new FixedBitSet(context.reader().maxDoc());
        res.set(0,context.reader().maxDoc());
      }
      final DocIdSet disi=getDISI(notFilters,i,context,null);
      if (disi != null) {
        DocSets.andNot(res,disi);
      }
    }
  }
  if (mustFilters != null) {
    for (int i=0; i < mustFilters.size(); i++) {
      final DocIdSet disi=getDISI(mustFilters,i,context,null);
      if (disi == null) {
        return null;
      }
      if (res == null) {
        res=new FixedBitSet(context.reader().maxDoc());
        DocSets.or(res,disi);
      }
 else {
        DocSets.and(res,disi);
      }
    }
  }
  return res;
}
