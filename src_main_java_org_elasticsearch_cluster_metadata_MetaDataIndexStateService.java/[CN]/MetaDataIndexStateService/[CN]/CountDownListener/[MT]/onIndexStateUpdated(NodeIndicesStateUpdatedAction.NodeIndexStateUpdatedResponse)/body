{
  if (version <= response.version()) {
    logger.debug("Received NodeIndexStateUpdatedResponse with version [{}] from [{}]",response.version(),response.nodeId());
    if (countDown.decrementAndGet() == 0) {
      indicesStateUpdatedAction.remove(this);
      if (notified.compareAndSet(false,true)) {
        logger.debug("NodeIndexStateUpdated was acknowledged by all expected nodes, returning");
        listener.onResponse(new Response(true));
      }
    }
  }
}
