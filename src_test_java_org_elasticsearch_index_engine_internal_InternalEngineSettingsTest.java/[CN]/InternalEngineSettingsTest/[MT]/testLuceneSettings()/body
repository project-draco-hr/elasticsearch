{
  final IndexService service=createIndex("foo");
  assertThat(engine(service).currentIndexWriterConfig().getUseCompoundFile(),is(true));
  client().admin().indices().prepareUpdateSettings("foo").setSettings(ImmutableSettings.builder().put(InternalEngineHolder.INDEX_COMPOUND_ON_FLUSH,false).build()).get();
  assertThat(engine(service).currentIndexWriterConfig().getUseCompoundFile(),is(false));
  client().admin().indices().prepareUpdateSettings("foo").setSettings(ImmutableSettings.builder().put(InternalEngineHolder.INDEX_COMPOUND_ON_FLUSH,true).build()).get();
  assertThat(engine(service).currentIndexWriterConfig().getUseCompoundFile(),is(true));
}
