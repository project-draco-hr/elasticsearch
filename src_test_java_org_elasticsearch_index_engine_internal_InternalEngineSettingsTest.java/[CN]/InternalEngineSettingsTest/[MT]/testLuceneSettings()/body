{
  final IndexService service=createIndex("foo");
  InternalEngine engine=((InternalEngine)engine(service));
  assertThat(engine.currentIndexWriterConfig().getUseCompoundFile(),is(true));
  client().admin().indices().prepareUpdateSettings("foo").setSettings(ImmutableSettings.builder().put(EngineConfig.INDEX_COMPOUND_ON_FLUSH,false).build()).get();
  assertThat(engine.currentIndexWriterConfig().getUseCompoundFile(),is(false));
  client().admin().indices().prepareUpdateSettings("foo").setSettings(ImmutableSettings.builder().put(EngineConfig.INDEX_COMPOUND_ON_FLUSH,true).build()).get();
  assertThat(engine.currentIndexWriterConfig().getUseCompoundFile(),is(true));
}
