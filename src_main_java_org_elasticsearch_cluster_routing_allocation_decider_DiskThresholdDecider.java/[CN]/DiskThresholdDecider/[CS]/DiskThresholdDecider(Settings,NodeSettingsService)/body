{
  super(settings);
  String lowWatermark=settings.get(CLUSTER_ROUTING_ALLOCATION_LOW_DISK_WATERMARK,"0.7");
  String highWatermark=settings.get(CLUSTER_ROUTING_ALLOCATION_HIGH_DISK_WATERMARK,"0.85");
  if (!validWatermarkSetting(lowWatermark)) {
    throw new ElasticSearchParseException("Unable to parse low watermark: [" + lowWatermark + "]");
  }
  if (!validWatermarkSetting(highWatermark)) {
    throw new ElasticSearchParseException("Unable to parse high watermark: [" + highWatermark + "]");
  }
  this.freeDiskThresholdLow=100.0 - thresholdPercentageFromWatermark(lowWatermark);
  this.freeDiskThresholdHigh=100.0 - thresholdPercentageFromWatermark(highWatermark);
  this.freeBytesThresholdLow=thresholdBytesFromWatermark(lowWatermark);
  this.freeBytesThresholdHigh=thresholdBytesFromWatermark(highWatermark);
  this.enabled=settings.getAsBoolean(CLUSTER_ROUTING_ALLOCATION_DISK_THRESHOLD_ENABLED,false);
  nodeSettingsService.addListener(new ApplySettings());
}
