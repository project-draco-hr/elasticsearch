{
  Map<String,DiskUsage> usages=info.getNodeDiskUsages();
  if (usages != null) {
    for (    DiskUsage entry : usages.values()) {
      if (entry.getFreeBytes() < DiskThresholdDecider.this.freeBytesThresholdHigh.bytes()) {
        if ((System.currentTimeMillis() - lastRun) > DiskThresholdDecider.this.rerouteInterval.millis()) {
          lastRun=System.currentTimeMillis();
          logger.info("high watermark [{}/{}%] exceeded on {}, rerouting shards",DiskThresholdDecider.this.freeBytesThresholdHigh,DiskThresholdDecider.this.freeDiskThresholdHigh,entry);
          client.admin().cluster().prepareReroute().execute();
          return;
        }
 else {
          logger.debug("high watermark exceeded on {} but an automatic reroute has occurred in the last [{}], skipping reroute",entry,DiskThresholdDecider.this.rerouteInterval);
          return;
        }
      }
    }
  }
}
