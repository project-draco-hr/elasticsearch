{
  Map<String,DiskUsage> usages=info.getNodeDiskUsages();
  if (usages != null) {
    boolean reroute=false;
    for (    DiskUsage entry : usages.values()) {
      warnAboutDiskIfNeeded(entry);
      if (entry.getFreeBytes() < DiskThresholdDecider.this.freeBytesThresholdHigh.bytes() || entry.getFreeDiskAsPercentage() < DiskThresholdDecider.this.freeDiskThresholdHigh) {
        if ((System.currentTimeMillis() - lastRun) > DiskThresholdDecider.this.rerouteInterval.millis()) {
          lastRun=System.currentTimeMillis();
          reroute=true;
        }
 else {
          logger.debug("high disk watermark exceeded on {} but an automatic reroute has occurred in the last [{}], skipping reroute",entry,DiskThresholdDecider.this.rerouteInterval);
        }
      }
    }
    if (reroute) {
      logger.info("high disk watermark exceeded on one or more nodes, rerouting shards");
      client.admin().cluster().prepareReroute().execute();
    }
  }
}
