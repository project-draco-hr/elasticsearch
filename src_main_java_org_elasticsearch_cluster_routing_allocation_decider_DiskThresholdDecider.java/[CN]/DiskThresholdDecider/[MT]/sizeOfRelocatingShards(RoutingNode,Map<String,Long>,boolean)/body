{
  long totalSize=0;
  for (  ShardRouting routing : node.shardsWithState(ShardRoutingState.RELOCATING,ShardRoutingState.INITIALIZING)) {
    if (routing.initializing() && routing.relocatingNodeId() != null) {
      totalSize+=getShardSize(routing,shardSizes);
    }
 else     if (subtractShardsMovingAway && routing.relocating()) {
      totalSize-=getShardSize(routing,shardSizes);
    }
  }
  return totalSize;
}
