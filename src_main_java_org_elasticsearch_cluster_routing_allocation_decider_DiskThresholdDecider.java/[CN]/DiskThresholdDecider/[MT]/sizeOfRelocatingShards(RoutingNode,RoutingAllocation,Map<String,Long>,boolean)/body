{
  List<ShardRouting> relocatingShards=allocation.routingTable().shardsWithState(ShardRoutingState.RELOCATING);
  long totalSize=0;
  for (  ShardRouting routing : relocatingShards) {
    if (routing.relocatingNodeId().equals(node.nodeId())) {
      totalSize+=getShardSize(routing,shardSizes);
    }
 else     if (subtractShardsMovingAway && routing.currentNodeId().equals(node.nodeId())) {
      totalSize-=getShardSize(routing,shardSizes);
    }
  }
  return totalSize;
}
