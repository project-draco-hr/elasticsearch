{
  states=bigArrays.grow(states,bucketOrd + 1);
  TDigestState state=states.get(bucketOrd);
  if (state == null) {
    state=new TDigestState(compression);
    states.set(bucketOrd,state);
  }
  values.setDocument(doc);
  final int valueCount=values.count();
  for (int i=0; i < valueCount; i++) {
    state.add(values.valueAt(i));
  }
}
