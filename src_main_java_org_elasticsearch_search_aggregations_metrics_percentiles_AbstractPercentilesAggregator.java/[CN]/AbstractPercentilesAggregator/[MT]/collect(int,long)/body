{
  states=bigArrays.grow(states,bucketOrd + 1);
  TDigestState state=states.get(bucketOrd);
  if (state == null) {
    state=new TDigestState(compression);
    states.set(bucketOrd,state);
  }
  final int valueCount=values.setDocument(doc);
  for (int i=0; i < valueCount; i++) {
    state.add(values.nextValue());
  }
}
