{
  createIndex("test");
  index("test","type","1","f",1);
  assertAcked(client().admin().indices().preparePutWarmer("custom_warmer").setSearchRequest(client().prepareSearch("test").setTypes("test").setQuery(QueryBuilders.matchAllQuery())));
  for (  Client client : clients()) {
    GetWarmersResponse getWarmersResponse=client.admin().indices().prepareGetWarmers().setLocal(true).get();
    assertThat(getWarmersResponse.warmers().size(),equalTo(1));
    ObjectObjectCursor<String,List<IndexWarmersMetaData.Entry>> entry=getWarmersResponse.warmers().iterator().next();
    assertThat(entry.key,equalTo("test"));
    assertThat(entry.value.size(),equalTo(1));
    assertThat(entry.value.get(0).name(),equalTo("custom_warmer"));
  }
}
