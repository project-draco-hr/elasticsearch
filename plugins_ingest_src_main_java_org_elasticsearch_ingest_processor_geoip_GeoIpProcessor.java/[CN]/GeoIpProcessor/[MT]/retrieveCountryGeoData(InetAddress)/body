{
  SecurityManager sm=System.getSecurityManager();
  if (sm != null) {
    sm.checkPermission(new SpecialPermission());
  }
  CountryResponse response=AccessController.doPrivileged(new PrivilegedAction<CountryResponse>(){
    @Override public CountryResponse run(){
      try {
        return dbReader.country(ipAddress);
      }
 catch (      IOException|GeoIp2Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
);
  Country country=response.getCountry();
  Continent continent=response.getContinent();
  Map<String,Object> geoData=new HashMap<String,Object>();
  geoData.put("ip",NetworkAddress.formatAddress(ipAddress));
  geoData.put("country_iso_code",country.getIsoCode());
  geoData.put("country_name",country.getName());
  geoData.put("continent_name",continent.getName());
  return geoData;
}
