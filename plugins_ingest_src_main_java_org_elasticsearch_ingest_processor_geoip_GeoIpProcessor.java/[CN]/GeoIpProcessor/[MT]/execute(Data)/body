{
  String ip=data.getProperty(ipField);
  final InetAddress ipAddress;
  try {
    ipAddress=InetAddress.getByName(ip);
  }
 catch (  UnknownHostException e) {
    throw new RuntimeException(e);
  }
  final Map<String,Object> geoData;
switch (dbReader.getMetadata().getDatabaseType()) {
case "GeoLite2-City":
    geoData=retrieveCityGeoData(ipAddress);
  break;
case "GeoLite2-Country":
geoData=retrieveCountryGeoData(ipAddress);
break;
default :
throw new IllegalStateException("Unsupported database type [" + dbReader.getMetadata().getDatabaseType() + "]");
}
data.addField(targetField,geoData);
}
