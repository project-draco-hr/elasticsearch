{
  String ip=data.getProperty(sourceField,String.class);
  final InetAddress ipAddress;
  try {
    ipAddress=InetAddress.getByName(ip);
  }
 catch (  UnknownHostException e) {
    throw new RuntimeException(e);
  }
  Map<String,Object> geoData;
switch (dbReader.getMetadata().getDatabaseType()) {
case "GeoLite2-City":
    try {
      geoData=retrieveCityGeoData(ipAddress);
    }
 catch (    AddressNotFoundRuntimeException e) {
      geoData=Collections.emptyMap();
    }
  break;
case "GeoLite2-Country":
try {
  geoData=retrieveCountryGeoData(ipAddress);
}
 catch (AddressNotFoundRuntimeException e) {
  geoData=Collections.emptyMap();
}
break;
default :
throw new IllegalStateException("Unsupported database type [" + dbReader.getMetadata().getDatabaseType() + "]");
}
data.addField(targetField,geoData);
}
