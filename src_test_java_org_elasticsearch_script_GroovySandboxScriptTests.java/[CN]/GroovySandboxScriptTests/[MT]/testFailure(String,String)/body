{
  logger.info("--> script: " + script);
  try {
    client().prepareSearch("test").setSource("{\"query\": {\"match_all\": {}}," + "\"sort\":{\"_script\": {\"script\": \"" + script + "; doc['foo'].value + 2\", \"type\": \"number\", \"lang\": \"groovy\"}}}").get();
    fail("script: " + script + " failed to be caught be the sandbox!");
  }
 catch (  SearchPhaseExecutionException e) {
    String msg=ExceptionsHelper.detailedMessage(ExceptionsHelper.unwrapCause(e));
    assertThat("script failed, but with incorrect message: " + msg,msg.contains(failMessage),equalTo(true));
  }
}
