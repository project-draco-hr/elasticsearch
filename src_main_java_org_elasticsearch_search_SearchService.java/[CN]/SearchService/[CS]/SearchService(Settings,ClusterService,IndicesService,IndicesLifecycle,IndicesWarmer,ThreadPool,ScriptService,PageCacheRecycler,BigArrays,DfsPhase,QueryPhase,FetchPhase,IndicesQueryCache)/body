{
  super(settings);
  this.threadPool=threadPool;
  this.clusterService=clusterService;
  this.indicesService=indicesService;
  indicesService.indicesLifecycle().addListener(new IndicesLifecycle.Listener(){
    @Override public void afterIndexClosed(    Index index){
      freeAllContextForIndex(index);
    }
  }
);
  this.indicesWarmer=indicesWarmer;
  this.scriptService=scriptService;
  this.pageCacheRecycler=pageCacheRecycler;
  this.bigArrays=bigArrays;
  this.dfsPhase=dfsPhase;
  this.queryPhase=queryPhase;
  this.fetchPhase=fetchPhase;
  this.indicesQueryCache=indicesQueryCache;
  TimeValue keepAliveInterval=componentSettings.getAsTime(KEEPALIVE_INTERVAL_COMPONENENT_KEY,timeValueMinutes(1));
  this.defaultKeepAlive=componentSettings.getAsTime(DEFAULT_KEEPALIVE_COMPONENENT_KEY,timeValueMinutes(5)).millis();
  Map<String,SearchParseElement> elementParsers=new HashMap<>();
  elementParsers.putAll(dfsPhase.parseElements());
  elementParsers.putAll(queryPhase.parseElements());
  elementParsers.putAll(fetchPhase.parseElements());
  elementParsers.put("stats",new StatsGroupsParseElement());
  this.elementParsers=ImmutableMap.copyOf(elementParsers);
  this.keepAliveReaper=threadPool.scheduleWithFixedDelay(new Reaper(),keepAliveInterval);
  this.indicesWarmer.addListener(new NormsWarmer());
  this.indicesWarmer.addListener(new FieldDataWarmer());
  this.indicesWarmer.addListener(new SearchWarmer());
}
