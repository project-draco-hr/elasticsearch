{
  long start=System.nanoTime();
  try {
    for (    AtomicReaderContext ctx : context.newSearcher().reader().leaves()) {
      warmer.warm(ctx.reader());
    }
    if (indexShard.warmerService().logger().isTraceEnabled()) {
      indexShard.warmerService().logger().trace("warmed readers, took [{}]",TimeValue.timeValueNanos(System.nanoTime() - start));
    }
  }
 catch (  Throwable t) {
    throw new ElasticSearchIllegalStateException("Unexpected exception while warming-up segment",t);
  }
}
