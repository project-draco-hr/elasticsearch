{
  IndexWarmersMetaData custom=indexMetaData.custom(IndexWarmersMetaData.TYPE);
  if (custom == null) {
    return;
  }
  for (  IndexWarmersMetaData.Entry entry : custom.entries()) {
    SearchContext context=null;
    try {
      long now=System.nanoTime();
      InternalSearchRequest request=new InternalSearchRequest(shardId.index().name(),shardId.id(),indexMetaData.numberOfShards(),SearchType.COUNT).source(entry.source().bytes(),entry.source().offset(),entry.source().length()).types(entry.types());
      context=createContext(request,search);
      queryPhase.execute(context);
      long took=System.nanoTime() - now;
      if (logger.isTraceEnabled()) {
        logger.trace("[{}][{}] warmed [{}], took [{}]",shardId.index().name(),shardId.id(),entry.name(),TimeValue.timeValueNanos(took));
      }
    }
 catch (    Throwable t) {
      logger.warn("[{}][{}] warmer [{}] failed",t,shardId.index().name(),shardId.id(),entry.name());
    }
 finally {
      if (context != null) {
        freeContext(context);
        cleanContext(context);
      }
    }
  }
}
