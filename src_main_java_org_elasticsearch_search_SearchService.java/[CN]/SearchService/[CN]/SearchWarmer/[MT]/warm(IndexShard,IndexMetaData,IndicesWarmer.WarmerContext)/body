{
  IndexWarmersMetaData custom=indexMetaData.custom(IndexWarmersMetaData.TYPE);
  if (custom == null) {
    return;
  }
  for (  IndexWarmersMetaData.Entry entry : custom.entries()) {
    SearchContext context=null;
    try {
      long now=System.nanoTime();
      ShardSearchRequest request=new ShardSearchRequest(indexShard.shardId().index().name(),indexShard.shardId().id(),indexMetaData.numberOfShards(),SearchType.QUERY_THEN_FETCH).source(entry.source()).types(entry.types());
      context=createContext(request,warmerContext.newSearcher());
      queryPhase.execute(context);
      long took=System.nanoTime() - now;
      if (indexShard.warmerService().logger().isTraceEnabled()) {
        indexShard.warmerService().logger().trace("warmed [{}], took [{}]",entry.name(),TimeValue.timeValueNanos(took));
      }
    }
 catch (    Throwable t) {
      indexShard.warmerService().logger().warn("warmer [{}] failed",t,entry.name());
    }
 finally {
      if (context != null) {
        freeContext(context);
        cleanContext(context);
      }
    }
  }
}
