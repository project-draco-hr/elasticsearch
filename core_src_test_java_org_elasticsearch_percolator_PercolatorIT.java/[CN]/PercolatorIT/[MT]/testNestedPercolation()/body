{
  initNestedIndexAndPercolation();
  PercolateResponse response=client().preparePercolate().setPercolateDoc(new PercolateSourceBuilder.DocBuilder().setDoc(getNotMatchingNestedDoc())).setIndices("nestedindex").setDocumentType("company").get();
  assertEquals(response.getMatches().length,0);
  response=client().preparePercolate().setPercolateDoc(new PercolateSourceBuilder.DocBuilder().setDoc(getMatchingNestedDoc())).setIndices("nestedindex").setDocumentType("company").get();
  assertEquals(response.getMatches().length,1);
  assertEquals(response.getMatches()[0].getId().string(),"Q");
}
