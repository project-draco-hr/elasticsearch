{
  try {
    client().prepareSearch("idx").addAggregation(range("histo").field(SINGLE_VALUED_FIELD_NAME).addRange(0,10).subAggregation(sum("the_sum").field(SINGLE_VALUED_VALUE_FIELD_NAME)).subAggregation(movingAvg("movingAvg").window(0).modelBuilder(new SimpleModel.SimpleModelBuilder()).gapPolicy(gapPolicy).setBucketsPaths("the_sum"))).execute().actionGet();
    fail("MovingAvg should not accept non-histogram as parent");
  }
 catch (  SearchPhaseExecutionException exception) {
  }
}
