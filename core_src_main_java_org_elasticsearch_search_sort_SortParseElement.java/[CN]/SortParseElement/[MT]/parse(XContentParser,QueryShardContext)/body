{
  XContentParser.Token token=parser.currentToken();
  List<SortField> sortFields=new ArrayList<>(2);
  if (token == XContentParser.Token.START_ARRAY) {
    while ((token=parser.nextToken()) != XContentParser.Token.END_ARRAY) {
      if (token == XContentParser.Token.START_OBJECT) {
        addCompoundSortField(parser,context,sortFields);
      }
 else       if (token == XContentParser.Token.VALUE_STRING) {
        addSortField(context,sortFields,parser.text(),false,null,null,null,null);
      }
 else {
        throw new IllegalArgumentException("malformed sort format, within the sort array, an object, or an actual string are allowed");
      }
    }
  }
 else   if (token == XContentParser.Token.VALUE_STRING) {
    addSortField(context,sortFields,parser.text(),false,null,null,null,null);
  }
 else   if (token == XContentParser.Token.START_OBJECT) {
    addCompoundSortField(parser,context,sortFields);
  }
 else {
    throw new IllegalArgumentException("malformed sort format, either start with array, object, or an actual string");
  }
  return sortFields;
}
