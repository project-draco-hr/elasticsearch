{
  IngestDocument ingestDocument=RandomDocumentPicks.randomIngestDocument(random());
  Map<String,String> fields=new HashMap<>();
  int numFields=randomIntBetween(1,5);
  for (int i=0; i < numFields; i++) {
    String fieldName=RandomDocumentPicks.addRandomField(random(),ingestDocument,"127.0.0.1");
    fields.put(fieldName,"\\.");
  }
  Processor processor=new SplitProcessor(fields);
  processor.execute(ingestDocument);
  for (  String field : fields.keySet()) {
    assertThat(ingestDocument.getPropertyValue(field,List.class),equalTo(Arrays.asList("127","0","0","1")));
  }
}
