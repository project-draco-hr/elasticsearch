{
  XContentParser.Token token=parser.currentToken();
  List<SortField> sortFields=Lists.newArrayListWithCapacity(2);
  if (token == XContentParser.Token.START_ARRAY) {
    while ((token=parser.nextToken()) != XContentParser.Token.END_ARRAY) {
      if (token == XContentParser.Token.START_OBJECT) {
        addCompoundSortField(parser,context,sortFields);
      }
 else       if (token == XContentParser.Token.VALUE_STRING) {
        addSortField(context,sortFields,parser.text(),false,false,null);
      }
    }
  }
 else {
    addCompoundSortField(parser,context,sortFields);
  }
  if (!sortFields.isEmpty()) {
    context.sort(new Sort(sortFields.toArray(new SortField[sortFields.size()])));
  }
}
