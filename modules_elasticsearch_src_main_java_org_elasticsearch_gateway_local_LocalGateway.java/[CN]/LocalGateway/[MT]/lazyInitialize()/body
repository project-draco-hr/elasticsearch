{
  if (initialized) {
    return;
  }
  initialized=true;
  if (!clusterService.state().nodes().localNode().masterNode() || !clusterService.state().nodes().localNode().dataNode()) {
    location=null;
  }
 else {
    this.location=new File(nodeEnv.nodeLocation(),"_state");
    this.location.mkdirs();
    try {
      long version=findLatestStateVersion();
      if (version != -1) {
        this.currentState=readState(Streams.copyToByteArray(new FileInputStream(new File(location,"state-" + version))));
      }
    }
 catch (    Exception e) {
      logger.warn("failed to read local state",e);
    }
  }
}
