{
  if (initialized) {
    return;
  }
  initialized=true;
  if (!clusterService.localNode().masterNode() && !clusterService.localNode().dataNode()) {
    location=null;
  }
 else {
    this.location=new File(nodeEnv.nodeDataLocation(),"_state");
    this.location.mkdirs();
    if (clusterService.localNode().masterNode()) {
      try {
        long version=findLatestMetaStateVersion();
        if (version != -1) {
          this.currentMetaState=readMetaState(Streams.copyToByteArray(new FileInputStream(new File(location,"metadata-" + version))));
        }
      }
 catch (      Exception e) {
        logger.warn("failed to read local state (metadata)",e);
      }
    }
    if (clusterService.localNode().dataNode()) {
      try {
        long version=findLatestStartedShardsVersion();
        if (version != -1) {
          this.currentStartedShards=readStartedShards(Streams.copyToByteArray(new FileInputStream(new File(location,"shards-" + version))));
        }
      }
 catch (      Exception e) {
        logger.warn("failed to read local state (started shards)",e);
      }
    }
  }
}
