{
  clusterService.submitStateUpdateTask("async_shard_fetch(" + type + ") "+ shardId+ ", reasons ("+ reason+ ")",Priority.HIGH,new ClusterStateUpdateTask(){
    @Override public ClusterState execute(    ClusterState currentState) throws Exception {
      if (currentState.nodes().masterNode() == null) {
        return currentState;
      }
      RoutingAllocation.Result routingResult=allocationService.reroute(currentState);
      if (!routingResult.changed()) {
        return currentState;
      }
      return ClusterState.builder(currentState).routingResult(routingResult).build();
    }
    @Override public void onFailure(    String source,    Throwable t){
      logger.warn("failed to perform reroute post async fetch for {}",t,source);
    }
  }
);
}
