{
  QueryParseContext context=new QueryParseContext(new IndicesQueriesRegistry(Settings.settingsBuilder().build(),Collections.emptyMap()));
  context.parseFieldMatcher(new ParseFieldMatcher(Settings.EMPTY));
  SmoothingModel testModel=createTestModel();
  XContentBuilder contentBuilder=XContentFactory.contentBuilder(randomFrom(XContentType.values()));
  if (randomBoolean()) {
    contentBuilder.prettyPrint();
  }
  contentBuilder.startObject();
  testModel.innerToXContent(contentBuilder,ToXContent.EMPTY_PARAMS);
  contentBuilder.endObject();
  XContentParser parser=XContentHelper.createParser(contentBuilder.bytes());
  context.reset(parser);
  parser.nextToken();
  SmoothingModel prototype=(SmoothingModel)namedWriteableRegistry.getPrototype(SmoothingModel.class,testModel.getWriteableName());
  SmoothingModel parsedModel=prototype.fromXContent(context);
  assertNotSame(testModel,parsedModel);
  assertEquals(testModel,parsedModel);
  assertEquals(testModel.hashCode(),parsedModel.hashCode());
}
