{
synchronized (mutex) {
    MemorySnapshot memorySnapshot=(MemorySnapshot)snapshot;
    if (currentId() != snapshot.translogId()) {
      return snapshot();
    }
    ArrayList<Operation> retVal=new ArrayList<Operation>();
    int counter=0;
    int snapshotSize=memorySnapshot.operations.length;
    for (    Operation operation : operations) {
      if (++counter > snapshotSize) {
        retVal.add(operation);
      }
    }
    return new MemorySnapshot(currentId(),retVal.toArray(new Operation[retVal.size()]));
  }
}
