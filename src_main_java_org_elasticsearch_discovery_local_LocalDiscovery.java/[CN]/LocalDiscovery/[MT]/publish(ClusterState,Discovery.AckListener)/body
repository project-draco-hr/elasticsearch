{
  if (!master) {
    throw new ElasticSearchIllegalStateException("Shouldn't publish state when not master");
  }
  LocalDiscovery[] members=members();
  if (members.length > 0) {
    publish(members,clusterState,new AckClusterStatePublishResponseHandler(members.length - 1,ackListener));
  }
}
