{
  while (true) {
    int stamp=counter.getStamp();
    boolean result=counter.compareAndSet(false,true,stamp,stamp);
    if (result) {
      if (stamp <= 0) {
        close();
      }
      return;
    }
 else     if (counter.getReference()) {
      return;
    }
  }
}
