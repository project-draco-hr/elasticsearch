{
  try (XContentParser qSourceParser=XContentFactory.xContent(queryBuilder.source()).createParser(queryBuilder.source())){
    final QueryParseContext parseContext=new QueryParseContext(context);
    parseContext.reset(qSourceParser);
    Query expected=parseContext.parseInnerQueryBuilder().toQuery(context);
    if (expected != null) {
      expected.setBoost(AbstractQueryBuilder.DEFAULT_BOOST);
    }
    assertThat(query,equalTo(expected));
  }
 }
