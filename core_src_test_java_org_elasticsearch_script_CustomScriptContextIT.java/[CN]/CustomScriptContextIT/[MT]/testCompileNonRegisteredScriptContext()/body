{
  ContextAndHeaderHolder contextAndHeaders=new ContextAndHeaderHolder();
  ScriptService scriptService=internalCluster().getInstance(ScriptService.class);
  try {
    scriptService.compile(new Script("test",randomFrom(ScriptService.ScriptType.values()),randomFrom(LANG_SET.toArray(new String[LANG_SET.size()])),null),new ScriptContext(){
      @Override public String getKey(){
        return "test";
      }
    }
,contextAndHeaders);
    fail("script compilation should have been rejected");
  }
 catch (  IllegalArgumentException e) {
    assertThat(e.getMessage(),containsString("script context [test] not supported"));
  }
}
