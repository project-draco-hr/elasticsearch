{
  super(settings);
  ImportCustomizer imports=new ImportCustomizer();
  imports.addStarImports("org.joda.time");
  imports.addStaticStars("java.lang.Math");
  CompilerConfiguration config=new CompilerConfiguration();
  config.addCompilationCustomizers(imports);
  config.addCompilationCustomizers(new GroovyBigDecimalTransformer(CompilePhase.CONVERSION));
  config.getOptimizationOptions().put(GROOVY_INDY_SETTING_NAME,true);
  final SecurityManager sm=System.getSecurityManager();
  if (sm != null) {
    sm.checkPermission(new SpecialPermission());
  }
  this.loader=AccessController.doPrivileged(new PrivilegedAction<GroovyClassLoader>(){
    @Override public GroovyClassLoader run(){
      final AccessControlContext engineContext=AccessController.getContext();
      return new GroovyClassLoader(new ClassLoader(getClass().getClassLoader()){
        @Override protected Class<?> loadClass(        String name,        boolean resolve) throws ClassNotFoundException {
          if (sm != null) {
            try {
              engineContext.checkPermission(new ClassPermission(name));
            }
 catch (            SecurityException e) {
              throw new ClassNotFoundException(name,e);
            }
          }
          return super.loadClass(name,resolve);
        }
      }
,config);
    }
  }
);
}
