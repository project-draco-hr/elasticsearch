{
  if (keyFieldName == null) {
    throw new SearchSourceBuilderException("field must be set on date histogram facet for facet [" + name + "]");
  }
  if (interval == null) {
    throw new SearchSourceBuilderException("interval must be set on date histogram facet for facet [" + name + "]");
  }
  builder.startObject(name);
  builder.startObject(DateHistogramFacet.TYPE);
  if (valueFieldName != null) {
    builder.field("key_field",keyFieldName);
    builder.field("value_field",valueFieldName);
  }
 else {
    builder.field("field",keyFieldName);
  }
  if (valueScript != null) {
    builder.field("value_script",valueScript);
    if (lang != null) {
      builder.field("lang",lang);
    }
    if (this.params != null) {
      builder.field("params",this.params);
    }
  }
  builder.field("interval",interval);
  if (preZone != null) {
    builder.field("pre_zone",preZone);
  }
  if (preZoneAdjustLargeInterval != null) {
    builder.field("pre_zone_adjust_large_interval",preZoneAdjustLargeInterval);
  }
  if (postZone != null) {
    builder.field("post_zone",postZone);
  }
  if (preOffset != 0) {
    builder.field("pre_offset",preOffset);
  }
  if (postOffset != 0) {
    builder.field("post_offset",postOffset);
  }
  if (factor != 1.0f) {
    builder.field("factor",factor);
  }
  if (comparatorType != null) {
    builder.field("comparator",comparatorType.description());
  }
  builder.endObject();
  addFilterFacetAndGlobal(builder,params);
  builder.endObject();
  return builder;
}
