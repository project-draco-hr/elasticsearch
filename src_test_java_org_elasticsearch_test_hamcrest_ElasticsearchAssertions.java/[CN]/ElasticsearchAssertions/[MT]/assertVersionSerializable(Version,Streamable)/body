{
  try {
    Streamable newInstance=tryCreateNewInstance(streamable);
    if (newInstance == null) {
      return;
    }
    if (streamable instanceof ActionRequest) {
      ((ActionRequest<?>)streamable).validate();
    }
    BytesReference orig=serialize(version,streamable);
    StreamInput input=new BytesStreamInput(orig);
    input.setVersion(version);
    newInstance.readFrom(input);
    assertThat("Stream should be fully read with version [" + version + "] for streamable ["+ streamable+ "]",input.available(),equalTo(0));
    assertThat("Serialization failed with version [" + version + "] bytes should be equal for streamable ["+ streamable+ "]",serialize(version,streamable),equalTo(orig));
  }
 catch (  Throwable ex) {
    throw new RuntimeException("failed to check serialization - version [" + version + "] for streamable ["+ streamable+ "]",ex);
  }
}
