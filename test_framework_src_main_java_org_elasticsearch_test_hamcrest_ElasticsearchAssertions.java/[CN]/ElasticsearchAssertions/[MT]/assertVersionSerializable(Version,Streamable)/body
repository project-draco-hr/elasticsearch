{
  NamedWriteableRegistry registry;
  if (ESIntegTestCase.isInternalCluster()) {
    registry=ESIntegTestCase.internalCluster().getInstance(NamedWriteableRegistry.class);
  }
 else {
    registry=new NamedWriteableRegistry();
    new SearchModule(Settings.EMPTY,registry,false,emptyList());
  }
  assertVersionSerializable(version,streamable,registry);
}
