{
  if (docs == null) {
    docs=PackedLongValues.packedBuilder(PackedInts.COMPACT);
  }
  docs.add(doc - lastDocId);
  lastDocId=doc;
  if (buckets == null) {
    if (owningBucketOrdinal != 0) {
      buckets=PackedLongValues.packedBuilder(PackedInts.COMPACT);
      for (int i=0; i < docs.size() - 1; i++) {
        buckets.add(0);
      }
      buckets.add(owningBucketOrdinal);
    }
  }
 else {
    buckets.add(owningBucketOrdinal);
  }
}
