{
  final String bloomFileName=IndexFileNames.segmentFileName(state.segmentInfo.name,state.segmentSuffix,BLOOM_EXTENSION);
  final Directory directory=state.directory;
  IndexInput dataInput=directory.openInput(bloomFileName,state.context);
  try {
    ChecksumIndexInput bloomIn=new BufferedChecksumIndexInput(dataInput.clone());
    version=CodecUtil.checkHeader(bloomIn,BLOOM_CODEC_NAME,BLOOM_CODEC_VERSION,BLOOM_CODEC_VERSION_CURRENT);
    final String delegatePostings=bloomIn.readString();
    this.delegateFieldsProducer=PostingsFormat.forName(delegatePostings).fieldsProducer(state);
    this.data=dataInput;
    dataInput=null;
  }
  finally {
    IOUtils.closeWhileHandlingException(dataInput);
  }
}
