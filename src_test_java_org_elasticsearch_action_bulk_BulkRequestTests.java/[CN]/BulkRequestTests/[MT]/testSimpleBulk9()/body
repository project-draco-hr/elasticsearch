{
  String bulkAction=copyToStringFromClasspath("/org/elasticsearch/action/bulk/simple-bulk9.json");
  BulkRequest bulkRequest=new BulkRequest();
  try {
    bulkRequest.add(bulkAction.getBytes(Charsets.UTF_8),0,bulkAction.length(),null,null);
    fail("should have thrown an exception about the wrong format of line 3");
  }
 catch (  IllegalArgumentException e) {
    assertThat("message contains error about the wrong format of line 3: " + e.getMessage(),e.getMessage().contains("Malformed action/metadata line [3], expected START_OBJECT or END_OBJECT but found [START_ARRAY]"),equalTo(true));
  }
}
