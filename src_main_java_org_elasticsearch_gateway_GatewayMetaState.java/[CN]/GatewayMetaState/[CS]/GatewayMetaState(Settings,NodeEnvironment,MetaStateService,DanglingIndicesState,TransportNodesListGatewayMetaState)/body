{
  super(settings);
  this.nodeEnv=nodeEnv;
  this.metaStateService=metaStateService;
  this.danglingIndicesState=danglingIndicesState;
  nodesListGatewayMetaState.init(this);
  if (DiscoveryNode.masterNode(settings) || DiscoveryNode.dataNode(settings)) {
    nodeEnv.ensureAtomicMoveSupported();
  }
  if (DiscoveryNode.masterNode(settings)) {
    try {
      ensureNoPre019State();
      pre20Upgrade();
      long start=System.currentTimeMillis();
      metaStateService.loadFullState();
      logger.debug("took {} to load state",TimeValue.timeValueMillis(System.currentTimeMillis() - start));
    }
 catch (    Exception e) {
      logger.error("failed to read local state, exiting...",e);
      throw e;
    }
  }
}
