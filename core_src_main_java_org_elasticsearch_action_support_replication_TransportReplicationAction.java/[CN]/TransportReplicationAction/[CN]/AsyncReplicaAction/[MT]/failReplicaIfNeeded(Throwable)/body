{
  String index=request.shardId().getIndex().getName();
  int shardId=request.shardId().id();
  logger.trace("failure on replica [{}][{}], action [{}], request [{}]",t,index,shardId,actionName,request);
  if (ignoreReplicaException(t) == false) {
    IndexService indexService=indicesService.indexService(index);
    if (indexService == null) {
      logger.debug("ignoring failed replica [{}][{}] because index was already removed.",index,shardId);
      return;
    }
    IndexShard indexShard=indexService.getShardOrNull(shardId);
    if (indexShard == null) {
      logger.debug("ignoring failed replica [{}][{}] because index was already removed.",index,shardId);
      return;
    }
    indexShard.failShard(actionName + " failed on replica",t);
  }
}
