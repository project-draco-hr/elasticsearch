{
  setPhase(task,"primary");
  final String writeConsistencyFailure=checkWriteConsistency(shardId);
  if (writeConsistencyFailure != null) {
    finishBecauseUnavailable(shardId,writeConsistencyFailure);
    return;
  }
  indexShardReference=getIndexShardReferenceOnPrimary(shardId,request);
  if (indexShardReference.isRelocated() == false) {
    executeLocally();
  }
 else {
    executeRemotely();
  }
}
