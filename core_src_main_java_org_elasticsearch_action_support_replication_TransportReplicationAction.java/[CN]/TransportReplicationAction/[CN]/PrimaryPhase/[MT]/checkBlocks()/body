{
  ClusterBlockException blockException=checkGlobalBlock(observer.observedState());
  if (blockException != null) {
    if (blockException.retryable()) {
      logger.trace("cluster is blocked ({}), scheduling a retry",blockException.getMessage());
      retry(blockException);
    }
 else {
      finishAsFailed(blockException);
    }
    return false;
  }
  if (resolveIndex()) {
    internalRequest.concreteIndex(indexNameExpressionResolver.concreteSingleIndex(observer.observedState(),internalRequest.request()));
  }
 else {
    internalRequest.concreteIndex(internalRequest.request().index());
  }
  resolveRequest(observer.observedState(),internalRequest,listener);
  blockException=checkRequestBlock(observer.observedState(),internalRequest);
  if (blockException != null) {
    if (blockException.retryable()) {
      logger.trace("cluster is blocked ({}), scheduling a retry",blockException.getMessage());
      retry(blockException);
    }
 else {
      finishAsFailed(blockException);
    }
    return false;
  }
  return true;
}
