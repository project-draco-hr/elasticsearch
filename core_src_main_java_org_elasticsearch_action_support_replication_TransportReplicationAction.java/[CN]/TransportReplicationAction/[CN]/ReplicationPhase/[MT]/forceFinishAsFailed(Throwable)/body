{
  if (finished.compareAndSet(false,true)) {
    Releasables.close(indexShardReference);
    try {
      channel.sendResponse(t);
    }
 catch (    IOException responseException) {
      logger.warn("failed to send error message back to client for action [{}]",responseException,transportReplicaAction);
      logger.warn("actual Exception",t);
    }
  }
}
