{
  transportService.sendRequest(node,action,request,transportOptions,new TransportResponseHandler<Response>(){
    @Override public Response newInstance(){
      return newResponseInstance();
    }
    @Override public String executor(){
      return ThreadPool.Names.SAME;
    }
    @Override public void handleResponse(    Response response){
      finishOnSuccess(response);
    }
    @Override public void handleException(    TransportException exp){
      try {
        final Throwable cause=exp.unwrapCause();
        if (cause instanceof ConnectTransportException || cause instanceof NodeClosedException || (isPrimaryAction && retryPrimaryException(cause))) {
          logger.trace(new ParameterizedMessage("received an error from node [{}] for request [{}], scheduling a retry",node.getId(),request),exp);
          retry(exp);
        }
 else {
          finishAsFailed(exp);
        }
      }
 catch (      Exception e) {
        e.addSuppressed(exp);
        finishWithUnexpectedFailure(e);
      }
    }
  }
);
}
