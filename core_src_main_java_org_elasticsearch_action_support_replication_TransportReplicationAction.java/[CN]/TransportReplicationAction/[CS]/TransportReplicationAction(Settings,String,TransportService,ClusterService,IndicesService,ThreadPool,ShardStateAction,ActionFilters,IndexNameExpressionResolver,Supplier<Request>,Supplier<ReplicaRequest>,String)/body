{
  super(settings,actionName,threadPool,actionFilters,indexNameExpressionResolver,transportService.getTaskManager());
  this.transportService=transportService;
  this.clusterService=clusterService;
  this.indicesService=indicesService;
  this.shardStateAction=shardStateAction;
  this.transportPrimaryAction=actionName + "[p]";
  this.transportReplicaAction=actionName + "[r]";
  transportService.registerRequestHandler(actionName,request,ThreadPool.Names.SAME,new OperationTransportHandler());
  transportService.registerRequestHandler(transportPrimaryAction,request,executor,new PrimaryOperationTransportHandler());
  transportService.registerRequestHandler(transportReplicaAction,replicaRequest,executor,true,true,new ReplicaOperationTransportHandler());
  this.transportOptions=transportOptions();
  this.defaultWriteConsistencyLevel=WriteConsistencyLevel.fromString(settings.get("action.write_consistency","quorum"));
  this.replicasProxy=new ReplicasProxy();
}
