{
  IndexService indexService=indicesService.indexServiceSafe(shardId.getIndex());
  IndexShard indexShard=indexService.getShard(shardId.id());
  if (indexShard.routingEntry().primary() == false) {
    throw new RetryOnPrimaryException(indexShard.shardId(),"actual shard is not a primary " + indexShard.routingEntry());
  }
  return IndexShardReferenceImpl.createOnPrimary(indexShard);
}
