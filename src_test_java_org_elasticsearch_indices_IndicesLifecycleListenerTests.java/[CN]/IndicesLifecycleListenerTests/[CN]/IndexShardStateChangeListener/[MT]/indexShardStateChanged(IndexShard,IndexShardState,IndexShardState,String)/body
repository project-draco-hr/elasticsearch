{
  List<IndexShardState> shardStates=this.shardStates.putIfAbsent(indexShard.shardId(),new CopyOnWriteArrayList<IndexShardState>(new IndexShardState[]{newState}));
  if (shardStates != null) {
    shardStates.add(newState);
  }
}
