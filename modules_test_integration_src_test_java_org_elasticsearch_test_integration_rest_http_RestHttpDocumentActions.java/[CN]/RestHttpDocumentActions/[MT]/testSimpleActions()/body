{
  logger.info("Running Cluster Health");
  ClusterHealthResponse clusterHealth=client1.admin().cluster().health(clusterHealthRequest().waitForGreenStatus()).actionGet();
  logger.info("Done Cluster Health, status " + clusterHealth.status());
  assertThat(clusterHealth.timedOut(),equalTo(false));
  assertThat(clusterHealth.status(),equalTo(ClusterHealthStatus.GREEN));
  Future<Response> response=httpClient.preparePut("http://localhost:9200/test/type1/1").setBody(source("1","test")).execute();
  Map<String,Object> respMap=XContentFactory.xContent(response.get().getResponseBody()).createParser(response.get().getResponseBody()).map();
  assertThat((Boolean)respMap.get("ok"),equalTo(Boolean.TRUE));
  assertThat((String)respMap.get("_id"),equalTo("1"));
  assertThat((String)respMap.get("_type"),equalTo("type1"));
  assertThat((String)respMap.get("_index"),equalTo("test"));
}
