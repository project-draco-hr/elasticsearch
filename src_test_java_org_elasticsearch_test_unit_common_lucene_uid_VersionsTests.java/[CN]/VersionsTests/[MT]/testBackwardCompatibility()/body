{
  IndexWriter writer=new IndexWriter(new RAMDirectory(),new IndexWriterConfig(Lucene.VERSION,Lucene.STANDARD_ANALYZER));
  DirectoryReader directoryReader=DirectoryReader.open(writer,true);
  MatcherAssert.assertThat(Versions.loadVersion(directoryReader,new Term(UidFieldMapper.NAME,"1")),equalTo(Versions.NOT_FOUND));
  Document doc=new Document();
  UidField uidAndVersion=new UidField("1",1L);
  doc.add(uidAndVersion);
  writer.addDocument(doc);
  uidAndVersion.uid="2";
  uidAndVersion.version=2;
  writer.addDocument(doc);
  writer.commit();
  directoryReader=DirectoryReader.openIfChanged(directoryReader);
  assertThat(Versions.loadVersion(directoryReader,new Term(UidFieldMapper.NAME,"1")),equalTo(1l));
  assertThat(Versions.loadVersion(directoryReader,new Term(UidFieldMapper.NAME,"2")),equalTo(2l));
  assertThat(Versions.loadVersion(directoryReader,new Term(UidFieldMapper.NAME,"3")),equalTo(Versions.NOT_FOUND));
}
