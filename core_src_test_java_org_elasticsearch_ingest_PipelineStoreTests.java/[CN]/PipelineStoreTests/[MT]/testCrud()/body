{
  String id="_id";
  Pipeline pipeline=store.get(id);
  assertThat(pipeline,nullValue());
  ClusterState clusterState=ClusterState.builder(new ClusterName("_name")).build();
  PutPipelineRequest putRequest=new PutPipelineRequest();
  putRequest.setId(id);
  putRequest.setSource(new BytesArray("{\"processors\": [{\"set\" : {\"field\": \"_field\", \"value\": \"_value\"}}]}"));
  clusterState=store.innerPut(putRequest,clusterState);
  store.innerUpdatePipelines(clusterState);
  pipeline=store.get(id);
  assertThat(pipeline,notNullValue());
  assertThat(pipeline.getId(),equalTo(id));
  assertThat(pipeline.getDescription(),nullValue());
  assertThat(pipeline.getProcessors().size(),equalTo(1));
  assertThat(pipeline.getProcessors().get(0).getType(),equalTo("set"));
  DeletePipelineRequest deleteRequest=new DeletePipelineRequest();
  deleteRequest.id(id);
  clusterState=store.innerDelete(deleteRequest,clusterState);
  store.innerUpdatePipelines(clusterState);
  pipeline=store.get(id);
  assertThat(pipeline,nullValue());
}
