{
  HeapDirectory dir=new HeapDirectory(new ByteSizeValue(40,ByteSizeUnit.BYTES),new ByteSizeValue(80,ByteSizeUnit.BYTES),false);
  Lock lock=dir.makeLock("testlock");
  assertThat(lock.isLocked(),equalTo(false));
  assertThat(lock.obtain(200),equalTo(true));
  assertThat(lock.isLocked(),equalTo(true));
  try {
    assertThat(lock.obtain(200),equalTo(false));
    assertThat("lock should be thrown",false,equalTo(true));
  }
 catch (  LockObtainFailedException e) {
  }
  lock.release();
  assertThat(lock.isLocked(),equalTo(false));
  dir.close();
}
