{
  assertAcked(prepareCreate(name,0,settingsBuilder().put("number_of_shards",between(1,6)).put("number_of_replicas",between(1,6)).put(MockDirectoryHelper.RANDOM_NO_DELETE_OPEN_FILE,false)));
  ensureYellow(name);
  logger.info("--> indexing some data into {}",name);
  for (int i=0; i < between(10,500); i++) {
    index(name,"doc",Integer.toString(i),"foo","bar" + i);
  }
  assertAcked(client().admin().indices().prepareUpdateSettings(name).setSettings(ImmutableSettings.builder().put(AbstractIndexStore.INDEX_STORE_THROTTLE_TYPE,"all").put(AbstractIndexStore.INDEX_STORE_THROTTLE_MAX_BYTES_PER_SEC,between(100,50000))));
}
