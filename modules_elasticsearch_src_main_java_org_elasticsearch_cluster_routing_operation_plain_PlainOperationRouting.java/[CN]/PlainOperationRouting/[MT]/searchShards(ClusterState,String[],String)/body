{
  if (indices == null || indices.length == 0) {
    indices=clusterState.metaData().concreteAllIndices();
  }
  IdentityHashSet<ShardsIterator> set=new IdentityHashSet<ShardsIterator>();
  for (  String index : indices) {
    IndexRoutingTable indexRouting=indexRoutingTable(clusterState,index);
    for (    IndexShardRoutingTable indexShard : indexRouting) {
      set.add(indexShard.shardsRandomIt());
    }
  }
  return new GroupShardsIterator(set);
}
