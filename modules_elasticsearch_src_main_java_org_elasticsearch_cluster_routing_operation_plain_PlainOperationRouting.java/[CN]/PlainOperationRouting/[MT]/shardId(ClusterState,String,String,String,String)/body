{
  if (routing == null) {
    return Math.abs(hash(type,id)) % indexMetaData(clusterState,index).numberOfShards();
  }
  return Math.abs(hash(routing)) % indexMetaData(clusterState,index).numberOfShards();
}
