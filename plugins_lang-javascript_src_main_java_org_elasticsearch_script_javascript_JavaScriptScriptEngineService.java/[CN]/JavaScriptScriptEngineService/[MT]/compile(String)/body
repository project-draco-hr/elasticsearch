{
  SecurityManager sm=System.getSecurityManager();
  if (sm != null) {
    sm.checkPermission(new SpecialPermission());
  }
  Context ctx=Context.enter();
  try {
    ctx.setWrapFactory(wrapFactory);
    ctx.setOptimizationLevel(optimizationLevel);
    ctx.setSecurityController(new PolicySecurityController());
    return ctx.compileString(script,generateScriptName(),1,new CodeSource(new URL("file:" + BootstrapInfo.UNTRUSTED_CODEBASE),(Certificate[])null));
  }
 catch (  MalformedURLException e) {
    throw new RuntimeException(e);
  }
 finally {
    Context.exit();
  }
}
