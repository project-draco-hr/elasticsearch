{
  try {
    String prop="es.test.isolated.plugin.count";
    int count=Integer.getInteger(prop,0);
    client();
    assertThat(Integer.getInteger(prop),greaterThanOrEqualTo(count + 2));
    Properties p=System.getProperties();
    prop=p.getProperty("es.test.isolated.plugin.instantiated.hashes");
    String[] hashes=Strings.delimitedListToStringArray(prop," ");
    assertThat(hashes.length,greaterThanOrEqualTo(count + 2));
    Arrays.sort(hashes);
    assertThat(Arrays.binarySearch(hashes,p.getProperty("es.test.isolated.plugin.instantiated")),greaterThanOrEqualTo(0));
  }
  finally {
    System.setProperties(props);
  }
}
