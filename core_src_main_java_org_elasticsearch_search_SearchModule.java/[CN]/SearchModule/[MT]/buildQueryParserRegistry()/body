{
  Map<String,QueryParser<?>> queryParsersMap=new HashMap<>();
  for (  Supplier<QueryParser<?>> parserSupplier : queryParsers) {
    QueryParser<? extends QueryBuilder> parser=parserSupplier.get();
    for (    String name : parser.names()) {
      Object oldValue=queryParsersMap.putIfAbsent(name,parser);
      if (oldValue != null) {
        throw new IllegalArgumentException("Query parser [" + oldValue + "] already registered for name ["+ name+ "] while trying to register ["+ parser+ "]");
      }
    }
    @SuppressWarnings("unchecked") NamedWriteable<? extends QueryBuilder> qb=parser.getBuilderPrototype();
    namedWriteableRegistry.registerPrototype(QueryBuilder.class,qb);
  }
  return new IndicesQueriesRegistry(settings,queryParsersMap);
}
