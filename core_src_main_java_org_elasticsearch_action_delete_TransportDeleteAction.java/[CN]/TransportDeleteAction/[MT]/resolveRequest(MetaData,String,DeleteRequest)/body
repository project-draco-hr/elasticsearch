{
  resolveAndValidateRouting(metaData,concreteIndex,request);
  ShardId shardId=clusterService.operationRouting().shardId(clusterService.state(),concreteIndex,request.id(),request.routing());
  request.setShardId(shardId);
}
