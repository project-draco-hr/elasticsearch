{
  if (queueSize.get() > 0 && poolSize < maximumPoolSize) {
    final ReentrantLock mainLock=ScalingThreadPoolExecutor.this.mainLock;
    mainLock.lock();
    try {
      int currentQueueSize=queueSize.get();
      if (currentQueueSize > 0 && poolSize < maximumPoolSize) {
        int incrementBy=currentQueueSize;
        if (poolSize + incrementBy > maximumPoolSize) {
          incrementBy=maximumPoolSize - poolSize;
        }
        for (int i=0; i < incrementBy; i++) {
          Thread t=addThread();
          if (t != null)           t.start();
        }
      }
    }
  finally {
      mainLock.unlock();
    }
  }
}
