{
  assertAcked(prepareCreate("test").addMapping("type",jsonBuilder().startObject().startObject("type").startObject("properties").startObject("test").field("type","string").endObject().startObject("num").field("type","double").endObject().endObject().endObject().endObject()));
  ensureYellow();
  client().index(indexRequest("test").type("type").source(jsonBuilder().startObject().field("test","value").field("num",1.0).endObject())).actionGet();
  refresh();
  XContentBuilder query=XContentFactory.jsonBuilder();
  query.startObject().startObject("query").startObject("function_score").field("weight","1").startArray("functions").startObject().startObject("script_score").field("script","3").endObject().endObject().endArray().endObject().endObject().endObject();
}
