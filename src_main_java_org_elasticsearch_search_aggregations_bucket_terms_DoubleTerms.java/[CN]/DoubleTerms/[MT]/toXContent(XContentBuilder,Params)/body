{
  builder.startObject(name);
  builder.startArray(CommonFields.BUCKETS);
  for (  InternalTerms.Bucket bucket : buckets) {
    builder.startObject();
    builder.field(CommonFields.KEY,((Bucket)bucket).term);
    if (formatter != null) {
      builder.field(CommonFields.KEY_AS_STRING,formatter.format(((Bucket)bucket).term));
    }
    builder.field(CommonFields.DOC_COUNT,bucket.getDocCount());
    ((InternalAggregations)bucket.getAggregations()).toXContentInternal(builder,params);
    builder.endObject();
  }
  builder.endArray();
  builder.endObject();
  return builder;
}
