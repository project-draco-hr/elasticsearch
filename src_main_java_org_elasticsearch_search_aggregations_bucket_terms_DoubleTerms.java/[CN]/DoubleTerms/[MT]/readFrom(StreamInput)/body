{
  this.name=in.readString();
  if (in.getVersion().onOrAfter(Version.V_1_4_0)) {
    this.docCountError=in.readLong();
  }
 else {
    this.docCountError=-1;
  }
  this.order=InternalOrder.Streams.readOrder(in);
  this.formatter=ValueFormatterStreams.readOptional(in);
  this.requiredSize=readSize(in);
  if (in.getVersion().onOrAfter(Version.V_1_4_0)) {
    this.shardSize=readSize(in);
    this.showTermDocCountError=in.readBoolean();
  }
 else {
    this.shardSize=requiredSize;
    this.showTermDocCountError=false;
  }
  this.minDocCount=in.readVLong();
  int size=in.readVInt();
  List<InternalTerms.Bucket> buckets=new ArrayList<>(size);
  for (int i=0; i < size; i++) {
    double term=in.readDouble();
    long docCount=in.readVLong();
    long bucketDocCountError=-1;
    if (in.getVersion().onOrAfter(Version.V_1_4_0) && showTermDocCountError) {
      bucketDocCountError=in.readLong();
    }
    InternalAggregations aggregations=InternalAggregations.readAggregations(in);
    buckets.add(new Bucket(term,docCount,aggregations,showTermDocCountError,bucketDocCountError));
  }
  this.buckets=buckets;
  this.bucketMap=null;
}
