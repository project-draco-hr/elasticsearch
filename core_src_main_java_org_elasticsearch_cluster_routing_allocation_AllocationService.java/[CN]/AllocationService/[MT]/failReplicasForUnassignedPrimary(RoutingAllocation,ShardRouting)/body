{
  List<ShardRouting> replicas=new ArrayList<>();
  for (  ShardRouting routing : allocation.routingNodes().assignedShards(primary.shardId())) {
    if (!routing.primary() && routing.initializing()) {
      replicas.add(routing);
    }
  }
  boolean changed=false;
  for (  ShardRouting routing : replicas) {
    changed|=applyFailedShard(allocation,routing,false,new UnassignedInfo(UnassignedInfo.Reason.PRIMARY_FAILED,"primary failed while replica initializing",null,0,allocation.getCurrentNanoTime(),System.currentTimeMillis(),false));
  }
  return changed;
}
