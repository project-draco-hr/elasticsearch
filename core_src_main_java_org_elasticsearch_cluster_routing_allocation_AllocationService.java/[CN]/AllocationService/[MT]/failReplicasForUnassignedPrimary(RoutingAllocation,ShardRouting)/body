{
  List<ShardRouting> replicas=new ArrayList<>();
  for (  ShardRouting routing : allocation.routingNodes().assignedShards(primary)) {
    if (!routing.primary() && routing.initializing()) {
      replicas.add(routing);
    }
  }
  boolean changed=false;
  for (  ShardRouting routing : replicas) {
    changed|=applyFailedShard(allocation,routing,false,new UnassignedInfo(UnassignedInfo.Reason.ALLOCATION_FAILED,"primary failed while replica initializing",null,allocation.getCurrentNanoTime(),System.currentTimeMillis()));
  }
  return changed;
}
