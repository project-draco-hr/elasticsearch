{
  RoutingNodes routingNodes=getMutableRoutingNodes(clusterState);
  routingNodes.unassigned().shuffle();
  RoutingAllocation allocation=new RoutingAllocation(allocationDeciders,routingNodes,clusterState,clusterInfoService.getClusterInfo(),currentNanoTime(),false);
  boolean changed=deassociateDeadNodes(allocation);
  if (reroute) {
    changed|=reroute(allocation);
  }
  if (!changed) {
    return new RoutingAllocation.Result(false,clusterState.routingTable(),clusterState.metaData());
  }
  return buildResultAndLogHealthChange(allocation,reason);
}
