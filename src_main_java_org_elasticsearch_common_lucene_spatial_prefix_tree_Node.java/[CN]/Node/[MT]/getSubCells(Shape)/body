{
  if (shapeFilter instanceof Point) {
    return Collections.singleton(getSubCell((Point)shapeFilter));
  }
  Collection<Node> cells=getSubCells();
  if (shapeFilter == null) {
    return cells;
  }
  List<Node> copy=new ArrayList<Node>(cells.size());
  for (  Node cell : cells) {
    SpatialRelation rel=cell.getShape().relate(shapeFilter,spatialPrefixTree.ctx);
    if (rel == SpatialRelation.DISJOINT)     continue;
    cell.shapeRel=rel;
    copy.add(cell);
  }
  cells=copy;
  return cells;
}
