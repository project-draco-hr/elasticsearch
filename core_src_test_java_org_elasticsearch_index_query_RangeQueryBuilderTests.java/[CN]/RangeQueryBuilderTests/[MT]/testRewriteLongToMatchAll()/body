{
  String fieldName=randomAsciiOfLengthBetween(1,20);
  RangeQueryBuilder query=new RangeQueryBuilder(fieldName);
  int queryFromValue=randomIntBetween(-1000000,1000000);
  int queryToValue=randomIntBetween(queryFromValue,2000000);
  long shardMinValue=randomIntBetween(queryFromValue,queryToValue);
  long shardMaxValue=randomIntBetween((int)shardMinValue,queryToValue);
  query.from((long)queryFromValue);
  query.to((long)queryToValue);
  QueryShardContext queryShardContext=queryShardContext();
  FieldStatsProvider fieldStatsProvider=new FieldStatsProvider(null,null){
    @Override public Relation isFieldWithinQuery(    String fieldName,    Object from,    Object to,    boolean includeLower,    boolean includeUpper,    DateTimeZone timeZone,    DateMathParser dateMathParser) throws IOException {
      return Relation.WITHIN;
    }
    @SuppressWarnings("unchecked") @Override public <T extends Comparable<T>>FieldStats<T> get(    String field) throws IOException {
      assertThat(field,equalTo(fieldName));
      return (FieldStats<T>)new FieldStats.Long(randomLong(),randomLong(),randomLong(),randomLong(),shardMinValue,shardMaxValue);
    }
  }
;
  queryShardContext.setFieldStatsProvider(fieldStatsProvider);
  QueryBuilder<?> rewritten=query.rewrite(queryShardContext);
  assertThat(rewritten,instanceOf(RangeQueryBuilder.class));
  RangeQueryBuilder rewrittenRange=(RangeQueryBuilder)rewritten;
  assertThat(rewrittenRange.fieldName(),equalTo(fieldName));
  assertThat(rewrittenRange.from(),equalTo(shardMinValue));
  assertThat(rewrittenRange.to(),equalTo(shardMaxValue));
  assertThat(rewrittenRange.includeLower(),equalTo(true));
  assertThat(rewrittenRange.includeUpper(),equalTo(true));
}
