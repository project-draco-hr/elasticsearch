{
  String fieldName=randomAsciiOfLengthBetween(1,20);
  RangeQueryBuilder query=new RangeQueryBuilder(fieldName){
    protected MappedFieldType.Relation getRelation(    QueryRewriteContext queryRewriteContext) throws IOException {
      return Relation.WITHIN;
    }
  }
;
  DateTime queryFromValue=new DateTime(2015,1,1,0,0,0,ISOChronology.getInstanceUTC());
  DateTime queryToValue=new DateTime(2016,1,1,0,0,0,ISOChronology.getInstanceUTC());
  DateTime shardMinValue=new DateTime(2015,3,1,0,0,0,ISOChronology.getInstanceUTC());
  DateTime shardMaxValue=new DateTime(2015,9,1,0,0,0,ISOChronology.getInstanceUTC());
  query.from(queryFromValue);
  query.to(queryToValue);
  QueryShardContext queryShardContext=queryShardContext();
  QueryBuilder<?> rewritten=query.rewrite(queryShardContext);
  assertThat(rewritten,instanceOf(RangeQueryBuilder.class));
  RangeQueryBuilder rewrittenRange=(RangeQueryBuilder)rewritten;
  assertThat(rewrittenRange.fieldName(),equalTo(fieldName));
  assertThat(rewrittenRange.from(),equalTo(null));
  assertThat(rewrittenRange.to(),equalTo(null));
}
