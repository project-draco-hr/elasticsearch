{
  builder.startObject("profile").startArray("shards");
  for (  Map.Entry<String,List<ProfileShardResult>> entry : shardResults.entrySet()) {
    builder.startObject().field("id",entry.getKey()).startArray("searches");
    for (    ProfileShardResult result : entry.getValue()) {
      builder.startObject();
      result.toXContent(builder,params);
      builder.endObject();
    }
    builder.endArray().endObject();
  }
  builder.endArray().endObject();
  return builder;
}
