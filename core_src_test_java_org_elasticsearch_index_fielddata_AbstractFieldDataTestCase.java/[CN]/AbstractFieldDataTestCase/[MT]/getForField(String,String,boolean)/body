{
  final MappedFieldType fieldType;
  final BuilderContext context=new BuilderContext(indexService.getIndexSettings().getSettings(),new ContentPath(1));
  if (type.equals("string")) {
    fieldType=new StringFieldMapper.Builder(fieldName).tokenized(false).fielddata(docValues == false).docValues(docValues).build(context).fieldType();
  }
 else   if (type.equals("float")) {
    fieldType=new FloatFieldMapper.Builder(fieldName).docValues(docValues).build(context).fieldType();
  }
 else   if (type.equals("double")) {
    fieldType=new DoubleFieldMapper.Builder(fieldName).docValues(docValues).build(context).fieldType();
  }
 else   if (type.equals("long")) {
    fieldType=new LongFieldMapper.Builder(fieldName).docValues(docValues).build(context).fieldType();
  }
 else   if (type.equals("int")) {
    fieldType=new IntegerFieldMapper.Builder(fieldName).docValues(docValues).build(context).fieldType();
  }
 else   if (type.equals("short")) {
    fieldType=new ShortFieldMapper.Builder(fieldName).docValues(docValues).build(context).fieldType();
  }
 else   if (type.equals("byte")) {
    fieldType=new ByteFieldMapper.Builder(fieldName).docValues(docValues).build(context).fieldType();
  }
 else   if (type.equals("geo_point")) {
    if (indexService.getIndexSettings().getIndexVersionCreated().before(Version.V_2_2_0)) {
      fieldType=new GeoPointFieldMapperLegacy.Builder(fieldName).docValues(docValues).build(context).fieldType();
    }
 else {
      fieldType=new GeoPointFieldMapper.Builder(fieldName).docValues(docValues).build(context).fieldType();
    }
  }
 else   if (type.equals("_parent")) {
    fieldType=new ParentFieldMapper.Builder("_type").type(fieldName).build(context).fieldType();
  }
 else   if (type.equals("binary")) {
    fieldType=new BinaryFieldMapper.Builder(fieldName).docValues(docValues).build(context).fieldType();
  }
 else {
    throw new UnsupportedOperationException(type);
  }
  return ifdService.getForField(fieldType);
}
