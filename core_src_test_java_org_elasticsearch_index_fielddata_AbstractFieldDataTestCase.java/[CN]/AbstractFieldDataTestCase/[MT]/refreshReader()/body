{
  if (readerContext != null) {
    readerContext.reader().close();
  }
  topLevelReader=ElasticsearchDirectoryReader.wrap(DirectoryReader.open(writer,true),new ShardId("foo",1));
  LeafReader reader=SlowCompositeReaderWrapper.wrap(topLevelReader);
  readerContext=reader.getContext();
  return readerContext;
}
