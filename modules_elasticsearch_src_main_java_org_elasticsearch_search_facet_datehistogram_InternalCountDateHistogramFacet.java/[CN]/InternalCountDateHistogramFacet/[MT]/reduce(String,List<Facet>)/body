{
  if (facets.size() == 1) {
    return facets.get(0);
  }
  TLongLongHashMap counts=CacheRecycler.popLongLongMap();
  for (  Facet facet : facets) {
    InternalCountDateHistogramFacet histoFacet=(InternalCountDateHistogramFacet)facet;
    for (TLongLongIterator it=histoFacet.counts.iterator(); it.hasNext(); ) {
      it.advance();
      counts.adjustOrPutValue(it.key(),it.value(),it.value());
    }
    histoFacet.releaseCache();
  }
  return new InternalCountDateHistogramFacet(name,comparatorType,counts,true);
}
