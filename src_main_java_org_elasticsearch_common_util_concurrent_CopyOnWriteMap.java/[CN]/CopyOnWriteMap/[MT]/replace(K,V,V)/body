{
  V v=map.get(key);
  if (v != null && v.equals(oldValue)) {
    Map<K,V> copyMap=copyMap();
    copyMap.put(key,newValue);
    map=copyMap;
    return true;
  }
  return false;
}
