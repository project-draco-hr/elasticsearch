{
  final DiscoveryNodes discoNodes=clusterService.state().nodes();
  final DiscoveryNode localNode=discoNodes.localNode();
  for (  final DiscoveryNode node : discoNodes) {
    if (node.equals(localNode)) {
      continue;
    }
    if (!node.masterNode() && !RiverNodeHelper.isRiverNode(node)) {
      continue;
    }
    transportService.sendRequest(node,ACTION_NAME,new PublishClusterStateRequest(clusterState),new EmptyTransportResponseHandler(ThreadPool.Names.SAME){
      @Override public void handleException(      TransportException exp){
        logger.debug("failed to send cluster state to [{}], should be detected as failed soon...",exp,node);
      }
    }
);
  }
}
