{
  name=in.readString();
  order=InternalOrder.Streams.readOrder(in);
  minDocCount=in.readVLong();
  if (minDocCount == 0) {
    emptyBucketInfo=EmptyBucketInfo.readFrom(in);
  }
  formatter=ValueFormatterStreams.readOptional(in);
  keyed=in.readBoolean();
  int size=in.readVInt();
  List<B> buckets=new ArrayList<>(size);
  for (int i=0; i < size; i++) {
    buckets.add(createBucket(in.readLong(),in.readVLong(),InternalAggregations.readAggregations(in),formatter));
  }
  this.buckets=buckets;
  this.bucketsMap=null;
}
