{
  this.factory=resolveFactory(in.readString());
  order=InternalOrder.Streams.readOrder(in);
  minDocCount=in.readVLong();
  if (minDocCount == 0) {
    emptyBucketInfo=EmptyBucketInfo.readFrom(in);
  }
  formatter=ValueFormatterStreams.readOptional(in);
  keyed=in.readBoolean();
  int size=in.readVInt();
  List<B> buckets=new ArrayList<>(size);
  for (int i=0; i < size; i++) {
    B bucket=getFactory().createEmptyBucket(keyed,formatter);
    bucket.readFrom(in);
    buckets.add(bucket);
  }
  this.buckets=buckets;
}
