{
  builder.startObject(name);
  if (keyed) {
    builder.startObject(CommonFields.BUCKETS);
  }
 else {
    builder.startArray(CommonFields.BUCKETS);
  }
  for (  B bucket : buckets) {
    bucket.toXContent(builder,params,keyed,formatter);
  }
  if (keyed) {
    builder.endObject();
  }
 else {
    builder.endArray();
  }
  return builder.endObject();
}
