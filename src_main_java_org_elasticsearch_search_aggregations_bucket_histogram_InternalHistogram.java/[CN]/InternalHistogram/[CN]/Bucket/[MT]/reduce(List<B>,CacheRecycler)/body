{
  if (buckets.size() == 1) {
    Bucket bucket=buckets.get(0);
    bucket.aggregations.reduce(cacheRecycler);
    return (B)bucket;
  }
  List<InternalAggregations> aggregations=new ArrayList<InternalAggregations>(buckets.size());
  Bucket reduced=null;
  for (  Bucket bucket : buckets) {
    if (reduced == null) {
      reduced=bucket;
    }
 else {
      reduced.docCount+=bucket.docCount;
    }
    aggregations.add((InternalAggregations)bucket.getAggregations());
  }
  reduced.aggregations=InternalAggregations.reduce(aggregations,cacheRecycler);
  return (B)reduced;
}
