{
  SearchRequestBuilder searchReq=client().prepareSearch("test").setQuery(QueryBuilders.matchAllQuery());
  SearchResponse searchRsp=searchReq.get();
  ElasticsearchAssertions.assertNoFailures(searchRsp);
  long numDocs=searchRsp.getHits().getTotalHits();
  logger.info("Found " + numDocs + " in old index");
  searchReq.addSort("long_sort",SortOrder.ASC);
  ElasticsearchAssertions.assertNoFailures(searchReq.get());
  searchReq=client().prepareSearch("test").setQuery(QueryBuilders.filteredQuery(QueryBuilders.matchAllQuery(),FilterBuilders.existsFilter("string")));
  searchRsp=searchReq.get();
  ElasticsearchAssertions.assertNoFailures(searchRsp);
  assertThat(numDocs,equalTo(searchRsp.getHits().getTotalHits()));
}
