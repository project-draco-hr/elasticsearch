{
  logger.info("--> testing basic search");
  SearchRequestBuilder searchReq=client().prepareSearch(indexName).setQuery(QueryBuilders.matchAllQuery());
  SearchResponse searchRsp=searchReq.get();
  ElasticsearchAssertions.assertNoFailures(searchRsp);
  long numDocs=searchRsp.getHits().getTotalHits();
  logger.info("Found " + numDocs + " in old index");
  logger.info("--> testing basic search with sort");
  searchReq.addSort("long_sort",SortOrder.ASC);
  ElasticsearchAssertions.assertNoFailures(searchReq.get());
  logger.info("--> testing exists filter");
  searchReq=client().prepareSearch(indexName).setQuery(QueryBuilders.filteredQuery(QueryBuilders.matchAllQuery(),FilterBuilders.existsFilter("string")));
  searchRsp=searchReq.get();
  ElasticsearchAssertions.assertNoFailures(searchRsp);
  assertEquals(numDocs,searchRsp.getHits().getTotalHits());
  logger.info("--> testing missing filter");
  searchReq=client().prepareSearch(indexName).setQuery(QueryBuilders.filteredQuery(QueryBuilders.matchAllQuery(),FilterBuilders.missingFilter("long_sort")));
  searchRsp=searchReq.get();
  ElasticsearchAssertions.assertNoFailures(searchRsp);
  assertEquals(0,searchRsp.getHits().getTotalHits());
}
