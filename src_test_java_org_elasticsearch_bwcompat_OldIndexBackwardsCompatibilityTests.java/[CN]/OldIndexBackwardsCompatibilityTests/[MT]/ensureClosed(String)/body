{
  assertTrue(awaitBusy(new Predicate<Object>(){
    @Override public boolean apply(    Object o){
      ClusterState state=client().admin().cluster().prepareState().get().getState();
      return state.metaData().hasIndex(index) && state.metaData().index(index).getState() == IndexMetaData.State.CLOSE;
    }
  }
));
}
