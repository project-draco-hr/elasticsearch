{
  interceptTransportActions(SearchServiceTransportAction.SCAN_ACTION_NAME);
  String[] randomIndicesOrAliases=randomIndicesOrAliases();
  for (int i=0; i < randomIndicesOrAliases.length; i++) {
    client().prepareIndex(randomIndicesOrAliases[i],"type","id-" + i).setSource("field","value").get();
  }
  refresh();
  SearchRequest searchRequest=new SearchRequest(randomIndicesOrAliases).searchType(SearchType.SCAN).scroll(new TimeValue(500));
  SearchResponse searchResponse=internalCluster().clientNodeClient().search(searchRequest).actionGet();
  assertNoFailures(searchResponse);
  assertThat(searchResponse.getHits().totalHits(),greaterThan(0l));
  client().prepareClearScroll().addScrollId(searchResponse.getScrollId()).get();
  clearInterceptedActions();
  assertSameIndices(searchRequest,SearchServiceTransportAction.SCAN_ACTION_NAME);
}
