{
  EnumSet<ShardStatusChangeType> changes=EnumSet.noneOf(ShardStatusChangeType.class);
  Iterator<ShardId> statusShardIdIterator=shardsIndicesStatus.keySet().iterator();
  while (statusShardIdIterator.hasNext()) {
    ShardId shardId=statusShardIdIterator.next();
    if (shardAvailable(shardId) == false) {
      changes.add(ShardStatusChangeType.DELETED);
      statusShardIdIterator.remove();
    }
  }
  return changes;
}
