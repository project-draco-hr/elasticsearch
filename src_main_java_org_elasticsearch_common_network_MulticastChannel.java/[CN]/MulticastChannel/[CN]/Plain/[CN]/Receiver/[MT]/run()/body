{
  while (running) {
    try {
synchronized (receiveMutex) {
        try {
          multicastSocket.receive(datagramPacketReceive);
        }
 catch (        SocketTimeoutException ignore) {
          continue;
        }
catch (        Exception e) {
          if (running) {
            if (multicastSocket.isClosed()) {
              logger.warn("multicast socket closed while running, restarting...");
              multicastSocket=buildMulticastSocket(config);
            }
 else {
              logger.warn("failed to receive packet, throttling...",e);
              Thread.sleep(500);
            }
          }
          continue;
        }
      }
      if (datagramPacketReceive.getData().length > 0) {
        listener.onMessage(new BytesArray(datagramPacketReceive.getData()),datagramPacketReceive.getSocketAddress());
      }
    }
 catch (    Throwable e) {
      if (running) {
        logger.warn("unexpected exception in multicast receiver",e);
      }
    }
  }
}
