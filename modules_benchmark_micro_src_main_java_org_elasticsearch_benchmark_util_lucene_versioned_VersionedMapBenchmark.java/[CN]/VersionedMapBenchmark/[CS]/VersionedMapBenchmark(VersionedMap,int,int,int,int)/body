{
  this.versionedMap=versionedMap;
  this.readerIterations=readerIterations;
  this.writerIterations=writerIterations;
  readerThreads=new Thread[numberOfReaders];
  for (int i=0; i < numberOfReaders; i++) {
    readerThreads[i]=new Thread(new ReaderThread(),"reader[" + i + "]");
  }
  writerThreads=new Thread[numberOfWriters];
  for (int i=0; i < numberOfWriters; i++) {
    writerThreads[i]=new Thread(new WriterThread(),"writer[" + i + "]");
  }
  latch=new CountDownLatch(numberOfReaders + numberOfWriters);
  barrier1=new CyclicBarrier(numberOfReaders + numberOfWriters + 1);
  barrier2=new CyclicBarrier(numberOfReaders + numberOfWriters + 1);
  StopWatch stopWatch=new StopWatch("warmup");
  stopWatch.start();
  int warmupSize=1000000;
  for (int i=0; i < warmupSize; i++) {
    versionedMap.putVersion(i,i);
    versionedMap.beforeVersion(i,i);
  }
  stopWatch.stop();
  System.out.println("Warmup up of [" + warmupSize + "]: "+ stopWatch.totalTime());
  versionedMap.clear();
}
