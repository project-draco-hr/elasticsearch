{
  IndexService indexService=createIndex("test",ImmutableSettings.settingsBuilder().build());
  XContentBuilder indexMapping=XContentFactory.jsonBuilder();
  boolean enabled=randomBoolean();
  indexMapping.startObject().startObject("type").startObject("_timestamp").field("enabled",enabled).field("store",true).startObject("fielddata").field("format","doc_values").endObject().endObject().endObject().endObject();
  DocumentMapper documentMapper=indexService.mapperService().parse("type",new CompressedString(indexMapping.string()),true);
  assertThat(documentMapper.timestampFieldMapper().enabled(),equalTo(enabled));
  assertTrue(documentMapper.timestampFieldMapper().fieldType().stored());
  assertTrue(documentMapper.timestampFieldMapper().hasDocValues());
  documentMapper=indexService.mapperService().parse("type",new CompressedString(documentMapper.mappingSource().string()),true);
  assertThat(documentMapper.timestampFieldMapper().enabled(),equalTo(enabled));
  assertTrue(documentMapper.timestampFieldMapper().hasDocValues());
  assertTrue(documentMapper.timestampFieldMapper().fieldType().stored());
}
