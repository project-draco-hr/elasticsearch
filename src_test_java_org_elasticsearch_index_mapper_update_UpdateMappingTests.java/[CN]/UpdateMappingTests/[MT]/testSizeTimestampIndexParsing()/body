{
  IndexService indexService=createIndex("test",ImmutableSettings.settingsBuilder().build());
  String mapping=copyToStringFromClasspath("/org/elasticsearch/index/mapper/update/default_mapping_with_disabled_root_types.json");
  DocumentMapper documentMapper=indexService.mapperService().parse("type",new CompressedString(mapping),true);
  assertThat(documentMapper.mappingSource().string(),equalTo(mapping));
  documentMapper.refreshSource();
  documentMapper=indexService.mapperService().parse("type",new CompressedString(documentMapper.mappingSource().string()),true);
  assertThat(documentMapper.mappingSource().string(),equalTo(mapping));
}
