{
  super(shardId,indexSettings);
  this.threadPool=threadPool;
  this.indexShard=indexShard;
  this.translog=translog;
  this.flushThresholdOperations=componentSettings.getAsInt("flush_threshold_ops",componentSettings.getAsInt("flush_threshold",20000));
  this.flushThresholdSize=componentSettings.getAsBytesSize("flush_threshold_size",new ByteSizeValue(500,ByteSizeUnit.MB));
  this.flushThresholdPeriod=componentSettings.getAsTime("flush_threshold_period",TimeValue.timeValueMinutes(60));
  this.interval=componentSettings.getAsTime("interval",timeValueMillis(5000));
  logger.debug("interval [{}], flush_threshold_ops [{}], flush_threshold_size [{}], flush_threshold_period [{}]",interval,flushThresholdOperations,flushThresholdSize,flushThresholdPeriod);
  this.future=threadPool.schedule(new TranslogBasedFlush(),interval,ThreadPool.ExecutionType.DEFAULT);
}
