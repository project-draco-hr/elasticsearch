{
  logger.trace("failure on replica [{}][{}]",t,index,shardId);
  if (!ignoreReplicaException(t)) {
    IndexService indexService=indicesService.indexService(index);
    if (indexService == null) {
      logger.debug("ignoring failed replica [{}][{}] because index was already removed.",index,shardId);
      return;
    }
    IndexShard indexShard=indexService.shard(shardId);
    if (indexShard == null) {
      logger.debug("ignoring failed replica [{}][{}] because index was already removed.",index,shardId);
      return;
    }
    indexShard.failShard(transportAction + " failed on replica",t);
  }
}
