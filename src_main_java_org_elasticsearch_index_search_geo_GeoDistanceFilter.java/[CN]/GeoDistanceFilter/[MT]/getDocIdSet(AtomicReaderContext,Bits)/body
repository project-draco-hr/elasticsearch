{
  DocIdSet boundingBoxDocSet=null;
  if (boundingBoxFilter != null) {
    boundingBoxDocSet=boundingBoxFilter.getDocIdSet(context,acceptedDocs);
    if (DocIdSets.isEmpty(boundingBoxDocSet)) {
      return null;
    }
  }
  final GeoPointFieldData fieldData=(GeoPointFieldData)fieldDataCache.cache(GeoPointFieldDataType.TYPE,context.reader(),fieldName);
  GeoDistanceDocSet distDocSet=new GeoDistanceDocSet(context.reader().maxDoc(),acceptedDocs,fieldData,fixedSourceDistance,distanceBoundingCheck,distance);
  if (boundingBoxDocSet == null) {
    return distDocSet;
  }
 else {
    return new AndDocIdSet(new DocIdSet[]{boundingBoxDocSet,distDocSet});
  }
}
