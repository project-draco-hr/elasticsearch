{
  DocSet boundingBoxDocSet=null;
  if (boundingBoxFilter != null) {
    DocIdSet docIdSet=boundingBoxFilter.getDocIdSet(reader);
    if (docIdSet == null) {
      return null;
    }
    boundingBoxDocSet=DocSets.convert(reader,docIdSet);
  }
  final GeoPointFieldData fieldData=(GeoPointFieldData)fieldDataCache.cache(GeoPointFieldDataType.TYPE,reader,fieldName);
  GeoDistanceDocSet distDocSet=new GeoDistanceDocSet(reader.maxDoc(),fieldData,fixedSourceDistance,distanceBoundingCheck,distance);
  if (boundingBoxDocSet == null) {
    return distDocSet;
  }
 else {
    return new AndDocSet(ImmutableList.of(boundingBoxDocSet,distDocSet));
  }
}
