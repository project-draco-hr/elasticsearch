{
  try {
    if (failureMarker.wasSuccessful() && dir.isOpen()) {
      Assert.fail("Directory not closed: " + dir);
    }
  }
  finally {
    if (dir.isOpen()) {
      dir.close();
    }
  }
}
