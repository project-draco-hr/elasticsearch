{
  QB testQuery=createTestQueryBuilder();
  QueryParseContext context=createContext();
  String contentString=testQuery.toString();
  XContentParser parser=XContentFactory.xContent(contentString).createParser(contentString);
  context.reset(parser);
  assertQueryHeader(parser,testQuery.queryId());
  QueryBuilder newQuery=queryParserService.queryParser(testQuery.queryId()).fromXContent(context);
  assertNotSame(newQuery,testQuery);
  assertEquals(newQuery,testQuery);
  assertEquals(newQuery.hashCode(),testQuery.hashCode());
}
