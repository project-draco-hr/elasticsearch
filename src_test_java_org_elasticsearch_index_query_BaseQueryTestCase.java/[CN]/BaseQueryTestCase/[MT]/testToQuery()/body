{
  QB testQuery=createTestQueryBuilder();
  QueryParseContext context=createContext();
  context.setAllowUnmappedFields(true);
  Query expectedQuery=createExpectedQuery(testQuery,context);
  Query actualQuery=testQuery.toQuery(context);
  assertThat(actualQuery,instanceOf(expectedQuery.getClass()));
  assertThat(actualQuery,equalTo(expectedQuery));
  assertLuceneQuery(testQuery,actualQuery,context);
}
