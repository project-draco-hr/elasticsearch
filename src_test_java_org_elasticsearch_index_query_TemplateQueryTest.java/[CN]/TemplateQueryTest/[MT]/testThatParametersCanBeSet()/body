{
  index("test","type","1",jsonBuilder().startObject().field("theField","foo").endObject());
  index("test","type","2",jsonBuilder().startObject().field("theField","foo 2").endObject());
  index("test","type","3",jsonBuilder().startObject().field("theField","foo 3").endObject());
  index("test","type","4",jsonBuilder().startObject().field("theField","foo 4").endObject());
  index("test","type","5",jsonBuilder().startObject().field("otherField","foo").endObject());
  refresh();
  Map<String,Object> templateParams=Maps.newHashMap();
  templateParams.put("mySize","2");
  templateParams.put("myField","theField");
  templateParams.put("myValue","foo");
  SearchResponse searchResponse=client().prepareSearch("test").setTypes("type").setTemplateName("full-query-template").setTemplateParams(templateParams).get();
  assertHitCount(searchResponse,4);
  assertThat(searchResponse.getHits().getHits().length,is(2));
  templateParams.put("myField","otherField");
  searchResponse=client().prepareSearch("test").setTypes("type").setTemplateName("full-query-template").setTemplateParams(templateParams).get();
  assertHitCount(searchResponse,1);
}
