{
  this.task=task;
  this.request=request;
  this.listener=listener;
  ClusterState clusterState=clusterService.state();
  nodesIds=filterNodeIds(clusterState.nodes(),resolveNodes(request,clusterState));
  this.nodes=new DiscoveryNode[nodesIds.length];
  for (int i=0; i < nodesIds.length; i++) {
    this.nodes[i]=clusterState.nodes().get(nodesIds[i]);
  }
  this.responses=new AtomicReferenceArray<>(this.nodesIds.length);
}
