{
  builder.field("type",contentType());
  if (includeDefaults || !names.name().equals(names.indexNameClean())) {
    builder.field("index_name",names.indexNameClean());
  }
  if (includeDefaults || boost != 1.0f) {
    builder.field("boost",boost);
  }
  FieldType defaultFieldType=defaultFieldType();
  boolean indexed=fieldType.indexOptions() != IndexOptions.NONE;
  boolean defaultIndexed=defaultFieldType.indexOptions() != IndexOptions.NONE;
  if (includeDefaults || indexed != defaultIndexed || fieldType.tokenized() != defaultFieldType.tokenized()) {
    builder.field("index",indexTokenizeOptionToString(indexed,fieldType.tokenized()));
  }
  if (includeDefaults || fieldType.stored() != defaultFieldType.stored()) {
    builder.field("store",fieldType.stored());
  }
  if (includeDefaults || hasDocValues() != Defaults.DOC_VALUES) {
    builder.field(TypeParsers.DOC_VALUES,docValues);
  }
  if (includeDefaults || fieldType.storeTermVectors() != defaultFieldType.storeTermVectors()) {
    builder.field("term_vector",termVectorOptionsToString(fieldType));
  }
  if (includeDefaults || fieldType.omitNorms() != defaultFieldType.omitNorms() || normsLoading != null) {
    builder.startObject("norms");
    if (includeDefaults || fieldType.omitNorms() != defaultFieldType.omitNorms()) {
      builder.field("enabled",!fieldType.omitNorms());
    }
    if (normsLoading != null) {
      builder.field(Loading.KEY,normsLoading);
    }
    builder.endObject();
  }
  if (indexed && (includeDefaults || fieldType.indexOptions() != defaultFieldType.indexOptions())) {
    builder.field("index_options",indexOptionToString(fieldType.indexOptions()));
  }
  if (indexAnalyzer == null && searchAnalyzer == null) {
    if (includeDefaults) {
      builder.field("analyzer","default");
    }
  }
 else   if (indexAnalyzer == null) {
    if (includeDefaults || (!searchAnalyzer.name().startsWith("_") && !searchAnalyzer.name().equals("default"))) {
      builder.field("search_analyzer",searchAnalyzer.name());
    }
  }
 else   if (searchAnalyzer == null) {
    if (includeDefaults || (!indexAnalyzer.name().startsWith("_") && !indexAnalyzer.name().equals("default"))) {
      builder.field("index_analyzer",indexAnalyzer.name());
    }
  }
 else   if (indexAnalyzer.name().equals(searchAnalyzer.name())) {
    if (includeDefaults || (!indexAnalyzer.name().startsWith("_") && !indexAnalyzer.name().equals("default"))) {
      builder.field("analyzer",indexAnalyzer.name());
    }
  }
 else {
    if (includeDefaults || (!indexAnalyzer.name().startsWith("_") && !indexAnalyzer.name().equals("default"))) {
      builder.field("index_analyzer",indexAnalyzer.name());
    }
    if (includeDefaults || (!searchAnalyzer.name().startsWith("_") && !searchAnalyzer.name().equals("default"))) {
      builder.field("search_analyzer",searchAnalyzer.name());
    }
  }
  if (postingsFormat != null) {
    if (includeDefaults || !postingsFormat.name().equals(defaultPostingFormat())) {
      builder.field("postings_format",postingsFormat.name());
    }
  }
 else   if (includeDefaults) {
    String format=defaultPostingFormat();
    if (format == null) {
      format=PostingsFormatService.DEFAULT_FORMAT;
    }
    builder.field("postings_format",format);
  }
  if (docValuesFormat != null) {
    if (includeDefaults || !docValuesFormat.name().equals(defaultDocValuesFormat())) {
      builder.field(DOC_VALUES_FORMAT,docValuesFormat.name());
    }
  }
 else   if (includeDefaults) {
    String format=defaultDocValuesFormat();
    if (format == null) {
      format=DocValuesFormatService.DEFAULT_FORMAT;
    }
    builder.field(DOC_VALUES_FORMAT,format);
  }
  if (similarity() != null) {
    builder.field("similarity",similarity().name());
  }
 else   if (includeDefaults) {
    builder.field("similarity",SimilarityLookupService.DEFAULT_SIMILARITY);
  }
  if (customFieldDataSettings != null) {
    builder.field("fielddata",(Map)customFieldDataSettings.getAsMap());
  }
 else   if (includeDefaults) {
    builder.field("fielddata",(Map)fieldDataType.getSettings().getAsMap());
  }
  multiFields.toXContent(builder,params);
  if (copyTo != null) {
    copyTo.toXContent(builder,params);
  }
}
