{
  if (!this.getClass().equals(mergeWith.getClass())) {
    String mergedType=mergeWith.getClass().getSimpleName();
    if (mergeWith instanceof AbstractFieldMapper) {
      mergedType=((AbstractFieldMapper)mergeWith).contentType();
    }
    mergeContext.addConflict("mapper [" + names.fullName() + "] of different type, current_type ["+ contentType()+ "], merged_type ["+ mergedType+ "]");
    return;
  }
  AbstractFieldMapper fieldMergeWith=(AbstractFieldMapper)mergeWith;
  boolean indexed=fieldType.indexOptions() != IndexOptions.NONE;
  boolean mergeWithIndexed=fieldMergeWith.fieldType().indexOptions() != IndexOptions.NONE;
  if (indexed != mergeWithIndexed || this.fieldType().tokenized() != fieldMergeWith.fieldType().tokenized()) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different index values");
  }
  if (this.fieldType().stored() != fieldMergeWith.fieldType().stored()) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different store values");
  }
  if (!this.hasDocValues() && fieldMergeWith.hasDocValues()) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different "+ TypeParsers.DOC_VALUES+ " values");
  }
  if (this.fieldType().omitNorms() && !fieldMergeWith.fieldType.omitNorms()) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] cannot enable norms (`norms.enabled`)");
  }
  if (this.fieldType().tokenized() != fieldMergeWith.fieldType().tokenized()) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different tokenize values");
  }
  if (this.fieldType().storeTermVectors() != fieldMergeWith.fieldType().storeTermVectors()) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different store_term_vector values");
  }
  if (this.fieldType().storeTermVectorOffsets() != fieldMergeWith.fieldType().storeTermVectorOffsets()) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different store_term_vector_offsets values");
  }
  if (this.fieldType().storeTermVectorPositions() != fieldMergeWith.fieldType().storeTermVectorPositions()) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different store_term_vector_positions values");
  }
  if (this.fieldType().storeTermVectorPayloads() != fieldMergeWith.fieldType().storeTermVectorPayloads()) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different store_term_vector_payloads values");
  }
  if (this.indexAnalyzer == null || "default".equals(this.indexAnalyzer.name())) {
    if (fieldMergeWith.indexAnalyzer != null && !"default".equals(fieldMergeWith.indexAnalyzer.name())) {
      mergeContext.addConflict("mapper [" + names.fullName() + "] has different analyzer");
    }
  }
 else   if (fieldMergeWith.indexAnalyzer == null || "default".equals(fieldMergeWith.indexAnalyzer.name())) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different analyzer");
  }
 else   if (!this.indexAnalyzer.name().equals(fieldMergeWith.indexAnalyzer.name())) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different analyzer");
  }
  if (!this.names().equals(fieldMergeWith.names())) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different index_name");
  }
  if (this.similarity == null) {
    if (fieldMergeWith.similarity() != null) {
      mergeContext.addConflict("mapper [" + names.fullName() + "] has different similarity");
    }
  }
 else   if (fieldMergeWith.similarity() == null) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different similarity");
  }
 else   if (!this.similarity().equals(fieldMergeWith.similarity())) {
    mergeContext.addConflict("mapper [" + names.fullName() + "] has different similarity");
  }
  multiFields.merge(mergeWith,mergeContext);
  if (!mergeContext.mergeFlags().simulate()) {
    this.fieldType=new FieldType(this.fieldType);
    this.fieldType.setOmitNorms(fieldMergeWith.fieldType.omitNorms());
    this.fieldType.freeze();
    this.boost=fieldMergeWith.boost;
    this.normsLoading=fieldMergeWith.normsLoading;
    this.copyTo=fieldMergeWith.copyTo;
    if (fieldMergeWith.searchAnalyzer != null) {
      this.searchAnalyzer=fieldMergeWith.searchAnalyzer;
    }
    if (fieldMergeWith.customFieldDataSettings != null) {
      if (!Objects.equal(fieldMergeWith.customFieldDataSettings,this.customFieldDataSettings)) {
        this.customFieldDataSettings=fieldMergeWith.customFieldDataSettings;
        this.fieldDataType=new FieldDataType(defaultFieldDataType().getType(),ImmutableSettings.builder().put(defaultFieldDataType().getSettings()).put(this.customFieldDataSettings));
      }
    }
  }
}
