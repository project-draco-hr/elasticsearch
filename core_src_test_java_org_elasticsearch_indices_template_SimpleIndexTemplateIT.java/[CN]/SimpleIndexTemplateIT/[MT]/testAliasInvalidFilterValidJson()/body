{
  client().admin().indices().preparePutTemplate("template_1").setTemplate("te*").addAlias(new Alias("invalid_alias").filter("{ \"invalid\": {} }")).get();
  GetIndexTemplatesResponse response=client().admin().indices().prepareGetTemplates("template_1").get();
  assertThat(response.getIndexTemplates().size(),equalTo(1));
  assertThat(response.getIndexTemplates().get(0).getAliases().size(),equalTo(1));
  assertThat(response.getIndexTemplates().get(0).getAliases().get("invalid_alias").filter().string(),equalTo("{\"invalid\":{}}"));
  try {
    createIndex("test");
    fail("index creation should have failed due to invalid alias filter in matching index template");
  }
 catch (  IllegalArgumentException e) {
    assertThat(e.getMessage(),equalTo("failed to parse filter for alias [invalid_alias]"));
    assertThat(e.getCause(),instanceOf(ParsingException.class));
    assertThat(e.getCause().getMessage(),equalTo("No query registered for [invalid]"));
  }
}
