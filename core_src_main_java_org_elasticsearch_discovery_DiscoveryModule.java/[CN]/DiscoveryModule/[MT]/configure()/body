{
  String defaultType=DiscoveryNode.localNode(settings) ? "local" : "zen";
  String discoveryType=settings.get(DISCOVERY_TYPE_KEY,defaultType);
  Class<? extends Discovery> discoveryClass=discoveryTypes.get(discoveryType);
  if (discoveryClass == null) {
    throw new IllegalArgumentException("Unknown Discovery type [" + discoveryType + "]");
  }
  if (discoveryType.equals("local") == false) {
    bind(ElectMasterService.class).asEagerSingleton();
    bind(ZenPingService.class).asEagerSingleton();
    Multibinder<UnicastHostsProvider> unicastHostsProviderMultibinder=Multibinder.newSetBinder(binder(),UnicastHostsProvider.class);
    for (    Class<? extends UnicastHostsProvider> unicastHostProvider : unicastHostProviders) {
      unicastHostsProviderMultibinder.addBinding().to(unicastHostProvider);
    }
  }
  bind(Discovery.class).to(discoveryClass).asEagerSingleton();
  bind(DiscoveryService.class).asEagerSingleton();
}
