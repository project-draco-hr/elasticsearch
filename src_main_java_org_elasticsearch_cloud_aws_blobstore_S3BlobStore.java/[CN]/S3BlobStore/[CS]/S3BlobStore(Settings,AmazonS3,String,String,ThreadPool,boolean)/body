{
  super(settings);
  this.client=client;
  this.bucket=bucket;
  this.region=region;
  this.threadPool=threadPool;
  this.serverSideEncryption=serverSideEncryption;
  this.bufferSizeInBytes=(int)settings.getAsBytesSize("buffer_size",new ByteSizeValue(100,ByteSizeUnit.KB)).bytes();
  this.numberOfRetries=settings.getAsInt("max_retries",3);
  if (!client.doesBucketExist(bucket)) {
    if (region != null) {
      client.createBucket(bucket,region);
    }
 else {
      client.createBucket(bucket);
    }
  }
}
