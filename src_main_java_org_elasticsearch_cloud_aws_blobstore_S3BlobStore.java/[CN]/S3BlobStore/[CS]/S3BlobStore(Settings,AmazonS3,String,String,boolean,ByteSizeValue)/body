{
  super(settings);
  this.client=client;
  this.bucket=bucket;
  this.region=region;
  this.serverSideEncryption=serverSideEncryption;
  this.bufferSize=(bufferSize != null) ? bufferSize : MIN_BUFFER_SIZE;
  if (this.bufferSize.getBytes() < MIN_BUFFER_SIZE.getBytes()) {
    throw new BlobStoreException("\"Detected a buffer_size for the S3 storage lower than [" + MIN_BUFFER_SIZE + "]");
  }
  this.numberOfRetries=settings.getAsInt("max_retries",3);
  if (!client.doesBucketExist(bucket)) {
    if (region != null) {
      client.createBucket(bucket,region);
    }
 else {
      client.createBucket(bucket);
    }
  }
}
