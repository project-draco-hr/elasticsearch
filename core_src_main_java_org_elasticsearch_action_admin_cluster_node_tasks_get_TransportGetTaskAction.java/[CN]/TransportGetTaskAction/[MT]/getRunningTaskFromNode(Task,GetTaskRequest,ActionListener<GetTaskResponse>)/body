{
  Task runningTask=taskManager.getTask(request.getTaskId().getId());
  if (runningTask == null) {
    getFinishedTaskFromIndex(thisTask,request,listener);
  }
 else {
    if (request.getWaitForCompletion()) {
      threadPool.generic().execute(new AbstractRunnable(){
        @Override protected void doRun() throws Exception {
          taskManager.waitForTaskCompletion(runningTask,waitForCompletionTimeout(request.getTimeout()));
          listener.onResponse(new GetTaskResponse(new PersistedTaskInfo(runningTask.taskInfo(clusterService.localNode(),true))));
        }
        @Override public void onFailure(        Throwable t){
          listener.onFailure(t);
        }
      }
);
    }
 else {
      listener.onResponse(new GetTaskResponse(new PersistedTaskInfo(runningTask.taskInfo(clusterService.localNode(),true))));
    }
  }
}
