{
  client().admin().cluster().prepareHealth("idx_unmapped").setWaitForYellowStatus().execute().actionGet();
  for (int precision=1; precision <= highestPrecisionGeohash; precision++) {
    SearchResponse response=client().prepareSearch("idx_unmapped").addAggregation(geohashGrid("geohashgrid").field("location").precision(precision)).execute().actionGet();
    assertThat(response.getFailedShards(),equalTo(0));
    GeoHashGrid geoGrid=response.getAggregations().get("geohashgrid");
    assertThat(geoGrid.getNumberOfBuckets(),equalTo(0));
  }
}
