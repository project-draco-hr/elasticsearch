{
  while (true) {
    for (int i=1; i < COUNT; i++) {
      try {
        client.prepareIndex(indexName,"parent",Integer.toString(i)).setSource(parentSource(Integer.toString(i),"test" + i)).execute().actionGet();
        for (int j=0; j < CHILD_COUNT; j++) {
          client.prepareIndex(indexName,"child",Integer.toString(i) + "_" + j).setParent(Integer.toString(i)).setSource(childSource(Integer.toString(j),"tag" + j)).execute().actionGet();
        }
        client.admin().indices().prepareRefresh(indexName).execute().actionGet();
        Thread.sleep(100);
        if (i % 500 == 0) {
          NodesStatsResponse statsResponse=client.admin().cluster().prepareNodesStats().clear().setIndices(true).execute().actionGet();
          System.out.println("Deleted docs: " + statsResponse.getAt(0).getIndices().getDocs().getDeleted());
        }
      }
 catch (      Throwable e) {
        e.printStackTrace();
      }
    }
  }
}
