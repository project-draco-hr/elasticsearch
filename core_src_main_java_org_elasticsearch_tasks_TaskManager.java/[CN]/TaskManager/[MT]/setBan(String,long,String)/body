{
  logger.trace("setting ban for the parent task {}:{} {}",parentNode,parentId,reason);
  Tuple<String,Long> ban=new Tuple<>(parentNode,parentId);
synchronized (banedParents) {
    if (lastDiscoveryNodes.nodeExists(parentNode)) {
      banedParents.put(ban,reason);
    }
  }
  for (  Map.Entry<Long,CancellableTaskHolder> taskEntry : cancellableTasks.entrySet()) {
    CancellableTaskHolder holder=taskEntry.getValue();
    if (holder.hasParent(parentNode,parentId)) {
      holder.cancel(reason);
    }
  }
}
