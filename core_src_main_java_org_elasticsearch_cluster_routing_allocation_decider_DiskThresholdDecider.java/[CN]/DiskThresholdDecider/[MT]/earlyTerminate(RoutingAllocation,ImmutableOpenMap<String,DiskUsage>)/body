{
  if (!enabled) {
    return allocation.decision(Decision.YES,NAME,"disk threshold decider disabled");
  }
  if (allocation.nodes().dataNodes().size() <= 1) {
    if (logger.isTraceEnabled()) {
      logger.trace("only a single data node is present, allowing allocation");
    }
    return allocation.decision(Decision.YES,NAME,"only a single data node is present");
  }
  final ClusterInfo clusterInfo=allocation.clusterInfo();
  if (clusterInfo == null) {
    if (logger.isTraceEnabled()) {
      logger.trace("cluster info unavailable for disk threshold decider, allowing allocation.");
    }
    return allocation.decision(Decision.YES,NAME,"cluster info unavailable");
  }
  if (usages.isEmpty()) {
    if (logger.isTraceEnabled()) {
      logger.trace("unable to determine disk usages for disk-aware allocation, allowing allocation");
    }
    return allocation.decision(Decision.YES,NAME,"disk usages unavailable");
  }
  return null;
}
