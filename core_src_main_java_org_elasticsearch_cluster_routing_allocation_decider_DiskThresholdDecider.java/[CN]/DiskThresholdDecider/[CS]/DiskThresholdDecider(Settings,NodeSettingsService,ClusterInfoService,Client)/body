{
  super(settings);
  String lowWatermark=settings.get(CLUSTER_ROUTING_ALLOCATION_LOW_DISK_WATERMARK,"85%");
  String highWatermark=settings.get(CLUSTER_ROUTING_ALLOCATION_HIGH_DISK_WATERMARK,"90%");
  if (!validWatermarkSetting(lowWatermark,CLUSTER_ROUTING_ALLOCATION_LOW_DISK_WATERMARK)) {
    throw new ElasticsearchParseException("Unable to parse low watermark: [" + lowWatermark + "]");
  }
  if (!validWatermarkSetting(highWatermark,CLUSTER_ROUTING_ALLOCATION_HIGH_DISK_WATERMARK)) {
    throw new ElasticsearchParseException("Unable to parse high watermark: [" + highWatermark + "]");
  }
  this.freeDiskThresholdLow=100.0 - thresholdPercentageFromWatermark(lowWatermark);
  this.freeDiskThresholdHigh=100.0 - thresholdPercentageFromWatermark(highWatermark);
  this.freeBytesThresholdLow=thresholdBytesFromWatermark(lowWatermark,CLUSTER_ROUTING_ALLOCATION_LOW_DISK_WATERMARK);
  this.freeBytesThresholdHigh=thresholdBytesFromWatermark(highWatermark,CLUSTER_ROUTING_ALLOCATION_HIGH_DISK_WATERMARK);
  this.includeRelocations=settings.getAsBoolean(CLUSTER_ROUTING_ALLOCATION_INCLUDE_RELOCATIONS,true);
  this.rerouteInterval=settings.getAsTime(CLUSTER_ROUTING_ALLOCATION_REROUTE_INTERVAL,TimeValue.timeValueSeconds(60));
  this.enabled=settings.getAsBoolean(CLUSTER_ROUTING_ALLOCATION_DISK_THRESHOLD_ENABLED,true);
  nodeSettingsService.addListener(new ApplySettings());
  infoService.addListener(new DiskListener(client));
}
