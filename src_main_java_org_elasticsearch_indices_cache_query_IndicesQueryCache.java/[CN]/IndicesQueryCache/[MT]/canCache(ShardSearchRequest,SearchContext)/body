{
  if (hasLength(request.templateSource())) {
    return false;
  }
  if (context.size() != 0) {
    return false;
  }
  if (!CACHEABLE_SEARCH_TYPES.contains(context.searchType())) {
    return false;
  }
  IndexMetaData index=clusterService.state().getMetaData().index(request.index());
  if (index == null) {
    return false;
  }
  if (request.queryCache() == null) {
    if (!index.settings().getAsBoolean(INDEX_CACHE_QUERY_ENABLED,Boolean.FALSE)) {
      return false;
    }
  }
 else   if (!request.queryCache()) {
    return false;
  }
  if (!(context.searcher().getIndexReader() instanceof DirectoryReader)) {
    return false;
  }
  if (context.nowInMillisUsed()) {
    return false;
  }
  return true;
}
