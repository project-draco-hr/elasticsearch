{
  InternalScrollSearchRequest internalRequest=internalScrollSearchRequest(searchId,request);
  searchService.sendExecuteQuery(node,internalRequest,new SearchServiceListener<QuerySearchResult>(){
    @Override public void onResult(    QuerySearchResult result){
      queryResults.set(shardIndex,result);
      if (counter.decrementAndGet() == 0) {
        try {
          executeFetchPhase();
        }
 catch (        Throwable e) {
          onFailure(e);
        }
      }
    }
    @Override public void onFailure(    Throwable t){
      Throwable cause=ExceptionsHelper.unwrapCause(t);
      if (cause instanceof SearchContextMissingException) {
        listener.onFailure(t);
      }
 else {
        onQueryPhaseFailure(shardIndex,counter,searchId,t);
      }
    }
  }
);
}
