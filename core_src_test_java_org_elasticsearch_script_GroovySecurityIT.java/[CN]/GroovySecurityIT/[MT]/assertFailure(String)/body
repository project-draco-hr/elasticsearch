{
  logger.info("--> script: " + script);
  SearchResponse resp=client().prepareSearch("test").setSource("{\"query\": {\"match_all\": {}}," + "\"sort\":{\"_script\": {\"script\": \"" + script + "; doc['foo'].value + 2\", \"type\": \"number\", \"lang\": \"groovy\"}}}").get();
  assertEquals(0,resp.getHits().getTotalHits());
  ShardSearchFailure fails[]=resp.getShardFailures();
  for (  ShardSearchFailure fail : fails) {
    assertTrue("unexpected exception" + fail.getCause(),fail.getCause().toString().toLowerCase(Locale.ROOT).contains("accesscontrolexception[access denied"));
  }
}
