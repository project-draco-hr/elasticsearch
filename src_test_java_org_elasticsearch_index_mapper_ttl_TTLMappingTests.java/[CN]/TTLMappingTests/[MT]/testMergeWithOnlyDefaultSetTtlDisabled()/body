{
  XContentBuilder mappingWithTtlEnabled=getMappingWithTtlDisabled("7d");
  IndexService indexService=createIndex("testindex",ImmutableSettings.settingsBuilder().build(),"type",mappingWithTtlEnabled);
  CompressedString mappingAfterCreation=indexService.mapperService().documentMapper("type").mappingSource();
  assertThat(mappingAfterCreation,equalTo(new CompressedString("{\"type\":{\"_ttl\":{\"enabled\":false},\"properties\":{\"field\":{\"type\":\"string\"}}}}")));
  XContentBuilder mappingWithOnlyDefaultSet=getMappingWithOnlyTtlDefaultSet("6m");
  MergeResult mergeResult=indexService.mapperService().documentMapper("type").merge(indexService.mapperService().parse("type",new CompressedString(mappingWithOnlyDefaultSet.string()),true).mapping(),false);
  assertFalse(mergeResult.hasConflicts());
  CompressedString mappingAfterMerge=indexService.mapperService().documentMapper("type").mappingSource();
  assertThat(mappingAfterMerge,equalTo(new CompressedString("{\"type\":{\"_ttl\":{\"enabled\":false},\"properties\":{\"field\":{\"type\":\"string\"}}}}")));
}
