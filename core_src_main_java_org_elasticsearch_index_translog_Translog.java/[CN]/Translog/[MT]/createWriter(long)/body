{
  TranslogWriter newFile;
  try {
    newFile=TranslogWriter.create(config.getType(),shardId,translogUUID,fileGeneration,location.resolve(getFilename(fileGeneration)),new OnCloseRunnable(),config.getBufferSizeBytes());
  }
 catch (  IOException e) {
    throw new TranslogException(shardId,"failed to create new translog file",e);
  }
  return newFile;
}
