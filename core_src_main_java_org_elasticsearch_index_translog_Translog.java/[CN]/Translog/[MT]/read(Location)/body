{
  try (ReleasableLock lock=readLock.acquire()){
    final BaseTranslogReader reader;
    final long currentGeneration=current.getGeneration();
    if (currentGeneration == location.generation) {
      reader=current;
    }
 else     if (readers.isEmpty() == false && readers.get(readers.size() - 1).getGeneration() == location.generation) {
      reader=readers.get(readers.size() - 1);
    }
 else     if (currentGeneration < location.generation) {
      throw new IllegalStateException("location generation [" + location.generation + "] is greater than the current generation ["+ currentGeneration+ "]");
    }
 else {
      return null;
    }
    return reader.read(location);
  }
 catch (  IOException e) {
    throw new ElasticsearchException("failed to read source from translog location " + location,e);
  }
}
