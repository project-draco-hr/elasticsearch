{
  final long generation=parseIdFromFileName(path);
  if (generation < 0) {
    throw new TranslogException(shardId,"failed to parse generation from file name matching pattern " + path);
  }
  FileChannel channel=FileChannel.open(path,StandardOpenOption.READ);
  try {
    final ChannelReference raf=new ChannelReference(path,generation,channel,new OnCloseRunnable());
    ImmutableTranslogReader reader=ImmutableTranslogReader.open(raf,checkpoint,translogUUID);
    channel=null;
    return reader;
  }
  finally {
    IOUtils.close(channel);
  }
}
