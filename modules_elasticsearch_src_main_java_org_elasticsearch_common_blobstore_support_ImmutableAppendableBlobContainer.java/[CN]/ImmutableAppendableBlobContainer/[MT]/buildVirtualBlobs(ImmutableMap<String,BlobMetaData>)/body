{
  Set<String> names=Sets.newHashSet();
  for (  BlobMetaData blob : blobs.values()) {
    if (blob.name().endsWith(".a0")) {
      names.add(blob.name().substring(0,blob.name().lastIndexOf(".a0")));
    }
  }
  ImmutableMap.Builder<String,BlobMetaData> builder=ImmutableMap.builder();
  for (  String name : names) {
    long sizeInBytes=0;
    if (blobs.containsKey(name)) {
      sizeInBytes=blobs.get(name).sizeInBytes();
    }
 else {
      int part=0;
      while (true) {
        BlobMetaData md=blobs.get(name + ".a" + part);
        if (md == null) {
          break;
        }
        sizeInBytes+=md.sizeInBytes();
        part++;
      }
    }
    builder.put(name,new PlainBlobMetaData(name,sizeInBytes,null));
  }
  return builder.build();
}
