{
  return new AppendableBlob(){
    int part=0;
    @Override public void append(    final AppendBlobListener listener){
      BytesStreamOutput out=new BytesStreamOutput();
      try {
        listener.withStream(out);
      }
 catch (      Exception e) {
        listener.onFailure(e);
        return;
      }
      if (out.size() == 0) {
        listener.onCompleted();
        return;
      }
      String partBlobName=blobName + ".a" + (part++);
      ByteArrayInputStream is=new ByteArrayInputStream(out.unsafeByteArray(),0,out.size());
      container.writeBlob(partBlobName,is,out.size(),new ImmutableBlobContainer.WriterListener(){
        @Override public void onCompleted(){
          listener.onCompleted();
        }
        @Override public void onFailure(        Throwable t){
          listener.onFailure(t);
        }
      }
);
    }
    @Override public void close(){
    }
  }
;
}
