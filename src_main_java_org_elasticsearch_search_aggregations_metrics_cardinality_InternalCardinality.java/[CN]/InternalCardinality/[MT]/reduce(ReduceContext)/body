{
  List<InternalAggregation> aggregations=reduceContext.aggregations();
  InternalCardinality reduced=null;
  for (  InternalAggregation aggregation : aggregations) {
    final InternalCardinality cardinality=(InternalCardinality)aggregation;
    if (cardinality.counts != null) {
      if (reduced == null) {
        reduced=cardinality;
      }
 else {
        reduced.merge(cardinality);
      }
    }
  }
  if (reduced == null) {
    reduced=(InternalCardinality)aggregations.get(0);
  }
  return reduced;
}
