{
  httpServer=HttpServer.create(new InetSocketAddress(InetAddress.getLoopbackAddress(),0),0);
  httpServer.start();
  for (  int statusCode : getAllStatusCodes()) {
    createStatusCodeContext(httpServer,statusCode);
  }
  int numHeaders=RandomInts.randomIntBetween(random(),0,3);
  defaultHeaders=new Header[numHeaders];
  for (int i=0; i < numHeaders; i++) {
    String headerName="Header-default" + (random().nextBoolean() ? i : "");
    String headerValue=RandomStrings.randomAsciiOfLengthBetween(random(),3,10);
    defaultHeaders[i]=new BasicHeader(headerName,headerValue);
  }
  restClient=RestClient.builder(new HttpHost(httpServer.getAddress().getHostString(),httpServer.getAddress().getPort())).setDefaultHeaders(defaultHeaders).build();
}
