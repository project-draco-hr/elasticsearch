{
  RoutingNodes routingNodes=clusterState.routingNodes();
  routingNodes.unassigned().shuffle();
  RoutingAllocation allocation=new RoutingAllocation(allocationDeciders,routingNodes,clusterState.nodes(),clusterInfoService.getClusterInfo());
  if (!reroute(allocation)) {
    return new RoutingAllocation.Result(false,clusterState.routingTable(),allocation.explanation());
  }
  return new RoutingAllocation.Result(true,new RoutingTable.Builder().updateNodes(routingNodes).build().validateRaiseException(clusterState.metaData()),allocation.explanation());
}
